import{k as E,u as L,r as a,s as v,j as t,i as B}from"./main-vCmkj0Ph.js";import{B as P,m as q}from"./card-QZFCDucj.js";import{D as z,g as u}from"./dropdown-menu-CRv4RkRy.js";import{S as g}from"./StatsCard-DsNwPDbG.js";import{E as F}from"./EmptyState-BSzsQ55S.js";import{S as T}from"./SearchInput-B9MbIqTz.js";import{S as V}from"./SubmissionCard-CvZQKS6o.js";import"./label-DA0WPkHe.js";import{A as $}from"./arrow-left-DABf050f.js";import{F as G}from"./file-text-BrP95lln.js";import{C as I}from"./circle-check-BzSOXqD0.js";import{C as Q}from"./clock-BTS0eNcV.js";import{C as R}from"./circle-alert-CMpGX98n.js";import"./index-DF9gUw3L.js";import"./chevron-right-DOiZ8o1C.js";import"./x-WugK2QXI.js";import"./badge-DYNIDruK.js";import"./calendar-zMPY0UDh.js";const de=()=>{const{activityId:n}=E(),d=L(),[S,p]=a.useState(!0),[o,y]=a.useState(null),[l,x]=a.useState([]),[f,b]=a.useState([]),[r,C]=a.useState(""),[c,j]=a.useState({total:0,graded:0,pending:0});a.useEffect(()=>{w()},[n]),a.useEffect(()=>{_()},[l,r]);const w=async()=>{try{p(!0);const{data:e,error:i}=await v.from("activities").select("*").eq("id",n).single();if(i)throw i;y(e);const{data:s,error:h}=await v.from("submissions").select(`
          *,
          student:profiles!submissions_user_id_fkey(id, name, email, avatar_url)
        `).eq("activity_id",n).order("submitted_at",{ascending:!1});if(h)throw h;x(s||[]);const A=s?.filter(m=>m.status==="graded").length||0,D=s?.filter(m=>m.status==="pending").length||0;j({total:s?.length||0,graded:A,pending:D})}catch(e){console.error("Erro ao carregar submissões:",e)}finally{p(!1)}},_=()=>{if(!r){b(l);return}const e=r.toLowerCase(),i=l.filter(s=>s.student?.name?.toLowerCase().includes(e)||s.student?.email?.toLowerCase().includes(e));b(i)},k=e=>{d(`/teacher/grading/${e.id}`)},N=e=>{d(`/teacher/grading/${e.id}`)};return S?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx(B,{size:"lg",text:"Carregando submissões..."})}):t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[t.jsxs(P,{variant:"ghost",onClick:()=>d("/teacher/activities"),className:"mb-4",children:[t.jsx($,{className:"w-4 h-4 mr-2"}),"Voltar para Atividades"]}),t.jsx(z,{title:o?.title||"Atividade",subtitle:`Submissões dos alunos • Prazo: ${o?.due_date?new Date(o.due_date).toLocaleDateString("pt-BR"):"Sem prazo"}`,role:"teacher"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[t.jsx(g,{title:"Total de Submissões",value:c.total,icon:G,gradient:u.stats.activities,bgColor:"bg-blue-50 dark:bg-blue-950/30",delay:0}),t.jsx(g,{title:"Corrigidas",value:c.graded,icon:I,gradient:u.success,bgColor:"bg-green-50 dark:bg-green-950/30",delay:.1}),t.jsx(g,{title:"Pendentes",value:c.pending,icon:Q,gradient:u.warning,bgColor:"bg-amber-50 dark:bg-amber-950/30",delay:.2})]}),t.jsx("div",{className:"mb-8",children:t.jsx(T,{placeholder:"Buscar por nome ou email do aluno...",value:r,onChange:C})}),f.length>0?t.jsx(q.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map((e,i)=>t.jsx(V,{submission:{id:e.id,student:{name:e.student?.name||"Aluno",avatar:e.student?.avatar_url},activity:{title:o?.title},submittedAt:e.submitted_at,status:e.status||"pending",grade:e.grade,feedback:e.feedback,isLate:e.due_date&&new Date(e.submitted_at)>new Date(e.due_date)},onView:k,onGrade:N,delay:i*.05},e.id))}):t.jsx(F,{icon:R,title:r?"Nenhuma submissão encontrada":"Nenhuma submissão ainda",description:r?"Tente buscar por outro termo.":"Os alunos ainda não enviaram suas respostas para esta atividade."})]})};export{de as default};
