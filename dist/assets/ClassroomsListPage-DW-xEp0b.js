import{j as e,u as R,a as V,r as n,i as q}from"./main-B-DuDfC3.js";import{m as N,C as z,B as L}from"./card-D9y6cEbK.js";import{c as Q,v as A,D as U,g as f}from"./dropdown-menu-S8hb-z0t.js";import{S as b,E as H}from"./EmptyState-D7T78sMN.js";import{B as Z}from"./badge-D_5Pz7Pp.js";import{B as w}from"./book-open-BeEk0vLA.js";import{U as B}from"./users-DREcB8-a.js";import{C as G}from"./chevron-right-BFR20X-e.js";import{S as J}from"./SearchInput-Bn2zNm8E.js";import{F as K}from"./FilterBar-BgbnheIS.js";import"./label-CQXNCxhD.js";import{C as F}from"./classService-v8xczc_x.js";import{F as W}from"./file-text-Vxms5le2.js";import{C as X}from"./clock-CnEWE99A.js";import{P as T}from"./plus-B1Dkz-eg.js";import"./index-BvwGeBdQ.js";import"./x-5mMV-IBm.js";import"./chevron-down-3DbVtmBJ.js";const Y=({id:C,name:d,subject:j,teacher:u,studentCount:m=0,status:g="active",color:h="from-blue-500 to-indigo-500",delay:y=0,onClick:l,actionLabel:p="Ver Turma",onAction:r})=>{const x={active:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300",inactive:"bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-300",archived:"bg-gray-100 dark:bg-gray-800 text-gray-700 dark:text-gray-300"};return e.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:y},children:e.jsxs(z,{className:`overflow-hidden ${Q.card.interactive} bg-white dark:bg-slate-900`,onClick:l,children:[e.jsxs("div",{className:`h-24 bg-gradient-to-r ${h} relative overflow-hidden`,children:[e.jsx("div",{className:"absolute inset-0 bg-grid-white/[0.05]"}),e.jsx("div",{className:"absolute -top-10 -right-10 w-40 h-40 bg-white/10 rounded-full blur-3xl"})]}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-1",children:A(d)}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:A(j,"Sem disciplina")})]}),e.jsx(Z,{className:x[g],children:g==="active"?"Ativa":g==="inactive"?"Inativa":"Arquivada"})]}),e.jsxs("div",{className:"space-y-2 mb-6 text-sm text-slate-600 dark:text-slate-400",children:[u&&e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(w,{className:"w-4 h-4"}),e.jsx("span",{children:u})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4"}),e.jsxs("span",{children:[m," aluno",m!==1?"s":""]})]})]}),e.jsxs(L,{onClick:i=>{i.stopPropagation(),r?.()},className:"w-full bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white inline-flex items-center justify-center gap-2",children:[p,e.jsx(G,{className:"w-4 h-4"})]})]})]})})},ve=()=>{const C=R(),{user:d}=V(),[j,u]=n.useState(!0),[m,g]=n.useState([]),[h,y]=n.useState([]),[l,p]=n.useState(""),[r,x]=n.useState({status:null,sort:"name"}),[i,E]=n.useState({totalClasses:0,totalStudents:0,totalActivities:0,pendingCorrections:0});n.useEffect(()=>{P()},[d]),n.useEffect(()=>{_()},[m,l,r]);const P=async()=>{if(d)try{u(!0);const t=await F.getClasses({teacherId:d.id,activeOnly:!1});g(t||[]);const a=t.reduce((v,o)=>{const O=o.members?.filter(M=>M.role==="student").length||0;return v+O},0);let s=0,c=0;for(const v of t){const o=await F.getClassStats(v.id);s+=o.activitiesCount,c+=o.pendingCorrections}E({totalClasses:t.length,totalStudents:a,totalActivities:s,pendingCorrections:c})}catch(t){console.error("Erro ao carregar turmas:",t)}finally{u(!1)}},_=()=>{let t=[...m];if(l){const a=l.toLowerCase();t=t.filter(s=>s.name?.toLowerCase().includes(a)||s.subject?.toLowerCase().includes(a)||s.invite_code?.toLowerCase().includes(a))}r.status!==null&&(r.status==="active"?t=t.filter(a=>a.is_active):r.status==="inactive"&&(t=t.filter(a=>!a.is_active))),t.sort((a,s)=>{switch(r.sort){case"name":return(a.name||"").localeCompare(s.name||"");case"recent":return new Date(s.created_at)-new Date(a.created_at);case"students":{const c=a.members?.filter(o=>o.role==="student").length||0;return(s.members?.filter(o=>o.role==="student").length||0)-c}default:return 0}}),y(t)},$=(t,a)=>{x(s=>({...s,[t]:a}))},D=()=>{x({status:null,sort:"name"}),p("")},k=t=>{C(`/teacher/classes/${t}`)},S=()=>{C("/teacher/classes/new")};return j?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(q,{size:"lg",text:"Carregando turmas..."})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsx(U,{title:"Minhas Turmas",subtitle:`${i.totalClasses} turma${i.totalClasses!==1?"s":""} ${i.totalClasses>0?r.status==="active"?"ativa":r.status==="inactive"?"inativa":"":""}`,role:"teacher"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(b,{title:"Total de Alunos",value:i.totalStudents,icon:B,gradient:f.stats.students,bgColor:"bg-purple-50 dark:bg-purple-950/30",delay:0}),e.jsx(b,{title:"Total de Atividades",value:i.totalActivities,icon:W,gradient:f.stats.activities,bgColor:"bg-emerald-50 dark:bg-emerald-950/30",delay:.1}),e.jsx(b,{title:"Correções Pendentes",value:i.pendingCorrections,icon:X,gradient:f.stats.pending,bgColor:"bg-amber-50 dark:bg-amber-950/30",delay:.2}),e.jsx(b,{title:"Total de Turmas",value:i.totalClasses,icon:w,gradient:f.stats.classes,bgColor:"bg-blue-50 dark:bg-blue-950/30",delay:.3})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[e.jsx("div",{className:"flex-1",children:e.jsx(J,{placeholder:"Buscar por nome, matéria ou código...",value:l,onChange:p})}),e.jsx(K,{filters:[{key:"status",label:"Status",options:[{value:"active",label:"Ativas"},{value:"inactive",label:"Inativas"}]},{key:"sort",label:"Ordenar",options:[{value:"name",label:"Nome (A-Z)"},{value:"recent",label:"Mais Recentes"},{value:"students",label:"Mais Alunos"}]}],activeFilters:r,onFilterChange:$,onClearAll:D})]}),h.length>0?e.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-20",children:h.map((t,a)=>{const s=t.members?.filter(c=>c.role==="student").length||0;return e.jsx(Y,{id:t.id,name:t.name,subject:t.subject,studentCount:s,status:t.is_active?"active":"inactive",color:t.banner_color||t.color||"from-blue-500 to-indigo-500",delay:a*.05,onClick:()=>k(t.id),actionLabel:"Ver Turma",onAction:()=>k(t.id)},t.id)})}):e.jsx(H,{icon:w,title:l||r.status?"Nenhuma turma encontrada":"Você ainda não criou nenhuma turma",description:l||r.status?"Tente ajustar os filtros ou buscar por outro termo.":"Crie sua primeira turma para começar a gerenciar suas aulas e atividades.",actionLabel:"Criar Primeira Turma",actionIcon:T,action:S}),h.length>0&&e.jsx(N.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.5},className:"fixed bottom-8 right-8 z-50",children:e.jsx(L,{onClick:S,className:"w-16 h-16 rounded-full shadow-2xl bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white",children:e.jsx(T,{className:"w-8 h-8"})})})]})};export{ve as default};
