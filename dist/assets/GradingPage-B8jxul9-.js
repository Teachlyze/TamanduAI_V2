import{r as x,j as e,h as ne,u as de,s as L,q as oe}from"./main-BtydHokz.js";import{B as w}from"./button-pkZcz0fw.js";import{C as D}from"./card-BLN8IVBT.js";import{B}from"./badge-DpVvk9bK.js";import{B as ce}from"./Breadcrumb-BaVmLvd0.js";import{P as me}from"./progress-CWEmAj8D.js";import{u as xe}from"./use-toast-BD7ojcJx.js";import{c as te,D as be}from"./DashboardHeader-Do_OLCE8.js";import{I as ue}from"./input-DevW5dIO.js";import"./dropdown-menu-DQk5WS44.js";import{L as se}from"./label-Do1Gcpls.js";import{Z as he}from"./zap-BRB1NCIh.js";import{S as ge}from"./sparkles-HF3LVzbg.js";import{S as fe}from"./save-EZIFPJyD.js";import{X as pe}from"./x-BtLVjj0F.js";import{c as ve,a as je,g as Ne}from"./autoGradingService-B3SAx8MW.js";import{s as _}from"./toastUtils-CQiYPKw9.js";import{A as ke}from"./arrow-left-A7LEbFFM.js";import{U as we}from"./user-CD_i74Py.js";import{F as ae}from"./file-text-GwBv-P3B.js";import{C as ye}from"./index-C0ZNntAv.js";import{C as Se}from"./chevron-right-Bh44L5jc.js";import"./proxy-BKNTM3tf.js";import"./house-dUPObbYn.js";import"./index-BRR_QA-l.js";import"./index-DOzlJ45Y.js";import"./index-sWFH3d_M.js";import"./Combination-DK-gSie6.js";import"./SidebarPremium-BEHUuQck.js";import"./users-CntpuLnR.js";import"./book-open-BQJiPDff.js";import"./graduation-cap-Bm5psu3Q.js";import"./calendar-xkfkZRmm.js";import"./chart-column-B3n9ZMAW.js";import"./message-circle-DTeSrK_w.js";import"./settings-BNGXdjmZ.js";import"./brain-DIkHdpFj.js";import"./index-BpBd5wiB.js";import"./index-DsrKRt14.js";import"./check-B1zY7uXK.js";const Ae=({maxGrade:o=10,initialGrade:v=null,initialFeedback:f="",onSave:Q,onCancel:$,onAutoGrade:J,onAISuggestion:z,loading:s=!1,canUseAutoGrade:U=!1,canUseAI:d=!1})=>{const[h,j]=x.useState(v?.toString()||""),[P,c]=x.useState(f),[y,g]=x.useState({}),[F,R]=x.useState(!1),[I,W]=x.useState(!1),T=()=>{const i={};if(!h||h.trim()==="")i.grade="Nota é obrigatória";else{const p=parseFloat(h);isNaN(p)?i.grade="Nota deve ser um número":p<0?i.grade="Nota não pode ser negativa":p>o&&(i.grade=`Nota não pode ser maior que ${o}`)}return g(i),Object.keys(i).length===0},M=i=>{if(i.preventDefault(),!T())return;const p=parseFloat(h);Q({grade:p,feedback:P})},Z=i=>{const p=i.target.value;(p===""||/^\d*\.?\d*$/.test(p))&&(j(p),y.grade&&g({...y,grade:null}))};return e.jsx(D,{className:"p-6 bg-white dark:bg-slate-900",children:e.jsxs("form",{onSubmit:M,className:"space-y-6",children:[e.jsxs("div",{children:[e.jsxs(se,{htmlFor:"grade",className:"text-sm font-semibold mb-2 block",children:["Nota (0 - ",o,")"]}),e.jsxs("div",{className:"relative",children:[e.jsx(ue,{id:"grade",type:"text",value:h,onChange:Z,placeholder:`Ex: ${(o/2).toFixed(1)}`,className:`text-lg font-semibold ${y.grade?"border-red-500 focus:ring-red-500":""}`,disabled:s}),e.jsxs("span",{className:"absolute right-3 top-1/2 -translate-y-1/2 text-sm text-slate-500",children:["/ ",o]})]}),y.grade&&e.jsx("p",{className:"mt-1 text-sm text-red-600 dark:text-red-400",children:y.grade}),h&&!isNaN(parseFloat(h))&&e.jsx("div",{className:"mt-2",children:e.jsx("div",{className:"h-2 bg-slate-200 dark:bg-slate-700 rounded-full overflow-hidden",children:e.jsx("div",{className:`h-full transition-all ${parseFloat(h)>=o*.7?"bg-green-500":parseFloat(h)>=o*.5?"bg-yellow-500":"bg-red-500"}`,style:{width:`${Math.min(parseFloat(h)/o*100,100)}%`}})})})]}),(U||d)&&e.jsxs("div",{className:"flex gap-2",children:[U&&e.jsx(w,{type:"button",variant:"outline",size:"sm",onClick:async()=>{R(!0);try{const i=await J?.();i&&(j(i.grade?.toString()||""),c(i.feedback||""))}finally{R(!1)}},disabled:s||F||I,className:"flex-1",children:F?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-blue-600 border-t-transparent rounded-full animate-spin mr-2"}),"Corrigindo..."]}):e.jsxs(e.Fragment,{children:[e.jsx(he,{className:"w-4 h-4 mr-2 text-amber-500"}),"Correção Automática"]})}),d&&e.jsx(w,{type:"button",variant:"outline",size:"sm",onClick:async()=>{W(!0);try{const i=await z?.();i?.feedback&&c(i.feedback)}finally{W(!1)}},disabled:s||F||I,className:"flex-1",children:I?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-purple-600 border-t-transparent rounded-full animate-spin mr-2"}),"Gerando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(ge,{className:"w-4 h-4 mr-2 text-purple-500"}),"Sugestão por IA"]})})]}),e.jsxs("div",{children:[e.jsx(se,{htmlFor:"feedback",className:"text-sm font-semibold mb-2 block",children:"Feedback (opcional)"}),e.jsx("textarea",{id:"feedback",value:P,onChange:i=>c(i.target.value),placeholder:"Escreva um feedback para o aluno...",rows:6,disabled:s,className:`
              w-full px-3 py-2 rounded-lg border ${te.border.default}
              bg-white dark:bg-slate-900 ${te.text.primary}
              focus:ring-2 focus:ring-blue-500 focus:border-blue-500
              resize-none transition-all
            `}),e.jsxs("p",{className:"mt-1 text-xs text-slate-500 dark:text-slate-500",children:[P.length," caracteres"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{type:"submit",disabled:s,className:"flex-1 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white",children:s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(fe,{className:"w-4 h-4 mr-2"}),"Salvar Nota"]})}),$&&e.jsxs(w,{type:"button",variant:"outline",onClick:$,disabled:s,children:[e.jsx(pe,{className:"w-4 h-4 mr-2"}),"Cancelar"]})]})]})})},ut=()=>{const{submissionId:o}=ne(),v=de(),{toast:f}=xe(),[Q,$]=x.useState(!0),[J,z]=x.useState(!1),[s,U]=x.useState(null),[d,h]=x.useState(null),[j,P]=x.useState(null),[c,y]=x.useState([]),[g,F]=x.useState(0),[R,I]=x.useState(!1);x.useEffect(()=>{Z()},[o]);const W=async t=>{if(t)try{if(t.path){const{data:r,error:n}=await L.storage.from("submissions").download(t.path);if(n)throw n;const a=URL.createObjectURL(r);window.open(a,"_blank","noopener,noreferrer")}else t.url&&window.open(t.url,"_blank","noopener,noreferrer")}catch(r){_(f,"Não foi possível abrir o arquivo. Tente novamente.",r,{logPrefix:"[GradingPage] Erro ao abrir anexo da submissão"})}},T=()=>{if(!s)return!1;const t=s.content,r=Array.isArray(t?.attachments)?t.attachments:[];return d?.type==="project"||d?.content?.advanced_settings?.submissionMode==="file_upload"||r.length>0},M=()=>{if(!s?.content)return e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Nenhum conteúdo enviado."});const t=s.content,r=Array.isArray(t?.attachments)?t.attachments:[];if(T())return e.jsxs("div",{className:"space-y-4",children:[d?.description&&e.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900 border-l-4 border-indigo-500 rounded",children:[e.jsx("p",{className:"text-xs font-semibold text-indigo-600 dark:text-indigo-400 mb-2",children:"ENUNCIADO DA ATIVIDADE"}),e.jsx("div",{className:"text-sm text-slate-800 dark:text-slate-100",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word",lineHeight:"1.5"},children:d.description})]}),r.length>0?e.jsxs("div",{className:"p-4 bg-amber-50 dark:bg-amber-950/20 border-l-4 border-amber-500 rounded-lg",children:[e.jsxs("div",{className:"flex items-start justify-between gap-3 mb-3",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-semibold text-amber-800 dark:text-amber-300",children:"ARQUIVOS ENVIADOS PELO ALUNO"}),e.jsx("p",{className:"text-[11px] text-amber-800/80 dark:text-amber-200/80 mt-1",children:"Revise o arquivo antes de definir a nota e o feedback."})]}),e.jsx(B,{className:"bg-amber-100 dark:bg-amber-900/40 text-amber-800 dark:text-amber-200",children:r.length===1?"1 arquivo":`${r.length} arquivos`})]}),e.jsx("div",{className:"space-y-3",children:r.map((a,b)=>e.jsxs("div",{className:"flex items-center justify-between gap-4 rounded-md bg-white/70 dark:bg-slate-950/50 border border-amber-100 dark:border-amber-900 px-3 py-2.5",children:[e.jsxs("div",{className:"flex items-center gap-3 min-w-0 flex-1",children:[e.jsx("div",{className:"flex h-9 w-9 items-center justify-center rounded-md bg-amber-100 dark:bg-amber-900 text-amber-700 dark:text-amber-200 flex-shrink-0",children:e.jsx(ae,{className:"w-4 h-4"})}),e.jsxs("div",{className:"min-w-0",children:[e.jsx("p",{className:"text-xs font-medium text-slate-900 dark:text-slate-50 truncate",children:a.name||`Arquivo ${b+1}`}),e.jsx("p",{className:"text-[11px] text-slate-500 dark:text-slate-400 truncate",children:typeof a.size=="number"?`${(a.size/(1024*1024)).toFixed(1)} MB`:"Tamanho desconhecido"})]})]}),e.jsx(w,{type:"button",variant:"gradientOutline",size:"sm",className:"shrink-0 min-w-[130px]",onClick:()=>W(a),children:"Abrir arquivo"})]},a.path||a.url||b))})]}):e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Nenhum arquivo enviado nesta submissao."})]});if(typeof t=="string")return e.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-950 rounded-lg",children:e.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word",maxWidth:"100%",overflow:"hidden",fontFamily:"inherit",fontSize:"0.875rem",lineHeight:"1.5"},children:t})});try{const a=typeof t=="string"?JSON.parse(t):t||{},b=a.selectedAnswers||a.answers||a,K=d?.content?.questions||[];return K.length===0?e.jsx("div",{className:"space-y-4",children:Object.entries(b).map(([l,S],E)=>e.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-950 rounded-lg border border-slate-200 dark:border-slate-800",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-blue-100 dark:bg-blue-900 flex items-center justify-center text-blue-600 dark:text-blue-300 font-bold flex-shrink-0",children:E+1}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-slate-900 dark:text-white mb-1",children:["Questão ",E+1]}),e.jsxs("div",{className:"text-sm text-slate-700 dark:text-slate-300",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word",maxWidth:"100%",overflow:"hidden",lineHeight:"1.5"},children:[e.jsx("span",{className:"font-semibold",children:"Resposta: "}),Array.isArray(S)?S.join(", "):S]})]})]})},l))}):e.jsx("div",{className:"space-y-4",children:K.map((l,S)=>{const E=l.id??S,u=b?.[E]??b?.[String(E)];let V=u;if(l.alternatives&&l.alternatives.length>0&&u!==void 0&&u!==null){const m=String(u),k=l.alternatives.find(G=>String(G.id)===m),A=l.alternatives.find(G=>String(G.letter)===m),le=l.alternatives.find(G=>G.text===u);V=(k||A||le)?.text||m}let N=null;if(l.alternatives&&l.alternatives.length>0){const m=l.alternatives.filter(k=>k.isCorrect);m.length>0&&(N=m.map(k=>k.text).join(", "))}!N&&l.answerKey&&(N=l.answerKey);let O=!1;if(l.alternatives&&l.alternatives.length>0&&u!==void 0&&u!==null){const m=String(u);O=l.alternatives.filter(A=>A.isCorrect).some(A=>String(A.id)===m||String(A.letter)===m||A.text===u)}else if(l.answerKey){const m=l.answerKey;O=Array.isArray(u)?Array.isArray(m)&&u.length===m.length&&u.every(k=>m.includes(k)):u===m}const Y=!!N;return e.jsx("div",{className:`p-4 rounded-lg border-2 ${Y?O?"bg-emerald-50 dark:bg-emerald-950/30 border-emerald-300 dark:border-emerald-800":"bg-red-50 dark:bg-red-950/30 border-red-300 dark:border-red-800":"bg-slate-50 dark:bg-slate-950 border-slate-200 dark:border-slate-800"}`,children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:`w-8 h-8 rounded-full flex items-center justify-center font-bold flex-shrink-0 ${Y?O?"bg-emerald-500 text-white":"bg-red-500 text-white":"bg-blue-100 dark:bg-blue-900 text-blue-600 dark:text-blue-300"}`,children:S+1}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-900 dark:text-white mb-2",children:`Questão ${S+1}`}),l.text&&e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300 mb-2",children:l.text}),e.jsxs("div",{className:"mb-2",children:[e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"Resposta do aluno:"}),e.jsx("div",{className:"text-sm font-medium text-slate-900 dark:text-white mt-1",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word",maxWidth:"100%",overflow:"hidden",lineHeight:"1.5"},children:Array.isArray(V)?V.join(", "):V||"Sem resposta"})]}),N&&e.jsxs("div",{children:[e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-400",children:"Gabarito:"}),e.jsx("div",{className:"text-sm font-medium text-emerald-600 dark:text-emerald-400 mt-1",style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word",maxWidth:"100%",overflow:"hidden",lineHeight:"1.5"},children:Array.isArray(N)?N.join(", "):N})]}),Y&&e.jsx("div",{className:"mt-2",children:O?e.jsx(B,{className:"bg-emerald-500 text-white",children:"✓ Correta"}):e.jsx(B,{className:"bg-red-500 text-white",children:"✗ Incorreta"})})]})]})},l.id)})})}catch{return e.jsx("div",{className:"p-4 bg-slate-50 dark:bg-slate-950 rounded-lg",children:e.jsx("div",{style:{whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word",maxWidth:"100%",overflow:"auto",fontFamily:"monospace",fontSize:"0.875rem",lineHeight:"1.5"},children:JSON.stringify(s.content,null,2)})})}},Z=async()=>{try{$(!0);const{data:t,error:r}=await L.from("submissions").select(`
          *,
          student:profiles!student_id(id, full_name, email, avatar_url),
          activity:activities!activity_id(id, title, max_score, due_date, content)
        `).eq("id",o).single();if(r){_(f,"Não foi possível encontrar esta submissão.",r,{logPrefix:"[GradingPage] Erro ao carregar submissão"}),v("/dashboard/corrections");return}if(U(t),h(t.activity),t.activity&&I(ve(t.activity)),t.activity_id){const{data:b}=await L.from("activity_class_assignments").select(`
            class_id,
            classes:class_id(id, name, subject)
          `).eq("activity_id",t.activity_id).single();b?.classes&&P(b.classes)}const{data:n,error:a}=await L.from("submissions").select("id, student_id, status, submitted_at, grade").eq("activity_id",t.activity_id).order("submitted_at",{ascending:!0});if(!a){y(n||[]);const b=n?.findIndex(K=>K.id===o)??0;F(b)}}catch(t){_(f,"Não foi possível carregar a submissão. Tente novamente.",t,{logPrefix:"[GradingPage] Erro inesperado ao carregar submissão"})}finally{$(!1)}},i=async()=>{if(!d||!s)return null;try{const t=typeof s.content=="string"?JSON.parse(s.content):s.content||{},r=t.selectedAnswers||t.answers||t,n=d.content?.questions||[],a=je(n,r,d.max_score);if(a){const b=Ne(a);return f({title:"Correção automática concluída",description:`Nota: ${a.grade}/${d.max_score} (${a.correctCount}/${a.totalQuestions} corretas)`}),{grade:a.grade,feedback:b}}}catch(t){_(f,"Não foi possível corrigir automaticamente.",t,{logPrefix:"[GradingPage] Erro na correção automática"})}return null},p=async()=>{if(!s||!d)return null;try{return f({title:"Sugestão por IA",description:"Em breve você poderá gerar feedback com IA!"}),{feedback:`Revisão da submissão realizada.

Pontos fortes:
- Organização das respostas
- Compreensão do conteúdo

Pontos de melhoria:
- Revisar conceitos específicos
- Aprofundar justificativas`}}catch(t){_(f,"Não foi possível gerar sugestão.",t,{logPrefix:"[GradingPage] Erro ao gerar sugestão por IA"})}return null},re=async({grade:t,feedback:r})=>{try{z(!0);const{error:n}=await L.from("submissions").update({grade:t,feedback:r,status:"graded",graded_at:new Date().toISOString(),updated_at:new Date().toISOString()}).eq("id",o);if(n)throw n;if(f({title:"✅ Nota salva com sucesso!",description:"O feedback foi enviado ao aluno."}),g<c.length-1){const a=c[g+1];v(`/dashboard/grading/${a.id}`)}else v("/dashboard/corrections")}catch(n){_(f,"Não foi possível salvar a nota. Tente novamente em instantes.",n,{logPrefix:"[GradingPage] Erro ao salvar nota"})}finally{z(!1)}},ee=t=>{const r=t==="prev"?g-1:g+1;if(r>=0&&r<c.length){const n=c[r];v(`/dashboard/grading/${n.id}`)}};if(Q)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(oe,{size:"lg",text:"Carregando submissão..."})});const H=T(),C=c.length||0,q=c.filter(t=>t.status==="graded").length,ie=C?q/C*100:0,X=[{label:"Correções",path:"/dashboard/corrections"}];return d&&X.push({label:d.title,path:`/dashboard/activities/${d.id}/submissions`}),s?.student?.full_name&&X.push({label:s.student.full_name}),e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsx("div",{className:"sticky top-0 z-20 -mx-6 mb-6 border-b border-slate-200/60 bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900",children:e.jsxs("div",{className:"px-6 pt-4",children:[e.jsxs("div",{className:"flex flex-col gap-3 md:flex-row md:items-center md:justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(w,{variant:"ghost",onClick:()=>v("/dashboard/corrections"),children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Voltar para Submissões"]}),e.jsx(ce,{items:X})]}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500 dark:text-slate-400",children:[e.jsxs("span",{children:["Submissão ",g+1," de ",C||0]}),e.jsx("span",{children:"•"}),e.jsxs("span",{children:[q," de ",C||0," corrigidas"]})]})]}),e.jsx("div",{className:"mt-4",children:e.jsx(be,{title:`Corrigir Submissão${s?.student?.full_name?` - ${s.student.full_name}`:""}`,subtitle:`${d?.title||"Atividade"}${j?.name?` • Turma: ${j.name}`:""} • ${g+1} de ${c.length}`,role:"teacher"})}),e.jsxs("div",{className:"mt-4 pb-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"text-xs font-medium text-slate-600 dark:text-slate-300",children:"Progresso da correção desta atividade"}),e.jsxs("span",{className:"text-xs text-slate-500 dark:text-slate-400",children:[q," de ",C," corrigidas"]})]}),e.jsx(me,{value:ie})]})]})}),C>0&&e.jsx("div",{className:"mb-6",children:e.jsxs(D,{className:"p-4 bg-white dark:bg-slate-900",children:[e.jsx("h3",{className:"text-sm font-semibold text-slate-900 dark:text-slate-100 mb-2",children:"Linha do tempo das submissões"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400 mb-3",children:"Histórico de envios desta atividade. Clique para navegar entre as submissões."}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto pr-1",children:c.map((t,r)=>{const n=t.id===o,a=t.status==="graded";return e.jsxs("button",{type:"button",onClick:()=>{n||v(`/dashboard/grading/${t.id}`)},className:`w-full flex items-center justify-between rounded-md border px-3 py-2 text-left text-xs transition-colors ${n?"border-blue-500 bg-blue-50 dark:bg-blue-950/40 text-blue-900 dark:text-blue-100":"border-slate-200 dark:border-slate-800 bg-white dark:bg-slate-900 hover:bg-slate-50 dark:hover:bg-slate-800"}`,children:[e.jsxs("div",{className:"flex flex-col",children:[e.jsxs("span",{className:"font-medium",children:["Submissão ",r+1,n?" • atual":""]}),e.jsx("span",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:t.submitted_at?new Date(t.submitted_at).toLocaleString("pt-BR"):"Sem data de envio"})]}),e.jsx(B,{className:a?"bg-emerald-100 dark:bg-emerald-900/40 text-emerald-700 dark:text-emerald-300":"bg-amber-100 dark:bg-amber-900/40 text-amber-700 dark:text-amber-300",children:a?"Corrigida":"Pendente"})]},t.id)})})]})}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsxs(D,{className:"p-6 bg-white dark:bg-slate-900",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(we,{className:"w-5 h-5"}),"Informações do Aluno"]}),e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[s?.student?.avatar_url?e.jsx("img",{src:s.student.avatar_url,alt:s.student.full_name,className:"w-16 h-16 rounded-full object-cover"}):e.jsx("div",{className:"w-16 h-16 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-white text-2xl font-bold",children:s?.student?.full_name?.[0]||"A"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold text-slate-900 dark:text-white text-lg",children:s?.student?.full_name||"Aluno"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:s?.student?.email||"Sem email"}),j&&e.jsxs("p",{className:"text-sm font-medium text-blue-600 dark:text-blue-400 mt-1",children:[j.name," ",j.subject&&`- ${j.subject}`]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Data de Envio:"}),e.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:s?.submitted_at?new Date(s.submitted_at).toLocaleString("pt-BR"):"Não enviada"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-slate-600 dark:text-slate-400",children:"Status:"}),e.jsx("div",{className:"mt-1",children:e.jsx(B,{className:s?.status==="graded"?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300",children:s?.status==="graded"?"Corrigida":"Pendente"})})]})]})]}),e.jsxs(D,{className:"p-6 bg-white dark:bg-slate-900",children:[e.jsxs("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(ae,{className:"w-5 h-5"}),"Conteúdo da Submissão"]}),e.jsx("div",{className:"max-w-none",children:M()})]})]}),e.jsxs("div",{className:"space-y-6",children:[e.jsx(Ae,{maxGrade:d?.max_score||10,initialGrade:s?.grade,initialFeedback:s?.feedback||"",onSave:re,onCancel:()=>v("/dashboard/corrections"),onAutoGrade:H?void 0:i,onAISuggestion:H?void 0:p,loading:J,canUseAutoGrade:H?!1:R,canUseAI:!H}),e.jsx(D,{className:"p-4 bg-white dark:bg-slate-900",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(w,{variant:"outline",onClick:()=>ee("prev"),disabled:g===0,children:[e.jsx(ye,{className:"w-4 h-4 mr-2"}),"Anterior"]}),e.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:[g+1," de ",c.length]}),e.jsxs(w,{variant:"outline",onClick:()=>ee("next"),disabled:g>=c.length-1,children:["Próxima",e.jsx(Se,{className:"w-4 h-4 ml-2"})]})]})})]})]})]})};export{ut as default};
