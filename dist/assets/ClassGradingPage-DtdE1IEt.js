import{t as P,u as $,r as s,s as j,l as q,j as a,p as G}from"./main--zAWDl51.js";import{B as Q,m as T}from"./button-C_V7g8cA.js";import{D as V,g as p}from"./DashboardHeader-CXdzO2BU.js";import{S as g}from"./StatsCard-mRekzbqi.js";import{E as z}from"./EmptyState-8gRtOYrE.js";import"./card-CLX4UMWo.js";import{S as H}from"./SearchInput-CWSsSs42.js";import{F as R}from"./FilterBar-DOqOoc41.js";import{S as J}from"./SubmissionCard-BO00aUsR.js";import"./input-Bs41O7Fb.js";import"./label-CISVKdgd.js";import{C as K}from"./classService-DDGixHj3.js";import{A as M}from"./arrow-left-Di5UEUQK.js";import{C as f}from"./circle-check-BzMnC4qM.js";import{C as O}from"./clock-D8WWZ3gq.js";import"./chevron-right-CHTWP7iA.js";import"./search-CtXZRXuc.js";import"./x-CvZonSQM.js";import"./dropdown-menu-D0mYKqvK.js";import"./SidebarPremium-CfP5whq7.js";import"./index-CJgcaHTP.js";import"./house-CLldyvL4.js";import"./users-C9tJN0-i.js";import"./book-open-DyM283ur.js";import"./file-text-B2IQk9lY.js";import"./graduation-cap-D26J0z2u.js";import"./calendar-DeEHT-Ew.js";import"./chart-column-C5QwmSZ5.js";import"./message-circle-CZexvp4h.js";import"./settings-C_eaHXhN.js";import"./index-Bvvn9rAe.js";import"./index-Bv89TW0t.js";import"./index-B6vL-k38.js";import"./index-CW7aGg6Q.js";import"./index-CnE12kOi.js";import"./check-VEyQrJQ_.js";import"./badge-DEf2O6Nf.js";import"./funnel-Cr4vRVVN.js";import"./chevron-down-COfygcpm.js";import"./circle-alert-BtJGe8bW.js";const Pt=()=>{const{classId:n}=P(),c=$(),[_,m]=s.useState(!0),[w,N]=s.useState(null),[v,h]=s.useState([]),[y,k]=s.useState([]),[l,x]=s.useState(""),[i,S]=s.useState({status:null,activityId:null}),[u,I]=s.useState({total:0,graded:0,pending:0}),[b,A]=s.useState([]);s.useEffect(()=>{F()},[n]),s.useEffect(()=>{E()},[v,l,i]);const F=async()=>{try{m(!0);const t=await K.getClassById(n);N(t);const{data:e}=await j.from("activity_class_assignments").select("activity:activities(id, title)").eq("class_id",n),r=e?.map(o=>o.activity).filter(Boolean)||[];A(r);const C=r.map(o=>o.id);if(C.length===0){h([]),m(!1);return}const{data:d}=await j.from("submissions").select(`
          *,
          student:profiles!submissions_user_id_fkey(id, full_name, email, avatar_url),
          activity:activities(id, title)
        `).in("activity_id",C).order("submitted_at",{ascending:!1});h(d||[]);const B=d?.filter(o=>o.status==="graded").length||0,D=d?.filter(o=>o.status==="pending").length||0;I({total:d?.length||0,graded:B,pending:D})}catch(t){q.error("Erro:",t)}finally{m(!1)}},E=()=>{let t=[...v];if(l){const e=l.toLowerCase();t=t.filter(r=>r.student?.name?.toLowerCase().includes(e)||r.activity?.title?.toLowerCase().includes(e))}i.status&&(t=t.filter(e=>e.status===i.status)),i.activityId&&(t=t.filter(e=>e.activity_id===i.activityId)),k(t)},L=(t,e)=>{S(r=>({...r,[t]:e}))};return _?a.jsx("div",{className:"flex items-center justify-center min-h-screen",children:a.jsx(G,{size:"lg"})}):a.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[a.jsxs(Q,{variant:"ghost",onClick:()=>c(`/dashboard/classes/${n}`),className:"mb-4",children:[a.jsx(M,{className:"w-4 h-4 mr-2"}),"Voltar"]}),a.jsx(V,{title:`Correções - ${w?.name||"Turma"}`,subtitle:"Submissões para corrigir",role:"teacher"}),a.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[a.jsx(g,{title:"Total de Submissões",value:u.total,icon:f,gradient:p.primary,delay:0}),a.jsx(g,{title:"Corrigidas",value:u.graded,icon:f,gradient:p.success,delay:.1}),a.jsx(g,{title:"Pendentes",value:u.pending,icon:O,gradient:p.warning,delay:.2})]}),a.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[a.jsx("div",{className:"flex-1",children:a.jsx(H,{placeholder:"Buscar por aluno ou atividade...",value:l,onChange:x})}),a.jsx(R,{filters:[{key:"status",label:"Status",options:[{value:"pending",label:"Pendentes"},{value:"graded",label:"Corrigidas"}]},...b.length>0?[{key:"activityId",label:"Atividade",options:b.map(t=>({value:t.id,label:t.title}))}]:[]],activeFilters:i,onFilterChange:L,onClearAll:()=>{S({status:null,activityId:null}),x("")}})]}),y.length>0?a.jsx(T.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map((t,e)=>a.jsx(J,{submission:{id:t.id,student:{name:t.student?.name,avatar:t.student?.avatar_url},activity:{title:t.activity?.title},submittedAt:t.submitted_at,status:t.status,grade:t.grade,feedback:t.feedback},onView:()=>c(`/dashboard/grading/${t.id}`),onGrade:()=>c(`/dashboard/grading/${t.id}`),delay:e*.05},t.id))}):a.jsx(z,{icon:f,title:l||i.status?"Nenhuma submissão encontrada":"Nenhuma submissão nesta turma",description:l||i.status?"Ajuste os filtros.":"Aguardando submissões dos alunos."})]})};export{Pt as default};
