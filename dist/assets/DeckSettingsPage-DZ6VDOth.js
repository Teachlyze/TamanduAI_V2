import{h as A,b as I,u as R,r as i,l as d,j as e,q as y}from"./main-CI5_MmIm.js";import{B as o}from"./button-D7H9d9Gd.js";import{C as h}from"./card-DpcnMbcE.js";import{L as m}from"./label-Nf4YzbUq.js";import{I as U}from"./input-BJMmyirp.js";import{T as q}from"./textarea-BEqUT7e4.js";import{S as z}from"./switch-Bh1E7XLH.js";import{u as V}from"./use-toast-D7N2H9RC.js";import{D as P}from"./DashboardHeader-CYuk3ql1.js";import"./dropdown-menu-dTrFNQHD.js";import{f as p}from"./flashcardService-DaDHhMrj.js";import{C as J}from"./ConfirmDialog-YuBKBIXX.js";import{S as G}from"./SuccessDialog-lcuJhA3l.js";import{A as H}from"./arrow-left-AtIy0G9L.js";import{m as f}from"./proxy-CT7Xtxle.js";import{F as K}from"./file-text-CtozP3gh.js";import{E as M}from"./eye-byIwLEg7.js";import{E as Q}from"./eye-off-DGaewRMO.js";import{S as w}from"./share-2-B47SjBv0.js";import{D as W}from"./download-Crb5Tmz4.js";import{U as X}from"./upload-DrqS-mb7.js";import{T as Y}from"./trash-2-CwB_tbLS.js";import{S as Z}from"./save-Bvez_5XM.js";import"./index-D4BuPd_i.js";import"./index-DrPD6SFW.js";import"./index-CRRraFTu.js";import"./index-CtvfaZbL.js";import"./index-DHrdJ99Z.js";import"./Combination-BfETjw1A.js";import"./SidebarPremium-0_wHXPj0.js";import"./house-B6Hparzo.js";import"./users-ChR7WEeh.js";import"./book-open-DlGI5eOy.js";import"./graduation-cap-mPfDCRgT.js";import"./calendar-Dbm_7POQ.js";import"./chart-column-G5dLAdkQ.js";import"./message-circle-CRpVuYq9.js";import"./settings-BWUwUKXK.js";import"./brain-DVBX4Id_.js";import"./index-RHGs5twt.js";import"./chevron-right-CHSrP1xQ.js";import"./x-DGmYUGM5.js";import"./index-jkBwDHc_.js";import"./check-GhIpAKm1.js";import"./triangle-alert-ta0gV1VM.js";import"./circle-check-big-KDmohnfK.js";const ee=[{value:"#EF4444",label:"Vermelho"},{value:"#F97316",label:"Laranja"},{value:"#F59E0B",label:"Amarelo"},{value:"#10B981",label:"Verde"},{value:"#3B82F6",label:"Azul"},{value:"#6366F1",label:"Índigo"},{value:"#8B5CF6",label:"Roxo"},{value:"#EC4899",label:"Rosa"}],Ke=()=>{const{deckId:r}=A(),{user:v}=I(),{toast:t}=V(),l=R(),[C,j]=i.useState(!0),[x,g]=i.useState(!1),[D,k]=i.useState(!1),[S,b]=i.useState(!1),[E,F]=i.useState(null),[a,c]=i.useState({name:"",description:"",color:"#3B82F6",icon:"BookOpen",is_public:!1});i.useEffect(()=>{v?.id&&r&&L()},[v,r]);const L=async()=>{try{j(!0);const{data:s,error:n}=await p.getDeckById(r);if(n)throw n;F(s),c({name:s.name||"",description:s.description||"",color:s.color||"#3B82F6",icon:s.icon||"BookOpen",is_public:s.is_public||!1})}catch(s){d.error("Error loading deck:",s),t({title:"Erro ao carregar",description:"Não foi possível carregar o deck.",variant:"destructive"}),l("/students/flashcards")}finally{j(!1)}},O=async()=>{try{g(!0);const{error:s}=await p.updateDeck(r,a);if(s)throw s;b(!0)}catch(s){d.error("Error saving deck:",s),t({title:"Erro ao salvar",description:"Não foi possível salvar as configurações.",variant:"destructive"})}finally{g(!1)}},B=()=>{b(!1),l(`/students/flashcards/decks/${r}`)},$=async()=>{try{const{error:s}=await p.deleteDeck(r);if(s)throw s;t({title:"Deck excluído",description:"O deck e todos os cards foram removidos."}),l("/students/flashcards")}catch(s){d.error("Error deleting deck:",s),t({title:"Erro ao excluir",description:"Não foi possível excluir o deck.",variant:"destructive"})}},T=async()=>{try{const{data:s}=await p.getCardsInDeck(r),n={deck:a,cards:s||[],exported_at:new Date().toISOString()},_=new Blob([JSON.stringify(n,null,2)],{type:"application/json"}),N=URL.createObjectURL(_),u=document.createElement("a");u.href=N,u.download=`${a.name.replace(/\s+/g,"_")}_deck.json`,u.click(),URL.revokeObjectURL(N),t({title:"Deck exportado!",description:"O arquivo foi baixado com sucesso."})}catch(s){d.error("Error exporting deck:",s),t({title:"Erro ao exportar",description:"Não foi possível exportar o deck.",variant:"destructive"})}};return C?e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(y,{size:"lg",text:"Carregando deck..."})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-4 sm:p-6",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(o,{variant:"ghost",onClick:()=>l(`/students/flashcards/decks/${r}`),className:"mb-4 hover:bg-slate-200 dark:hover:bg-slate-800",children:[e.jsx(H,{className:"w-4 h-4 mr-2"}),"Voltar"]}),e.jsx(P,{title:"Configurações do Deck",subtitle:`Gerenciar "${a.name}"`})]}),e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.1},children:e.jsxs(h,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-xl",children:e.jsx(K,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Informações Básicas"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Nome, descrição e aparência do deck"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(m,{htmlFor:"name",children:"Nome do Deck *"}),e.jsx(U,{id:"name",value:a.name,onChange:s=>c({...a,name:s.target.value}),placeholder:"Ex: Vocabulário Japonês",className:"mt-2",required:!0})]}),e.jsxs("div",{children:[e.jsx(m,{htmlFor:"description",children:"Descrição"}),e.jsx(q,{id:"description",value:a.description,onChange:s=>c({...a,description:s.target.value}),placeholder:"Descreva o conteúdo deste deck...",rows:3,className:"mt-2"})]}),e.jsxs("div",{children:[e.jsx(m,{children:"Cor do Deck"}),e.jsx("div",{className:"grid grid-cols-4 gap-3 mt-2",children:ee.map(s=>e.jsx("button",{onClick:()=>c({...a,color:s.value}),className:`p-4 rounded-lg border-2 transition-all ${a.color===s.value?"border-slate-900 dark:border-white scale-105":"border-transparent hover:scale-105"}`,style:{backgroundColor:s.value},title:s.label,children:e.jsx("span",{className:"sr-only",children:s.label})},s.value))})]})]})]})}),e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.2},children:e.jsxs(h,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-purple-100 dark:bg-purple-900/30 rounded-xl",children:a.is_public?e.jsx(M,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"}):e.jsx(Q,{className:"w-6 h-6 text-purple-600 dark:text-purple-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Privacidade"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Controle quem pode ver este deck"})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx(m,{children:"Deck público"}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Outros usuários poderão ver e clonar este deck"})]}),e.jsx(z,{checked:a.is_public,onCheckedChange:s=>c({...a,is_public:s})})]})]})}),e.jsx(f.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:.3},children:e.jsxs(h,{className:"p-6 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-xl",children:e.jsx(w,{className:"w-6 h-6 text-green-600 dark:text-green-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white",children:"Ações"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Exportar, compartilhar ou excluir"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-3",children:[e.jsxs(o,{variant:"outline",onClick:T,className:"justify-start",children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Exportar Deck"]}),e.jsxs(o,{variant:"outline",onClick:()=>t({title:"Em breve",description:"Funcionalidade de importação em desenvolvimento"}),className:"justify-start",disabled:!0,children:[e.jsx(X,{className:"w-4 h-4 mr-2"}),"Importar Cards"]}),e.jsxs(o,{variant:"outline",onClick:()=>{navigator.clipboard.writeText(`${window.location.origin}/students/flashcards/decks/${r}`),t({title:"Link copiado!",description:"Link do deck copiado para área de transferência."})},className:"justify-start",children:[e.jsx(w,{className:"w-4 h-4 mr-2"}),"Copiar Link"]}),e.jsxs(o,{variant:"destructive",onClick:()=>k(!0),className:"justify-start",children:[e.jsx(Y,{className:"w-4 h-4 mr-2"}),"Excluir Deck"]})]})]})}),e.jsxs("div",{className:"flex gap-4 justify-end",children:[e.jsx(o,{variant:"outline",onClick:()=>l(`/students/flashcards/decks/${r}`),disabled:x,children:"Cancelar"}),e.jsx(o,{onClick:O,disabled:x||!a.name.trim(),className:"bg-gradient-to-r from-purple-600 to-pink-600 hover:from-purple-700 hover:to-pink-700 text-white",children:x?e.jsxs(e.Fragment,{children:[e.jsx(y,{size:"sm",className:"mr-2"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Z,{className:"w-4 h-4 mr-2"}),"Salvar Alterações"]})})]}),e.jsx(J,{isOpen:D,onClose:()=>k(!1),onConfirm:$,title:"Excluir deck?",message:`Tem certeza que deseja excluir "${a.name}"? Esta ação não pode ser desfeita e todos os ${E?.total_cards||0} cards serão perdidos.`,confirmText:"Sim, excluir",cancelText:"Cancelar",variant:"danger"}),e.jsx(G,{isOpen:S,onClose:B,title:"Deck atualizado!",message:`As configurações do deck "${a.name}" foram salvas com sucesso.`})]})})};export{Ke as default};
