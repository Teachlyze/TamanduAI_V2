import{l as T,s as R,j as n,r as h,e as Ot,a as Et,g as y,y as bs,q as ws}from"./main-DAPsYT4a.js";import{B as $,u as De,e as js,m as Ns}from"./button-DFkxrTs2.js";import{C as Z}from"./card-CHLrcnUu.js";import{I as ot}from"./input-gY-F_5Pf.js";import{e as Ss,S as Ze,a as Xe,b as Ke,c as Je,d as ue}from"./select-BPeLDmde.js";import"./tabs-Dv6sYzdL.js";import{D as Cs,g as wt}from"./DashboardHeader-tBreTLm8.js";import{S as Qe}from"./StatsCard-CQYLaL8r.js";import{E as _s}from"./EmptyState-AuFi0cll.js";import{D as Qt,a as er,b as tr,d as ks,c as _t}from"./dropdown-menu-r_4kt0iB.js";import{L as U}from"./label-B849_cEC.js";import{u as it}from"./use-toast-Bdk-Ih8K.js";import{N as rr,a as Ds,C as Ms}from"./classService-BK2z6rXM.js";import{D as tt,a as rt,b as sr,c as nr}from"./dialog-Cmv7zdkS.js";import{T as Tt}from"./textarea-CCuayRqG.js";import{F as At,T as Os}from"./trending-up-B2-WBYxN.js";import{S as kt}from"./slider-DBZJSJvV.js";import{e as ke,T as ie,k as ar,u as Es,l as Ts,p as As,c as le,m as or,P as Ye,b as Ps,D as Ws,n as Is,o as Rs,C as Fs,a as Ee,d as Bs}from"./SidebarPremium-B0l6FvNw.js";import{c as ir,P as We}from"./index-CxoQTrGk.js";import{h as Ys,R as Ls,u as $s,F as zs}from"./index-D0-hv4e2.js";import{R as lr,a as Te}from"./radio-group-BH8Khy3h.js";import{M as et}from"./message-square-9JNOD9_T.js";import{T as Ht}from"./thumbs-up-Dk8hUZqd.js";import{C as st}from"./circle-alert-DnnpR18B.js";import{L as qt}from"./lightbulb-CYZqaU6p.js";import{X as Pt}from"./x-B7wPkr0Q.js";import{C as Hs}from"./chevron-right-CgUPhRTY.js";import{S as qs}from"./save-BhZk2-Yl.js";import{C as Dt}from"./checkbox-Dcv3HmC1.js";import{c as Re}from"./utils-CgPOOQdm.js";import{C as cr}from"./index-DTFBvU13.js";import{S as Us}from"./shield-BK_xWETD.js";import{E as Vs}from"./ellipsis-vertical-DzgFdeHn.js";import{U as Gs}from"./user-BscNjPFV.js";import{f as ze,d as Zs,g as Xs,a as Ks,i as Js,s as Qs,b as en,c as tn,e as rn}from"./format-BcFT9btV.js";import{p as Le}from"./pt-BR-CuGSKEGQ.js";import{c as je,t as ce,n as sn,e as dr}from"./en-US-B6HbAA6N.js";import{a as ur}from"./addDays-pVIPqqUr.js";import{a as fr,n as mr,i as nn,s as an}from"./isSameMonth-CK0W24Ro.js";import{d as on}from"./differenceInCalendarMonths-FFYroMBa.js";import{e as hr}from"./endOfWeek-BRNs0S5s.js";import{i as ln}from"./isSameDay-D5LInQhv.js";import{e as cn}from"./endOfMonth-BD-g1yyK.js";import{u as dn}from"./index-CKoyZSwW.js";import{U as un}from"./users-Bs21yf14.js";import{T as fn}from"./triangle-alert-t8QkS9SO.js";import{C as mn}from"./clock-CYIyH-Yw.js";import{C as hn}from"./circle-check-big-DQOwfVGB.js";import{S as pn}from"./search-D-GL0Z3Y.js";import{F as gn}from"./funnel-DfEmb5YQ.js";import{D as xn}from"./download-wFpaslwU.js";import"./index-Bd5NktG4.js";import"./index-B2bzlyZg.js";import"./chevron-down-gl_d4Nmb.js";import"./check-cEAmrvjJ.js";import"./chevron-up-DF4ET_PF.js";import"./index-CCLfHPmf.js";import"./settings-BMbEXDky.js";import"./house-Dx0sCuaE.js";import"./graduation-cap-BRPCRZmC.js";import"./chart-column-DPF3N0FI.js";function vn(e,t,r){return ur(e,t*7,r)}function yn(e,t,r){return fr(e,t*12,r)}function bn(e,t){let r,s=t?.in;return e.forEach(a=>{!s&&typeof a=="object"&&(s=je.bind(null,a));const o=ce(a,s);(!r||r<o||isNaN(+o))&&(r=o)}),je(s,r||NaN)}function wn(e,t){let r,s=t?.in;return e.forEach(a=>{!s&&typeof a=="object"&&(s=je.bind(null,a));const o=ce(a,s);(!r||r>o||isNaN(+o))&&(r=o)}),je(s,r||NaN)}function jn(e,t){const{start:r,end:s}=mr(t?.in,e);let a=+r>+s;const o=a?+r:+s,l=a?s:r;l.setHours(0,0,0,0),l.setDate(1);let i=1;const c=[];for(;+l<=o;)c.push(je(r,l)),l.setMonth(l.getMonth()+i);return a?c.reverse():c}function Nn(e,t){const r=ce(e,t?.in),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(23,59,59,999),r}function Sn(e,t){const{start:r,end:s}=mr(t?.in,e);let a=+r>+s;const o=a?+r:+s,l=a?s:r;l.setHours(0,0,0,0),l.setMonth(0,1);let i=1;const c=[];for(;+l<=o;)c.push(je(r,l)),l.setFullYear(l.getFullYear()+i);return a?c.reverse():c}function Cn(e,t){return hr(e,{...t,weekStartsOn:1})}function _n(e,t){const r=ce(e,t?.in),s=r.getFullYear(),a=r.getMonth(),o=je(r,0);return o.setFullYear(s,a+1,0),o.setHours(0,0,0,0),o.getDate()}function kn(e,t){return ce(e,t?.in).getMonth()}function Dn(e,t){return ce(e,t?.in).getFullYear()}function Mn(e,t){return+ce(e)>+ce(t)}function On(e,t){return+ce(e)<+ce(t)}function En(e,t,r){const[s,a]=sn(r?.in,e,t);return s.getFullYear()===a.getFullYear()}function Tn(e,t,r){const s=ce(e,r?.in),a=s.getFullYear(),o=s.getDate(),l=je(e,0);l.setFullYear(a,t,15),l.setHours(0,0,0,0);const i=_n(l);return s.setMonth(t,Math.min(o,i)),s}function An(e,t,r){const s=ce(e,r?.in);return isNaN(+s)?je(e,NaN):(s.setFullYear(t),s)}const He={"0-10":{min:0,max:10,type:"numeric",decimals:2},"0-100":{min:0,max:100,type:"numeric",decimals:0},"A-F":{type:"letter",scale:[{letter:"A",min:9,max:10},{letter:"B",min:7,max:8.9},{letter:"C",min:5,max:6.9},{letter:"D",min:3,max:4.9},{letter:"F",min:0,max:2.9}]},"pass-fail":{type:"binary",scale:[{label:"Aprovado",min:6,max:10},{label:"Reprovado",min:0,max:5.9}]},"excellent-poor":{type:"concept",scale:[{label:"Excelente",min:9,max:10},{label:"Ã“timo",min:7.5,max:8.9},{label:"Bom",min:6,max:7.4},{label:"Regular",min:4,max:5.9},{label:"Insuficiente",min:0,max:3.9}]}};function Pn(e,t="0-10"){const r=He[t];if(!r)return T.warn(`Sistema de notas desconhecido: ${t}, usando 0-10`),parseFloat(e);if(t==="0-10")return parseFloat(e);if(r.type==="numeric")return parseFloat(e)/r.max*10;if(r.type==="letter"){const a=r.scale.find(o=>o.letter===e.toUpperCase());if(a)return(a.min+a.max)/2}if(r.type==="binary"||r.type==="concept"){const a=r.scale.find(o=>o.label===e);if(a)return(a.min+a.max)/2}const s=parseFloat(e);return isNaN(s)?0:s}function Wn(e,t="0-10"){const r=He[t],s=parseFloat(e);if(isNaN(s))return"";if(!r)return s;if(t==="0-10")return s.toFixed(r.decimals);if(r.type==="numeric"){const a=s/10*r.max;return Math.round(a)}if(r.type==="letter"){const a=r.scale.find(o=>s>=o.min&&s<=o.max);return a?a.letter:"F"}if(r.type==="binary"||r.type==="concept"){const a=r.scale.find(o=>s>=o.min&&s<=o.max);return a?a.label:r.scale[r.scale.length-1].label}return s}function In(e="0-10"){const t=He[e];return!t||t.type==="numeric"?null:t.type==="letter"?t.scale.map(r=>r.letter):t.type==="binary"||t.type==="concept"?t.scale.map(r=>r.label):null}function Rn(e,t="0-10"){const r=He[t];if(!r)return!0;if(r.type==="numeric"){const s=parseFloat(e);return!isNaN(s)&&s>=r.min&&s<=r.max}return r.type==="letter"?r.scale.some(s=>s.letter===e.toUpperCase()):r.type==="binary"||r.type==="concept"?r.scale.some(s=>s.label===e):!1}const Fn=async(e={})=>{try{let t=R.from("submissions").select(`
        *,
        activity:activities(
          id,
          title,
          type,
          max_score,
          content,
          plagiarism_enabled,
          created_by,
          activity_class_assignments(
            class:classes(
              grading_system
            )
          )
        ),
        student:profiles!student_id(
          id,
          full_name,
          avatar_url,
          email
        ),
        answers(
          id,
          question_id,
          answer_json,
          points_earned
        )
      `).in("status",["submitted","graded","needs_revision"]);switch(e.classId&&(t=t.eq("activity.activity_class_assignments.class_id",e.classId)),e.activityId&&(t=t.eq("activity_id",e.activityId)),e.status&&(t=t.eq("status",e.status)),e.studentId&&(t=t.eq("student_id",e.studentId)),e.flagged&&(t=t.eq("status","needs_review")),e.plagiarism&&e.plagiarism<100&&(t=t.lt("plagiarism_score",e.plagiarism)),e.sortBy||"oldest"){case"newest":t=t.order("submitted_at",{ascending:!1});break;case"student":t=t.order("student.full_name",{ascending:!0});break;case"grade":t=t.order("grade",{ascending:!1});break;default:t=t.order("submitted_at",{ascending:!0})}const{data:s,error:a}=await t;if(a)throw a;return{data:s,error:null}}catch(t){return T.error("Erro ao buscar submissÃµes:",t),{data:null,error:t}}},Bn=async e=>{try{const{data:t,error:r}=await R.from("submissions").select(`
        *,
        activity:activities(
          id,
          title,
          description,
          type,
          max_score,
          content,
          plagiarism_enabled,
          due_date,
          created_by,
          activity_class_assignments(
            class:classes(
              grading_system
            )
          )
        ),
        student:profiles!student_id(
          id,
          full_name,
          avatar_url,
          email
        ),
        answers(*)
      `).eq("id",e).single();if(r)throw r;if(t.activity.plagiarism_enabled){const{data:s}=await R.from("plagiarism_checks").select("*").eq("submission_id",e).order("checked_at",{ascending:!1}).limit(1).single();t.plagiarism_check=s}return{data:t,error:null}}catch(t){return T.error("Erro ao buscar detalhes da submissÃ£o:",t),{data:null,error:t}}},pr=async(e,t)=>{try{const{grade:r,feedback:s,rubricScores:a=[],status:o="graded",teacherId:l}=t;console.log("ðŸ“ Salvando correÃ§Ã£o:",{submissionId:e,grade:r,gradeType:typeof r,feedback:s?.substring(0,50),status:o});const{data:i}=await R.from("submissions").select(`
        activity:activities(
          max_score,
          activity_class_assignments(
            class:classes(grading_system)
          )
        )
      `).eq("id",e).single(),c=i?.activity?.max_score||10,d=i?.activity?.activity_class_assignments?.[0]?.class?.grading_system||"0-10";console.log("ðŸ“Š Convertendo nota:",{gradeInput:r,gradingSystem:d,maxScore:c});let u;const f=r;try{u=Pn(r,d),T.debug(`âœ… ConversÃ£o: "${r}" (${d}) â†’ ${u.toFixed(2)}/10`)}catch(w){throw T.error("âŒ Erro na conversÃ£o:",w),new Error(`Nota invÃ¡lida para o sistema ${d}: ${r}`)}if(u>10)throw new Error(`Nota ${r} resultou em ${u.toFixed(2)}/10, excedendo o limite.`);if(u<0)throw new Error("Nota nÃ£o pode ser negativa.");if(isNaN(u))throw new Error(`Nota invÃ¡lida: ${r}`);const m={grade:u,feedback:s||"",status:o,graded_at:new Date().toISOString()};T.debug("ðŸ“¤ Update payload:",m);const{data:p,error:x}=await R.from("submissions").update(m).eq("id",e).select().single();if(x)throw T.error("âŒ Erro no update:",x),x;if(T.debug("âœ… CorreÃ§Ã£o salva com sucesso"),a.length>0){const w=a.map(g=>({submission_id:e,rubric_id:g.rubricId,score:g.score,comment:g.comment||null})),{error:N}=await R.from("submission_rubric_scores").upsert(w);if(N)throw N}return await R.from("correction_history").insert({submission_id:e,teacher_id:l,action:"corrected",new_grade:u,notes:d!=="0-10"?`CorreÃ§Ã£o realizada: "${f}" (${d}) = ${u.toFixed(2)}/10`:`CorreÃ§Ã£o realizada: ${u} pontos`}),{data:p,error:null,converted:d!=="0-10",gradingSystem:d,originalGrade:f,normalizedGrade:u,maxScore:c}}catch(r){return T.error("Erro ao salvar correÃ§Ã£o:",r),{data:null,error:r}}},Yn=async(e,t,r)=>{try{const{data:s,error:a}=await R.from("correction_drafts").upsert({submission_id:e,teacher_id:t,draft_data:r,last_saved_at:new Date().toISOString()},{onConflict:"submission_id,teacher_id"});if(a)throw a;return{data:s,error:null}}catch(s){return T.error("Erro ao salvar rascunho:",s),{data:null,error:s}}},Ln=async(e,t)=>{try{const{data:r,error:s}=await R.from("correction_drafts").select("*").eq("submission_id",e).eq("teacher_id",t).single();if(s&&s.code!=="PGRST116")throw s;return{data:r,error:null}}catch(r){return T.error("Erro ao recuperar rascunho:",r),{data:null,error:r}}},$n=async(e,t,r)=>{try{const s=[],a=[];for(const o of e){const l=await pr(o,{...t,teacherId:r});l.error?a.push({submissionId:o,error:l.error}):s.push(l.data)}return{data:{success:s,failed:a,successCount:s.length,failedCount:a.length},error:null}}catch(s){return T.error("Erro na correÃ§Ã£o em lote:",s),{data:null,error:s}}},zn=async(e,t="week")=>{try{const r=new Date,s=new Date;switch(t){case"day":s.setDate(r.getDate()-1);break;case"week":s.setDate(r.getDate()-7);break;case"month":s.setMonth(r.getMonth()-1);break;default:s.setDate(r.getDate()-7)}const{data:a,error:o}=await R.from("correction_metrics").select("*").eq("teacher_id",e).gte("date",s.toISOString().split("T")[0]).order("date",{ascending:!1});if(o)throw o;if(!a||a.length===0)return{data:{corrections_count:0,total_time_seconds:0,avg_grade:0,avg_feedback_length:0,avg_time_per_correction:0,daily_metrics:[]},error:null};const l={corrections_count:0,total_time_seconds:0,grades:[],lengths:[]},i=a.reduce((f,m)=>{const p=Number(m.corrections_count)||0,x=Number(m.total_time_seconds)||0,w=Number(m.avg_grade_given)||0,N=Number(m.feedback_avg_length)||0;return{corrections_count:f.corrections_count+p,total_time_seconds:f.total_time_seconds+x,grades:[...f.grades,w],lengths:[...f.lengths,N]}},l),c=i.grades.length>0?parseFloat((i.grades.reduce((f,m)=>f+m,0)/i.grades.length).toFixed(1)):0,d=i.lengths.length>0?Math.round(i.lengths.reduce((f,m)=>f+m,0)/i.lengths.length):0,u=i.corrections_count>0?Math.round(i.total_time_seconds/i.corrections_count):0;return{data:{...i,avg_grade:c,avg_feedback_length:d,avg_time_per_correction:u,daily_metrics:a},error:null}}catch(r){return T.error("Erro ao buscar mÃ©tricas:",r),{data:null,error:r}}},Hn=async(e,t,r,s)=>{try{const a=new Date().toISOString().split("T")[0],{data:o}=await R.from("correction_metrics").select("*").eq("teacher_id",e).eq("date",a).single(),l=(o?.corrections_count||0)+1,i=(o?.total_time_seconds||0)+t,c=o?(o.avg_grade_given*o.corrections_count+r)/l:r,d=o?(o.feedback_avg_length*o.corrections_count+s)/l:s,{data:u,error:f}=await R.from("correction_metrics").upsert({teacher_id:e,date:a,corrections_count:l,total_time_seconds:i,avg_time_per_correction:Math.round(i/l),avg_grade_given:c,feedback_avg_length:d},{onConflict:"teacher_id,date"});if(f)throw f;return{data:u,error:null}}catch(a){return T.error("Erro ao atualizar mÃ©tricas:",a),{data:null,error:a}}},qn={async createActivity(e){const{title:t,description:r,created_by:s,max_score:a=100,due_date:o,type:l="assignment",plagiarism_enabled:i=!1,plagiarism_threshold:c=35,instructions:d,content:u}=e,{data:f,error:m}=await R.from("activities").insert({title:t,description:r,instructions:d||r,content:u||{},created_by:s,max_score:a,max_grade:a,due_date:o,type:l,status:"draft",is_draft:!0,is_published:!1,plagiarism_enabled:i,plagiarism_threshold:c,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(m)throw T.error("Error creating activity:",m),m;return f},async updateActivity(e,t){const{data:r,error:s}=await R.from("activities").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw T.error("Error updating activity:",s),s;return r},async publishActivity(e,t,r=!1){const{data:s,error:a}=await R.from("activities").update({status:"active",is_published:!0,is_draft:!1,plagiarism_enabled:r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(a)throw T.error("Error publishing activity:",a),a;if(t&&t.length>0){const o=t.map(i=>({activity_id:e,class_id:i,assigned_at:new Date().toISOString()})),{error:l}=await R.from("activity_class_assignments").insert(o);if(l&&l.code!=="23505")throw T.error("Error assigning activity to classes:",l),l;try{for(const i of t){const{data:c}=await R.from("class_members").select("user_id").eq("class_id",i).eq("role","student"),d=c?.map(u=>u.user_id)||[];for(const u of d)await rr.send("activityPublished",{userId:u,variables:{activityTitle:s.title,dueDate:s.due_date?new Date(s.due_date).toLocaleDateString("pt-BR"):"Sem prazo"},channelOverride:"push",metadata:{activityId:e,classId:i}})}}catch(i){T.warn("Failed to notify students:",i)}}return s},async getActivityById(e){const{data:t,error:r}=await R.from("activities").select(`
        *,
        created_by_user:profiles!activities_created_by_fkey(id, full_name, avatar_url),
        assignments:activity_class_assignments(
          class_id,
          class:classes(id, name, subject, color)
        )
      `).eq("id",e).single();if(r)throw T.error("Error fetching activity:",r),r;return t},async getActivitiesByTeacher(e,{status:t,includeDrafts:r=!0}={}){let s=R.from("activities").select(`
        *,
        assignments:activity_class_assignments(
          class_id,
          class:classes(id, name, subject)
        )
      `).eq("created_by",e).order("created_at",{ascending:!1});t&&(s=s.eq("status",t)),r||(s=s.eq("is_draft",!1));const{data:a,error:o}=await s;if(o)throw T.error("Error fetching activities:",o),o;return a},async getActivitySubmissions(e){const{data:t,error:r}=await R.from("submissions").select(`
        *,
        student:profiles!submissions_student_id_fkey(id, full_name, name, avatar_url)
      `).eq("activity_id",e).order("submitted_at",{ascending:!1});if(r)throw T.error("Error fetching submissions:",r),r;return t},async deleteActivity(e){const{error:t}=await R.from("activities").delete().eq("id",e);if(t)throw T.error("Error deleting activity:",t),t;return!0},async getActivitiesByClass(e){const{data:t,error:r}=await R.from("activity_class_assignments").select(`
        activity_id,
        activity:activities(
          id,
          title,
          description,
          due_date,
          created_at,
          created_by_user:profiles!activities_created_by_fkey(id, full_name, avatar_url)
        )
      `).eq("class_id",e);if(r)throw T.error("Error fetching activities:",r),r;return t.map(s=>s.activity)},async getActivityStats(e){const{data:t}=await R.from("submissions").select("id, status, grade, submitted_at").eq("activity_id",e),r=t?.length||0,s=t?.filter(c=>c.submitted_at).length||0,a=t?.filter(c=>c.grade!==null).length||0,o=s-a,l=t?.filter(c=>c.grade!==null).map(c=>parseFloat(c.grade))||[],i=l.length>0?l.reduce((c,d)=>c+d,0)/l.length:0;return{total:r,submitted:s,graded:a,pending:o,avgGrade:i.toFixed(2),submissionRate:r>0?(s/r*100).toFixed(1):0}}},Un=async e=>{try{const{data:t,error:r}=await R.from("feedback_templates").select("*").eq("teacher_id",e).order("usage_count",{ascending:!1});if(r)throw r;return{data:t,error:null}}catch(t){return T.error("Erro ao buscar templates:",t),{data:null,error:t}}},Vn=async e=>{try{const s=await fetch("https://wapbwaimkurbuihatmix.supabase.co/functions/v1/generate-feedback",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndhcGJ3YWlta3VyYnVpaGF0bWl4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkyODY3MjksImV4cCI6MjA3NDg2MjcyOX0.x-NQQ2TtRgaUjjBZCf6j49eWOW4XSqjTFKC_KB1L56A","Content-Type":"application/json"},body:JSON.stringify({submissionData:e.content,grade:e.grade,activityType:e.activityType||"assignment"})});if(!s.ok)throw new Error("Erro ao gerar feedback com IA");const a=await s.json();return{data:{suggestion:a.feedback,isAI:!0,warning:a.warning||"Esta Ã© uma sugestÃ£o gerada por IA. Revise e personalize antes de usar."},error:null}}catch(t){T.error("Erro ao gerar sugestÃ£o com IA:",t);const{grade:r,maxScore:s=10}=e,a=r/s*100;let o="";return a>=90?o="Excelente trabalho! Sua resposta demonstra compreensÃ£o profunda do tema. Continue assim!":a>=70?o="Bom trabalho! VocÃª demonstrou entendimento do tema, mas alguns pontos podem ser aprimorados.":a>=50?o="Seu trabalho mostra algum entendimento, mas hÃ¡ aspectos importantes que precisam ser revisados.":o="Recomendo revisar o material e buscar apoio para compreender melhor os conceitos.",{data:{suggestion:o,isAI:!1,warning:"Falha ao conectar com IA. Usando feedback genÃ©rico."},error:null}}},jt="ivlbXbVUS4o8L8ZZpNBvPr2n5a9HZwCneMsplP6d74cf40cf",Gn="https://api.winston.ai/v1",Ae={LOW:20,MEDIUM:35,HIGH:50,CRITICAL:75},Zn=e=>e>=Ae.CRITICAL?"critical":e>=Ae.HIGH?"high":e>=Ae.MEDIUM?"medium":e>=Ae.LOW?"low":"none",Xn=async(e,t={})=>{try{const r=await fetch(`${Gn}/detect`,{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${jt}`,"X-API-Key":jt},body:JSON.stringify({text:e,language:t.language||"pt",threshold:t.threshold||.1,...t})});if(!r.ok){const a=await r.json().catch(()=>({message:"Unknown error"}));throw new Error(a.message||`Winston AI error: ${r.status}`)}const s=await r.json();return{score:s.score||0,severity:Zn(s.score||0),aiDetected:s.ai_generated||!1,sources:s.sources||[],rawResponse:s,confidence:s.confidence||0}}catch(r){throw T.error("Error checking for plagiarism with Winston AI:",r),r}},Kn=async(e,t,r={})=>{try{const{data:s,error:a}=await R.from("submissions").select(`
        id,
        activity_id,
        student_id,
        activities (
          id,
          class_id,
          plagiarism_enabled
        )
      `).eq("id",e).single();if(a)throw a;if(!s?.activities?.plagiarism_enabled)return{message:"Plagiarism check disabled for this activity"};const{data:o}=await R.from("plagiarism_checks_v2").select("*").eq("submission_id",e).gte("checked_at",new Date(Date.now()-3600*1e3).toISOString()).order("checked_at",{ascending:!1}).limit(1).single();if(o)return o;const l=await Xn(t,r),{data:i}=await R.from("activity_class_assignments").select("class_id").eq("activity_id",s.activity_id).limit(1).single(),{data:c,error:d}=await R.from("plagiarism_checks_v2").insert([{submission_id:e,activity_id:s.activity_id,class_id:null,plag_percent:l.score,unique_percent:l.rawResponse?.unique_percent||100-l.score,rephrased_percent:l.rawResponse?.rephrased_percent||0,exact_matched_percent:l.rawResponse?.exact_matched_percent||0,severity:l.severity,sources_detected:l.sources,winston_api_response:l.rawResponse,status:"completed"}]).select().single();if(d||(await R.from("submissions").update({plagiarism_check_status:"completed",plagiarism_checked_at:new Date().toISOString()}).eq("id",e),d))throw d;return l.severity!=="none"&&await Qn(s,l),c}catch(s){throw T.error("Error in checkSubmissionForPlagiarism:",s),s}},Jn=async e=>{try{const{data:t,error:r}=await R.from("plagiarism_notification_settings").select("*").eq("class_id",e).single();if(r&&r.code!=="PGRST116")throw r;return t||null}catch(t){return T.error("Error getting plagiarism notification settings:",t),null}},Qn=async(e,t)=>{try{const{activities:r,user_id:s}=e;if(!r?.id)return;const{data:a}=await R.from("activity_class_assignments").select(`
        class_id,
        classes (
          id,
          name,
          created_by,
          professor_id
        )
      `).eq("activity_id",r.id);if(!a?.length)return;const{data:o}=await R.from("profiles").select("full_name").eq("id",s).single();for(const l of a){const i=l.classes;if(!i?.created_by)continue;const c=await Jn(l.class_id);c&&!ea(t.severity,c)||await rr.send("plagiarismDetected",{userId:i.created_by,variables:{studentName:o?.full_name||"Aluno",activityName:r.title||"Atividade",severity:t.severity,score:Math.round(t.score)},channelOverride:c?.notify_push!==!1?"push":void 0,email:c?.notify_email!==!1?!0:void 0,metadata:{submissionId:e.id,activityId:r.id,classId:l.class_id,severity:t.severity,score:t.score}})}}catch(r){T.error("Error notifying teacher of plagiarism:",r)}},ea=(e,t)=>{if(!t?.notify_immediately)return!1;switch(e){case"critical":return!0;case"high":return t.threshold_high<=Ae.HIGH;case"medium":return t.threshold_medium<=Ae.MEDIUM;case"low":return t.threshold_low<=Ae.LOW;default:return!1}},ta=async(e,t)=>{try{const a=await fetch("https://wapbwaimkurbuihatmix.supabase.co/functions/v1/check-plagiarism",{method:"POST",headers:{Authorization:"Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6IndhcGJ3YWlta3VyYnVpaGF0bWl4Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTkyODY3MjksImV4cCI6MjA3NDg2MjcyOX0.x-NQQ2TtRgaUjjBZCf6j49eWOW4XSqjTFKC_KB1L56A","Content-Type":"application/json"},body:JSON.stringify({submissionId:e,text:t})});if(!a.ok){const l=await a.json();throw new Error(l.error||"Erro ao verificar plÃ¡gio")}return{data:await a.json(),error:null}}catch(r){T.error("Erro ao verificar plÃ¡gio com edge function:",r);try{return{data:await Kn(e,t),error:null}}catch(s){return{data:null,error:s}}}},ra=({templates:e,onSelect:t})=>{if(!e||e.length===0)return null;const r=e.reduce((a,o)=>{const l=o.category||"general";return a[l]||(a[l]=[]),a[l].push(o),a},{}),s={positive:"Positivos",constructive:"Construtivos",critical:"CrÃ­ticos",general:"Gerais"};return n.jsxs(Qt,{children:[n.jsx(er,{asChild:!0,children:n.jsxs($,{variant:"outline",size:"sm",children:[n.jsx(At,{className:"w-4 h-4 mr-2"}),"Templates"]})}),n.jsx(tr,{align:"end",className:"w-80",children:Object.entries(r).map(([a,o],l)=>n.jsxs("div",{children:[l>0&&n.jsx(ks,{}),n.jsx("div",{className:"px-2 py-1.5 text-sm font-semibold text-gray-500",children:s[a]||a}),o.map(i=>n.jsx(_t,{onClick:()=>t(i),className:"cursor-pointer",children:n.jsxs("div",{className:"flex-1",children:[n.jsx("div",{className:"text-sm line-clamp-2",children:i.template_text}),n.jsxs("div",{className:"text-xs text-gray-500 mt-1",children:["Usado ",i.usage_count||0,"x"]})]})},i.id))]},a))})]})},sa=({rubric:e,scores:t,onChange:r,onTotalChange:s})=>{const[a,o]=h.useState({});h.useEffect(()=>{const c={};e?.criteria?.forEach(d=>{const u=t.find(f=>f.rubricId===d.id);c[d.id]=u?.score||0}),o(c)},[e,t]),h.useEffect(()=>{const c=Object.values(a).reduce((d,u)=>d+(parseFloat(u)||0),0);s(c)},[a,s]);const l=(c,d)=>{o(f=>({...f,[c]:d}));const u=e.criteria.map(f=>({rubricId:f.id,score:f.id===c?parseFloat(d)||0:a[f.id]||0}));r(u)};if(!e||!e.criteria)return n.jsx("div",{className:"text-gray-600 text-sm",children:"Esta atividade nÃ£o possui rubrica configurada."});const i=Object.values(a).reduce((c,d)=>c+(parseFloat(d)||0),0);return n.jsxs("div",{className:"space-y-4",children:[e.criteria.map(c=>n.jsx(Z,{className:"p-4",children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex justify-between items-start",children:[n.jsxs("div",{className:"flex-1",children:[n.jsx("h4",{className:"font-semibold",children:c.name}),c.description&&n.jsx("p",{className:"text-sm text-gray-600 mt-1",children:c.description})]}),n.jsxs("div",{className:"text-right ml-4",children:[n.jsx("div",{className:"text-sm text-gray-500",children:"MÃ¡ximo"}),n.jsx("div",{className:"font-semibold",children:c.maxScore})]})]}),n.jsxs("div",{className:"flex items-center gap-4",children:[n.jsx(kt,{value:[a[c.id]||0],onValueChange:([d])=>l(c.id,d),max:c.maxScore,step:.1,className:"flex-1"}),n.jsx(ot,{type:"number",min:"0",max:c.maxScore,step:"0.1",value:a[c.id]||0,onChange:d=>l(c.id,d.target.value),className:"w-20 text-center"})]}),c.levels&&n.jsx("div",{className:"grid grid-cols-2 gap-2 text-xs",children:c.levels.map((d,u)=>n.jsxs("div",{className:"p-2 rounded bg-gray-50 cursor-pointer hover:bg-gray-100",onClick:()=>l(c.id,d.percentage/100*c.maxScore),children:[n.jsx("div",{className:"font-semibold",children:d.level}),n.jsxs("div",{className:"text-gray-600",children:[d.percentage,"% - ",d.description]})]},u))})]})},c.id)),n.jsx(Z,{className:"p-4 bg-blue-50 dark:bg-blue-950/30",children:n.jsxs("div",{className:"flex justify-between items-center",children:[n.jsx("div",{className:"font-semibold text-lg",children:"Nota Total"}),n.jsxs("div",{className:"text-2xl font-bold text-blue-600",children:[i.toFixed(1)," / ",e.criteria.reduce((c,d)=>c+d.maxScore,0)]})]})})]})},na=({submission:e})=>{const t=e.content,r=e.activity?.content?.questions||[],s=e.answers||[];if(r.length>0&&s.length>0)return n.jsx("div",{className:"space-y-4",children:r.map((o,l)=>{const i=s.find(f=>f.question_id===o.id||f.question_id===`question_${l}`||f.question_id===l.toString()),c=i?.answer_json?.answer||i?.answer_json?.selected||(typeof i?.answer_json=="string"?i.answer_json:null),d=(i?.points_earned||0)>0,u=o.correctAnswer||o.correct_answer||o.answer;return n.jsxs(Z,{className:"p-4 border-l-4",style:{borderLeftColor:d?"#22c55e":"#ef4444"},children:[n.jsxs("div",{className:"flex justify-between items-start mb-3",children:[n.jsxs("h4",{className:"font-semibold text-lg",children:["QuestÃ£o ",l+1]}),n.jsxs(ke,{variant:d?"success":"destructive",children:[d?"âœ“ Correta":"âœ— Incorreta",i?.points_earned!==void 0&&` (${i.points_earned} pts)`]})]}),n.jsxs("div",{className:"mb-4 p-4 bg-slate-50 dark:bg-slate-900 border-l-4 border-indigo-500 rounded",children:[n.jsx("p",{className:"text-xs font-semibold text-indigo-600 dark:text-indigo-400 mb-2",children:"ðŸ“ ENUNCIADO:"}),n.jsx(ie,{text:o.text||o.question||o.prompt,className:"font-medium leading-relaxed"}),o.maxScore&&n.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Valor: ",o.maxScore," pontos"]})]}),n.jsxs("div",{className:"space-y-3 mb-3",children:[n.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-950/20 border-l-4 border-blue-500 rounded",children:[n.jsx("p",{className:"text-xs font-semibold text-blue-700 dark:text-blue-400 mb-2",children:"ðŸ‘¤ RESPOSTA DO ALUNO:"}),n.jsx(ie,{text:c||"NÃ£o respondeu",className:"font-medium"})]}),u&&n.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-950/20 border-l-4 border-green-500 rounded",children:[n.jsx("p",{className:"text-xs font-semibold text-green-700 dark:text-green-400 mb-2",children:"âœ“ RESPOSTA CORRETA:"}),n.jsx(ie,{text:u,className:"font-medium"})]})]}),o.options&&o.options.length>0&&n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"OpÃ§Ãµes:"}),o.options.map((f,m)=>n.jsx("div",{className:`p-2 rounded text-sm ${f===u?"bg-green-100 dark:bg-green-950/30 border border-green-500":f===c?"bg-red-100 dark:bg-red-950/30 border border-red-500":"bg-gray-50 dark:bg-gray-800"}`,children:n.jsx(ie,{text:f})},m))]}),o.explanation&&n.jsx("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-950/20 rounded text-sm",children:n.jsxs("div",{className:"space-y-1",children:[n.jsx("strong",{children:"ExplicaÃ§Ã£o:"}),n.jsx(ie,{text:o.explanation,className:"block mt-1"})]})})]},l)})});const a=()=>{if(!t)return"Sem conteÃºdo";const o={whiteSpace:"pre-wrap",wordBreak:"break-word",overflowWrap:"break-word",wordWrap:"break-word",maxWidth:"100%",overflow:"hidden",display:"block",lineHeight:"1.5"};if(typeof t=="string")return n.jsx("div",{style:o,children:t});if(t.text)return n.jsx("div",{style:o,children:t.text});if(t.answer)return n.jsx("div",{style:o,children:t.answer});const l=Object.keys(t);return l.length>0&&l.every(i=>/^\d+$/.test(i))?n.jsxs("div",{className:"space-y-2",children:[n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:"Respostas do aluno:"}),l.map(i=>n.jsxs("div",{className:"p-3 bg-blue-50 dark:bg-blue-950/20 rounded border",children:[n.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400 mb-1",children:"Resposta:"}),n.jsx("div",{style:o,children:t[i]})]},i))]}):n.jsx("div",{className:"text-xs overflow-auto bg-gray-100 dark:bg-gray-800 p-3 rounded",children:n.jsx(ie,{text:JSON.stringify(t,null,2)})})};if(e.activity?.type==="assignment"){const o=e.activity?.description||e.activity?.content?.description||"";return n.jsxs("div",{className:"space-y-4",children:[o&&n.jsxs("div",{className:"p-4 bg-slate-50 dark:bg-slate-900 border-l-4 border-indigo-500 rounded",children:[n.jsx("p",{className:"text-xs font-semibold text-indigo-600 dark:text-indigo-400 mb-2",children:"ðŸ“ ENUNCIADO DA ATIVIDADE:"}),n.jsx(ie,{text:o,className:"font-medium leading-relaxed"})]}),n.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-950/20 border-l-4 border-blue-500 rounded",children:[n.jsx("p",{className:"text-xs font-semibold text-blue-700 dark:text-blue-400 mb-3",children:"ðŸ‘¤ RESPOSTA DO ALUNO:"}),n.jsx("div",{style:{width:"100%",maxWidth:"100%",wordBreak:"break-word",whiteSpace:"pre-wrap",overflowWrap:"break-word",wordWrap:"break-word",overflow:"hidden"},children:a()})]}),t?.attachments&&t.attachments.length>0&&n.jsxs("div",{className:"p-4 bg-amber-50 dark:bg-amber-950/20 border-l-4 border-amber-500 rounded",children:[n.jsx("p",{className:"text-xs font-semibold text-amber-700 dark:text-amber-400 mb-2",children:"ðŸ“Ž ANEXOS:"}),n.jsx("ul",{className:"space-y-2",children:t.attachments.map((l,i)=>n.jsx("li",{children:n.jsx("a",{href:l.url,target:"_blank",rel:"noopener noreferrer",className:"text-blue-600 hover:underline text-sm",children:l.name})},i))})]})]})}if(e.activity?.type==="quiz"){const o=e.activity?.content?.questions||[],l=e.answers||[];return n.jsx("div",{className:"space-y-4",children:o.map((i,c)=>{const d=l.find(p=>p.question_id===i.id||p.question_id===`question_${c}`||p.question_id===c.toString()),u=d?.answer_json?.answer||d?.answer_json?.selected||(typeof d?.answer_json=="string"?d.answer_json:null),f=(d?.points_earned||0)>0,m=i.correctAnswer||i.correct_answer||i.answer;return n.jsxs(Z,{className:"p-4 border-l-4",style:{borderLeftColor:f?"#22c55e":"#ef4444"},children:[n.jsxs("div",{className:"flex justify-between items-start mb-3",children:[n.jsxs("h4",{className:"font-semibold text-lg",children:["QuestÃ£o ",c+1]}),n.jsxs(ke,{variant:f?"success":"destructive",children:[f?"âœ“ Correta":"âœ— Incorreta",d?.points_earned!==void 0&&` (${d.points_earned} pts)`]})]}),n.jsxs("div",{className:"mb-4 p-4 bg-slate-50 dark:bg-slate-900 border-l-4 border-indigo-500 rounded",children:[n.jsx("p",{className:"text-xs font-semibold text-indigo-600 dark:text-indigo-400 mb-2",children:"ðŸ“ ENUNCIADO:"}),n.jsx(ie,{text:i.text||i.question||i.prompt,className:"font-medium leading-relaxed"}),i.maxScore&&n.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:["Valor: ",i.maxScore," pontos"]})]}),n.jsxs("div",{className:"space-y-3 mb-3",children:[n.jsxs("div",{className:"p-4 bg-blue-50 dark:bg-blue-950/20 border-l-4 border-blue-500 rounded",children:[n.jsx("p",{className:"text-xs font-semibold text-blue-700 dark:text-blue-400 mb-2",children:"ðŸ‘¤ RESPOSTA DO ALUNO:"}),n.jsx(ie,{text:u||"NÃ£o respondeu",className:"font-medium"})]}),m&&n.jsxs("div",{className:"p-4 bg-green-50 dark:bg-green-950/20 border-l-4 border-green-500 rounded",children:[n.jsx("p",{className:"text-xs font-semibold text-green-700 dark:text-green-400 mb-2",children:"âœ“ RESPOSTA CORRETA:"}),n.jsx(ie,{text:m,className:"font-medium"})]})]}),i.options&&i.options.length>0&&n.jsxs("div",{className:"space-y-1",children:[n.jsx("p",{className:"text-xs text-gray-600 mb-2",children:"OpÃ§Ãµes:"}),i.options.map((p,x)=>n.jsx("div",{className:`p-2 rounded text-sm ${p===m?"bg-green-100 dark:bg-green-950/30 border border-green-500":p===u?"bg-red-100 dark:bg-red-950/30 border border-red-500":"bg-gray-50 dark:bg-gray-800"}`,children:n.jsx(ie,{text:p})},x))]}),i.explanation&&n.jsx("div",{className:"mt-3 p-3 bg-blue-50 dark:bg-blue-950/20 rounded text-sm",children:n.jsxs("div",{className:"space-y-1",children:[n.jsx("strong",{children:"ExplicaÃ§Ã£o:"}),n.jsx(ie,{text:i.explanation,className:"block mt-1"})]})})]},c)})})}return n.jsx("div",{className:"text-gray-600",children:"Tipo de atividade nÃ£o suportado para visualizaÃ§Ã£o"})};var lt="Popover",[gr]=ir(lt,[ar]),qe=ar(),[aa,Me]=gr(lt),xr=e=>{const{__scopePopover:t,children:r,open:s,defaultOpen:a,onOpenChange:o,modal:l=!1}=e,i=qe(t),c=h.useRef(null),[d,u]=h.useState(!1),[f,m]=Es({prop:s,defaultProp:a??!1,onChange:o,caller:lt});return n.jsx(Ts,{...i,children:n.jsx(aa,{scope:t,contentId:As(),triggerRef:c,open:f,onOpenChange:m,onOpenToggle:h.useCallback(()=>m(p=>!p),[m]),hasCustomAnchor:d,onCustomAnchorAdd:h.useCallback(()=>u(!0),[]),onCustomAnchorRemove:h.useCallback(()=>u(!1),[]),modal:l,children:r})})};xr.displayName=lt;var vr="PopoverAnchor",oa=h.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,a=Me(vr,r),o=qe(r),{onCustomAnchorAdd:l,onCustomAnchorRemove:i}=a;return h.useEffect(()=>(l(),()=>i()),[l,i]),n.jsx(or,{...o,...s,ref:t})});oa.displayName=vr;var yr="PopoverTrigger",br=h.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,a=Me(yr,r),o=qe(r),l=De(t,a.triggerRef),i=n.jsx(We.button,{type:"button","aria-haspopup":"dialog","aria-expanded":a.open,"aria-controls":a.contentId,"data-state":Cr(a.open),...s,ref:l,onClick:le(e.onClick,a.onOpenToggle)});return a.hasCustomAnchor?i:n.jsx(or,{asChild:!0,...o,children:i})});br.displayName=yr;var Wt="PopoverPortal",[ia,la]=gr(Wt,{forceMount:void 0}),wr=e=>{const{__scopePopover:t,forceMount:r,children:s,container:a}=e,o=Me(Wt,t);return n.jsx(ia,{scope:t,forceMount:r,children:n.jsx(Ye,{present:r||o.open,children:n.jsx(Ps,{asChild:!0,container:a,children:s})})})};wr.displayName=Wt;var Fe="PopoverContent",jr=h.forwardRef((e,t)=>{const r=la(Fe,e.__scopePopover),{forceMount:s=r.forceMount,...a}=e,o=Me(Fe,e.__scopePopover);return n.jsx(Ye,{present:s||o.open,children:o.modal?n.jsx(da,{...a,ref:t}):n.jsx(ua,{...a,ref:t})})});jr.displayName=Fe;var ca=js("PopoverContent.RemoveScroll"),da=h.forwardRef((e,t)=>{const r=Me(Fe,e.__scopePopover),s=h.useRef(null),a=De(t,s),o=h.useRef(!1);return h.useEffect(()=>{const l=s.current;if(l)return Ys(l)},[]),n.jsx(Ls,{as:ca,allowPinchZoom:!0,children:n.jsx(Nr,{...e,ref:a,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:le(e.onCloseAutoFocus,l=>{l.preventDefault(),o.current||r.triggerRef.current?.focus()}),onPointerDownOutside:le(e.onPointerDownOutside,l=>{const i=l.detail.originalEvent,c=i.button===0&&i.ctrlKey===!0,d=i.button===2||c;o.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:le(e.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1})})})}),ua=h.forwardRef((e,t)=>{const r=Me(Fe,e.__scopePopover),s=h.useRef(!1),a=h.useRef(!1);return n.jsx(Nr,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:o=>{e.onCloseAutoFocus?.(o),o.defaultPrevented||(s.current||r.triggerRef.current?.focus(),o.preventDefault()),s.current=!1,a.current=!1},onInteractOutside:o=>{e.onInteractOutside?.(o),o.defaultPrevented||(s.current=!0,o.detail.originalEvent.type==="pointerdown"&&(a.current=!0));const l=o.target;r.triggerRef.current?.contains(l)&&o.preventDefault(),o.detail.originalEvent.type==="focusin"&&a.current&&o.preventDefault()}})}),Nr=h.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:s,onOpenAutoFocus:a,onCloseAutoFocus:o,disableOutsidePointerEvents:l,onEscapeKeyDown:i,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:u,...f}=e,m=Me(Fe,r),p=qe(r);return $s(),n.jsx(zs,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:a,onUnmountAutoFocus:o,children:n.jsx(Ws,{asChild:!0,disableOutsidePointerEvents:l,onInteractOutside:u,onEscapeKeyDown:i,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>m.onOpenChange(!1),children:n.jsx(Is,{"data-state":Cr(m.open),role:"dialog",id:m.contentId,...p,...f,ref:t,style:{...f.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),Sr="PopoverClose",fa=h.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,a=Me(Sr,r);return n.jsx(We.button,{type:"button",...s,ref:t,onClick:le(e.onClick,()=>a.onOpenChange(!1))})});fa.displayName=Sr;var ma="PopoverArrow",ha=h.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,a=qe(r);return n.jsx(Rs,{...a,...s,ref:t})});ha.displayName=ma;function Cr(e){return e?"open":"closed"}var pa=xr,ga=br,xa=wr,_r=jr;const kr=pa,Dr=ga,It=h.forwardRef(({className:e,align:t="center",sideOffset:r=4,...s},a)=>n.jsx(xa,{children:n.jsx(_r,{ref:a,align:t,sideOffset:r,className:Ot("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})}));It.displayName=_r.displayName;const va=({text:e,comments:t=[],onAddComment:r,onDeleteComment:s})=>{const[a,o]=h.useState(null),[l,i]=h.useState(!1),[c,d]=h.useState(""),[u,f]=h.useState("correction"),m=()=>{const g=window.getSelection(),j=g.toString().trim();if(j.length>0){const v=g.getRangeAt(0),S=v.getBoundingClientRect();o({text:j,start:v.startOffset,end:v.endOffset,rect:{top:S.top+window.scrollY,left:S.left+window.scrollX}}),i(!0)}},p=()=>{if(!a||!c)return;const g={id:Date.now().toString(),text:c,type:u,selection:{text:a.text,start:a.start,end:a.end},createdAt:new Date().toISOString()};r(g),d(""),f("correction"),i(!1),o(null)},x=g=>{switch(g){case"praise":return n.jsx(Ht,{className:"w-4 h-4 text-green-600"});case"correction":return n.jsx(st,{className:"w-4 h-4 text-red-600"});case"question":return n.jsx(et,{className:"w-4 h-4 text-blue-600"});case"suggestion":return n.jsx(qt,{className:"w-4 h-4 text-yellow-600"});default:return n.jsx(et,{className:"w-4 h-4"})}},w=g=>{switch(g){case"praise":return"bg-green-100 border-green-300";case"correction":return"bg-red-100 border-red-300";case"question":return"bg-blue-100 border-blue-300";case"suggestion":return"bg-yellow-100 border-yellow-300";default:return"bg-gray-100 border-gray-300"}},N=()=>!e||t.length===0?n.jsx("p",{className:"whitespace-pre-wrap",children:e}):n.jsxs("div",{className:"relative",onMouseUp:m,children:[n.jsx("p",{className:"whitespace-pre-wrap",children:e}),t.map((g,j)=>n.jsx("span",{className:"absolute bg-yellow-200 opacity-30 pointer-events-none",style:{top:`${j*2}rem`,left:0}},g.id))]});return n.jsxs("div",{className:"space-y-4",children:[n.jsxs(Z,{className:"p-4 bg-gray-50",children:[n.jsx("div",{className:"prose max-w-none",children:N()}),l&&a&&n.jsxs(kr,{open:l,onOpenChange:i,children:[n.jsx(Dr,{asChild:!0,children:n.jsx("div",{className:"absolute bg-blue-600 text-white rounded-full p-2 shadow-lg cursor-pointer",style:{top:a.rect?.top-40,left:a.rect?.left},children:n.jsx(et,{className:"w-4 h-4"})})}),n.jsx(It,{className:"w-80",children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{children:[n.jsx(U,{className:"text-sm font-semibold",children:"Texto selecionado:"}),n.jsxs("p",{className:"text-sm italic text-gray-600 mt-1",children:['"',a.text,'"']})]}),n.jsxs("div",{children:[n.jsx(U,{children:"Tipo de ComentÃ¡rio"}),n.jsxs(lr,{value:u,onValueChange:f,className:"mt-2",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Te,{value:"praise",id:"praise"}),n.jsxs(U,{htmlFor:"praise",className:"cursor-pointer flex items-center gap-2",children:[n.jsx(Ht,{className:"w-4 h-4 text-green-600"}),"Elogio"]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Te,{value:"correction",id:"correction"}),n.jsxs(U,{htmlFor:"correction",className:"cursor-pointer flex items-center gap-2",children:[n.jsx(st,{className:"w-4 h-4 text-red-600"}),"CorreÃ§Ã£o"]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Te,{value:"question",id:"question"}),n.jsxs(U,{htmlFor:"question",className:"cursor-pointer flex items-center gap-2",children:[n.jsx(et,{className:"w-4 h-4 text-blue-600"}),"DÃºvida"]})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Te,{value:"suggestion",id:"suggestion"}),n.jsxs(U,{htmlFor:"suggestion",className:"cursor-pointer flex items-center gap-2",children:[n.jsx(qt,{className:"w-4 h-4 text-yellow-600"}),"SugestÃ£o"]})]})]})]}),n.jsxs("div",{children:[n.jsx(U,{children:"ComentÃ¡rio"}),n.jsx(Tt,{value:c,onChange:g=>d(g.target.value),placeholder:"Digite seu comentÃ¡rio...",className:"mt-1",rows:3})]}),n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx($,{variant:"outline",size:"sm",onClick:()=>i(!1),children:"Cancelar"}),n.jsx($,{size:"sm",onClick:p,disabled:!c,children:"Adicionar"})]})]})})]})]}),t.length>0&&n.jsxs("div",{className:"space-y-2",children:[n.jsxs("h4",{className:"font-semibold text-sm",children:["ComentÃ¡rios (",t.length,")"]}),t.map((g,j)=>n.jsx(Z,{className:`p-3 ${w(g.type)} border-l-4`,children:n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1",children:[n.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[x(g.type),n.jsxs(ke,{variant:"outline",className:"text-xs",children:["#",j+1]}),n.jsxs("span",{className:"text-xs text-gray-500 italic",children:['"',g.selection.text,'"']})]}),n.jsx("p",{className:"text-sm",children:g.text})]}),n.jsx($,{variant:"ghost",size:"icon",className:"h-6 w-6",onClick:()=>s(g.id),children:n.jsx(Pt,{className:"w-4 h-4"})})]})},g.id))]}),t.length===0&&n.jsx("p",{className:"text-sm text-gray-500 text-center py-4",children:"Selecione um trecho do texto acima para adicionar um comentÃ¡rio"})]})},ya=({submission:e,submissions:t=[],currentIndex:r=0,onClose:s,onSaved:a,onNavigate:o})=>{const{user:l}=Et(),{toast:i}=it(),c=e.activity?.activity_class_assignments?.[0]?.class?.grading_system||"0-10",d=In(c),u=He[c],[f,m]=h.useState(!1),[p,x]=h.useState(!1),[w,N]=h.useState(!1),g=e.grade?Wn(e.grade,c):"",[j,v]=h.useState(g),[S,b]=h.useState(e.feedback||""),[C,D]=h.useState([]),[O,A]=h.useState([]),[W,B]=h.useState([]),[K]=h.useState(Date.now()),me=r>0,V=r<t.length-1,te=e.activity?.max_score||10,he=j!==""&&Rn(j,c),ye=S.length>=20;h.useEffect(()=>{X(),G();const M=setInterval(()=>{(j||S)&&ee()},3e4);return()=>clearInterval(M)},[]);const X=async()=>{const{data:M}=await Un(l.id);M&&A(M)},G=async()=>{const{data:M}=await Ln(e.id,l.id);M?.draft_data&&(v(M.draft_data.grade||""),b(M.draft_data.feedback||""),D(M.draft_data.rubricScores||[]))},ee=async()=>{await Yn(e.id,l.id,{grade:j,feedback:S,rubricScores:C})},Ne=async()=>{if(!he){i({title:"Erro",description:`A nota deve estar entre 0 e ${te}`,variant:"destructive"});return}if(!ye){i({title:"Aviso",description:"Recomendamos um feedback com pelo menos 20 caracteres",variant:"destructive"});return}m(!0);try{const M=Math.round((Date.now()-K)/1e3),Y=await pr(e.id,{grade:j,feedback:S,rubricScores:C,teacherId:l.id});if(Y.error)throw Y.error;if(Y.converted){const J={"0-10":"0-10","0-100":"0-100","A-F":"A-F","pass-fail":"Aprovado/Reprovado","excellent-poor":"Conceitos"}[Y.gradingSystem]||Y.gradingSystem;i({title:"â„¹ï¸ Nota Convertida",description:`Nota "${Y.originalGrade}" (${J}) foi salva como ${Y.normalizedGrade.toFixed(2)}/10 no sistema`,duration:4e3})}await Hn(l.id,M,parseFloat(j),S.length);try{await Ds.sendCorrectionNotification({submissionId:e.id,studentId:e.student_id,activityTitle:e.activity?.title,grade:parseFloat(j),maxScore:te})}catch(J){T.error("Erro ao enviar notificaÃ§Ã£o:",J)}a()}catch(M){T.error("Erro ao salvar correÃ§Ã£o:",M),i({title:"Erro",description:"NÃ£o foi possÃ­vel salvar a correÃ§Ã£o",variant:"destructive"})}finally{m(!1)}},Se=M=>{b(Y=>Y?`${Y}

${M.template_text}`:M.template_text)},Ce=async()=>{if(!j){i({title:"Erro",description:"Atribua uma nota antes de gerar feedback com IA",variant:"destructive"});return}x(!0);try{const{data:M,error:Y}=await Vn({content:e.content,grade:parseFloat(j),maxScore:te,activityType:e.activity?.type});if(Y)throw Y;M.suggestion&&(b(J=>J?`${J}

${M.suggestion}`:M.suggestion),i({title:"Feedback gerado",description:M.warning||"Revise e personalize antes de salvar"}))}catch{i({title:"Erro",description:"NÃ£o foi possÃ­vel gerar feedback com IA",variant:"destructive"})}finally{x(!1)}},oe=async()=>{const M=typeof e.content=="string"?e.content:e.content?.text||"";if(!M){i({title:"Erro",description:"Sem texto para verificar",variant:"destructive"});return}N(!0);try{const{data:Y,error:J}=await ta(e.id,M);if(J)throw J;i({title:"VerificaÃ§Ã£o concluÃ­da",description:`Originalidade: ${Y.plagiarismScore}% - ${Y.message}`,variant:Y.severity==="high"?"destructive":"default"})}catch{i({title:"Erro",description:"NÃ£o foi possÃ­vel verificar plÃ¡gio",variant:"destructive"})}finally{N(!1)}};return n.jsx(tt,{open:!0,onOpenChange:()=>{},children:n.jsxs(rt,{className:"max-w-7xl h-[90vh] p-0 overflow-hidden",children:[n.jsxs("div",{className:"flex items-center justify-between p-6 border-b bg-white dark:bg-slate-900",children:[n.jsxs("div",{className:"flex items-center gap-3",children:[n.jsx($,{variant:"outline",size:"icon",onClick:()=>o&&o("prev"),disabled:!me,children:n.jsx(Fs,{className:"w-5 h-5"})}),n.jsxs("div",{children:[n.jsx("h2",{className:"text-2xl font-bold text-gray-900 dark:text-gray-100",children:e.student?.full_name}),n.jsx("p",{className:"text-gray-600 dark:text-gray-400",children:e.activity?.title}),t.length>0&&n.jsxs("p",{className:"text-sm text-gray-500",children:[r+1," de ",t.length]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx($,{variant:"outline",size:"icon",onClick:()=>o&&o("next"),disabled:!V,children:n.jsx(Hs,{className:"w-5 h-5"})}),n.jsx($,{variant:"ghost",size:"icon",onClick:s,title:"Fechar e voltar",children:n.jsx(Pt,{className:"w-5 h-5"})})]})]}),n.jsx("div",{className:"flex-1 overflow-hidden",children:n.jsxs("div",{className:"h-full grid grid-cols-2 gap-6 p-6",children:[n.jsxs("div",{className:"overflow-y-auto space-y-4",children:[n.jsxs(Z,{className:"p-6",children:[n.jsx("h3",{className:"font-semibold text-lg mb-4",children:"SubmissÃ£o do Aluno"}),n.jsx(na,{submission:e})]}),e.activity?.plagiarism_enabled&&n.jsxs(Z,{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"font-semibold text-lg",children:"VerificaÃ§Ã£o de PlÃ¡gio"}),n.jsx($,{variant:"outline",size:"sm",onClick:oe,disabled:w,children:w?"Verificando...":"ðŸ” Verificar"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(st,{className:"w-5 h-5 text-yellow-600"}),n.jsxs("span",{children:["Originalidade: ",e.plagiarism_score||"NÃ£o verificado","%"]})]})]}),e.activity?.type==="assignment"&&n.jsxs(Z,{className:"p-6",children:[n.jsx("h3",{className:"font-semibold text-lg mb-4",children:"ComentÃ¡rios no Texto"}),n.jsx(va,{text:typeof e.content=="string"?e.content:e.content?.text,comments:W,onAddComment:M=>B(Y=>[...Y,M]),onDeleteComment:M=>B(Y=>Y.filter(J=>J.id!==M))})]})]}),n.jsxs("div",{className:"overflow-y-auto space-y-4",children:[e.activity?.content?.rubric&&n.jsxs(Z,{className:"p-6",children:[n.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Rubrica de AvaliaÃ§Ã£o"}),n.jsx(sa,{rubric:e.activity.content.rubric,scores:C,onChange:D,onTotalChange:M=>v(M.toString())})]}),n.jsxs(Z,{className:"p-6",children:[n.jsx("h3",{className:"font-semibold text-lg mb-4",children:"Nota Final"}),n.jsxs("div",{className:"space-y-2",children:[d?n.jsxs("select",{value:j,onChange:M=>v(M.target.value),className:"w-full px-4 py-3 text-2xl font-bold text-center border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-600 dark:bg-slate-800",children:[n.jsx("option",{value:"",children:"Selecione..."}),d.map(M=>n.jsx("option",{value:M,children:M},M))]}):n.jsx(ot,{type:"number",min:u?.min||0,max:u?.max||te,step:u?.type==="numeric"&&u.max===100?"1":"0.1",value:j,onChange:M=>v(M.target.value),className:"text-2xl font-bold text-center",placeholder:"0"}),n.jsx("p",{className:"text-sm text-center text-gray-600 dark:text-gray-400",children:u?.type==="numeric"?`Escala: ${u.min}-${u.max}`:`Sistema: ${c}`}),!he&&j!==""&&n.jsxs("p",{className:"text-sm text-red-600 text-center",children:["Nota invÃ¡lida para o sistema ",c]})]})]}),n.jsxs(Z,{className:"p-6",children:[n.jsxs("div",{className:"flex items-center justify-between mb-4",children:[n.jsx("h3",{className:"font-semibold text-lg",children:"Feedback"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx($,{variant:"outline",size:"sm",onClick:Ce,disabled:p||!j,children:p?"Gerando...":"âœ¨ IA"}),n.jsx(ra,{templates:O,onSelect:Se})]})]}),n.jsx(Tt,{value:S,onChange:M=>b(M.target.value),placeholder:"Escreva um feedback detalhado para o aluno...",className:"min-h-[200px]"}),n.jsx("div",{className:"flex justify-between mt-2 text-sm",children:n.jsxs("span",{className:S.length<20?"text-red-600":"text-gray-600",children:[S.length," caracteres ",S.length<20&&"(mÃ­nimo recomendado: 20)"]})})]})]})]})}),n.jsxs("div",{className:"flex items-center justify-between p-6 border-t bg-white dark:bg-slate-900",children:[n.jsx($,{variant:"outline",onClick:s,children:"Cancelar"}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx($,{variant:"outline",onClick:ee,disabled:f,children:"Salvar Rascunho"}),n.jsxs($,{onClick:Ne,disabled:f||!he,className:"bg-green-600 hover:bg-green-700",children:[n.jsx(qs,{className:"w-4 h-4 mr-2"}),f?"Salvando...":"Salvar e Fechar"]})]})]})]})})},ba=({submission:e,onCorrect:t,isSelected:r,onSelect:s})=>{const a=d=>{const u={submitted:{label:"Aguardando",color:"bg-yellow-500 text-white"},graded:{label:"Corrigida",color:"bg-green-500 text-white"},needs_revision:{label:"RevisÃ£o",color:"bg-orange-500 text-white"}};return u[d]||u.submitted},o=d=>{const u={assignment:{label:"Aberta",color:"bg-green-100 text-green-700"},quiz:{label:"Fechada",color:"bg-blue-100 text-blue-700"},project:{label:"Mista",color:"bg-purple-100 text-purple-700"}};return u[d]||u.assignment},l=e.submitted_at&&e.activity?.due_date&&new Date(e.submitted_at)>new Date(e.activity.due_date),i=a(e.status),c=o(e.activity?.type);return n.jsx(Z,{className:Re("p-4 hover:shadow-md transition-all duration-200",e.status==="needs_review"&&"border-l-4 border-l-red-500",r&&"ring-2 ring-blue-500 bg-blue-50"),children:n.jsxs("div",{className:"flex items-center gap-4",children:[s&&n.jsx(Dt,{checked:r,onCheckedChange:s}),n.jsx("div",{className:"flex-shrink-0",children:e.student?.avatar_url?n.jsx("img",{src:e.student.avatar_url,alt:e.student.full_name,className:"w-12 h-12 rounded-full"}):n.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold",children:e.student?.full_name?.[0]||"A"})}),n.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[n.jsxs("div",{className:"flex items-start justify-between",children:[n.jsxs("div",{className:"flex-1 min-w-0",children:[n.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 truncate",children:e.student?.full_name||"Aluno Desconhecido"}),n.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:e.activity?.title||"Atividade"})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(ke,{className:Re("text-xs",c.color),children:c.label}),n.jsx(ke,{className:Re("text-xs",i.color),children:i.label})]})]}),n.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(cr,{className:"w-4 h-4"}),n.jsx("span",{children:e.submitted_at?ze(new Date(e.submitted_at),"dd/MM/yyyy 'Ã s' HH:mm",{locale:Le}):"NÃ£o submetida"})]}),l&&n.jsx(ke,{variant:"destructive",className:"text-xs",children:"Atrasada"}),e.activity?.plagiarism_enabled&&e.plagiarism_score!==null&&n.jsxs("div",{className:"flex items-center gap-1",children:[n.jsx(Us,{className:Re("w-4 h-4",e.plagiarism_score>=90?"text-green-600":e.plagiarism_score>=70?"text-yellow-600":"text-red-600")}),n.jsxs("span",{children:[e.plagiarism_score,"% original"]})]}),e.grade!==null&&n.jsxs("div",{className:"font-semibold",children:["Nota: ",e.grade,"/",e.activity?.max_score||10]})]})]}),n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx($,{onClick:t,className:Re(e.status==="graded"?"bg-blue-600 hover:bg-blue-700":"bg-green-600 hover:bg-green-700"),children:e.status==="graded"?"Revisar":"Corrigir"}),n.jsxs(Qt,{children:[n.jsx(er,{asChild:!0,children:n.jsx($,{variant:"ghost",size:"icon",children:n.jsx(Vs,{className:"w-5 h-5"})})}),n.jsxs(tr,{align:"end",children:[n.jsxs(_t,{children:[n.jsx(At,{className:"w-4 h-4 mr-2"}),"Ver Atividade"]}),n.jsxs(_t,{children:[n.jsx(Gs,{className:"w-4 h-4 mr-2"}),"Ver Perfil do Aluno"]})]})]})]})]})})},wa=({submissions:e,onClose:t,onCompleted:r})=>{const{user:s}=Et(),{toast:a}=it(),[o,l]=h.useState(!1),[i,c]=h.useState("same_grade"),[d,u]=h.useState(""),[f,m]=h.useState(""),[p,x]=h.useState(""),[w,N]=h.useState("add"),g=e[0]?.activity?.max_score||10,j=async()=>{l(!0);try{let v={feedback:f};if(i==="same_grade"){if(!d||parseFloat(d)<0||parseFloat(d)>g){a({title:"Erro",description:`Nota deve estar entre 0 e ${g}`,variant:"destructive"}),l(!1);return}v.grade=parseFloat(d)}const S=e.map(D=>D.id),{data:b,error:C}=await $n(S,v,s.id);if(C)throw C;a({title:"Sucesso",description:`${b.successCount} submissÃµes corrigidas. ${b.failedCount} falharam.`}),r(),t()}catch(v){T.error("Erro na correÃ§Ã£o em lote:",v),a({title:"Erro",description:"NÃ£o foi possÃ­vel completar a correÃ§Ã£o em lote",variant:"destructive"})}finally{l(!1)}};return n.jsx(tt,{open:!0,onOpenChange:t,children:n.jsxs(rt,{className:"max-w-3xl",children:[n.jsxs(sr,{children:[n.jsx(nr,{children:"CorreÃ§Ã£o em Lote"}),n.jsxs("p",{className:"text-sm text-gray-600",children:[e.length," submissÃµes selecionadas"]})]}),n.jsxs("div",{className:"space-y-6 py-4",children:[n.jsxs(Z,{className:"p-4 max-h-40 overflow-y-auto",children:[n.jsx("h4",{className:"font-semibold mb-2",children:"SubmissÃµes:"}),n.jsx("ul",{className:"space-y-1 text-sm",children:e.map(v=>n.jsxs("li",{className:"flex justify-between",children:[n.jsx("span",{children:v.student?.full_name}),n.jsx("span",{className:"text-gray-500",children:v.activity?.title})]},v.id))})]}),n.jsxs("div",{children:[n.jsx(U,{className:"text-base font-semibold mb-3 block",children:"MÃ©todo de CorreÃ§Ã£o"}),n.jsx(lr,{value:i,onValueChange:c,children:n.jsxs("div",{className:"space-y-3",children:[n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Te,{value:"same_grade",id:"same_grade"}),n.jsx(U,{htmlFor:"same_grade",className:"cursor-pointer",children:"Mesma nota para todas"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Te,{value:"by_criteria",id:"by_criteria"}),n.jsx(U,{htmlFor:"by_criteria",className:"cursor-pointer",children:"Nota baseada em critÃ©rio (em breve)"})]}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Te,{value:"adjust",id:"adjust"}),n.jsx(U,{htmlFor:"adjust",className:"cursor-pointer",children:"Ajuste proporcional (em breve)"})]})]})})]}),i==="same_grade"&&n.jsxs("div",{className:"space-y-4",children:[n.jsxs("div",{children:[n.jsxs(U,{children:["Nota (0 - ",g,")"]}),n.jsx(ot,{type:"number",min:"0",max:g,step:"0.1",value:d,onChange:v=>u(v.target.value),className:"mt-1"})]}),n.jsxs("div",{children:[n.jsx(U,{children:"Feedback PadrÃ£o"}),n.jsx(Tt,{value:f,onChange:v=>m(v.target.value),placeholder:"Digite um feedback que serÃ¡ aplicado a todas as submissÃµes...",className:"mt-1",rows:4})]})]}),n.jsxs(Z,{className:"p-4 bg-blue-50 dark:bg-blue-950/30",children:[n.jsx("h4",{className:"font-semibold mb-2",children:"Preview do Resultado"}),n.jsxs("div",{className:"text-sm space-y-1",children:[n.jsxs("p",{children:[n.jsx("strong",{children:"SubmissÃµes afetadas:"})," ",e.length]}),i==="same_grade"&&d&&n.jsxs("p",{children:[n.jsx("strong",{children:"Nota a ser atribuÃ­da:"})," ",d,"/",g]}),n.jsxs("p",{children:[n.jsx("strong",{children:"Feedback:"})," ",f?`${f.substring(0,50)}...`:"Nenhum"]})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-2",children:[n.jsx($,{variant:"outline",onClick:t,disabled:o,children:"Cancelar"}),n.jsx($,{onClick:j,disabled:o||!d,className:"bg-green-600 hover:bg-green-700",children:o?"Aplicando...":"Aplicar CorreÃ§Ãµes"})]})]})})};function ja(e,t,r="long"){return new Intl.DateTimeFormat("en-US",{hour:"numeric",timeZone:e,timeZoneName:r}).format(t).split(/\s/g).slice(2).join(" ")}const Na={},$e={};function Pe(e,t){try{const s=(Na[e]||=new Intl.DateTimeFormat("en-US",{timeZone:e,timeZoneName:"longOffset"}).format)(t).split("GMT")[1];return s in $e?$e[s]:Ut(s,s.split(":"))}catch{if(e in $e)return $e[e];const r=e?.match(Sa);return r?Ut(e,r.slice(1)):NaN}}const Sa=/([+-]\d\d):?(\d\d)?/;function Ut(e,t){const r=+(t[0]||0),s=+(t[1]||0),a=+(t[2]||0)/60;return $e[e]=r*60+s>0?r*60+s+a:r*60-s-a}class ge extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(Pe(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),Mr(this),Mt(this)):this.setTime(Date.now())}static tz(t,...r){return r.length?new ge(...r,t):new ge(Date.now(),t)}withTimeZone(t){return new ge(+this,t)}getTimezoneOffset(){const t=-Pe(this.timeZone,this);return t>0?Math.floor(t):Math.ceil(t)}setTime(t){return Date.prototype.setTime.apply(this,arguments),Mt(this),+this}[Symbol.for("constructDateFrom")](t){return new ge(+new Date(t),this.timeZone)}}const Vt=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!Vt.test(e))return;const t=e.replace(Vt,"$1UTC");ge.prototype[t]&&(e.startsWith("get")?ge.prototype[e]=function(){return this.internal[t]()}:(ge.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),Ca(this),+this},ge.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),Mt(this),+this}))});function Mt(e){e.internal.setTime(+e),e.internal.setUTCSeconds(e.internal.getUTCSeconds()-Math.round(-Pe(e.timeZone,e)*60))}function Ca(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),Mr(e)}function Mr(e){const t=Pe(e.timeZone,e),r=t>0?Math.floor(t):Math.ceil(t),s=new Date(+e);s.setUTCHours(s.getUTCHours()-1);const a=-new Date(+e).getTimezoneOffset(),o=-new Date(+s).getTimezoneOffset(),l=a-o,i=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();l&&i&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+l);const c=a-r;c&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+c);const d=new Date(+e);d.setUTCSeconds(0);const u=a>0?d.getSeconds():(d.getSeconds()-60)%60,f=Math.round(-(Pe(e.timeZone,e)*60))%60;(f||u)&&(e.internal.setUTCSeconds(e.internal.getUTCSeconds()+f),Date.prototype.setUTCSeconds.call(e,Date.prototype.getUTCSeconds.call(e)+f+u));const m=Pe(e.timeZone,e),p=m>0?Math.floor(m):Math.ceil(m),w=-new Date(+e).getTimezoneOffset()-p,N=p!==r,g=w-c;if(N&&g){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+g);const j=Pe(e.timeZone,e),v=j>0?Math.floor(j):Math.ceil(j),S=p-v;S&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+S),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+S))}}class Q extends ge{static tz(t,...r){return r.length?new Q(...r,t):new Q(Date.now(),t)}toISOString(){const[t,r,s]=this.tzComponents(),a=`${t}${r}:${s}`;return this.internal.toISOString().slice(0,-1)+a}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,r,s,a]=this.internal.toUTCString().split(" ");return`${t?.slice(0,-1)} ${s} ${r} ${a}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[r,s,a]=this.tzComponents();return`${t} GMT${r}${s}${a} (${ja(this.timeZone,this)})`}toLocaleString(t,r){return Date.prototype.toLocaleString.call(this,t,{...r,timeZone:r?.timeZone||this.timeZone})}toLocaleDateString(t,r){return Date.prototype.toLocaleDateString.call(this,t,{...r,timeZone:r?.timeZone||this.timeZone})}toLocaleTimeString(t,r){return Date.prototype.toLocaleTimeString.call(this,t,{...r,timeZone:r?.timeZone||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),r=t>0?"-":"+",s=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),a=String(Math.abs(t)%60).padStart(2,"0");return[r,s,a]}withTimeZone(t){return new Q(+this,t)}[Symbol.for("constructDateFrom")](t){return new Q(+new Date(t),this.timeZone)}}const Gt=5,_a=4;function ka(e,t){const r=t.startOfMonth(e),s=r.getDay()>0?r.getDay():7,a=t.addDays(e,-s+1),o=t.addDays(a,Gt*7-1);return t.getMonth(e)===t.getMonth(o)?Gt:_a}function Or(e,t){const r=t.startOfMonth(e),s=r.getDay();return s===1?r:s===0?t.addDays(r,-6):t.addDays(r,-1*(s-1))}function Da(e,t){const r=Or(e,t),s=ka(e,t);return t.addDays(r,s*7-1)}class ae{constructor(t,r){this.Date=Date,this.today=()=>this.overrides?.today?this.overrides.today():this.options.timeZone?Q.tz(this.options.timeZone):new this.Date,this.newDate=(s,a,o)=>this.overrides?.newDate?this.overrides.newDate(s,a,o):this.options.timeZone?new Q(s,a,o,this.options.timeZone):new Date(s,a,o),this.addDays=(s,a)=>this.overrides?.addDays?this.overrides.addDays(s,a):ur(s,a),this.addMonths=(s,a)=>this.overrides?.addMonths?this.overrides.addMonths(s,a):fr(s,a),this.addWeeks=(s,a)=>this.overrides?.addWeeks?this.overrides.addWeeks(s,a):vn(s,a),this.addYears=(s,a)=>this.overrides?.addYears?this.overrides.addYears(s,a):yn(s,a),this.differenceInCalendarDays=(s,a)=>this.overrides?.differenceInCalendarDays?this.overrides.differenceInCalendarDays(s,a):Zs(s,a),this.differenceInCalendarMonths=(s,a)=>this.overrides?.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(s,a):on(s,a),this.eachMonthOfInterval=s=>this.overrides?.eachMonthOfInterval?this.overrides.eachMonthOfInterval(s):jn(s),this.eachYearOfInterval=s=>{const a=this.overrides?.eachYearOfInterval?this.overrides.eachYearOfInterval(s):Sn(s),o=new Set(a.map(i=>this.getYear(i)));if(o.size===a.length)return a;const l=[];return o.forEach(i=>{l.push(new Date(i,0,1))}),l},this.endOfBroadcastWeek=s=>this.overrides?.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(s):Da(s,this),this.endOfISOWeek=s=>this.overrides?.endOfISOWeek?this.overrides.endOfISOWeek(s):Cn(s),this.endOfMonth=s=>this.overrides?.endOfMonth?this.overrides.endOfMonth(s):cn(s),this.endOfWeek=(s,a)=>this.overrides?.endOfWeek?this.overrides.endOfWeek(s,a):hr(s,this.options),this.endOfYear=s=>this.overrides?.endOfYear?this.overrides.endOfYear(s):Nn(s),this.format=(s,a,o)=>{const l=this.overrides?.format?this.overrides.format(s,a,this.options):ze(s,a,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(l):l},this.getISOWeek=s=>this.overrides?.getISOWeek?this.overrides.getISOWeek(s):Xs(s),this.getMonth=(s,a)=>this.overrides?.getMonth?this.overrides.getMonth(s,this.options):kn(s,this.options),this.getYear=(s,a)=>this.overrides?.getYear?this.overrides.getYear(s,this.options):Dn(s,this.options),this.getWeek=(s,a)=>this.overrides?.getWeek?this.overrides.getWeek(s,this.options):Ks(s,this.options),this.isAfter=(s,a)=>this.overrides?.isAfter?this.overrides.isAfter(s,a):Mn(s,a),this.isBefore=(s,a)=>this.overrides?.isBefore?this.overrides.isBefore(s,a):On(s,a),this.isDate=s=>this.overrides?.isDate?this.overrides.isDate(s):Js(s),this.isSameDay=(s,a)=>this.overrides?.isSameDay?this.overrides.isSameDay(s,a):ln(s,a),this.isSameMonth=(s,a)=>this.overrides?.isSameMonth?this.overrides.isSameMonth(s,a):nn(s,a),this.isSameYear=(s,a)=>this.overrides?.isSameYear?this.overrides.isSameYear(s,a):En(s,a),this.max=s=>this.overrides?.max?this.overrides.max(s):bn(s),this.min=s=>this.overrides?.min?this.overrides.min(s):wn(s),this.setMonth=(s,a)=>this.overrides?.setMonth?this.overrides.setMonth(s,a):Tn(s,a),this.setYear=(s,a)=>this.overrides?.setYear?this.overrides.setYear(s,a):An(s,a),this.startOfBroadcastWeek=(s,a)=>this.overrides?.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(s,this):Or(s,this),this.startOfDay=s=>this.overrides?.startOfDay?this.overrides.startOfDay(s):Qs(s),this.startOfISOWeek=s=>this.overrides?.startOfISOWeek?this.overrides.startOfISOWeek(s):en(s),this.startOfMonth=s=>this.overrides?.startOfMonth?this.overrides.startOfMonth(s):an(s),this.startOfWeek=(s,a)=>this.overrides?.startOfWeek?this.overrides.startOfWeek(s,this.options):tn(s,this.options),this.startOfYear=s=>this.overrides?.startOfYear?this.overrides.startOfYear(s):rn(s),this.options={locale:dr,...t},this.overrides=r}getDigitMap(){const{numerals:t="latn"}=this.options,r=new Intl.NumberFormat("en-US",{numberingSystem:t}),s={};for(let a=0;a<10;a++)s[a.toString()]=r.format(a);return s}replaceDigits(t){const r=this.getDigitMap();return t.replace(/\d/g,s=>r[s]||s)}formatNumber(t){return this.replaceDigits(t.toString())}getMonthYearOrder(){const t=this.options.locale?.code;return t&&ae.yearFirstLocales.has(t)?"year-first":"month-first"}formatMonthYear(t){const{locale:r,timeZone:s,numerals:a}=this.options,o=r?.code;if(o&&ae.yearFirstLocales.has(o))try{return new Intl.DateTimeFormat(o,{month:"long",year:"numeric",timeZone:s,numberingSystem:a}).format(t)}catch{}const l=this.getMonthYearOrder()==="year-first"?"y LLLL":"LLLL y";return this.format(t,l)}}ae.yearFirstLocales=new Set(["eu","hu","ja","ja-Hira","ja-JP","ko","ko-KR","lt","lt-LT","lv","lv-LV","mn","mn-MN","zh","zh-CN","zh-HK","zh-TW"]);const xe=new ae;class Er{constructor(t,r,s=xe){this.date=t,this.displayMonth=r,this.outside=!!(r&&!s.isSameMonth(t,r)),this.dateLib=s}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class Ma{constructor(t,r){this.date=t,this.weeks=r}}class Oa{constructor(t,r){this.days=r,this.weekNumber=t}}function Ea(e){return y.createElement("button",{...e})}function Ta(e){return y.createElement("span",{...e})}function Aa(e){const{size:t=24,orientation:r="left",className:s}=e;return y.createElement("svg",{className:s,width:t,height:t,viewBox:"0 0 24 24"},r==="up"&&y.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),r==="down"&&y.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),r==="left"&&y.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),r==="right"&&y.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function Pa(e){const{day:t,modifiers:r,...s}=e;return y.createElement("td",{...s})}function Wa(e){const{day:t,modifiers:r,...s}=e,a=y.useRef(null);return y.useEffect(()=>{r.focused&&a.current?.focus()},[r.focused]),y.createElement("button",{ref:a,...s})}var _;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(_||(_={}));var H;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(H||(H={}));var fe;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(fe||(fe={}));var ne;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(ne||(ne={}));function Ia(e){const{options:t,className:r,components:s,classNames:a,...o}=e,l=[a[_.Dropdown],r].join(" "),i=t?.find(({value:c})=>c===o.value);return y.createElement("span",{"data-disabled":o.disabled,className:a[_.DropdownRoot]},y.createElement(s.Select,{className:l,...o},t?.map(({value:c,label:d,disabled:u})=>y.createElement(s.Option,{key:c,value:c,disabled:u},d))),y.createElement("span",{className:a[_.CaptionLabel],"aria-hidden":!0},i?.label,y.createElement(s.Chevron,{orientation:"down",size:18,className:a[_.Chevron]})))}function Ra(e){return y.createElement("div",{...e})}function Fa(e){return y.createElement("div",{...e})}function Ba(e){const{calendarMonth:t,displayIndex:r,...s}=e;return y.createElement("div",{...s},e.children)}function Ya(e){const{calendarMonth:t,displayIndex:r,...s}=e;return y.createElement("div",{...s})}function La(e){return y.createElement("table",{...e})}function $a(e){return y.createElement("div",{...e})}const Tr=h.createContext(void 0);function Ue(){const e=h.useContext(Tr);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function za(e){const{components:t}=Ue();return y.createElement(t.Dropdown,{...e})}function Ha(e){const{onPreviousClick:t,onNextClick:r,previousMonth:s,nextMonth:a,...o}=e,{components:l,classNames:i,labels:{labelPrevious:c,labelNext:d}}=Ue(),u=h.useCallback(m=>{a&&r?.(m)},[a,r]),f=h.useCallback(m=>{s&&t?.(m)},[s,t]);return y.createElement("nav",{...o},y.createElement(l.PreviousMonthButton,{type:"button",className:i[_.PreviousMonthButton],tabIndex:s?void 0:-1,"aria-disabled":s?void 0:!0,"aria-label":c(s),onClick:f},y.createElement(l.Chevron,{disabled:s?void 0:!0,className:i[_.Chevron],orientation:"left"})),y.createElement(l.NextMonthButton,{type:"button",className:i[_.NextMonthButton],tabIndex:a?void 0:-1,"aria-disabled":a?void 0:!0,"aria-label":d(a),onClick:u},y.createElement(l.Chevron,{disabled:a?void 0:!0,orientation:"right",className:i[_.Chevron]})))}function qa(e){const{components:t}=Ue();return y.createElement(t.Button,{...e})}function Ua(e){return y.createElement("option",{...e})}function Va(e){const{components:t}=Ue();return y.createElement(t.Button,{...e})}function Ga(e){const{rootRef:t,...r}=e;return y.createElement("div",{...r,ref:t})}function Za(e){return y.createElement("select",{...e})}function Xa(e){const{week:t,...r}=e;return y.createElement("tr",{...r})}function Ka(e){return y.createElement("th",{...e})}function Ja(e){return y.createElement("thead",{"aria-hidden":!0},y.createElement("tr",{...e}))}function Qa(e){const{week:t,...r}=e;return y.createElement("th",{...r})}function eo(e){return y.createElement("th",{...e})}function to(e){return y.createElement("tbody",{...e})}function ro(e){const{components:t}=Ue();return y.createElement(t.Dropdown,{...e})}const so=Object.freeze(Object.defineProperty({__proto__:null,Button:Ea,CaptionLabel:Ta,Chevron:Aa,Day:Pa,DayButton:Wa,Dropdown:Ia,DropdownNav:Ra,Footer:Fa,Month:Ba,MonthCaption:Ya,MonthGrid:La,Months:$a,MonthsDropdown:za,Nav:Ha,NextMonthButton:qa,Option:Ua,PreviousMonthButton:Va,Root:Ga,Select:Za,Week:Xa,WeekNumber:Qa,WeekNumberHeader:eo,Weekday:Ka,Weekdays:Ja,Weeks:to,YearsDropdown:ro},Symbol.toStringTag,{value:"Module"}));function be(e,t,r=!1,s=xe){let{from:a,to:o}=e;const{differenceInCalendarDays:l,isSameDay:i}=s;return a&&o?(l(o,a)<0&&([a,o]=[o,a]),l(t,a)>=(r?1:0)&&l(o,t)>=(r?1:0)):!r&&o?i(o,t):!r&&a?i(a,t):!1}function Ar(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Rt(e){return!!(e&&typeof e=="object"&&"from"in e)}function Pr(e){return!!(e&&typeof e=="object"&&"after"in e)}function Wr(e){return!!(e&&typeof e=="object"&&"before"in e)}function Ir(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Rr(e,t){return Array.isArray(e)&&e.every(t.isDate)}function we(e,t,r=xe){const s=Array.isArray(t)?t:[t],{isSameDay:a,differenceInCalendarDays:o,isAfter:l}=r;return s.some(i=>{if(typeof i=="boolean")return i;if(r.isDate(i))return a(e,i);if(Rr(i,r))return i.includes(e);if(Rt(i))return be(i,e,!1,r);if(Ir(i))return Array.isArray(i.dayOfWeek)?i.dayOfWeek.includes(e.getDay()):i.dayOfWeek===e.getDay();if(Ar(i)){const c=o(i.before,e),d=o(i.after,e),u=c>0,f=d<0;return l(i.before,i.after)?f&&u:u||f}return Pr(i)?o(e,i.after)>0:Wr(i)?o(i.before,e)>0:typeof i=="function"?i(e):!1})}function no(e,t,r,s,a){const{disabled:o,hidden:l,modifiers:i,showOutsideDays:c,broadcastCalendar:d,today:u}=t,{isSameDay:f,isSameMonth:m,startOfMonth:p,isBefore:x,endOfMonth:w,isAfter:N}=a,g=r&&p(r),j=s&&w(s),v={[H.focused]:[],[H.outside]:[],[H.disabled]:[],[H.hidden]:[],[H.today]:[]},S={};for(const b of e){const{date:C,displayMonth:D}=b,O=!!(D&&!m(C,D)),A=!!(g&&x(C,g)),W=!!(j&&N(C,j)),B=!!(o&&we(C,o,a)),K=!!(l&&we(C,l,a))||A||W||!d&&!c&&O||d&&c===!1&&O,me=f(C,u??a.today());O&&v.outside.push(b),B&&v.disabled.push(b),K&&v.hidden.push(b),me&&v.today.push(b),i&&Object.keys(i).forEach(V=>{const te=i?.[V];te&&we(C,te,a)&&(S[V]?S[V].push(b):S[V]=[b])})}return b=>{const C={[H.focused]:!1,[H.disabled]:!1,[H.hidden]:!1,[H.outside]:!1,[H.today]:!1},D={};for(const O in v){const A=v[O];C[O]=A.some(W=>W===b)}for(const O in S)D[O]=S[O].some(A=>A===b);return{...C,...D}}}function ao(e,t,r={}){return Object.entries(e).filter(([,a])=>a===!0).reduce((a,[o])=>(r[o]?a.push(r[o]):t[H[o]]?a.push(t[H[o]]):t[fe[o]]&&a.push(t[fe[o]]),a),[t[_.Day]])}function oo(e){return{...so,...e}}function io(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([r,s])=>{r.startsWith("data-")&&(t[r]=s)}),t}function lo(){const e={};for(const t in _)e[_[t]]=`rdp-${_[t]}`;for(const t in H)e[H[t]]=`rdp-${H[t]}`;for(const t in fe)e[fe[t]]=`rdp-${fe[t]}`;for(const t in ne)e[ne[t]]=`rdp-${ne[t]}`;return e}function Fr(e,t,r){return(r??new ae(t)).formatMonthYear(e)}const co=Fr;function uo(e,t,r){return(r??new ae(t)).format(e,"d")}function fo(e,t=xe){return t.format(e,"LLLL")}function mo(e,t,r){return(r??new ae(t)).format(e,"cccccc")}function ho(e,t=xe){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function po(){return""}function Br(e,t=xe){return t.format(e,"yyyy")}const go=Br,xo=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:Fr,formatDay:uo,formatMonthCaption:co,formatMonthDropdown:fo,formatWeekNumber:ho,formatWeekNumberHeader:po,formatWeekdayName:mo,formatYearCaption:go,formatYearDropdown:Br},Symbol.toStringTag,{value:"Module"}));function vo(e){return e?.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e?.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...xo,...e}}function yo(e,t,r,s,a){const{startOfMonth:o,startOfYear:l,endOfYear:i,eachMonthOfInterval:c,getMonth:d}=a;return c({start:l(e),end:i(e)}).map(m=>{const p=s.formatMonthDropdown(m,a),x=d(m),w=t&&m<o(t)||r&&m>o(r)||!1;return{value:x,label:p,disabled:w}})}function bo(e,t={},r={}){let s={...t?.[_.Day]};return Object.entries(e).filter(([,a])=>a===!0).forEach(([a])=>{s={...s,...r?.[a]}}),s}function wo(e,t,r){const s=e.today(),a=t?e.startOfISOWeek(s):e.startOfWeek(s),o=[];for(let l=0;l<7;l++){const i=e.addDays(a,l);o.push(i)}return o}function jo(e,t,r,s,a=!1){if(!e||!t)return;const{startOfYear:o,endOfYear:l,eachYearOfInterval:i,getYear:c}=s,d=o(e),u=l(t),f=i({start:d,end:u});return a&&f.reverse(),f.map(m=>{const p=r.formatYearDropdown(m,s);return{value:c(m),label:p,disabled:!1}})}function Yr(e,t,r,s){let a=(s??new ae(r)).format(e,"PPPP");return t.today&&(a=`Today, ${a}`),t.selected&&(a=`${a}, selected`),a}const No=Yr;function Lr(e,t,r){return(r??new ae(t)).formatMonthYear(e)}const So=Lr;function Co(e,t,r,s){let a=(s??new ae(r)).format(e,"PPPP");return t?.today&&(a=`Today, ${a}`),a}function _o(e){return"Choose the Month"}function ko(){return""}function Do(e){return"Go to the Next Month"}function Mo(e){return"Go to the Previous Month"}function Oo(e,t,r){return(r??new ae(t)).format(e,"cccc")}function Eo(e,t){return`Week ${e}`}function To(e){return"Week Number"}function Ao(e){return"Choose the Year"}const Po=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:So,labelDay:No,labelDayButton:Yr,labelGrid:Lr,labelGridcell:Co,labelMonthDropdown:_o,labelNav:ko,labelNext:Do,labelPrevious:Mo,labelWeekNumber:Eo,labelWeekNumberHeader:To,labelWeekday:Oo,labelYearDropdown:Ao},Symbol.toStringTag,{value:"Module"})),Ve=e=>e instanceof HTMLElement?e:null,Nt=e=>[...e.querySelectorAll("[data-animated-month]")??[]],Wo=e=>Ve(e.querySelector("[data-animated-month]")),St=e=>Ve(e.querySelector("[data-animated-caption]")),Ct=e=>Ve(e.querySelector("[data-animated-weeks]")),Io=e=>Ve(e.querySelector("[data-animated-nav]")),Ro=e=>Ve(e.querySelector("[data-animated-weekdays]"));function Fo(e,t,{classNames:r,months:s,focused:a,dateLib:o}){const l=h.useRef(null),i=h.useRef(s),c=h.useRef(!1);h.useLayoutEffect(()=>{const d=i.current;if(i.current=s,!t||!e.current||!(e.current instanceof HTMLElement)||s.length===0||d.length===0||s.length!==d.length)return;const u=o.isSameMonth(s[0].date,d[0].date),f=o.isAfter(s[0].date,d[0].date),m=f?r[ne.caption_after_enter]:r[ne.caption_before_enter],p=f?r[ne.weeks_after_enter]:r[ne.weeks_before_enter],x=l.current,w=e.current.cloneNode(!0);if(w instanceof HTMLElement?(Nt(w).forEach(v=>{if(!(v instanceof HTMLElement))return;const S=Wo(v);S&&v.contains(S)&&v.removeChild(S);const b=St(v);b&&b.classList.remove(m);const C=Ct(v);C&&C.classList.remove(p)}),l.current=w):l.current=null,c.current||u||a)return;const N=x instanceof HTMLElement?Nt(x):[],g=Nt(e.current);if(g?.every(j=>j instanceof HTMLElement)&&N&&N.every(j=>j instanceof HTMLElement)){c.current=!0,e.current.style.isolation="isolate";const j=Io(e.current);j&&(j.style.zIndex="1"),g.forEach((v,S)=>{const b=N[S];if(!b)return;v.style.position="relative",v.style.overflow="hidden";const C=St(v);C&&C.classList.add(m);const D=Ct(v);D&&D.classList.add(p);const O=()=>{c.current=!1,e.current&&(e.current.style.isolation=""),j&&(j.style.zIndex=""),C&&C.classList.remove(m),D&&D.classList.remove(p),v.style.position="",v.style.overflow="",v.contains(b)&&v.removeChild(b)};b.style.pointerEvents="none",b.style.position="absolute",b.style.overflow="hidden",b.setAttribute("aria-hidden","true");const A=Ro(b);A&&(A.style.opacity="0");const W=St(b);W&&(W.classList.add(f?r[ne.caption_before_exit]:r[ne.caption_after_exit]),W.addEventListener("animationend",O));const B=Ct(b);B&&B.classList.add(f?r[ne.weeks_before_exit]:r[ne.weeks_after_exit]),v.insertBefore(b,v.firstChild)})}})}function Bo(e,t,r,s){const a=e[0],o=e[e.length-1],{ISOWeek:l,fixedWeeks:i,broadcastCalendar:c}=r??{},{addDays:d,differenceInCalendarDays:u,differenceInCalendarMonths:f,endOfBroadcastWeek:m,endOfISOWeek:p,endOfMonth:x,endOfWeek:w,isAfter:N,startOfBroadcastWeek:g,startOfISOWeek:j,startOfWeek:v}=s,S=c?g(a,s):l?j(a):v(a),b=c?m(o):l?p(x(o)):w(x(o)),C=u(b,S),D=f(o,a)+1,O=[];for(let B=0;B<=C;B++){const K=d(S,B);if(t&&N(K,t))break;O.push(K)}const W=(c?35:42)*D;if(i&&O.length<W){const B=W-O.length;for(let K=0;K<B;K++){const me=d(O[O.length-1],1);O.push(me)}}return O}function Yo(e){const t=[];return e.reduce((r,s)=>{const a=s.weeks.reduce((o,l)=>o.concat(l.days.slice()),t.slice());return r.concat(a.slice())},t.slice())}function Lo(e,t,r,s){const{numberOfMonths:a=1}=r,o=[];for(let l=0;l<a;l++){const i=s.addMonths(e,l);if(t&&i>t)break;o.push(i)}return o}function Zt(e,t,r,s){const{month:a,defaultMonth:o,today:l=s.today(),numberOfMonths:i=1}=e;let c=a||o||l;const{differenceInCalendarMonths:d,addMonths:u,startOfMonth:f}=s;if(r&&d(r,c)<i-1){const m=-1*(i-1);c=u(r,m)}return t&&d(c,t)<0&&(c=t),f(c)}function $o(e,t,r,s){const{addDays:a,endOfBroadcastWeek:o,endOfISOWeek:l,endOfMonth:i,endOfWeek:c,getISOWeek:d,getWeek:u,startOfBroadcastWeek:f,startOfISOWeek:m,startOfWeek:p}=s,x=e.reduce((w,N)=>{const g=r.broadcastCalendar?f(N,s):r.ISOWeek?m(N):p(N),j=r.broadcastCalendar?o(N):r.ISOWeek?l(i(N)):c(i(N)),v=t.filter(D=>D>=g&&D<=j),S=r.broadcastCalendar?35:42;if(r.fixedWeeks&&v.length<S){const D=t.filter(O=>{const A=S-v.length;return O>j&&O<=a(j,A)});v.push(...D)}const b=v.reduce((D,O)=>{const A=r.ISOWeek?d(O):u(O),W=D.find(K=>K.weekNumber===A),B=new Er(O,N,s);return W?W.days.push(B):D.push(new Oa(A,[B])),D},[]),C=new Ma(N,b);return w.push(C),w},[]);return r.reverseMonths?x.reverse():x}function zo(e,t){let{startMonth:r,endMonth:s}=e;const{startOfYear:a,startOfDay:o,startOfMonth:l,endOfMonth:i,addYears:c,endOfYear:d,newDate:u,today:f}=t,{fromYear:m,toYear:p,fromMonth:x,toMonth:w}=e;!r&&x&&(r=x),!r&&m&&(r=t.newDate(m,0,1)),!s&&w&&(s=w),!s&&p&&(s=u(p,11,31));const N=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return r?r=l(r):m?r=u(m,0,1):!r&&N&&(r=a(c(e.today??f(),-100))),s?s=i(s):p?s=u(p,11,31):!s&&N&&(s=d(e.today??f())),[r&&o(r),s&&o(s)]}function Ho(e,t,r,s){if(r.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:o=1}=r,{startOfMonth:l,addMonths:i,differenceInCalendarMonths:c}=s,d=a?o:1,u=l(e);if(!t)return i(u,d);if(!(c(t,e)<o))return i(u,d)}function qo(e,t,r,s){if(r.disableNavigation)return;const{pagedNavigation:a,numberOfMonths:o}=r,{startOfMonth:l,addMonths:i,differenceInCalendarMonths:c}=s,d=a?o??1:1,u=l(e);if(!t)return i(u,-d);if(!(c(u,t)<=0))return i(u,-d)}function Uo(e){const t=[];return e.reduce((r,s)=>r.concat(s.weeks.slice()),t.slice())}function ct(e,t){const[r,s]=h.useState(e);return[t===void 0?r:t,s]}function Vo(e,t){const[r,s]=zo(e,t),{startOfMonth:a,endOfMonth:o}=t,l=Zt(e,r,s,t),[i,c]=ct(l,e.month?l:void 0);h.useEffect(()=>{const C=Zt(e,r,s,t);c(C)},[e.timeZone]);const d=Lo(i,s,e,t),u=Bo(d,e.endMonth?o(e.endMonth):void 0,e,t),f=$o(d,u,e,t),m=Uo(f),p=Yo(f),x=qo(i,r,e,t),w=Ho(i,s,e,t),{disableNavigation:N,onMonthChange:g}=e,j=C=>m.some(D=>D.days.some(O=>O.isEqualTo(C))),v=C=>{if(N)return;let D=a(C);r&&D<a(r)&&(D=a(r)),s&&D>a(s)&&(D=a(s)),c(D),g?.(D)};return{months:f,weeks:m,days:p,navStart:r,navEnd:s,previousMonth:x,nextMonth:w,goToMonth:v,goToDay:C=>{j(C)||v(C.date)}}}var pe;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(pe||(pe={}));function Xt(e){return!e[H.disabled]&&!e[H.hidden]&&!e[H.outside]}function Go(e,t,r,s){let a,o=-1;for(const l of e){const i=t(l);Xt(i)&&(i[H.focused]&&o<pe.FocusedModifier?(a=l,o=pe.FocusedModifier):s?.isEqualTo(l)&&o<pe.LastFocused?(a=l,o=pe.LastFocused):r(l.date)&&o<pe.Selected?(a=l,o=pe.Selected):i[H.today]&&o<pe.Today&&(a=l,o=pe.Today))}return a||(a=e.find(l=>Xt(t(l)))),a}function Zo(e,t,r,s,a,o,l){const{ISOWeek:i,broadcastCalendar:c}=o,{addDays:d,addMonths:u,addWeeks:f,addYears:m,endOfBroadcastWeek:p,endOfISOWeek:x,endOfWeek:w,max:N,min:g,startOfBroadcastWeek:j,startOfISOWeek:v,startOfWeek:S}=l;let C={day:d,week:f,month:u,year:m,startOfWeek:D=>c?j(D,l):i?v(D):S(D),endOfWeek:D=>c?p(D):i?x(D):w(D)}[e](r,t==="after"?1:-1);return t==="before"&&s?C=N([s,C]):t==="after"&&a&&(C=g([a,C])),C}function $r(e,t,r,s,a,o,l,i=0){if(i>365)return;const c=Zo(e,t,r.date,s,a,o,l),d=!!(o.disabled&&we(c,o.disabled,l)),u=!!(o.hidden&&we(c,o.hidden,l)),f=c,m=new Er(c,f,l);return!d&&!u?m:$r(e,t,m,s,a,o,l,i+1)}function Xo(e,t,r,s,a){const{autoFocus:o}=e,[l,i]=h.useState(),c=Go(t.days,r,s||(()=>!1),l),[d,u]=h.useState(o?c:void 0);return{isFocusTarget:w=>!!c?.isEqualTo(w),setFocused:u,focused:d,blur:()=>{i(d),u(void 0)},moveFocus:(w,N)=>{if(!d)return;const g=$r(w,N,d,t.navStart,t.navEnd,e,a);g&&(e.disableNavigation&&!t.days.some(v=>v.isEqualTo(g))||(t.goToDay(g),u(g)))}}}function Ko(e,t){const{selected:r,required:s,onSelect:a}=e,[o,l]=ct(r,a?r:void 0),i=a?r:o,{isSameDay:c}=t,d=p=>i?.some(x=>c(x,p))??!1,{min:u,max:f}=e;return{selected:i,select:(p,x,w)=>{let N=[...i??[]];if(d(p)){if(i?.length===u||s&&i?.length===1)return;N=i?.filter(g=>!c(g,p))}else i?.length===f?N=[p]:N=[...N,p];return a||l(N),a?.(N,p,x,w),N},isSelected:d}}function Jo(e,t,r=0,s=0,a=!1,o=xe){const{from:l,to:i}=t||{},{isSameDay:c,isAfter:d,isBefore:u}=o;let f;if(!l&&!i)f={from:e,to:r>0?void 0:e};else if(l&&!i)c(l,e)?r===0?f={from:l,to:e}:a?f={from:l,to:void 0}:f=void 0:u(e,l)?f={from:e,to:l}:f={from:l,to:e};else if(l&&i)if(c(l,e)&&c(i,e))a?f={from:l,to:i}:f=void 0;else if(c(l,e))f={from:l,to:r>0?void 0:e};else if(c(i,e))f={from:e,to:r>0?void 0:e};else if(u(e,l))f={from:e,to:i};else if(d(e,l))f={from:l,to:e};else if(d(e,i))f={from:l,to:e};else throw new Error("Invalid range");if(f?.from&&f?.to){const m=o.differenceInCalendarDays(f.to,f.from);s>0&&m>s?f={from:e,to:void 0}:r>1&&m<r&&(f={from:e,to:void 0})}return f}function Qo(e,t,r=xe){const s=Array.isArray(t)?t:[t];let a=e.from;const o=r.differenceInCalendarDays(e.to,e.from),l=Math.min(o,6);for(let i=0;i<=l;i++){if(s.includes(a.getDay()))return!0;a=r.addDays(a,1)}return!1}function Kt(e,t,r=xe){return be(e,t.from,!1,r)||be(e,t.to,!1,r)||be(t,e.from,!1,r)||be(t,e.to,!1,r)}function ei(e,t,r=xe){const s=Array.isArray(t)?t:[t];if(s.filter(i=>typeof i!="function").some(i=>typeof i=="boolean"?i:r.isDate(i)?be(e,i,!1,r):Rr(i,r)?i.some(c=>be(e,c,!1,r)):Rt(i)?i.from&&i.to?Kt(e,{from:i.from,to:i.to},r):!1:Ir(i)?Qo(e,i.dayOfWeek,r):Ar(i)?r.isAfter(i.before,i.after)?Kt(e,{from:r.addDays(i.after,1),to:r.addDays(i.before,-1)},r):we(e.from,i,r)||we(e.to,i,r):Pr(i)||Wr(i)?we(e.from,i,r)||we(e.to,i,r):!1))return!0;const l=s.filter(i=>typeof i=="function");if(l.length){let i=e.from;const c=r.differenceInCalendarDays(e.to,e.from);for(let d=0;d<=c;d++){if(l.some(u=>u(i)))return!0;i=r.addDays(i,1)}}return!1}function ti(e,t){const{disabled:r,excludeDisabled:s,selected:a,required:o,onSelect:l}=e,[i,c]=ct(a,l?a:void 0),d=l?a:i;return{selected:d,select:(m,p,x)=>{const{min:w,max:N}=e,g=m?Jo(m,d,w,N,o,t):void 0;return s&&r&&g?.from&&g.to&&ei({from:g.from,to:g.to},r,t)&&(g.from=m,g.to=void 0),l||c(g),l?.(g,m,p,x),g},isSelected:m=>d&&be(d,m,!1,t)}}function ri(e,t){const{selected:r,required:s,onSelect:a}=e,[o,l]=ct(r,a?r:void 0),i=a?r:o,{isSameDay:c}=t;return{selected:i,select:(f,m,p)=>{let x=f;return!s&&i&&i&&c(f,i)&&(x=void 0),a||l(x),a?.(x,f,m,p),x},isSelected:f=>i?c(i,f):!1}}function si(e,t){const r=ri(e,t),s=Ko(e,t),a=ti(e,t);switch(e.mode){case"single":return r;case"multiple":return s;case"range":return a;default:return}}function ni(e){let t=e;t.timeZone&&(t={...e},t.today&&(t.today=new Q(t.today,t.timeZone)),t.month&&(t.month=new Q(t.month,t.timeZone)),t.defaultMonth&&(t.defaultMonth=new Q(t.defaultMonth,t.timeZone)),t.startMonth&&(t.startMonth=new Q(t.startMonth,t.timeZone)),t.endMonth&&(t.endMonth=new Q(t.endMonth,t.timeZone)),t.mode==="single"&&t.selected?t.selected=new Q(t.selected,t.timeZone):t.mode==="multiple"&&t.selected?t.selected=t.selected?.map(P=>new Q(P,t.timeZone)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?new Q(t.selected.from,t.timeZone):void 0,to:t.selected.to?new Q(t.selected.to,t.timeZone):void 0}));const{components:r,formatters:s,labels:a,dateLib:o,locale:l,classNames:i}=h.useMemo(()=>{const P={...dr,...t.locale};return{dateLib:new ae({locale:P,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:oo(t.components),formatters:vo(t.formatters),labels:{...Po,...t.labels},locale:P,classNames:{...lo(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]),{captionLayout:c,mode:d,navLayout:u,numberOfMonths:f=1,onDayBlur:m,onDayClick:p,onDayFocus:x,onDayKeyDown:w,onDayMouseEnter:N,onDayMouseLeave:g,onNextClick:j,onPrevClick:v,showWeekNumber:S,styles:b}=t,{formatCaption:C,formatDay:D,formatMonthDropdown:O,formatWeekNumber:A,formatWeekNumberHeader:W,formatWeekdayName:B,formatYearDropdown:K}=s,me=Vo(t,o),{days:V,months:te,navStart:he,navEnd:ye,previousMonth:X,nextMonth:G,goToMonth:ee}=me,Ne=no(V,t,he,ye,o),{isSelected:Se,select:Ce,selected:oe}=si(t,o)??{},{blur:M,focused:Y,isFocusTarget:J,moveFocus:Ie,setFocused:_e}=Xo(t,me,Ne,Se??(()=>!1),o),{labelDayButton:ft,labelGridcell:mt,labelGrid:ht,labelMonthDropdown:pt,labelNav:Ge,labelPrevious:gt,labelNext:k,labelWeekday:I,labelWeekNumber:q,labelWeekNumberHeader:re,labelYearDropdown:Oe}=a,ns=h.useMemo(()=>wo(o,t.ISOWeek),[o,t.ISOWeek]),$t=d!==void 0||p!==void 0,xt=h.useCallback(()=>{X&&(ee(X),v?.(X))},[X,ee,v]),vt=h.useCallback(()=>{G&&(ee(G),j?.(G))},[ee,G,j]),as=h.useCallback((P,z)=>E=>{E.preventDefault(),E.stopPropagation(),_e(P),Ce?.(P.date,z,E),p?.(P.date,z,E)},[Ce,p,_e]),os=h.useCallback((P,z)=>E=>{_e(P),x?.(P.date,z,E)},[x,_e]),is=h.useCallback((P,z)=>E=>{M(),m?.(P.date,z,E)},[M,m]),ls=h.useCallback((P,z)=>E=>{const L={ArrowLeft:[E.shiftKey?"month":"day",t.dir==="rtl"?"after":"before"],ArrowRight:[E.shiftKey?"month":"day",t.dir==="rtl"?"before":"after"],ArrowDown:[E.shiftKey?"year":"week","after"],ArrowUp:[E.shiftKey?"year":"week","before"],PageUp:[E.shiftKey?"year":"month","before"],PageDown:[E.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(L[E.key]){E.preventDefault(),E.stopPropagation();const[se,F]=L[E.key];Ie(se,F)}w?.(P.date,z,E)},[Ie,w,t.dir]),cs=h.useCallback((P,z)=>E=>{N?.(P.date,z,E)},[N]),ds=h.useCallback((P,z)=>E=>{g?.(P.date,z,E)},[g]),us=h.useCallback(P=>z=>{const E=Number(z.target.value),L=o.setMonth(o.startOfMonth(P),E);ee(L)},[o,ee]),fs=h.useCallback(P=>z=>{const E=Number(z.target.value),L=o.setYear(o.startOfMonth(P),E);ee(L)},[o,ee]),{className:ms,style:hs}=h.useMemo(()=>({className:[i[_.Root],t.className].filter(Boolean).join(" "),style:{...b?.[_.Root],...t.style}}),[i,t.className,t.style,b]),ps=io(t),zt=h.useRef(null);Fo(zt,!!t.animate,{classNames:i,months:te,focused:Y,dateLib:o});const gs={dayPickerProps:t,selected:oe,select:Ce,isSelected:Se,months:te,nextMonth:G,previousMonth:X,goToMonth:ee,getModifiers:Ne,components:r,classNames:i,styles:b,labels:a,formatters:s};return y.createElement(Tr.Provider,{value:gs},y.createElement(r.Root,{rootRef:t.animate?zt:void 0,className:ms,style:hs,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],"aria-labelledby":t["aria-labelledby"],...ps},y.createElement(r.Months,{className:i[_.Months],style:b?.[_.Months]},!t.hideNavigation&&!u&&y.createElement(r.Nav,{"data-animated-nav":t.animate?"true":void 0,className:i[_.Nav],style:b?.[_.Nav],"aria-label":Ge(),onPreviousClick:xt,onNextClick:vt,previousMonth:X,nextMonth:G}),te.map((P,z)=>y.createElement(r.Month,{"data-animated-month":t.animate?"true":void 0,className:i[_.Month],style:b?.[_.Month],key:z,displayIndex:z,calendarMonth:P},u==="around"&&!t.hideNavigation&&z===0&&y.createElement(r.PreviousMonthButton,{type:"button",className:i[_.PreviousMonthButton],tabIndex:X?void 0:-1,"aria-disabled":X?void 0:!0,"aria-label":gt(X),onClick:xt,"data-animated-button":t.animate?"true":void 0},y.createElement(r.Chevron,{disabled:X?void 0:!0,className:i[_.Chevron],orientation:t.dir==="rtl"?"right":"left"})),y.createElement(r.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:i[_.MonthCaption],style:b?.[_.MonthCaption],calendarMonth:P,displayIndex:z},c?.startsWith("dropdown")?y.createElement(r.DropdownNav,{className:i[_.Dropdowns],style:b?.[_.Dropdowns]},(()=>{const E=c==="dropdown"||c==="dropdown-months"?y.createElement(r.MonthsDropdown,{key:"month",className:i[_.MonthsDropdown],"aria-label":pt(),classNames:i,components:r,disabled:!!t.disableNavigation,onChange:us(P.date),options:yo(P.date,he,ye,s,o),style:b?.[_.Dropdown],value:o.getMonth(P.date)}):y.createElement("span",{key:"month"},O(P.date,o)),L=c==="dropdown"||c==="dropdown-years"?y.createElement(r.YearsDropdown,{key:"year",className:i[_.YearsDropdown],"aria-label":Oe(o.options),classNames:i,components:r,disabled:!!t.disableNavigation,onChange:fs(P.date),options:jo(he,ye,s,o,!!t.reverseYears),style:b?.[_.Dropdown],value:o.getYear(P.date)}):y.createElement("span",{key:"year"},K(P.date,o));return o.getMonthYearOrder()==="year-first"?[L,E]:[E,L]})(),y.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},C(P.date,o.options,o))):y.createElement(r.CaptionLabel,{className:i[_.CaptionLabel],role:"status","aria-live":"polite"},C(P.date,o.options,o))),u==="around"&&!t.hideNavigation&&z===f-1&&y.createElement(r.NextMonthButton,{type:"button",className:i[_.NextMonthButton],tabIndex:G?void 0:-1,"aria-disabled":G?void 0:!0,"aria-label":k(G),onClick:vt,"data-animated-button":t.animate?"true":void 0},y.createElement(r.Chevron,{disabled:G?void 0:!0,className:i[_.Chevron],orientation:t.dir==="rtl"?"left":"right"})),z===f-1&&u==="after"&&!t.hideNavigation&&y.createElement(r.Nav,{"data-animated-nav":t.animate?"true":void 0,className:i[_.Nav],style:b?.[_.Nav],"aria-label":Ge(),onPreviousClick:xt,onNextClick:vt,previousMonth:X,nextMonth:G}),y.createElement(r.MonthGrid,{role:"grid","aria-multiselectable":d==="multiple"||d==="range","aria-label":ht(P.date,o.options,o)||void 0,className:i[_.MonthGrid],style:b?.[_.MonthGrid]},!t.hideWeekdays&&y.createElement(r.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:i[_.Weekdays],style:b?.[_.Weekdays]},S&&y.createElement(r.WeekNumberHeader,{"aria-label":re(o.options),className:i[_.WeekNumberHeader],style:b?.[_.WeekNumberHeader],scope:"col"},W()),ns.map(E=>y.createElement(r.Weekday,{"aria-label":I(E,o.options,o),className:i[_.Weekday],key:String(E),style:b?.[_.Weekday],scope:"col"},B(E,o.options,o)))),y.createElement(r.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:i[_.Weeks],style:b?.[_.Weeks]},P.weeks.map(E=>y.createElement(r.Week,{className:i[_.Week],key:E.weekNumber,style:b?.[_.Week],week:E},S&&y.createElement(r.WeekNumber,{week:E,style:b?.[_.WeekNumber],"aria-label":q(E.weekNumber,{locale:l}),className:i[_.WeekNumber],scope:"row",role:"rowheader"},A(E.weekNumber,o)),E.days.map(L=>{const{date:se}=L,F=Ne(L);if(F[H.focused]=!F.hidden&&!!Y?.isEqualTo(L),F[fe.selected]=Se?.(se)||F.selected,Rt(oe)){const{from:yt,to:bt}=oe;F[fe.range_start]=!!(yt&&bt&&o.isSameDay(se,yt)),F[fe.range_end]=!!(yt&&bt&&o.isSameDay(se,bt)),F[fe.range_middle]=be(oe,se,!0,o)}const xs=bo(F,b,t.modifiersStyles),vs=ao(F,i,t.modifiersClassNames),ys=!$t&&!F.hidden?mt(se,F,o.options,o):void 0;return y.createElement(r.Day,{key:`${o.format(se,"yyyy-MM-dd")}_${o.format(L.displayMonth,"yyyy-MM")}`,day:L,modifiers:F,className:vs.join(" "),style:xs,role:"gridcell","aria-selected":F.selected||void 0,"aria-label":ys,"data-day":o.format(se,"yyyy-MM-dd"),"data-month":L.outside?o.format(se,"yyyy-MM"):void 0,"data-selected":F.selected||void 0,"data-disabled":F.disabled||void 0,"data-hidden":F.hidden||void 0,"data-outside":L.outside||void 0,"data-focused":F.focused||void 0,"data-today":F.today||void 0},!F.hidden&&$t?y.createElement(r.DayButton,{className:i[_.DayButton],style:b?.[_.DayButton],type:"button",day:L,modifiers:F,disabled:F.disabled||void 0,tabIndex:J(L)?0:-1,"aria-label":ft(se,F,o.options,o),onClick:as(L,F),onBlur:is(L,F),onFocus:os(L,F),onKeyDown:ls(L,F),onMouseEnter:cs(L,F),onMouseLeave:ds(L,F)},D(se,o.options,o)):!F.hidden&&D(L.date,o.options,o))})))))))),t.footer&&y.createElement(r.Footer,{className:i[_.Footer],style:b?.[_.Footer],role:"status","aria-live":"polite"},t.footer)))}const ai=({mode:e="single",selected:t,onSelect:r,numberOfMonths:s=1,locale:a,initialFocus:o,...l})=>n.jsx(ni,{mode:e,selected:t,onSelect:r,numberOfMonths:s,locale:a,initialFocus:o,...l}),oi=({onApply:e,onClear:t})=>{const[r,s]=h.useState({classes:[],activities:[],statuses:[],gradeRange:[0,10],dateRange:{from:null,to:null},plagiarismThreshold:70,onlyFlagged:!1}),a=()=>{e(r)},o=()=>{s({classes:[],activities:[],statuses:[],gradeRange:[0,10],dateRange:{from:null,to:null},plagiarismThreshold:70,onlyFlagged:!1}),t()};return n.jsxs(Z,{className:"p-6 space-y-6",children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsx("h3",{className:"text-lg font-semibold",children:"Filtros AvanÃ§ados"}),n.jsxs($,{variant:"ghost",size:"sm",onClick:o,children:[n.jsx(Pt,{className:"w-4 h-4 mr-2"}),"Limpar Todos"]})]}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx(U,{className:"font-semibold",children:"Status da CorreÃ§Ã£o"}),n.jsx("div",{className:"space-y-2",children:["submitted","graded","needs_revision"].map(l=>n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Dt,{id:`status-${l}`,checked:r.statuses.includes(l),onCheckedChange:i=>{s(c=>({...c,statuses:i?[...c.statuses,l]:c.statuses.filter(d=>d!==l)}))}}),n.jsx(U,{htmlFor:`status-${l}`,className:"cursor-pointer text-sm",children:l==="submitted"?"NÃ£o Corrigidas":l==="graded"?"Corrigidas":"Necessitam RevisÃ£o"})]},l))})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(U,{className:"font-semibold",children:"Faixa de Nota (apenas corrigidas)"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(kt,{value:r.gradeRange,onValueChange:l=>s(i=>({...i,gradeRange:l})),min:0,max:10,step:.5,className:"w-full"}),n.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[n.jsx("span",{children:r.gradeRange[0]}),n.jsx("span",{children:r.gradeRange[1]})]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(U,{className:"font-semibold",children:"Data de SubmissÃ£o"}),n.jsxs(kr,{children:[n.jsx(Dr,{asChild:!0,children:n.jsxs($,{variant:"outline",className:Re("w-full justify-start text-left font-normal",!r.dateRange.from&&"text-muted-foreground"),children:[n.jsx(cr,{className:"mr-2 h-4 w-4"}),r.dateRange.from?r.dateRange.to?n.jsxs(n.Fragment,{children:[ze(r.dateRange.from,"dd/MM/yyyy",{locale:Le})," -"," ",ze(r.dateRange.to,"dd/MM/yyyy",{locale:Le})]}):ze(r.dateRange.from,"dd/MM/yyyy",{locale:Le}):n.jsx("span",{children:"Selecione perÃ­odo"})]})}),n.jsx(It,{className:"w-auto p-0",align:"start",children:n.jsx(ai,{initialFocus:!0,mode:"range",selected:r.dateRange,onSelect:l=>s(i=>({...i,dateRange:l||{from:null,to:null}})),numberOfMonths:2,locale:Le})})]})]}),n.jsxs("div",{className:"space-y-3",children:[n.jsx(U,{className:"font-semibold",children:"Originalidade MÃ­nima (%)"}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(kt,{value:[r.plagiarismThreshold],onValueChange:([l])=>s(i=>({...i,plagiarismThreshold:l})),min:0,max:100,step:5,className:"w-full"}),n.jsxs("div",{className:"text-sm text-center text-gray-600",children:["Mostrar apenas com originalidade < ",r.plagiarismThreshold,"%"]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx(U,{className:"font-semibold",children:"Outros Filtros"}),n.jsxs("div",{className:"flex items-center space-x-2",children:[n.jsx(Dt,{id:"flagged",checked:r.onlyFlagged,onCheckedChange:l=>s(i=>({...i,onlyFlagged:l}))}),n.jsx(U,{htmlFor:"flagged",className:"cursor-pointer text-sm",children:"Apenas marcadas para revisÃ£o"})]})]})]}),n.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[n.jsx($,{variant:"outline",onClick:o,children:"Limpar"}),n.jsx($,{onClick:a,className:"bg-blue-600 hover:bg-blue-700",children:"Aplicar Filtros"})]})]})};function ii(e,t){return h.useReducer((r,s)=>t[r][s]??r,e)}var Ft="ScrollArea",[zr]=ir(Ft),[li,de]=zr(Ft),Hr=h.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:s="hover",dir:a,scrollHideDelay:o=600,...l}=e,[i,c]=h.useState(null),[d,u]=h.useState(null),[f,m]=h.useState(null),[p,x]=h.useState(null),[w,N]=h.useState(null),[g,j]=h.useState(0),[v,S]=h.useState(0),[b,C]=h.useState(!1),[D,O]=h.useState(!1),A=De(t,B=>c(B)),W=dn(a);return n.jsx(li,{scope:r,type:s,dir:W,scrollHideDelay:o,scrollArea:i,viewport:d,onViewportChange:u,content:f,onContentChange:m,scrollbarX:p,onScrollbarXChange:x,scrollbarXEnabled:b,onScrollbarXEnabledChange:C,scrollbarY:w,onScrollbarYChange:N,scrollbarYEnabled:D,onScrollbarYEnabledChange:O,onCornerWidthChange:j,onCornerHeightChange:S,children:n.jsx(We.div,{dir:W,...l,ref:A,style:{position:"relative","--radix-scroll-area-corner-width":g+"px","--radix-scroll-area-corner-height":v+"px",...e.style}})})});Hr.displayName=Ft;var qr="ScrollAreaViewport",Ur=h.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:s,nonce:a,...o}=e,l=de(qr,r),i=h.useRef(null),c=De(t,i,l.onViewportChange);return n.jsxs(n.Fragment,{children:[n.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:a}),n.jsx(We.div,{"data-radix-scroll-area-viewport":"",...o,ref:c,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...e.style},children:n.jsx("div",{ref:l.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});Ur.displayName=qr;var ve="ScrollAreaScrollbar",Bt=h.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=de(ve,e.__scopeScrollArea),{onScrollbarXEnabledChange:o,onScrollbarYEnabledChange:l}=a,i=e.orientation==="horizontal";return h.useEffect(()=>(i?o(!0):l(!0),()=>{i?o(!1):l(!1)}),[i,o,l]),a.type==="hover"?n.jsx(ci,{...s,ref:t,forceMount:r}):a.type==="scroll"?n.jsx(di,{...s,ref:t,forceMount:r}):a.type==="auto"?n.jsx(Vr,{...s,ref:t,forceMount:r}):a.type==="always"?n.jsx(Yt,{...s,ref:t}):null});Bt.displayName=ve;var ci=h.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=de(ve,e.__scopeScrollArea),[o,l]=h.useState(!1);return h.useEffect(()=>{const i=a.scrollArea;let c=0;if(i){const d=()=>{window.clearTimeout(c),l(!0)},u=()=>{c=window.setTimeout(()=>l(!1),a.scrollHideDelay)};return i.addEventListener("pointerenter",d),i.addEventListener("pointerleave",u),()=>{window.clearTimeout(c),i.removeEventListener("pointerenter",d),i.removeEventListener("pointerleave",u)}}},[a.scrollArea,a.scrollHideDelay]),n.jsx(Ye,{present:r||o,children:n.jsx(Vr,{"data-state":o?"visible":"hidden",...s,ref:t})})}),di=h.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=de(ve,e.__scopeScrollArea),o=e.orientation==="horizontal",l=ut(()=>c("SCROLL_END"),100),[i,c]=ii("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return h.useEffect(()=>{if(i==="idle"){const d=window.setTimeout(()=>c("HIDE"),a.scrollHideDelay);return()=>window.clearTimeout(d)}},[i,a.scrollHideDelay,c]),h.useEffect(()=>{const d=a.viewport,u=o?"scrollLeft":"scrollTop";if(d){let f=d[u];const m=()=>{const p=d[u];f!==p&&(c("SCROLL"),l()),f=p};return d.addEventListener("scroll",m),()=>d.removeEventListener("scroll",m)}},[a.viewport,o,c,l]),n.jsx(Ye,{present:r||i!=="hidden",children:n.jsx(Yt,{"data-state":i==="hidden"?"hidden":"visible",...s,ref:t,onPointerEnter:le(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:le(e.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),Vr=h.forwardRef((e,t)=>{const r=de(ve,e.__scopeScrollArea),{forceMount:s,...a}=e,[o,l]=h.useState(!1),i=e.orientation==="horizontal",c=ut(()=>{if(r.viewport){const d=r.viewport.offsetWidth<r.viewport.scrollWidth,u=r.viewport.offsetHeight<r.viewport.scrollHeight;l(i?d:u)}},10);return Be(r.viewport,c),Be(r.content,c),n.jsx(Ye,{present:s||o,children:n.jsx(Yt,{"data-state":o?"visible":"hidden",...a,ref:t})})}),Yt=h.forwardRef((e,t)=>{const{orientation:r="vertical",...s}=e,a=de(ve,e.__scopeScrollArea),o=h.useRef(null),l=h.useRef(0),[i,c]=h.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=Jr(i.viewport,i.content),u={...s,sizes:i,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:m=>o.current=m,onThumbPointerUp:()=>l.current=0,onThumbPointerDown:m=>l.current=m};function f(m,p){return gi(m,l.current,i,p)}return r==="horizontal"?n.jsx(ui,{...u,ref:t,onThumbPositionChange:()=>{if(a.viewport&&o.current){const m=a.viewport.scrollLeft,p=Jt(m,i,a.dir);o.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:m=>{a.viewport&&(a.viewport.scrollLeft=m)},onDragScroll:m=>{a.viewport&&(a.viewport.scrollLeft=f(m,a.dir))}}):r==="vertical"?n.jsx(fi,{...u,ref:t,onThumbPositionChange:()=>{if(a.viewport&&o.current){const m=a.viewport.scrollTop,p=Jt(m,i);o.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:m=>{a.viewport&&(a.viewport.scrollTop=m)},onDragScroll:m=>{a.viewport&&(a.viewport.scrollTop=f(m))}}):null}),ui=h.forwardRef((e,t)=>{const{sizes:r,onSizesChange:s,...a}=e,o=de(ve,e.__scopeScrollArea),[l,i]=h.useState(),c=h.useRef(null),d=De(t,c,o.onScrollbarXChange);return h.useEffect(()=>{c.current&&i(getComputedStyle(c.current))},[c]),n.jsx(Zr,{"data-orientation":"horizontal",...a,ref:d,sizes:r,style:{bottom:0,left:o.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:o.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":dt(r)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.x),onDragScroll:u=>e.onDragScroll(u.x),onWheelScroll:(u,f)=>{if(o.viewport){const m=o.viewport.scrollLeft+u.deltaX;e.onWheelScroll(m),es(m,f)&&u.preventDefault()}},onResize:()=>{c.current&&o.viewport&&l&&s({content:o.viewport.scrollWidth,viewport:o.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:at(l.paddingLeft),paddingEnd:at(l.paddingRight)}})}})}),fi=h.forwardRef((e,t)=>{const{sizes:r,onSizesChange:s,...a}=e,o=de(ve,e.__scopeScrollArea),[l,i]=h.useState(),c=h.useRef(null),d=De(t,c,o.onScrollbarYChange);return h.useEffect(()=>{c.current&&i(getComputedStyle(c.current))},[c]),n.jsx(Zr,{"data-orientation":"vertical",...a,ref:d,sizes:r,style:{top:0,right:o.dir==="ltr"?0:void 0,left:o.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":dt(r)+"px",...e.style},onThumbPointerDown:u=>e.onThumbPointerDown(u.y),onDragScroll:u=>e.onDragScroll(u.y),onWheelScroll:(u,f)=>{if(o.viewport){const m=o.viewport.scrollTop+u.deltaY;e.onWheelScroll(m),es(m,f)&&u.preventDefault()}},onResize:()=>{c.current&&o.viewport&&l&&s({content:o.viewport.scrollHeight,viewport:o.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:at(l.paddingTop),paddingEnd:at(l.paddingBottom)}})}})}),[mi,Gr]=zr(ve),Zr=h.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:s,hasThumb:a,onThumbChange:o,onThumbPointerUp:l,onThumbPointerDown:i,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:u,onResize:f,...m}=e,p=de(ve,r),[x,w]=h.useState(null),N=De(t,A=>w(A)),g=h.useRef(null),j=h.useRef(""),v=p.viewport,S=s.content-s.viewport,b=Ee(u),C=Ee(c),D=ut(f,10);function O(A){if(g.current){const W=A.clientX-g.current.left,B=A.clientY-g.current.top;d({x:W,y:B})}}return h.useEffect(()=>{const A=W=>{const B=W.target;x?.contains(B)&&b(W,S)};return document.addEventListener("wheel",A,{passive:!1}),()=>document.removeEventListener("wheel",A,{passive:!1})},[v,x,S,b]),h.useEffect(C,[s,C]),Be(x,D),Be(p.content,D),n.jsx(mi,{scope:r,scrollbar:x,hasThumb:a,onThumbChange:Ee(o),onThumbPointerUp:Ee(l),onThumbPositionChange:C,onThumbPointerDown:Ee(i),children:n.jsx(We.div,{...m,ref:N,style:{position:"absolute",...m.style},onPointerDown:le(e.onPointerDown,A=>{A.button===0&&(A.target.setPointerCapture(A.pointerId),g.current=x.getBoundingClientRect(),j.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),O(A))}),onPointerMove:le(e.onPointerMove,O),onPointerUp:le(e.onPointerUp,A=>{const W=A.target;W.hasPointerCapture(A.pointerId)&&W.releasePointerCapture(A.pointerId),document.body.style.webkitUserSelect=j.current,p.viewport&&(p.viewport.style.scrollBehavior=""),g.current=null})})})}),nt="ScrollAreaThumb",Xr=h.forwardRef((e,t)=>{const{forceMount:r,...s}=e,a=Gr(nt,e.__scopeScrollArea);return n.jsx(Ye,{present:r||a.hasThumb,children:n.jsx(hi,{ref:t,...s})})}),hi=h.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:s,...a}=e,o=de(nt,r),l=Gr(nt,r),{onThumbPositionChange:i}=l,c=De(t,f=>l.onThumbChange(f)),d=h.useRef(void 0),u=ut(()=>{d.current&&(d.current(),d.current=void 0)},100);return h.useEffect(()=>{const f=o.viewport;if(f){const m=()=>{if(u(),!d.current){const p=xi(f,i);d.current=p,i()}};return i(),f.addEventListener("scroll",m),()=>f.removeEventListener("scroll",m)}},[o.viewport,u,i]),n.jsx(We.div,{"data-state":l.hasThumb?"visible":"hidden",...a,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:le(e.onPointerDownCapture,f=>{const p=f.target.getBoundingClientRect(),x=f.clientX-p.left,w=f.clientY-p.top;l.onThumbPointerDown({x,y:w})}),onPointerUp:le(e.onPointerUp,l.onThumbPointerUp)})});Xr.displayName=nt;var Lt="ScrollAreaCorner",Kr=h.forwardRef((e,t)=>{const r=de(Lt,e.__scopeScrollArea),s=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&s?n.jsx(pi,{...e,ref:t}):null});Kr.displayName=Lt;var pi=h.forwardRef((e,t)=>{const{__scopeScrollArea:r,...s}=e,a=de(Lt,r),[o,l]=h.useState(0),[i,c]=h.useState(0),d=!!(o&&i);return Be(a.scrollbarX,()=>{const u=a.scrollbarX?.offsetHeight||0;a.onCornerHeightChange(u),c(u)}),Be(a.scrollbarY,()=>{const u=a.scrollbarY?.offsetWidth||0;a.onCornerWidthChange(u),l(u)}),d?n.jsx(We.div,{...s,ref:t,style:{width:o,height:i,position:"absolute",right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function at(e){return e?parseInt(e,10):0}function Jr(e,t){const r=e/t;return isNaN(r)?0:r}function dt(e){const t=Jr(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=(e.scrollbar.size-r)*t;return Math.max(s,18)}function gi(e,t,r,s="ltr"){const a=dt(r),o=a/2,l=t||o,i=a-l,c=r.scrollbar.paddingStart+l,d=r.scrollbar.size-r.scrollbar.paddingEnd-i,u=r.content-r.viewport,f=s==="ltr"?[0,u]:[u*-1,0];return Qr([c,d],f)(e)}function Jt(e,t,r="ltr"){const s=dt(t),a=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,o=t.scrollbar.size-a,l=t.content-t.viewport,i=o-s,c=r==="ltr"?[0,l]:[l*-1,0],d=Ss(e,c);return Qr([0,l],[0,i])(d)}function Qr(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(r-e[0])}}function es(e,t){return e>0&&e<t}var xi=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},s=0;return(function a(){const o={left:e.scrollLeft,top:e.scrollTop},l=r.left!==o.left,i=r.top!==o.top;(l||i)&&t(),r=o,s=window.requestAnimationFrame(a)})(),()=>window.cancelAnimationFrame(s)};function ut(e,t){const r=Ee(e),s=h.useRef(0);return h.useEffect(()=>()=>window.clearTimeout(s.current),[]),h.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(r,t)},[r,t])}function Be(e,t){const r=Ee(t);Bs(()=>{let s=0;if(e){const a=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(r)});return a.observe(e),()=>{window.cancelAnimationFrame(s),a.unobserve(e)}}},[e,r])}var ts=Hr,vi=Ur,yi=Kr;const rs=h.forwardRef(({className:e,children:t,...r},s)=>n.jsxs(ts,{ref:s,className:Ot("relative overflow-hidden",e),...r,children:[n.jsx(vi,{className:"h-full w-full rounded-[inherit]",children:t}),n.jsx(ss,{}),n.jsx(yi,{})]}));rs.displayName=ts.displayName;const ss=h.forwardRef(({className:e,orientation:t="vertical",...r},s)=>n.jsx(Bt,{ref:s,orientation:t,className:Ot("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 border-t border-t-transparent p-[1px]",e),...r,children:n.jsx(Xr,{className:"relative flex-1 rounded-full bg-border"})}));ss.displayName=Bt.displayName;const bi=({submissionIds:e,onClose:t})=>{const{toast:r}=it(),[s,a]=h.useState([]),[o,l]=h.useState(!0),[i,c]=h.useState(null);h.useEffect(()=>{d()},[e]);const d=async()=>{l(!0);try{const m=e.map(w=>Bn(w)),x=(await Promise.all(m)).map(w=>w.data).filter(Boolean);if(a(x),x.length===2){const w=u(x[0].content,x[1].content);c(w)}}catch(m){T.error("Erro ao carregar submissÃµes:",m)}finally{l(!1)}},u=(m,p)=>{const x=typeof m=="string"?m:m?.text||"",w=typeof p=="string"?p:p?.text||"",N=x.toLowerCase().split(/\s+/),g=w.toLowerCase().split(/\s+/),v=N.filter(S=>g.includes(S)).length/Math.max(N.length,g.length)*100;return Math.round(v)},f=m=>m>=80?"text-red-600 bg-red-100":m>=60?"text-yellow-600 bg-yellow-100":"text-green-600 bg-green-100";return o?n.jsx(tt,{open:!0,onOpenChange:t,children:n.jsx(rt,{className:"max-w-6xl h-[80vh]",children:n.jsx("div",{className:"flex items-center justify-center h-full",children:n.jsx("p",{children:"Carregando comparaÃ§Ã£o..."})})})}):n.jsx(tt,{open:!0,onOpenChange:t,children:n.jsxs(rt,{className:"max-w-7xl h-[90vh]",children:[n.jsx(sr,{children:n.jsxs(nr,{className:"flex items-center gap-2",children:[n.jsx(un,{className:"w-5 h-5"}),"ComparaÃ§Ã£o de SubmissÃµes"]})}),i!==null&&n.jsxs(Z,{className:`p-4 ${f(i)}`,children:[n.jsxs("div",{className:"flex items-center justify-between",children:[n.jsxs("div",{className:"flex items-center gap-2",children:[n.jsx(fn,{className:"w-5 h-5"}),n.jsx("span",{className:"font-semibold",children:"Similaridade Detectada:"})]}),n.jsxs("div",{className:"text-2xl font-bold",children:[i,"%"]})]}),i>=60&&n.jsx("p",{className:"text-sm mt-2",children:"Alta similaridade detectada entre as submissÃµes. Recomenda-se revisÃ£o manual detalhada."})]}),n.jsx("div",{className:"grid grid-cols-2 gap-4 flex-1 overflow-hidden",children:s.map((m,p)=>n.jsxs(Z,{className:"p-4 flex flex-col",children:[n.jsxs("div",{className:"mb-4",children:[n.jsx("h3",{className:"font-semibold text-lg",children:m.student?.full_name}),n.jsx("p",{className:"text-sm text-gray-600",children:m.activity?.title}),n.jsxs("div",{className:"flex gap-2 mt-2",children:[m.grade!==null&&n.jsxs(ke,{children:["Nota: ",m.grade]}),n.jsx(ke,{variant:"outline",children:m.status==="graded"?"Corrigida":"Pendente"})]})]}),n.jsx(rs,{className:"flex-1",children:n.jsxs("div",{className:"pr-4",children:[n.jsx("h4",{className:"font-semibold mb-2",children:"SubmissÃ£o:"}),n.jsx("div",{className:"bg-gray-50 p-3 rounded whitespace-pre-wrap text-sm",children:typeof m.content=="string"?m.content:m.content?.text||"Sem conteÃºdo"}),m.feedback&&n.jsxs(n.Fragment,{children:[n.jsx("h4",{className:"font-semibold mt-4 mb-2",children:"Feedback:"}),n.jsx("div",{className:"bg-blue-50 p-3 rounded text-sm",children:m.feedback})]})]})})]},m.id))}),n.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[n.jsxs("div",{className:"text-sm text-gray-600",children:["Comparando ",s.length," submissÃµes"]}),n.jsxs("div",{className:"flex gap-2",children:[n.jsx($,{variant:"outline",onClick:t,children:"Fechar"}),n.jsx($,{variant:"destructive",disabled:i<60,onClick:()=>{r({title:"ðŸš§ Em desenvolvimento",description:"Funcionalidade de marcar plÃ¡gio serÃ¡ implementada em breve."})},children:"Marcar como Suspeita"})]})]})]})})},Dl=()=>{const{user:e}=Et(),{toast:t}=it();bs();const[r,s]=h.useState(!0),[a,o]=h.useState([]),[l,i]=h.useState([]),[c,d]=h.useState(null),[u,f]=h.useState(0),[m,p]=h.useState(!1),[x,w]=h.useState([]),[N,g]=h.useState(!1),[j,v]=h.useState(!1),[S,b]=h.useState("all"),[C,D]=h.useState(""),[O,A]=h.useState("oldest"),[W,B]=h.useState(!1),[K,me]=h.useState([]),[V,te]=h.useState(""),[he,ye]=h.useState([]),[X,G]=h.useState("all"),[ee,Ne]=h.useState(!0),[Se,Ce]=h.useState(!1),[oe,M]=h.useState({totalPending:0,correctedToday:0,avgGrade:0,avgTime:0}),Y=h.useCallback(async()=>{if(e?.id)try{Ne(!0);const k=await Ms.getTeacherClasses(e.id);me(k),k.length===1&&te(k[0].id)}catch(k){T.error("Erro ao carregar turmas:",k),t({title:"Erro",description:"NÃ£o foi possÃ­vel carregar as turmas.",variant:"destructive"})}finally{Ne(!1)}},[e]),J=h.useCallback(async k=>{if(!k){ye([]),G("all");return}try{Ce(!0);const I=await qn.getActivitiesByClass(k),q=Array.isArray(I)?I.map(re=>({id:re.id,title:re.title,description:re.description,due_date:re.due_date,created_at:re.created_at,status:re.status,max_score:re.max_score})):[];ye(q),q.length===1?G(q[0].id):G("all")}catch(I){T.error("Erro ao carregar atividades:",I),t({title:"Erro",description:"NÃ£o foi possÃ­vel carregar as atividades desta turma.",variant:"destructive"})}finally{Ce(!1)}},[]);h.useEffect(()=>{Y(),_e()},[Y]),h.useEffect(()=>{V?J(V):(ye([]),G(""))},[V,J]),h.useEffect(()=>{V&&Ie()},[V,X,S]),h.useEffect(()=>{if(!a||a.length===0){i([]);return}let k=[...a];if(C){const I=C.toLowerCase();k=k.filter(q=>q.student?.full_name?.toLowerCase().includes(I)||q.activity?.title?.toLowerCase().includes(I))}O==="newest"?k.sort((I,q)=>new Date(q.submitted_at)-new Date(I.submitted_at)):O==="oldest"?k.sort((I,q)=>new Date(I.submitted_at)-new Date(q.submitted_at)):O==="grade_asc"?k.sort((I,q)=>(I.grade||0)-(q.grade||0)):O==="grade_desc"&&k.sort((I,q)=>(q.grade||0)-(I.grade||0)),i(k)},[a,C,O]);const Ie=async()=>{if(!(!e||!V))try{s(!0);const k={classId:V,activityId:X!=="all"?X:null,status:S==="all"?null:S==="pending"?"submitted":S==="graded"?"graded":S==="flagged"?"needs_review":null,sortBy:O},{data:I,error:q}=await Fn(k);if(q)throw q;o(I||[]);const re=I?.filter(Oe=>Oe.status==="submitted").length||0;M(Oe=>({...Oe,totalPending:re}))}catch(k){T.error("Erro ao carregar submissÃµes:",k),t({title:"Erro",description:"NÃ£o foi possÃ­vel carregar as submissÃµes.",variant:"destructive"})}finally{s(!1)}},_e=async()=>{if(e)try{const{data:k}=await zn(e.id,"day");k&&M(I=>({...I,correctedToday:k.corrections_count||0,avgGrade:k.avg_grade?.toFixed(1)||0,avgTime:Math.round(k.avg_time_per_correction/60)||0}))}catch(k){T.error("Erro ao carregar mÃ©tricas:",k)}},ft=(k,I=0)=>{d(k),f(I),p(!0)},mt=k=>{const I=k==="next"?u+1:u-1;I>=0&&I<l.length&&(f(I),d(l[I]))},ht=()=>{if(x.length===0){t({title:"Erro",description:"Selecione pelo menos uma submissÃ£o",variant:"destructive"});return}g(!0)},pt=()=>{if(x.length!==2){t({title:"Erro",description:"Selecione exatamente 2 submissÃµes para comparar",variant:"destructive"});return}v(!0)},Ge=()=>{p(!1),d(null),Ie(),_e(),t({title:"Sucesso",description:"CorreÃ§Ã£o salva com sucesso!"})},gt=()=>{t({title:"Em breve",description:"FunÃ§Ã£o de exportaÃ§Ã£o serÃ¡ implementada em breve."})};return r?n.jsx("div",{className:"flex items-center justify-center min-h-screen",children:n.jsx(ws,{size:"lg",text:"Carregando correÃ§Ãµes..."})}):n.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[n.jsx(Cs,{title:"CorreÃ§Ãµes Pendentes",subtitle:`${oe.totalPending} submissÃµes aguardando correÃ§Ã£o`,role:"teacher"}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[n.jsx(Qe,{title:"Pendentes",value:oe.totalPending,icon:mn,gradient:wt.warning,bgColor:"bg-yellow-50 dark:bg-yellow-950/30"}),n.jsx(Qe,{title:"Corrigidas Hoje",value:oe.correctedToday,icon:hn,gradient:wt.success,bgColor:"bg-green-50 dark:bg-green-950/30"}),n.jsx(Qe,{title:"MÃ©dia de Notas",value:oe.avgGrade,icon:Os,gradient:wt.info,bgColor:"bg-blue-50 dark:bg-blue-950/30"}),n.jsx(Qe,{title:"Tempo MÃ©dio",value:`${oe.avgTime}min`,icon:st,gradient:"from-purple-500 to-pink-500",bgColor:"bg-purple-50 dark:bg-purple-950/30"})]}),n.jsx(Z,{className:"p-6 mb-6",children:n.jsxs("div",{className:"space-y-6",children:[n.jsxs("div",{className:"space-y-4",children:[n.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:n.jsxs("div",{children:[n.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"CorreÃ§Ãµes"}),n.jsx("p",{className:"text-muted-foreground",children:S==="all"?"Todas as submissÃµes":S==="pending"?"SubmissÃµes aguardando correÃ§Ã£o":S==="graded"?"SubmissÃµes jÃ¡ corrigidas":"SubmissÃµes sinalizadas"})]})}),n.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-sm font-medium leading-none",children:"Turma"}),n.jsxs(Ze,{value:V,onValueChange:te,disabled:ee,children:[n.jsx(Xe,{children:n.jsx(Ke,{placeholder:ee?"Carregando turmas...":"Selecione uma turma"})}),n.jsx(Je,{children:K.map(k=>n.jsx(ue,{value:k.id,children:k.name},k.id))})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-sm font-medium leading-none",children:"Atividade"}),n.jsxs(Ze,{value:X,onValueChange:G,disabled:!V||Se,children:[n.jsx(Xe,{children:n.jsx(Ke,{placeholder:V?Se?"Carregando atividades...":"Todas as atividades":"Selecione uma turma primeiro"})}),n.jsxs(Je,{children:[n.jsx(ue,{value:"all",children:"Todas as atividades"}),he.map(k=>n.jsx(ue,{value:k.id,children:k.title},k.id))]})]})]}),n.jsxs("div",{className:"space-y-2",children:[n.jsx("label",{className:"text-sm font-medium leading-none",children:"Status"}),n.jsxs(Ze,{value:S,onValueChange:b,children:[n.jsx(Xe,{children:n.jsx(Ke,{placeholder:"Todas"})}),n.jsxs(Je,{children:[n.jsx(ue,{value:"all",children:"Todas"}),n.jsx(ue,{value:"pending",children:"Pendentes"}),n.jsx(ue,{value:"graded",children:"Corrigidas"}),n.jsx(ue,{value:"flagged",children:"Sinalizadas"})]})]})]})]}),n.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[n.jsxs("div",{className:"relative flex-1",children:[n.jsx(pn,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),n.jsx(ot,{placeholder:"Buscar por aluno ou atividade...",className:"pl-9 w-full",value:C,onChange:k=>D(k.target.value)})]}),n.jsxs(Ze,{value:O,onValueChange:A,children:[n.jsx(Xe,{className:"w-full sm:w-[180px]",children:n.jsx(Ke,{placeholder:"Ordenar por"})}),n.jsxs(Je,{children:[n.jsx(ue,{value:"oldest",children:"Mais antigas primeiro"}),n.jsx(ue,{value:"newest",children:"Mais recentes primeiro"}),n.jsx(ue,{value:"grade_asc",children:"Nota: menor para maior"}),n.jsx(ue,{value:"grade_desc",children:"Nota: maior para menor"})]})]}),n.jsxs($,{variant:"outline",onClick:()=>B(!W),className:"w-full sm:w-auto",children:[n.jsx(gn,{className:"mr-2 h-4 w-4"}),"Mais filtros"]})]})]}),n.jsxs("div",{className:"flex flex-wrap gap-3",children:[n.jsxs($,{variant:"outline",onClick:gt,children:[n.jsx(xn,{className:"w-4 h-4 mr-2"}),"Exportar"]}),x.length>0&&n.jsxs(n.Fragment,{children:[n.jsxs($,{variant:"outline",onClick:ht,children:["CorreÃ§Ã£o em Lote (",x.length,")"]}),x.length===2&&n.jsx($,{variant:"outline",onClick:pt,children:"Comparar SubmissÃµes"})]})]})]})}),W&&n.jsx("div",{className:"mb-6",children:n.jsx(oi,{onApply:k=>{T.debug("Aplicar filtros avanÃ§ados:",k),t({title:"Filtros aplicados"})},onClear:()=>{B(!1)}})}),l.length>0?n.jsx("div",{className:"space-y-3",children:l.map((k,I)=>n.jsx(Ns.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:I*.05},children:n.jsx(ba,{submission:k,onCorrect:()=>ft(k,I),isSelected:x.includes(k.id),onSelect:q=>{w(re=>q?[...re,k.id]:re.filter(Oe=>Oe!==k.id))}})},k.id))}):n.jsx(_s,{icon:At,title:"Nenhuma submissÃ£o encontrada",description:"NÃ£o hÃ¡ submissÃµes pendentes de correÃ§Ã£o no momento."}),m&&c&&n.jsx(ya,{submission:c,submissions:l,currentIndex:u,onClose:()=>{p(!1),d(null)},onSaved:Ge,onNavigate:mt}),N&&n.jsx(wa,{submissions:a.filter(k=>x.includes(k.id)),onClose:()=>g(!1),onCompleted:()=>{g(!1),w([]),Ie(),_e()}}),j&&n.jsx(bi,{submissionIds:x,onClose:()=>v(!1)})]})};export{Dl as default};
