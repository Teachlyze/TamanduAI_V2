import{c as H,h as J,b as O,u as Q,r as o,l as V,j as e,q as W}from"./main-BtydHokz.js";import{B as d}from"./button-pkZcz0fw.js";import{C as A}from"./card-BLN8IVBT.js";import{B as g}from"./badge-DpVvk9bK.js";import{P as Y}from"./progress-CWEmAj8D.js";import"./switch-BZnWEHpm.js";import"./label-Do1Gcpls.js";import{u as Z}from"./use-toast-BD7ojcJx.js";import"./DashboardHeader-Do_OLCE8.js";import"./input-DevW5dIO.js";import"./dropdown-menu-DQk5WS44.js";import{f as D}from"./flashcardService-CK0ttocm.js";import{A as ee}from"./arrow-left-A7LEbFFM.js";import{C as te}from"./clock-cyyJEg8O.js";import{P as se}from"./play-B6IQHa80.js";import{P as T}from"./pause-xpmKiHVS.js";import{A as E}from"./index-BpBd5wiB.js";import{m as w}from"./proxy-BKNTM3tf.js";import{C as ae}from"./circle-x-BqIQYXj5.js";import{C as re}from"./circle-check-big-odCM7i_Y.js";import"./index-BRR_QA-l.js";import"./index-C35Ckziv.js";import"./index-DOzlJ45Y.js";import"./index-sWFH3d_M.js";import"./index-C0ZNntAv.js";import"./Combination-DK-gSie6.js";import"./SidebarPremium-BEHUuQck.js";import"./house-dUPObbYn.js";import"./users-CntpuLnR.js";import"./book-open-BQJiPDff.js";import"./file-text-GwBv-P3B.js";import"./graduation-cap-Bm5psu3Q.js";import"./calendar-xkfkZRmm.js";import"./chart-column-B3n9ZMAW.js";import"./message-circle-DTeSrK_w.js";import"./settings-BNGXdjmZ.js";import"./brain-DIkHdpFj.js";import"./chevron-right-Bh44L5jc.js";import"./x-BtLVjj0F.js";import"./index-DsrKRt14.js";import"./check-B1zY7uXK.js";const oe=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],ie=H("rotate-ccw",oe),Qe=()=>{const{deckId:i}=J(),{user:k}=O(),{toast:f}=Z(),h=Q(),[$,j]=o.useState(!0),[z,B]=o.useState(null),[c,N]=o.useState([]),[l,v]=o.useState(0),[b,u]=o.useState(!1),[a,p]=o.useState({total:0,reviewed:0,known:0,unknown:0,startTime:Date.now()}),[m,I]=o.useState(!1),[x,ne]=o.useState({shuffle:!0,autoFlip:!1,timer:!1}),[L,y]=o.useState(0);o.useEffect(()=>{k?.id&&i&&R()},[k,i]),o.useEffect(()=>{if(!m&&x.timer){const t=setInterval(()=>{y(Math.floor((Date.now()-a.startTime)/1e3))},1e3);return()=>clearInterval(t)}},[m,x.timer,a.startTime]);const R=async()=>{try{j(!0);const{data:t,error:r}=await D.getDeckById(i);if(r)throw r;B(t);const{data:s,error:n}=await D.getCardsInDeck(i);if(n)throw n;if(!s||s.length===0){f({title:"Nenhum card disponÃ­vel",description:"Adicione cards ao deck primeiro."}),h(`/students/flashcards/decks/${i}`);return}const P=x.shuffle?C([...s]):s;N(P),p({total:P.length,reviewed:0,known:0,unknown:0,startTime:Date.now()})}catch(t){V.error("Error loading cram session:",t),f({title:"Erro ao carregar",description:"NÃ£o foi possÃ­vel iniciar o modo cram.",variant:"destructive"}),h("/students/flashcards")}finally{j(!1)}},C=t=>{const r=[...t];for(let s=r.length-1;s>0;s--){const n=Math.floor(Math.random()*(s+1));[r[s],r[n]]=[r[n],r[s]]}return r},q=()=>{u(!0)},_=()=>{p(t=>({...t,reviewed:t.reviewed+1,known:t.known+1})),S()},F=()=>{p(t=>({...t,reviewed:t.reviewed+1,unknown:t.unknown+1})),S()},S=()=>{l<c.length-1?(v(l+1),u(!1)):K()},K=()=>{const t=Math.floor((Date.now()-a.startTime)/1e3),r=Math.floor(t/60),s=t%60,n=Math.round(a.known/a.total*100);f({title:"ðŸŽ‰ SessÃ£o de Cram concluÃ­da!",description:`${a.reviewed} cards em ${r}m ${s}s. AcurÃ¡cia: ${n}%`,duration:5e3}),h(`/students/flashcards/decks/${i}`)},U=()=>{const t=x.shuffle?C([...c]):c;N(t),v(0),u(!1),p({total:t.length,reviewed:0,known:0,unknown:0,startTime:Date.now()}),y(0)},X=t=>{const r=Math.floor(t/60),s=t%60;return`${r}:${s.toString().padStart(2,"0")}`};if($)return e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx(W,{size:"lg",text:"Preparando modo cram..."})});const M=c[l],G=(l+1)/c.length*100;return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-orange-50 to-red-50 dark:from-slate-950 dark:to-slate-900",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white/80 dark:bg-slate-900/80 backdrop-blur-sm border-b border-slate-200 dark:border-slate-800 p-4",children:[e.jsxs("div",{className:"max-w-7xl mx-auto flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs(d,{variant:"ghost",size:"sm",onClick:()=>h(`/students/flashcards/decks/${i}`),children:[e.jsx(ee,{className:"w-4 h-4 mr-2"}),"Sair"]}),e.jsxs("div",{children:[e.jsx(g,{variant:"secondary",className:"mb-1",children:"Modo Cram"}),e.jsx("h1",{className:"text-lg font-bold text-slate-900 dark:text-white",children:z?.name})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[x.timer&&e.jsxs(g,{variant:"outline",className:"flex items-center gap-2",children:[e.jsx(te,{className:"w-4 h-4"}),X(L)]}),e.jsxs(g,{variant:"secondary",children:[l+1,"/",c.length]}),e.jsx(d,{variant:"ghost",size:"sm",onClick:()=>I(!m),children:m?e.jsx(se,{className:"w-4 h-4"}):e.jsx(T,{className:"w-4 h-4"})}),e.jsx(d,{variant:"ghost",size:"sm",onClick:U,children:e.jsx(ie,{className:"w-4 h-4"})})]})]}),e.jsx(Y,{value:G,className:"mt-4"})]}),e.jsx("div",{className:"max-w-4xl mx-auto p-6",children:e.jsx(E,{mode:"wait",children:m?e.jsxs(w.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-20",children:[e.jsx(T,{className:"w-16 h-16 mx-auto mb-4 text-slate-400"}),e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-2",children:"Pausado"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Clique no botÃ£o de play para continuar"})]},"paused"):e.jsxs(w.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},children:[e.jsxs(A,{className:"mb-6 overflow-hidden border-2 border-orange-200 dark:border-orange-800",children:[e.jsx("div",{className:"p-8 min-h-[300px] flex items-center justify-center bg-gradient-to-br from-white to-slate-50 dark:from-slate-900 dark:to-slate-800",children:e.jsx("p",{className:"text-2xl font-medium text-slate-900 dark:text-white text-center",children:M.front})}),e.jsx(E,{children:b&&e.jsx(w.div,{initial:{height:0,opacity:0},animate:{height:"auto",opacity:1},exit:{height:0,opacity:0},children:e.jsx("div",{className:"p-8 border-t-2 border-orange-200 dark:border-orange-800 bg-gradient-to-br from-orange-50 to-red-50 dark:from-slate-800 dark:to-slate-900",children:e.jsx("p",{className:"text-xl text-slate-700 dark:text-slate-300 text-center",children:M.back})})})}),e.jsx("div",{className:"p-6 flex justify-center border-t border-slate-100 dark:border-slate-800",children:b?e.jsxs("div",{className:"flex gap-4",children:[e.jsxs(d,{size:"lg",onClick:F,className:"bg-red-500 hover:bg-red-600 text-white",children:[e.jsx(ae,{className:"w-5 h-5 mr-2"}),"NÃ£o Sabia"]}),e.jsxs(d,{size:"lg",onClick:_,className:"bg-green-500 hover:bg-green-600 text-white",children:[e.jsx(re,{className:"w-5 h-5 mr-2"}),"Sabia"]})]}):e.jsx(d,{size:"lg",onClick:q,className:"bg-gradient-to-r from-orange-600 to-red-600 hover:from-orange-700 hover:to-red-700 text-white px-12",children:"Mostrar Resposta"})})]}),e.jsx(A,{className:"p-6",children:e.jsxs("div",{className:"flex items-center justify-center gap-8 text-sm",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Progresso"}),e.jsxs("p",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:[a.reviewed,"/",a.total]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"Sabia"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 dark:text-green-400",children:a.known})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"NÃ£o Sabia"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 dark:text-red-400",children:a.unknown})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:"AcurÃ¡cia"}),e.jsxs("p",{className:"text-2xl font-bold text-blue-600 dark:text-blue-400",children:[a.reviewed>0?Math.round(a.known/a.reviewed*100):0,"%"]})]})]})})]},l)})})]})};export{Qe as default};
