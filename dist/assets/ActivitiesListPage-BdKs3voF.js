import{u as P,a as _,r,s as $,j as t,i as q}from"./main-vCmkj0Ph.js";import{m as C,B as z}from"./card-QZFCDucj.js";import{D as B,g as j}from"./dropdown-menu-CRv4RkRy.js";import{S as p}from"./StatsCard-DsNwPDbG.js";import{E as Q}from"./EmptyState-BSzsQ55S.js";import{A as M}from"./ActivityCard-BsEhJPoh.js";import{S as R}from"./SearchInput-B9MbIqTz.js";import{F as V}from"./FilterBar-CHVM_iqe.js";import"./label-DA0WPkHe.js";import{F as y}from"./file-text-BrP95lln.js";import{C as H}from"./circle-check-BzSOXqD0.js";import{C as X}from"./circle-x-BgvwgIod.js";import{P as S}from"./plus-eaiJZyVH.js";import"./index-DF9gUw3L.js";import"./chevron-right-DOiZ8o1C.js";import"./badge-DYNIDruK.js";import"./circle-alert-CMpGX98n.js";import"./calendar-zMPY0UDh.js";import"./users-D-Skvp4U.js";import"./clock-BTS0eNcV.js";import"./x-WugK2QXI.js";import"./chevron-down-DJboQT18.js";const fe=()=>{const c=P(),{user:d}=_(),[A,f]=r.useState(!0),[g,w]=r.useState([]),[u,N]=r.useState([]),[l,h]=r.useState(""),[s,v]=r.useState({status:null,classId:null,type:null}),[o,k]=r.useState({total:0,active:0,closed:0}),[b,E]=r.useState([]);r.useEffect(()=>{F()},[d]),r.useEffect(()=>{L()},[g,l,s]);const F=async()=>{if(d)try{f(!0);const{data:e,error:a}=await $.from("activities").select(`
          *,
          assignments:activity_class_assignments(
            class:classes(id, name)
          )
        `).eq("created_by",d.id).order("created_at",{ascending:!1});if(a)throw a;w(e||[]);const i=e?.filter(n=>n.status==="active").length||0,D=e?.filter(n=>n.status==="closed").length||0;k({total:e?.length||0,active:i,closed:D});const x=new Map;e?.forEach(n=>{n.assignments?.forEach(m=>{m.class&&x.set(m.class.id,m.class)})}),E(Array.from(x.values()))}catch(e){console.error("Erro ao carregar atividades:",e)}finally{f(!1)}},L=()=>{let e=[...g];if(l){const a=l.toLowerCase();e=e.filter(i=>i.title?.toLowerCase().includes(a)||i.description?.toLowerCase().includes(a))}s.status&&(e=e.filter(a=>a.status===s.status)),s.classId&&(e=e.filter(a=>a.assignments?.some(i=>i.class?.id===s.classId))),s.type&&(e=e.filter(a=>a.type===s.type)),N(e)},I=(e,a)=>{v(i=>({...i,[e]:a}))},T=()=>{v({status:null,classId:null,type:null}),h("")};return A?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx(q,{size:"lg",text:"Carregando atividades..."})}):t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[t.jsx(B,{title:"Minhas Atividades",subtitle:`${o.total} atividade${o.total!==1?"s":""} criada${o.total!==1?"s":""}`,role:"teacher"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[t.jsx(p,{title:"Total de Atividades",value:o.total,icon:y,gradient:j.stats.activities,bgColor:"bg-emerald-50 dark:bg-emerald-950/30",delay:0}),t.jsx(p,{title:"Ativas",value:o.active,icon:H,gradient:j.success,bgColor:"bg-green-50 dark:bg-green-950/30",delay:.1}),t.jsx(p,{title:"Encerradas",value:o.closed,icon:X,gradient:"from-slate-500 to-slate-600",bgColor:"bg-slate-50 dark:bg-slate-950/30",delay:.2})]}),t.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[t.jsx("div",{className:"flex-1",children:t.jsx(R,{placeholder:"Buscar por título ou descrição...",value:l,onChange:h})}),t.jsx(V,{filters:[{key:"status",label:"Status",options:[{value:"active",label:"Ativas"},{value:"draft",label:"Rascunho"},{value:"closed",label:"Encerradas"}]},{key:"type",label:"Tipo",options:[{value:"assignment",label:"Tarefa"},{value:"quiz",label:"Quiz"},{value:"project",label:"Projeto"}]},...b.length>0?[{key:"classId",label:"Turma",options:b.map(e=>({value:e.id,label:e.name}))}]:[]],activeFilters:s,onFilterChange:I,onClearAll:T})]}),u.length>0?t.jsx(C.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6 mb-20",children:u.map((e,a)=>{const i=e.assignments?.[0]?.class?.name||"Sem turma";return t.jsx(M,{id:e.id,title:e.title,className:i,dueDate:e.due_date,status:e.status||"draft",submissionCount:0,totalStudents:0,priority:"normal",delay:a*.05,onClick:()=>c(`/teacher/activities/${e.id}`),actionLabel:"Ver Detalhes",onAction:()=>c(`/teacher/activities/${e.id}`)},e.id)})}):t.jsx(Q,{icon:y,title:l||s.status?"Nenhuma atividade encontrada":"Você ainda não criou nenhuma atividade",description:l||s.status?"Tente ajustar os filtros ou buscar por outro termo.":"Crie sua primeira atividade para começar a avaliar seus alunos.",actionLabel:"Criar Primeira Atividade",actionIcon:S,action:()=>c("/teacher/activities/new")}),u.length>0&&t.jsx(C.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.5},className:"fixed bottom-8 right-8 z-50",children:t.jsx(z,{onClick:()=>c("/teacher/activities/new"),className:"w-16 h-16 rounded-full shadow-2xl bg-gradient-to-r from-emerald-600 to-teal-600 hover:from-emerald-700 hover:to-teal-700 text-white",children:t.jsx(S,{className:"w-8 h-8"})})})]})};export{fe as default};
