import{j as e,k as q,u as I,r,s as D,i as R}from"./main-B-DuDfC3.js";import{m as L,C as T,B as C}from"./card-D9y6cEbK.js";import{c as V,v as E,D as O,g as N}from"./dropdown-menu-S8hb-z0t.js";import{S as k,E as Q}from"./EmptyState-D7T78sMN.js";import{S as G}from"./SearchInput-Bn2zNm8E.js";import{B as H}from"./badge-D_5Pz7Pp.js";import{C as B}from"./circle-alert-BKc5oqo6.js";import{C as y}from"./circle-check-Bv5_Zyh1.js";import{C as z}from"./clock-CnEWE99A.js";import{C as J}from"./calendar-HjYr_AWs.js";import{F as S}from"./file-text-Vxms5le2.js";import"./label-CQXNCxhD.js";import{A as K}from"./arrow-left-br2hRIKT.js";import"./index-BvwGeBdQ.js";import"./chevron-right-BFR20X-e.js";import"./x-5mMV-IBm.js";const M=({submission:i,onView:d,onGrade:x,delay:b=0,expanded:l=!1})=>{const{id:w,student:a,activity:f,submittedAt:m,status:o="pending",grade:s,feedback:p,isLate:g=!1}=i,h={pending:{icon:z,label:"Pendente",color:"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300",iconColor:"text-amber-600 dark:text-amber-400"},graded:{icon:y,label:"Corrigida",color:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300",iconColor:"text-green-600 dark:text-green-400"},late:{icon:B,label:"Atrasada",color:"bg-red-100 dark:bg-red-900/30 text-red-700 dark:text-red-300",iconColor:"text-red-600 dark:text-red-400"}},u=h[g?"late":o]||h.pending,v=u.icon;return e.jsx(L.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:b},children:e.jsxs(T,{className:`p-6 ${V.card.hover} bg-white dark:bg-slate-900`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[a?.avatar?e.jsx("img",{src:a.avatar,alt:a.name,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold",children:a?.name?.[0]||"A"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:E(a?.name)}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:E(f?.title)})]})]}),e.jsxs(H,{className:u.color,children:[e.jsx(v,{className:"w-3 h-3 mr-1"}),u.label]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 text-sm text-slate-600 dark:text-slate-400",children:[e.jsx(J,{className:"w-4 h-4"}),e.jsx("span",{children:m?new Date(m).toLocaleDateString("pt-BR"):"Não enviada"})]}),o==="graded"&&s!==null&&e.jsxs("div",{className:"flex items-center gap-2 text-sm",children:[e.jsx(S,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"}),e.jsxs("span",{className:"font-semibold text-blue-600 dark:text-blue-400",children:["Nota: ",s.toFixed(1)]})]})]}),l&&p&&e.jsxs("div",{className:"mb-4 p-4 bg-slate-50 dark:bg-slate-900 rounded-lg",children:[e.jsx("h4",{className:"text-sm font-semibold text-slate-900 dark:text-white mb-2",children:"Feedback:"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:p})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[d&&e.jsxs(C,{variant:"outline",size:"sm",onClick:()=>d(i),className:"flex-1",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Ver Submissão"]}),o==="pending"&&x&&e.jsxs(C,{size:"sm",onClick:()=>x(i),className:"flex-1 bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white",children:[e.jsx(y,{className:"w-4 h-4 mr-2"}),"Corrigir"]})]})]})})},me=()=>{const{activityId:i}=q(),d=I(),[x,b]=r.useState(!0),[l,w]=r.useState(null),[a,f]=r.useState([]),[m,o]=r.useState([]),[s,p]=r.useState(""),[g,h]=r.useState({total:0,graded:0,pending:0});r.useEffect(()=>{_()},[i]),r.useEffect(()=>{u()},[a,s]);const _=async()=>{try{b(!0);const{data:t,error:c}=await D.from("activities").select("*").eq("id",i).single();if(c)throw c;w(t);const{data:n,error:A}=await D.from("submissions").select(`
          *,
          student:profiles!submissions_user_id_fkey(id, name, email, avatar_url)
        `).eq("activity_id",i).order("submitted_at",{ascending:!1});if(A)throw A;f(n||[]);const P=n?.filter(j=>j.status==="graded").length||0,$=n?.filter(j=>j.status==="pending").length||0;h({total:n?.length||0,graded:P,pending:$})}catch(t){console.error("Erro ao carregar submissões:",t)}finally{b(!1)}},u=()=>{if(!s){o(a);return}const t=s.toLowerCase(),c=a.filter(n=>n.student?.name?.toLowerCase().includes(t)||n.student?.email?.toLowerCase().includes(t));o(c)},v=t=>{d(`/teacher/grading/${t.id}`)},F=t=>{d(`/teacher/grading/${t.id}`)};return x?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(R,{size:"lg",text:"Carregando submissões..."})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsxs(C,{variant:"ghost",onClick:()=>d("/teacher/activities"),className:"mb-4",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Voltar para Atividades"]}),e.jsx(O,{title:l?.title||"Atividade",subtitle:`Submissões dos alunos • Prazo: ${l?.due_date?new Date(l.due_date).toLocaleDateString("pt-BR"):"Sem prazo"}`,role:"teacher"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(k,{title:"Total de Submissões",value:g.total,icon:S,gradient:N.stats.activities,bgColor:"bg-blue-50 dark:bg-blue-950/30",delay:0}),e.jsx(k,{title:"Corrigidas",value:g.graded,icon:y,gradient:N.success,bgColor:"bg-green-50 dark:bg-green-950/30",delay:.1}),e.jsx(k,{title:"Pendentes",value:g.pending,icon:z,gradient:N.warning,bgColor:"bg-amber-50 dark:bg-amber-950/30",delay:.2})]}),e.jsx("div",{className:"mb-8",children:e.jsx(G,{placeholder:"Buscar por nome ou email do aluno...",value:s,onChange:p})}),m.length>0?e.jsx(L.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:m.map((t,c)=>e.jsx(M,{submission:{id:t.id,student:{name:t.student?.name||"Aluno",avatar:t.student?.avatar_url},activity:{title:l?.title},submittedAt:t.submitted_at,status:t.status||"pending",grade:t.grade,feedback:t.feedback,isLate:t.due_date&&new Date(t.submitted_at)>new Date(t.due_date)},onView:v,onGrade:F,delay:c*.05},t.id))}):e.jsx(Q,{icon:B,title:s?"Nenhuma submissão encontrada":"Nenhuma submissão ainda",description:s?"Tente buscar por outro termo.":"Os alunos ainda não enviaram suas respostas para esta atividade."})]})};export{me as default};
