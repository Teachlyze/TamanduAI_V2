import{h as B,u as E,r as l,s as d,l as P,j as e,q}from"./main-CI5_MmIm.js";import{B as T}from"./button-D7H9d9Gd.js";import{C as p}from"./card-DpcnMbcE.js";import{B as f}from"./badge-BOI6M_d9.js";import{D as L,g}from"./DashboardHeader-CYuk3ql1.js";import{S as m}from"./StatsCard-C6i8pjlS.js";import{E as F}from"./EmptyState-2SgC2yO6.js";import"./input-BJMmyirp.js";import"./dropdown-menu-dTrFNQHD.js";import{D as M}from"./DataTable-C3EIdn3A.js";import"./label-Nf4YzbUq.js";import{A as O}from"./arrow-left-AtIy0G9L.js";import{M as R}from"./mail-CRZAKwaM.js";import{C as G}from"./calendar-Dbm_7POQ.js";import{T as H}from"./trending-up-1zEvTPQM.js";import{C as b}from"./circle-check-aCTblfpW.js";import{C as V}from"./clock-3X7dheFj.js";import{A as z}from"./award-CvYEvQ9U.js";import"./proxy-CT7Xtxle.js";import"./chevron-right-CHSrP1xQ.js";import"./index-D4BuPd_i.js";import"./index-CRRraFTu.js";import"./index-CtvfaZbL.js";import"./index-DHrdJ99Z.js";import"./Combination-BfETjw1A.js";import"./SidebarPremium-0_wHXPj0.js";import"./house-B6Hparzo.js";import"./users-ChR7WEeh.js";import"./book-open-DlGI5eOy.js";import"./file-text-CtozP3gh.js";import"./graduation-cap-mPfDCRgT.js";import"./chart-column-G5dLAdkQ.js";import"./message-circle-CRpVuYq9.js";import"./settings-BWUwUKXK.js";import"./brain-DVBX4Id_.js";import"./index-RHGs5twt.js";import"./x-DGmYUGM5.js";import"./index-jkBwDHc_.js";import"./check-GhIpAKm1.js";import"./chevron-up-CrZ13wWo.js";import"./chevron-down-DXVEpPD6.js";const Ee=()=>{const{studentId:i}=B(),h=E(),[v,u]=l.useState(!0),[r,j]=l.useState(null),[x,y]=l.useState([]),[o,N]=l.useState({average:0,completed:0,pending:0,xp:0});l.useEffect(()=>{k()},[i]);const k=async()=>{try{u(!0);const{data:a}=await d.from("profiles").select("*").eq("id",i).single(),{data:t}=await d.from("class_members").select("class:classes(id, name)").eq("user_id",i).eq("role","student"),{data:n}=await d.from("submissions").select(`
          *,
          activity:activities(
            id, 
            title, 
            max_score,
            assignments:activity_class_assignments(
              class:classes(name)
            )
          )
        `).eq("student_id",i).order("submitted_at",{ascending:!1}),{data:w}=await d.from("gamification_profiles").select("*").eq("user_id",i).single(),c=n?.filter(s=>s.grade!==null).map(s=>s.grade)||[],S=c.length>0?c.reduce((s,D)=>s+D,0)/c.length:0,C=n?.filter(s=>s.status==="graded").length||0,A=n?.filter(s=>s.status==="pending").length||0;j({...a,name:a?.full_name||a?.name||a?.email||"Aluno",classes:t?.map(s=>s.class).filter(Boolean)||[]}),y(n||[]),N({average:Number(S.toFixed(2)),completed:C,pending:A,xp:w?.xp_total||0})}catch(a){P.error("Erro:",a)}finally{u(!1)}},_=[{key:"activity",label:"Atividade",render:(a,t)=>t.activity?.title||"Sem t√≠tulo"},{key:"class",label:"Turma",render:(a,t)=>t.activity?.assignments?.[0]?.class?.name||"-"},{key:"submitted_at",label:"Data de Envio",type:"date"},{key:"grade",label:"Nota",render:(a,t)=>t.grade===null?"-":e.jsxs("span",{className:"font-semibold",children:[t.grade.toFixed(2)," / ",t.activity?.max_score||10]})},{key:"status",label:"Status",type:"badge",render:(a,t)=>e.jsx(f,{className:t.status==="graded"?"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300":"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300",children:t.status==="graded"?"Corrigida":"Pendente"})}];return v?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(q,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsxs(T,{variant:"ghost",onClick:()=>h("/dashboard/students"),className:"mb-4",children:[e.jsx(O,{className:"w-4 h-4 mr-2"}),"Voltar"]}),e.jsx(L,{title:"Perfil do Aluno",subtitle:r?.name||"Aluno",role:"teacher"}),e.jsxs(p,{className:"p-6 bg-white dark:bg-slate-900 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-6 mb-6",children:[r?.avatar_url?e.jsx("img",{src:r.avatar_url,alt:r.name,className:"w-24 h-24 rounded-full"}):e.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-white text-4xl font-bold",children:r?.name?.[0]||"A"}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-slate-900 dark:text-white mb-2",children:r?.name||"Sem nome"}),e.jsxs("div",{className:"flex items-center gap-4 text-sm text-slate-600 dark:text-slate-400",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(R,{className:"w-4 h-4"}),r?.email]}),r?.created_at&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(G,{className:"w-4 h-4"}),"Desde ",new Date(r.created_at).toLocaleDateString("pt-BR")]})]})]})]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:r?.classes.map((a,t)=>e.jsx(f,{variant:"secondary",children:a.name},t))})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[e.jsx(m,{title:"M√©dia Geral",value:o.average.toFixed(2),icon:H,gradient:g.primary,format:"text",delay:0}),e.jsx(m,{title:"Atividades Conclu√≠das",value:o.completed,icon:b,gradient:g.success,delay:.1}),e.jsx(m,{title:"Pendentes",value:o.pending,icon:V,gradient:g.warning,delay:.2}),e.jsx(m,{title:"XP Total",value:o.xp,icon:z,gradient:"from-amber-500 to-orange-500",delay:.3})]}),e.jsx(p,{className:"p-6 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800 mb-8",children:e.jsxs("p",{className:"text-blue-800 dark:text-blue-200 text-sm",children:["üíé ",e.jsx("strong",{children:"Vers√£o PRO:"})," Gr√°ficos de evolu√ß√£o, an√°lise detalhada de desempenho e compara√ß√£o com a turma."]})}),e.jsxs(p,{className:"p-6 bg-white dark:bg-slate-900",children:[e.jsx("h3",{className:"text-lg font-bold text-slate-900 dark:text-white mb-6",children:"Hist√≥rico de Atividades"}),x.length>0?e.jsx(M,{columns:_,data:x,sortBy:"submitted_at",sortOrder:"desc"}):e.jsx(F,{icon:b,title:"Nenhuma atividade ainda",description:"O aluno ainda n√£o enviou atividades."})]})]})};export{Ee as default};
