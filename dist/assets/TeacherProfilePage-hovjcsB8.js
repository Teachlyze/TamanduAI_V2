import{c as W,s as d,l as h,a as Z,u as Q,r as b,j as e,p as z}from"./main-CulyknMy.js";import{C as $}from"./card-0IW715z3.js";import{m as I,B as y}from"./button-Dfu2yMjN.js";import{t as c}from"./use-toast-D1WbEInh.js";import{U as ee}from"./user-BGYzkTxO.js";import{S as ae}from"./settings-Bqthy2dX.js";import{S as re}from"./shield-CuqBw5K4.js";import{S as R}from"./save-CiiFTid_.js";import{X as te}from"./x-C2dkvfPv.js";import{B as se}from"./bell-DQawnzMz.js";import{M as U,S as L}from"./sun-C1zBAxi_.js";import{G as ie}from"./globe-BGps5cUg.js";import{K as le}from"./key-DcUSRl6c.js";import{T as B}from"./triangle-alert-B2lKc9qN.js";import{T as G}from"./trash-2-BIgCFaej.js";import{A as oe}from"./index-BZWQ4euU.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M13.997 4a2 2 0 0 1 1.76 1.05l.486.9A2 2 0 0 0 18.003 7H20a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2h1.997a2 2 0 0 0 1.759-1.048l.489-.904A2 2 0 0 1 10.004 4z",key:"18u6gg"}],["circle",{cx:"12",cy:"13",r:"3",key:"1vg3eu"}]],de=W("camera",ne),ce=async s=>{try{const{data:l,error:i}=await d.from("profiles").select("*").eq("id",s).eq("role","teacher").single();if(i)throw i;return{data:l,error:null}}catch(l){return h.error("Erro ao buscar perfil do professor:",l),{data:null,error:l}}},me=async(s,l)=>{try{const{data:i,error:x}=await d.from("profiles").update({...l,updated_at:new Date().toISOString()}).eq("id",s).select().single();if(x)throw x;return{data:i,error:null}}catch(i){return h.error("Erro ao atualizar perfil do professor:",i),{data:null,error:i}}},X=async s=>{try{const{data:l,error:i}=await d.from("classes").select("id").eq("created_by",s).eq("is_active",!0);if(i)throw i;const x=l?.length||0,f=l?.map(p=>p.id)||[],{data:u,error:m}=await d.from("class_members").select("user_id").in("class_id",f).eq("role","student");if(m)throw m;const k=new Set(u?.map(p=>p.user_id)||[]).size,{data:C,error:P}=await d.from("activities").select("id").eq("created_by",s);if(P)throw P;const M=C?.length||0,N=C?.map(p=>p.id)||[],{data:_,error:A}=await d.from("submissions").select("id").in("activity_id",N).eq("status","submitted");if(A)throw A;const w=_?.length||0,{data:S,error:F}=await d.from("submissions").select("grade").in("activity_id",N).not("grade","is",null);if(F)throw F;const T=S?.length>0?S.reduce((p,O)=>p+O.grade,0)/S.length:0,E=new Date;E.setHours(0,0,0,0);const n=new Date(E);n.setDate(n.getDate()+1);const{data:v,error:j}=await d.from("submissions").select("id").in("activity_id",N).gte("graded_at",E.toISOString()).lt("graded_at",n.toISOString());if(j)throw j;const D=v?.length||0;return{data:{totalClasses:x,totalStudents:k,totalActivities:M,pendingGrading:w,avgGrade:Number(T.toFixed(1)),todayCorrections:D},error:null}}catch(l){return h.error("Erro ao buscar estatísticas do professor:",l),{data:null,error:l}}},ue=async s=>{try{const{data:l,error:i}=await X(s);if(i)throw i;const{data:x,error:f}=await d.from("classes").select(`
        *,
        class_members(count)
      `).eq("created_by",s).eq("is_active",!0).order("updated_at",{ascending:!1}).limit(5);if(f)throw f;const{data:u,error:m}=await d.from("activities").select(`
        *,
        activity_class_assignments(class:classes(name))
      `).eq("created_by",s).order("created_at",{ascending:!1}).limit(5);if(m)throw m;return{data:{stats:l,recentClasses:x||[],recentActivities:u||[]},error:null}}catch(l){return h.error("Erro ao buscar resumo do dashboard:",l),{data:null,error:l}}},fe=async(s,l)=>{try{const{data:i}=await d.from("profiles").select("preferences").eq("id",s).single(),f={...i?.preferences||{},...l,updated_at:new Date().toISOString()},{data:u,error:m}=await d.from("profiles").update({preferences:f}).eq("id",s).select().single();if(m)throw m;return{data:u,error:null}}catch(i){return h.error("Erro ao atualizar preferências:",i),{data:null,error:i}}},xe=async(s,l)=>{try{const i=l.name.split(".").pop(),x=`${Date.now()}.${i}`,f=`${s}/${x}`,{error:u}=await d.storage.from("avatars").upload(f,l,{cacheControl:"3600",upsert:!0});if(u)throw u;const{data:m}=d.storage.from("avatars").getPublicUrl(f),g=m.publicUrl,{error:k}=await d.from("profiles").update({avatar_url:g}).eq("id",s);if(k)throw k;return{data:{avatar_url:g},error:null}}catch(i){return h.error("Erro ao fazer upload do avatar:",i),{data:null,error:i}}},q={getTeacherProfile:ce,updateTeacherProfile:me,getTeacherStats:X,getDashboardSummary:ue,updatePreferences:fe,uploadAvatar:xe},De=()=>{const{user:s,signOut:l}=Z(),i=Q(),[x,f]=b.useState(!0),[u,m]=b.useState(!1),[g,k]=b.useState("personal"),[C,P]=b.useState(!1),[M,N]=b.useState(!1),[_,A]=b.useState(""),[w,S]=b.useState(!1),F=a=>{if(a=a.replace(/[^\d]/g,""),a.length!==11||/^(\d)\1{10}$/.test(a))return!1;let r=0;for(let o=0;o<9;o++)r+=parseInt(a.charAt(o))*(10-o);let t=11-r%11;if((t===10||t===11)&&(t=0),t!==parseInt(a.charAt(9)))return!1;r=0;for(let o=0;o<10;o++)r+=parseInt(a.charAt(o))*(11-o);return t=11-r%11,(t===10||t===11)&&(t=0),t===parseInt(a.charAt(10))},T=a=>a?(a=String(a).replace(/\D/g,""),a.length<=10?(a=a.replace(/(\d{2})(\d)/,"($1) $2"),a=a.replace(/(\d{4})(\d)/,"$1-$2")):(a=a.replace(/(\d{2})(\d)/,"($1) $2"),a=a.replace(/(\d{5})(\d)/,"$1-$2")),a):"",E=a=>a?(a=String(a).replace(/\D/g,""),a=a.replace(/(\d{3})(\d)/,"$1.$2"),a=a.replace(/(\d{3})(\d)/,"$1.$2"),a=a.replace(/(\d{3})(\d{1,2})$/,"$1-$2"),a):"",[n,v]=b.useState({full_name:"",email:"",phone:"",cpf:"",institution:""}),[j,D]=b.useState({notifications:{email:{newSubmissions:!0,studentsAlert:!0,upcomingEvents:!0,weeklyReport:!0,platform:!0},push:{newSubmissions:!0,todayEvents:!1,messages:!0},inApp:"all"},interface:{language:"pt-BR",theme:"light",fontSize:"medium"},regional:{timezone:"America/Sao_Paulo",dateFormat:"DD/MM/YYYY",timeFormat:"24h"},dashboard:{itemsPerPage:25,defaultClassOrder:"recent",showArchivedClasses:!1}});b.useEffect(()=>{s?.id&&p()},[s]);const p=async()=>{try{f(!0);const{data:a,error:r}=await q.getTeacherProfile(s.id);if(r)throw r;a&&(v({full_name:a.full_name||"",email:a.email||"",phone:T(a.phone||""),cpf:E(a.cpf||""),institution:a.institution||""}),a.preferences&&D(t=>({...t,...a.preferences})))}catch(a){h.error("Erro ao carregar perfil:",a),c({title:"Erro ao carregar perfil",description:"Não foi possível carregar seus dados.",variant:"destructive"})}finally{f(!1)}},O=async a=>{const r=a.target.files?.[0];if(r){if(!r.type.startsWith("image/")){c({title:"Arquivo inválido",description:"Por favor, selecione uma imagem.",variant:"destructive"});return}if(r.size>5*1024*1024){c({title:"Arquivo muito grande",description:"A imagem deve ter no máximo 5MB.",variant:"destructive"});return}try{P(!0);const{data:t,error:o}=await q.uploadAvatar(s.id,r);if(o)throw o;v(J=>({...J,avatar_url:t.avatar_url})),c({title:"Foto atualizada!",description:"Sua foto de perfil foi atualizada com sucesso."})}catch(t){h.error("Erro ao fazer upload:",t);const o=t.message?.includes("Bucket not found")?"Bucket de avatars não configurado. Entre em contato com o administrador.":"Não foi possível atualizar sua foto. Tente novamente.";c({title:"Erro ao fazer upload",description:o,variant:"destructive"})}finally{P(!1)}}},Y=async()=>{if(!n.full_name.trim()){c({title:"Nome obrigatório",description:"Por favor, preencha seu nome completo.",variant:"destructive"});return}try{if(m(!0),n.cpf&&!F(n.cpf)){c({title:"CPF inválido",description:"Por favor, insira um CPF válido.",variant:"destructive"}),m(!1);return}const a=n.phone.replace(/\D/g,""),r=n.cpf.replace(/\D/g,""),t={};n.full_name?.trim()&&(t.full_name=n.full_name.trim()),a&&(t.phone=a),r&&(t.cpf=r),n.institution?.trim()&&(t.institution=n.institution.trim());const{error:o}=await q.updateTeacherProfile(s.id,t);if(o)throw o;c({title:"Perfil atualizado!",description:"Suas informações foram salvas com sucesso."})}catch(a){h.error("Erro ao salvar perfil:",a),c({title:"Erro ao salvar",description:"Não foi possível salvar suas alterações.",variant:"destructive"})}finally{m(!1)}},H=async()=>{try{m(!0);const{error:a}=await q.updatePreferences(s.id,j);if(a)throw a;c({title:"Preferências salvas!",description:"Suas configurações foram atualizadas."}),V(j.interface.theme)}catch(a){h.error("Erro ao salvar preferências:",a),c({title:"Erro ao salvar",description:"Não foi possível salvar suas preferências.",variant:"destructive"})}finally{m(!1)}},V=a=>{const r=document.documentElement;a==="dark"?r.classList.add("dark"):a==="light"?r.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches?r.classList.add("dark"):r.classList.remove("dark")},K=[{id:"personal",label:"Dados Pessoais",icon:ee},{id:"preferences",label:"Preferências",icon:ae},{id:"security",label:"Segurança",icon:re}];return x?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(z,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsxs("div",{className:"relative mb-6 overflow-hidden rounded-2xl bg-gradient-to-r from-blue-600 to-cyan-500 p-8 text-white shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-white/[0.05] bg-[size:20px_20px]"}),e.jsxs(I.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative z-10",children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Meu Perfil"}),e.jsx("p",{className:"text-cyan-100",children:"Gerencie suas informações pessoais e preferências"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-4 gap-6",children:[e.jsx($,{className:"lg:col-span-1 p-4 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 h-fit",children:e.jsx("div",{className:"space-y-2",children:K.map(a=>{const r=a.icon,t=g===a.id;return e.jsxs("button",{onClick:()=>k(a.id),className:`w-full flex items-center gap-3 px-4 py-3 rounded-lg transition-all ${t?"bg-blue-50 dark:bg-blue-950/30 text-blue-600 dark:text-blue-400 border-2 border-blue-600":"text-slate-700 dark:text-slate-300 hover:bg-slate-50 dark:hover:bg-slate-800 border-2 border-transparent"}`,children:[e.jsx(r,{className:"w-5 h-5"}),e.jsx("span",{className:"font-medium",children:a.label})]},a.id)})})}),e.jsxs("div",{className:"lg:col-span-3",children:[g==="personal"&&e.jsxs($,{className:"p-6 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-slate-900 dark:text-white",children:"Dados Pessoais"}),e.jsxs("div",{className:"mb-8",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Foto de Perfil"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-24 h-24 rounded-full bg-gradient-to-br from-blue-600 to-cyan-500 flex items-center justify-center text-white text-2xl font-bold overflow-hidden",children:n.avatar_url?e.jsx("img",{src:n.avatar_url,alt:"Avatar",className:"w-full h-full object-cover"}):n.full_name?.[0]||"P"}),C&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center bg-black/50 rounded-full",children:e.jsx(z,{size:"sm"})})]}),e.jsxs("div",{children:[e.jsx("input",{type:"file",id:"avatar-upload",accept:"image/*",onChange:O,className:"hidden",disabled:C}),e.jsxs("label",{htmlFor:"avatar-upload",className:"inline-flex items-center gap-2 px-4 py-2 bg-blue-600 hover:bg-blue-700 text-white rounded-lg cursor-pointer transition-colors",children:[e.jsx(de,{className:"w-4 h-4"}),"Alterar Foto"]}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"JPG, PNG ou GIF. Máximo 5MB."})]})]})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h3",{className:"font-semibold text-lg text-slate-900 dark:text-white",children:"Informações Básicas"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Nome Completo *"}),e.jsx("input",{type:"text",value:n.full_name,onChange:a=>v(r=>({...r,full_name:a.target.value})),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",placeholder:"Seu nome completo"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:n.email,readOnly:!0,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg bg-slate-100 dark:bg-slate-800 cursor-not-allowed"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Telefone"}),e.jsx("input",{type:"tel",value:n.phone,onChange:a=>v(r=>({...r,phone:T(a.target.value)})),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",placeholder:"(00) 00000-0000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"CPF"}),e.jsx("input",{type:"text",value:n.cpf,onChange:a=>v(r=>({...r,cpf:E(a.target.value)})),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",placeholder:"000.000.000-00"})]})]})]}),e.jsxs("div",{className:"space-y-4 mb-8",children:[e.jsx("h3",{className:"font-semibold text-lg text-slate-900 dark:text-white",children:"Informações Profissionais"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Instituição"}),e.jsx("input",{type:"text",value:n.institution,onChange:a=>v(r=>({...r,institution:a.target.value})),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",placeholder:"Nome da escola/universidade"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t border-slate-200 dark:border-slate-800",children:[e.jsx(y,{onClick:Y,disabled:u,className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:u?e.jsxs(e.Fragment,{children:[e.jsx(z,{size:"sm",className:"mr-2"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Salvar Alterações"]})}),e.jsxs(y,{variant:"outline",onClick:p,disabled:u,children:[e.jsx(te,{className:"w-4 h-4 mr-2"}),"Cancelar"]})]})]}),g==="preferences"&&e.jsxs($,{className:"p-6 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-slate-900 dark:text-white",children:"Preferências"}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"font-semibold text-lg text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[e.jsx(se,{className:"w-5 h-5"}),"Notificações por Email"]}),e.jsx("div",{className:"space-y-3",children:Object.entries({newSubmissions:"Novas submissões de alunos",studentsAlert:"Alunos em alerta",upcomingEvents:"Lembrete de eventos próximos",weeklyReport:"Resumo semanal de atividades",platform:"Comunicados da plataforma"}).map(([a,r])=>e.jsxs("label",{className:"flex items-center gap-3 p-3 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:j.notifications.email[a],onChange:t=>D(o=>({...o,notifications:{...o.notifications,email:{...o.notifications.email,[a]:t.target.checked}}})),className:"w-5 h-5 text-blue-600 rounded focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-slate-700 dark:text-slate-300",children:r})]},a))})]}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"font-semibold text-lg text-slate-900 dark:text-white mb-4 flex items-center gap-2",children:[j.interface.theme==="dark"?e.jsx(U,{className:"w-5 h-5"}):e.jsx(L,{className:"w-5 h-5"}),"Interface"]}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Tema Visual"}),e.jsx("div",{className:"flex gap-3",children:[{value:"light",label:"Claro",icon:L},{value:"dark",label:"Escuro",icon:U},{value:"auto",label:"Automático",icon:ie}].map(({value:a,label:r,icon:t})=>e.jsxs("button",{onClick:()=>D(o=>({...o,interface:{...o.interface,theme:a}})),className:`flex-1 flex flex-col items-center gap-2 p-4 rounded-lg border-2 transition-all ${j.interface.theme===a?"border-blue-600 bg-blue-50 dark:bg-blue-950/30":"border-slate-200 dark:border-slate-700 hover:border-blue-300"}`,children:[e.jsx(t,{className:"w-5 h-5"}),e.jsx("span",{className:"text-sm font-medium",children:r})]},a))})]})})]}),e.jsx("div",{className:"flex items-center gap-3 pt-4 border-t border-slate-200 dark:border-slate-800",children:e.jsx(y,{onClick:H,disabled:u,className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:u?e.jsxs(e.Fragment,{children:[e.jsx(z,{size:"sm",className:"mr-2"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(R,{className:"w-4 h-4 mr-2"}),"Salvar Preferências"]})})})]}),g==="security"&&e.jsxs($,{className:"p-6 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800",children:[e.jsx("h2",{className:"text-2xl font-bold mb-6 text-slate-900 dark:text-white",children:"Segurança"}),e.jsxs("div",{className:"mb-8",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2",children:[e.jsx(le,{className:"w-5 h-5"}),"Alterar Senha"]}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:"Para alterar sua senha, você receberá um email com instruções."}),e.jsx(y,{variant:"outline",onClick:async()=>{const{error:a}=await d.auth.resetPasswordForEmail(s.email,{redirectTo:`${window.location.origin}/reset-password`});a?c({title:"Erro",description:"Não foi possível enviar o email de redefinição.",variant:"destructive"}):c({title:"Email Enviado",description:"Verifique sua caixa de entrada para redefinir sua senha."})},children:"Enviar Email de Redefinição"})]}),e.jsxs("div",{className:"border-t border-slate-200 dark:border-slate-800 pt-8",children:[e.jsxs("h3",{className:"text-lg font-semibold mb-4 flex items-center gap-2 text-red-600",children:[e.jsx(B,{className:"w-5 h-5"}),"Zona de Perigo"]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800 rounded-lg p-4",children:[e.jsx("h4",{className:"font-semibold text-red-900 dark:text-red-300 mb-2",children:"Deletar Conta"}),e.jsxs("p",{className:"text-sm text-red-800 dark:text-red-400 mb-4",children:["Esta ação é ",e.jsx("strong",{children:"irreversível"}),". Todos os seus dados, turmas, atividades e histórico serão permanentemente deletados."]}),e.jsxs(y,{variant:"destructive",onClick:()=>N(!0),className:"bg-red-600 hover:bg-red-700",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Deletar Minha Conta"]})]})]})]})]})]}),e.jsx(oe,{children:M&&e.jsxs(e.Fragment,{children:[e.jsx(I.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 bg-black/60 z-[100]",onClick:()=>!w&&N(!1)}),e.jsx(I.div,{initial:{opacity:0,scale:.95,y:-20},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-20},transition:{type:"spring",duration:.3},className:"fixed inset-0 z-[101] flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-xl shadow-2xl p-6 border border-red-200 dark:border-red-800 w-full max-w-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-full bg-red-100 dark:bg-red-900/30 flex items-center justify-center",children:e.jsx(B,{className:"w-6 h-6 text-red-600 dark:text-red-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-bold text-red-600",children:"Deletar Conta Permanentemente"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Esta ação não pode ser desfeita"})]})]}),e.jsxs("div",{className:"bg-red-50 dark:bg-red-900/10 border border-red-200 dark:border-red-800 rounded-lg p-4 mb-4",children:[e.jsx("p",{className:"text-sm text-red-900 dark:text-red-300 font-semibold mb-2",children:"⚠️ O que será deletado:"}),e.jsxs("ul",{className:"text-sm text-red-800 dark:text-red-400 space-y-1 ml-4 list-disc",children:[e.jsx("li",{children:"Todos os seus dados pessoais"}),e.jsx("li",{children:"Todas as turmas que você criou"}),e.jsx("li",{children:"Todas as atividades e submissões"}),e.jsx("li",{children:"Todo o histórico e relatórios"}),e.jsx("li",{children:"Acesso permanente à plataforma"})]})]}),e.jsxs("p",{className:"text-sm text-slate-700 dark:text-slate-300 mb-4",children:["Para confirmar, digite ",e.jsx("strong",{className:"font-mono bg-slate-100 dark:bg-slate-800 px-2 py-1 rounded",children:"CONFIRMAR EXCLUSÃO"})," abaixo:"]}),e.jsx("input",{type:"text",value:_,onChange:a=>A(a.target.value),placeholder:"Digite: CONFIRMAR EXCLUSÃO",disabled:w,className:"w-full px-4 py-2 border border-slate-300 dark:border-slate-700 rounded-lg mb-6 bg-white dark:bg-slate-800 text-slate-900 dark:text-white focus:ring-2 focus:ring-red-500 focus:border-transparent disabled:opacity-50"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(y,{onClick:()=>{N(!1),A("")},disabled:w,variant:"outline",className:"flex-1",children:"Cancelar"}),e.jsx(y,{onClick:async()=>{if(_!=="CONFIRMAR EXCLUSÃO"){c({title:"Texto Incorreto",description:'Por favor, digite exatamente "CONFIRMAR EXCLUSÃO".',variant:"destructive"});return}S(!0);try{const{error:a}=await d.from("profiles").delete().eq("id",s.id);if(a)throw a;const{error:r}=await d.auth.admin.deleteUser(s.id);if(r){await l(),c({title:"Conta Desativada",description:"Sua conta foi desativada. Entre em contato com o suporte para conclusão."}),i("/login");return}await l(),c({title:"Conta Deletada",description:"Sua conta foi permanentemente deletada."}),i("/login")}catch(a){h.error("Erro ao deletar conta:",a),c({title:"Erro",description:"Não foi possível deletar a conta. Tente novamente.",variant:"destructive"}),S(!1)}},disabled:w||_!=="CONFIRMAR EXCLUSÃO",className:"flex-1 bg-red-600 hover:bg-red-700 text-white font-semibold",children:w?e.jsxs(e.Fragment,{children:[e.jsx("span",{className:"animate-spin mr-2",children:"⏳"}),"Deletando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Deletar Permanentemente"]})})]})]})})]})})]})};export{De as default};
