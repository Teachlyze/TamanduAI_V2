import{h as _,u as L,b as I,r,l as g,j as e,q as z}from"./main-CI5_MmIm.js";import{B as l}from"./button-D7H9d9Gd.js";import{D as B,g as v}from"./DashboardHeader-CYuk3ql1.js";import{S as j}from"./StatsCard-C6i8pjlS.js";import{E as $}from"./EmptyState-2SgC2yO6.js";import"./card-DpcnMbcE.js";import{S as P}from"./SearchInput-BxHdZR2H.js";import"./dropdown-menu-dTrFNQHD.js";import{C as U}from"./CopyButton-C3cXPyAl.js";import{D as q}from"./DataTable-C3EIdn3A.js";import"./input-BJMmyirp.js";import"./label-Nf4YzbUq.js";import{C as c}from"./classService-BCL3qFwZ.js";import{u as F}from"./use-toast-D7N2H9RC.js";import{A as G}from"./arrow-left-AtIy0G9L.js";import{U as C}from"./users-ChR7WEeh.js";import{M as Q}from"./mail-CRZAKwaM.js";import{U as S}from"./user-plus-B8uXpW-W.js";import{T as R}from"./trash-2-CwB_tbLS.js";import"./proxy-CT7Xtxle.js";import"./chevron-right-CHSrP1xQ.js";import"./search-C3Ws2_PV.js";import"./x-DGmYUGM5.js";import"./index-D4BuPd_i.js";import"./index-CRRraFTu.js";import"./index-CtvfaZbL.js";import"./index-DHrdJ99Z.js";import"./Combination-BfETjw1A.js";import"./SidebarPremium-0_wHXPj0.js";import"./house-B6Hparzo.js";import"./book-open-DlGI5eOy.js";import"./file-text-CtozP3gh.js";import"./graduation-cap-mPfDCRgT.js";import"./calendar-Dbm_7POQ.js";import"./chart-column-G5dLAdkQ.js";import"./message-circle-CRpVuYq9.js";import"./settings-BWUwUKXK.js";import"./brain-DVBX4Id_.js";import"./index-RHGs5twt.js";import"./index-jkBwDHc_.js";import"./check-GhIpAKm1.js";import"./copy-DoAVddfE.js";import"./badge-BOI6M_d9.js";import"./chevron-up-CrZ13wWo.js";import"./chevron-down-DXVEpPD6.js";const $e=()=>{const{classId:i}=_(),d=L(),{user:V}=I(),{toast:u}=F(),[p,f]=r.useState(!0),[n,y]=r.useState(null),[m,N]=r.useState([]),[h,x]=r.useState([]),[a,k]=r.useState(""),[A,M]=r.useState({totalStudents:0,activeStudents:0,inactiveStudents:0});r.useEffect(()=>{b()},[i]),r.useEffect(()=>{w()},[m,a]);const b=async()=>{try{f(!0);const s=await c.getClassById(i);y(s);const t=await c.getClassMembers(i,{role:"student"});N(t||[]);const o=t?.filter(D=>D.user?.role==="student").length||0;M({totalStudents:t?.length||0,activeStudents:o,inactiveStudents:0})}catch(s){g.error("Erro ao carregar membros:",s)}finally{f(!1)}},w=()=>{if(!a){x(m);return}const s=a.toLowerCase(),t=m.filter(o=>o.user?.name?.toLowerCase().includes(s)||o.user?.email?.toLowerCase().includes(s));x(t)},E=async(s,t)=>{if(confirm("Tem certeza que deseja remover este aluno da turma?"))try{await c.removeStudentsFromClass(i,[t]),await b(),u({title:"✅ Membro removido",description:"O usuário foi removido da turma."})}catch(o){g.error("Erro ao remover membro:",o),u({title:"❌ Erro ao remover",description:"Tente novamente.",variant:"destructive"})}},T=[{key:"name",label:"Aluno",sortable:!0,render:(s,t)=>e.jsxs("div",{className:"flex items-center gap-3",children:[t.user?.avatar_url?e.jsx("img",{src:t.user.avatar_url,alt:t.user.name,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-cyan-500 flex items-center justify-center text-white font-bold",children:t.user?.name?.[0]||"A"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-white",children:t.user?.name||"Sem nome"}),e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:t.user?.email||"Sem email"})]})]})},{key:"joined_at",label:"Data de Entrada",sortable:!0,type:"date"},{key:"actions",label:"Ações",align:"right",render:(s,t)=>e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>d(`/dashboard/students/${t.user_id}`),children:"Ver Perfil"}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>E(t.id,t.user_id),className:"text-red-600 hover:text-red-700 dark:text-red-400",children:e.jsx(R,{className:"w-4 h-4"})})]})}];return p?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(z,{size:"lg",text:"Carregando membros..."})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsxs(l,{variant:"ghost",onClick:()=>d(`/dashboard/classes/${i}`),className:"mb-4",children:[e.jsx(G,{className:"w-4 h-4 mr-2"}),"Voltar para Turma"]}),e.jsx(B,{title:`Membros - ${n?.name||"Turma"}`,subtitle:`Gerencie os alunos da turma ${n?.subject?`• ${n.subject}`:""}`,role:"teacher"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(j,{title:"Total de Alunos",value:A.totalStudents,icon:C,gradient:v.stats.students,bgColor:"bg-blue-50 dark:bg-blue-950/30",delay:0}),e.jsx(j,{title:"Código de Convite",value:n?.invite_code||"N/A",icon:Q,gradient:v.primary,bgColor:"bg-blue-50 dark:bg-blue-950/30",delay:.1,format:"text"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(U,{text:n?.invite_code||"",label:"Copiar Código",successMessage:"Copiado!"}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{},children:"Gerar Novo Código"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[e.jsx("div",{className:"flex-1",children:e.jsx(P,{placeholder:"Buscar por nome ou email...",value:a,onChange:k})}),e.jsxs(l,{className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Adicionar Aluno"]})]}),h.length>0?e.jsx(q,{columns:T,data:h,loading:p}):e.jsx($,{icon:C,title:a?"Nenhum aluno encontrado":"Nenhum aluno na turma",description:a?"Tente buscar por outro termo.":"Adicione alunos usando o código de convite ou convide-os manualmente.",actionLabel:"Adicionar Aluno",actionIcon:S,action:()=>{}})]})};export{$e as default};
