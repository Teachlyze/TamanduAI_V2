import{t as L,u as T,r as a,s as v,l as B,j as e,p as P}from"./main-DdaZa2uw.js";import{B as q}from"./button-C8tPcSnA.js";import{u as z}from"./use-toast-BHHozLsU.js";import{D as F,g as u}from"./DashboardHeader-CzmIe9wt.js";import{S as g}from"./StatsCard-Cz7qpUAY.js";import{E as V}from"./EmptyState-B6sTidYu.js";import"./card-B5qOXzCs.js";import{S as $}from"./SearchInput-DnXiRt_j.js";import"./dropdown-menu-BtcRZYAO.js";import{S as G}from"./SubmissionCard-CeEqBVZr.js";import"./input-1LHkCxOt.js";import"./label-C86gYWIM.js";import{A as I}from"./arrow-left-DCcxITxu.js";import{F as Q}from"./file-text-KG1EARAT.js";import{C as R}from"./circle-check-BV0uLsoL.js";import{C as H}from"./clock-BPO994B-.js";import{m as O}from"./proxy-cOiZ72Cz.js";import{C as J}from"./circle-alert-BEpCgrrb.js";import"./chevron-right-D-Gd8Ev0.js";import"./search-CRKSGVnM.js";import"./x-Dfn-8env.js";import"./SidebarPremium-DVCiHgHT.js";import"./house-BuCVh-jt.js";import"./users-CL6i5PZL.js";import"./book-open-BB96wzR_.js";import"./graduation-cap-BXMQrtzB.js";import"./calendar-BgLSegFA.js";import"./chart-column-fsDJzCSk.js";import"./message-circle-D6wHM5-f.js";import"./settings-Lxan3lFe.js";import"./index-Aqr4bB4c.js";import"./index-B7hVVF4G.js";import"./index-BbNaVbvl.js";import"./index-DljWCpXy.js";import"./index-Chp0GnAd.js";import"./check-D-al-kKT.js";import"./badge-BIkuT5Lr.js";const At=()=>{const{activityId:n}=L(),d=T(),{toast:S}=z(),[y,p]=a.useState(!0),[o,x]=a.useState(null),[l,C]=a.useState([]),[f,b]=a.useState([]),[s,j]=a.useState(""),[m,w]=a.useState({total:0,graded:0,pending:0});a.useEffect(()=>{_()},[n]),a.useEffect(()=>{k()},[l,s]);const _=async()=>{try{p(!0);const{data:t,error:i}=await v.from("activities").select("*").eq("id",n).single();if(i)throw i;x(t);const{data:r,error:h}=await v.from("submissions").select(`
          *,
          student:student_id(id, full_name, email, avatar_url)
        `).eq("activity_id",n).order("submitted_at",{ascending:!1});if(h)throw h;C(r||[]);const D=r?.filter(c=>c.status==="graded").length||0,A=r?.filter(c=>c.status==="pending").length||0;w({total:r?.length||0,graded:D,pending:A})}catch(t){B.error("Erro ao carregar submissões:",t),S({title:"Erro ao carregar submissões",description:t?.message||"Tente novamente.",variant:"destructive"})}finally{p(!1)}},k=()=>{if(!s){b(l);return}const t=s.toLowerCase(),i=l.filter(r=>r.student?.full_name?.toLowerCase().includes(t)||r.student?.email?.toLowerCase().includes(t));b(i)},E=t=>{d(`/dashboard/grading/${t.id}`)},N=t=>{d(`/dashboard/grading/${t.id}`)};return y?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(P,{size:"lg",text:"Carregando submissões..."})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsxs(q,{variant:"outline",onClick:()=>d(-1),className:"mb-4",children:[e.jsx(I,{className:"w-4 h-4 mr-2"}),"Voltar"]}),e.jsx(F,{title:o?.title||"Atividade",subtitle:`Submissões dos alunos • Prazo: ${o?.due_date?new Date(o.due_date).toLocaleDateString("pt-BR"):"Sem prazo"}`,role:"teacher"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(g,{title:"Total de Submissões",value:m.total,icon:Q,gradient:u.stats.activities,bgColor:"bg-blue-50 dark:bg-blue-950/30",delay:0}),e.jsx(g,{title:"Corrigidas",value:m.graded,icon:R,gradient:u.success,bgColor:"bg-green-50 dark:bg-green-950/30",delay:.1}),e.jsx(g,{title:"Pendentes",value:m.pending,icon:H,gradient:u.warning,bgColor:"bg-amber-50 dark:bg-amber-950/30",delay:.2})]}),e.jsx("div",{className:"mb-8",children:e.jsx($,{placeholder:"Buscar por nome ou email do aluno...",value:s,onChange:j})}),f.length>0?e.jsx(O.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map((t,i)=>e.jsx(G,{submission:{id:t.id,student:{name:t.student?.full_name||"Aluno",avatar:t.student?.avatar_url},activity:{title:o?.title},submittedAt:t.submitted_at,status:t.status||"pending",grade:t.grade,feedback:t.feedback,isLate:t.due_date&&new Date(t.submitted_at)>new Date(t.due_date)},onView:E,onGrade:N,delay:i*.05},t.id))}):e.jsx(V,{icon:J,title:s?"Nenhuma submissão encontrada":"Nenhuma submissão ainda",description:s?"Tente buscar por outro termo.":"Os alunos ainda não enviaram suas respostas para esta atividade."})]})};export{At as default};
