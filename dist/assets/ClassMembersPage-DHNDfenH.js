import{c as y,r as i,j as e,k as B,u as I,a as z,i as P}from"./main-B-DuDfC3.js";import{B as g,m as w}from"./card-D9y6cEbK.js";import{C as R,a as k,t as S,D as U,g as $}from"./dropdown-menu-S8hb-z0t.js";import{S as M,E as V}from"./EmptyState-D7T78sMN.js";import{S as H}from"./SearchInput-Bn2zNm8E.js";import{A as q}from"./index-DaQoYot5.js";import{B as F}from"./badge-D_5Pz7Pp.js";import{C as G}from"./chevron-down-3DbVtmBJ.js";import"./label-CQXNCxhD.js";import{C}from"./classService-v8xczc_x.js";import{A as Q}from"./arrow-left-br2hRIKT.js";import{U as _}from"./users-DREcB8-a.js";import{M as O}from"./mail-C8YKpjgr.js";import"./index-BvwGeBdQ.js";import"./chevron-right-BFR20X-e.js";import"./x-5mMV-IBm.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const J=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],W=y("chevron-up",J);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const X=[["path",{d:"m7 15 5 5 5-5",key:"1hf1tw"}],["path",{d:"m7 9 5-5 5 5",key:"sgt6xg"}]],Y=y("chevrons-up-down",X);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Z=[["rect",{width:"14",height:"14",x:"8",y:"8",rx:"2",ry:"2",key:"17jyea"}],["path",{d:"M4 16c-1.1 0-2-.9-2-2V4c0-1.1.9-2 2-2h10c1.1 0 2 .9 2 2",key:"zix9uf"}]],K=y("copy",Z);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ee=[["path",{d:"M10 11v6",key:"nco0om"}],["path",{d:"M14 11v6",key:"outv1u"}],["path",{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6",key:"miytrc"}],["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M8 6V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2",key:"e791ji"}]],te=y("trash-2",ee);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],A=y("user-plus",ae),se=({text:r,label:d="Copiar",successMessage:f="Copiado!",variant:u="outline",size:h="sm",onCopy:n})=>{const[p,l]=i.useState(!1),v=async()=>{try{await navigator.clipboard.writeText(r),l(!0),n&&n(r),setTimeout(()=>{l(!1)},2e3)}catch(x){console.error("Erro ao copiar:",x)}};return e.jsx(g,{variant:u,size:h,onClick:v,className:`whitespace-nowrap inline-flex items-center gap-2 ${p?"bg-green-50 dark:bg-green-950/30 border-green-300 dark:border-green-700 text-green-700 dark:text-green-300":""}`,children:e.jsx(q,{mode:"wait",children:p?e.jsxs(w.div,{initial:{scale:0,rotate:-180},animate:{scale:1,rotate:0},exit:{scale:0,rotate:180},transition:{duration:.2},className:"inline-flex items-center gap-2",children:[e.jsx(R,{className:"w-4 h-4"}),f]},"check"):e.jsxs(w.div,{initial:{scale:0},animate:{scale:1},exit:{scale:0},transition:{duration:.2},className:"inline-flex items-center gap-2",children:[e.jsx(K,{className:"w-4 h-4"}),d]},"copy")})})},re=({columns:r=[],data:d=[],onRowClick:f,sortBy:u=null,sortOrder:h="asc",onSort:n,loading:p=!1,emptyState:l=null})=>{const[v,x]=i.useState(null),j=t=>{if(!n||!r.find(s=>s.key===t)?.sortable)return;n(t,u===t&&h==="asc"?"desc":"asc")},m=(t,o)=>o?u!==t?e.jsx(Y,{className:"w-4 h-4 ml-2 opacity-40"}):h==="asc"?e.jsx(W,{className:"w-4 h-4 ml-2 text-blue-600 dark:text-blue-400"}):e.jsx(G,{className:"w-4 h-4 ml-2 text-blue-600 dark:text-blue-400"}):null,N=(t,o)=>{if(t.render)return t.render(o[t.key],o);const s=o[t.key];return t.type==="badge"?e.jsx(F,{className:t.getBadgeColor?.(s)||"",children:s}):t.type==="date"&&s?new Date(s).toLocaleDateString("pt-BR"):t.type==="number"?s?.toLocaleString("pt-BR")||"-":s||"-"};return p?e.jsxs("div",{className:"w-full p-12 text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto mb-4"}),e.jsx("p",{className:k.text.secondary,children:"Carregando..."})]}):d.length===0&&l?l:e.jsxs("div",{className:"w-full overflow-x-auto rounded-lg border border-slate-200 dark:border-slate-700",children:[e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-slate-50 dark:bg-slate-900 border-b border-slate-200 dark:border-slate-700",children:e.jsx("tr",{children:r.map(t=>e.jsx("th",{onClick:()=>j(t.key),className:`
                  px-6 py-4 text-left ${S.bodySmall} font-semibold ${k.text.primary}
                  ${t.sortable?"cursor-pointer hover:bg-slate-100 dark:hover:bg-slate-800 select-none":""}
                  ${t.width?`w-${t.width}`:""}
                `,children:e.jsxs("div",{className:"flex items-center",children:[t.label,m(t.key,t.sortable)]})},t.key))})}),e.jsx("tbody",{className:"divide-y divide-slate-200 dark:divide-slate-700",children:d.map((t,o)=>e.jsx("tr",{onClick:()=>f?.(t),onMouseEnter:()=>x(o),onMouseLeave:()=>x(null),className:`
                transition-colors
                ${f?"cursor-pointer":""}
                ${v===o?"bg-slate-50 dark:bg-slate-900":"bg-white dark:bg-slate-950"}
                hover:bg-slate-50 dark:hover:bg-slate-900
              `,children:r.map(s=>e.jsx("td",{className:`
                    px-6 py-4 ${S.bodySmall} ${k.text.primary}
                    ${s.align==="center"?"text-center":s.align==="right"?"text-right":"text-left"}
                  `,children:N(s,t)},s.key))},t.id||o))})]}),d.length===0&&!l&&e.jsx("div",{className:"p-12 text-center",children:e.jsx("p",{className:k.text.secondary,children:"Nenhum dado encontrado"})})]})},je=()=>{const{classId:r}=B(),d=I(),{user:f}=z(),[u,h]=i.useState(!0),[n,p]=i.useState(null),[l,v]=i.useState([]),[x,j]=i.useState([]),[m,N]=i.useState(""),[t,o]=i.useState({totalStudents:0,activeStudents:0,inactiveStudents:0});i.useEffect(()=>{s()},[r]),i.useEffect(()=>{D()},[l,m]);const s=async()=>{try{h(!0);const c=await C.getClassById(r);p(c);const a=await C.getClassMembers(r,{role:"student"});v(a||[]);const b=a?.filter(T=>T.user?.role==="student").length||0;o({totalStudents:a?.length||0,activeStudents:b,inactiveStudents:0})}catch(c){console.error("Erro ao carregar membros:",c)}finally{h(!1)}},D=()=>{if(!m){j(l);return}const c=m.toLowerCase(),a=l.filter(b=>b.user?.name?.toLowerCase().includes(c)||b.user?.email?.toLowerCase().includes(c));j(a)},E=async(c,a)=>{if(confirm("Tem certeza que deseja remover este aluno da turma?"))try{await C.removeStudentsFromClass(r,[a]),await s()}catch(b){console.error("Erro ao remover membro:",b),alert("Erro ao remover membro. Tente novamente.")}},L=[{key:"name",label:"Aluno",sortable:!0,render:(c,a)=>e.jsxs("div",{className:"flex items-center gap-3",children:[a.user?.avatar_url?e.jsx("img",{src:a.user.avatar_url,alt:a.user.name,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold",children:a.user?.name?.[0]||"A"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-white",children:a.user?.name||"Sem nome"}),e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:a.user?.email||"Sem email"})]})]})},{key:"joined_at",label:"Data de Entrada",sortable:!0,type:"date"},{key:"actions",label:"Ações",align:"right",render:(c,a)=>e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>d(`/teacher/students/${a.user_id}`),children:"Ver Perfil"}),e.jsx(g,{variant:"ghost",size:"sm",onClick:()=>E(a.id,a.user_id),className:"text-red-600 hover:text-red-700 dark:text-red-400",children:e.jsx(te,{className:"w-4 h-4"})})]})}];return u?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(P,{size:"lg",text:"Carregando membros..."})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsxs(g,{variant:"ghost",onClick:()=>d(`/teacher/classes/${r}`),className:"mb-4",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Voltar para Turma"]}),e.jsx(U,{title:`Membros - ${n?.name||"Turma"}`,subtitle:`Gerencie os alunos da turma ${n?.subject?`• ${n.subject}`:""}`,role:"teacher"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(M,{title:"Total de Alunos",value:t.totalStudents,icon:_,gradient:$.stats.students,bgColor:"bg-purple-50 dark:bg-purple-950/30",delay:0}),e.jsx(M,{title:"Código de Convite",value:n?.invite_code||"N/A",icon:O,gradient:$.primary,bgColor:"bg-blue-50 dark:bg-blue-950/30",delay:.1,format:"text"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(se,{text:n?.invite_code||"",label:"Copiar Código",successMessage:"Copiado!"}),e.jsx(g,{variant:"outline",size:"sm",onClick:()=>{},children:"Gerar Novo Código"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[e.jsx("div",{className:"flex-1",children:e.jsx(H,{placeholder:"Buscar por nome ou email...",value:m,onChange:N})}),e.jsxs(g,{className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white",children:[e.jsx(A,{className:"w-4 h-4 mr-2"}),"Adicionar Aluno"]})]}),x.length>0?e.jsx(re,{columns:L,data:x,loading:u}):e.jsx(V,{icon:_,title:m?"Nenhum aluno encontrado":"Nenhum aluno na turma",description:m?"Tente buscar por outro termo.":"Adicione alunos usando o código de convite ou convide-os manualmente.",actionLabel:"Adicionar Aluno",actionIcon:A,action:()=>{}})]})};export{je as default};
