import{l as P,u as $,r as s,s as j,j as e,k as q}from"./main-Cr4CeQqJ.js";import{B as G,m as Q}from"./button-VDnOzUX8.js";import{D as T,g}from"./dropdown-menu-W1Sf6eM2.js";import{S as p}from"./StatsCard-CEAHNeHe.js";import{E as V}from"./EmptyState-B0IxJOql.js";import"./card-CvoT5xff.js";import{S as z}from"./SearchInput-DsjTKZsh.js";import{F as H}from"./FilterBar-UvgSqinU.js";import{S as R}from"./SubmissionCard-B5aWmFQy.js";import"./input-DJYxsXYr.js";import"./label-Cj0ah_CE.js";import{C as J}from"./classService-Dl5Pj-lT.js";import{A as K}from"./arrow-left-CYQstS2d.js";import{C as f}from"./circle-check-DWdYCGZi.js";import{C as M}from"./clock-CJn97wdf.js";import"./index-Zvo5G3yJ.js";import"./chevron-right-D9YOEkTh.js";import"./check-BNbB6Qjw.js";import"./search-BPLrgJyl.js";import"./x-B5z18hzp.js";import"./badge-BpFoLbJI.js";import"./chevron-down-BuAwE9yu.js";import"./circle-alert-B-sotHTf.js";import"./calendar-BfYonUFO.js";import"./file-text-JP6gqb3e.js";const xt=()=>{const{classId:n}=P(),c=$(),[_,m]=s.useState(!0),[k,w]=s.useState(null),[v,h]=s.useState([]),[y,N]=s.useState([]),[o,x]=s.useState(""),[i,S]=s.useState({status:null,activityId:null}),[u,I]=s.useState({total:0,graded:0,pending:0}),[C,A]=s.useState([]);s.useEffect(()=>{F()},[n]),s.useEffect(()=>{E()},[v,o,i]);const F=async()=>{try{m(!0);const t=await J.getClassById(n);w(t);const{data:a}=await j.from("activity_class_assignments").select("activity:activities(id, title)").eq("class_id",n),r=a?.map(l=>l.activity).filter(Boolean)||[];A(r);const b=r.map(l=>l.id);if(b.length===0){h([]),m(!1);return}const{data:d}=await j.from("submissions").select(`
          *,
          student:profiles!submissions_user_id_fkey(id, name, email, avatar_url),
          activity:activities(id, title)
        `).in("activity_id",b).order("submitted_at",{ascending:!1});h(d||[]);const B=d?.filter(l=>l.status==="graded").length||0,D=d?.filter(l=>l.status==="pending").length||0;I({total:d?.length||0,graded:B,pending:D})}catch(t){console.error("Erro:",t)}finally{m(!1)}},E=()=>{let t=[...v];if(o){const a=o.toLowerCase();t=t.filter(r=>r.student?.name?.toLowerCase().includes(a)||r.activity?.title?.toLowerCase().includes(a))}i.status&&(t=t.filter(a=>a.status===i.status)),i.activityId&&(t=t.filter(a=>a.activity_id===i.activityId)),N(t)},L=(t,a)=>{S(r=>({...r,[t]:a}))};return _?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(q,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsxs(G,{variant:"ghost",onClick:()=>c(`/teacher/classes/${n}`),className:"mb-4",children:[e.jsx(K,{className:"w-4 h-4 mr-2"}),"Voltar"]}),e.jsx(T,{title:`Correções - ${k?.name||"Turma"}`,subtitle:"Submissões para corrigir",role:"teacher"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(p,{title:"Total de Submissões",value:u.total,icon:f,gradient:g.primary,delay:0}),e.jsx(p,{title:"Corrigidas",value:u.graded,icon:f,gradient:g.success,delay:.1}),e.jsx(p,{title:"Pendentes",value:u.pending,icon:M,gradient:g.warning,delay:.2})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[e.jsx("div",{className:"flex-1",children:e.jsx(z,{placeholder:"Buscar por aluno ou atividade...",value:o,onChange:x})}),e.jsx(H,{filters:[{key:"status",label:"Status",options:[{value:"pending",label:"Pendentes"},{value:"graded",label:"Corrigidas"}]},...C.length>0?[{key:"activityId",label:"Atividade",options:C.map(t=>({value:t.id,label:t.title}))}]:[]],activeFilters:i,onFilterChange:L,onClearAll:()=>{S({status:null,activityId:null}),x("")}})]}),y.length>0?e.jsx(Q.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:y.map((t,a)=>e.jsx(R,{submission:{id:t.id,student:{name:t.student?.name,avatar:t.student?.avatar_url},activity:{title:t.activity?.title},submittedAt:t.submitted_at,status:t.status,grade:t.grade,feedback:t.feedback},onView:()=>c(`/teacher/grading/${t.id}`),onGrade:()=>c(`/teacher/grading/${t.id}`),delay:a*.05},t.id))}):e.jsx(V,{icon:f,title:o||i.status?"Nenhuma submissão encontrada":"Nenhuma submissão nesta turma",description:o||i.status?"Ajuste os filtros.":"Aguardando submissões dos alunos."})]})};export{xt as default};
