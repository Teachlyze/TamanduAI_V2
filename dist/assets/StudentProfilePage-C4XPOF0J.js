import{a as u,r as p,j as e,s as l,l as d}from"./main-XXuEaTDd.js";import{C as f}from"./card-BmX5EBcq.js";import{I as m}from"./input-BsdcwXwo.js";import{B as h}from"./button-CnByYIhr.js";import{D as x}from"./DashboardHeader-BrNcgIGw.js";import"./dropdown-menu-EPJY_Fdk.js";import"./label-BTofGEwk.js";import{u as b}from"./use-toast-nLXEkatJ.js";import"./SidebarPremium-eC0udO90.js";import"./message-circle-Bnfe4kSM.js";import"./book-open-C2-Re7kr.js";import"./trending-up-B04abNi1.js";import"./user-DGN0W0vL.js";import"./settings-BoPgazzK.js";import"./index-DlVMVqW0.js";import"./house-Cqu6JObC.js";import"./users-DHSoS6td.js";import"./graduation-cap-CrHOTf4P.js";import"./calendar-Dh85b9lX.js";import"./chart-column-B4DM1V4B.js";import"./index-BgsUcMRO.js";import"./chevron-right-DahHX28a.js";import"./x-rANpGSmW.js";import"./index-BUvRw9fk.js";import"./index-eRwsCZ6_.js";import"./index-DCGojTwo.js";import"./index-D_6pv9Jf.js";import"./check-0NoJAfkQ.js";const O=()=>{const{user:a}=u(),[r,s]=p.useState({name:"",email:"",phone:""}),{toast:n}=b();p.useEffect(()=>{(async()=>{if(a?.id)try{const{data:o,error:i}=await l.from("profiles").select("full_name, email").eq("id",a.id).single();if(i&&i.code!=="PGRST116")throw i;s({name:o?.full_name||a.user_metadata?.name||"",email:o?.email||a.email||"",phone:a.user_metadata?.phone||""})}catch(o){d.warn("Falha ao carregar perfil:",o),s({name:a.user_metadata?.name||"",email:a.email||"",phone:a.user_metadata?.phone||""})}})()},[a]);const c=async()=>{try{if(!a?.id)return;const{error:t}=await l.from("profiles").upsert({id:a.id,full_name:r.name,email:r.email},{onConflict:"id"});if(t)throw t;const{error:o}=await l.auth.updateUser({data:{name:r.name,phone:r.phone}});if(o)throw o;n({title:"Perfil atualizado",description:"Suas informações foram salvas com sucesso."})}catch(t){d.error("Erro:",t),n({variant:"destructive",title:"Erro ao salvar",description:"Não foi possível atualizar seu perfil."})}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsx(x,{title:"Meu Perfil",subtitle:"Gerencie suas informações",role:"student"}),e.jsx(f,{className:"p-6 bg-white dark:bg-slate-900 max-w-2xl mx-auto",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold mb-2 block",children:"Nome"}),e.jsx(m,{value:r.name,onChange:t=>s({...r,name:t.target.value}),placeholder:"Seu nome"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold mb-2 block",children:"Email"}),e.jsx(m,{value:r.email,disabled:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-semibold mb-2 block",children:"Telefone"}),e.jsx(m,{value:r.phone,onChange:t=>s({...r,phone:t.target.value}),placeholder:"(00) 00000-0000"})]}),e.jsx(h,{onClick:c,className:"w-full bg-gradient-to-r from-blue-600 to-cyan-600",children:"Salvar Alterações"})]})})]})};export{O as default};
