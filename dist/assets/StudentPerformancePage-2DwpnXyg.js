import{s as f,a as Q,r as S,j as t,k as K}from"./main-PnoWv5mu.js";import{C as E}from"./card-DNyDBtwZ.js";import{A as V,B as D}from"./SidebarPremium-DbDmcmQG.js";import{m as T,B as W}from"./button-B1az96ai.js";import{P as Y}from"./progress-C-Hqao8P.js";import{S as R}from"./StatsCard-rzGomFX8.js";import"./input-BGWMq9XA.js";import"./dropdown-menu-BDAIvG1Q.js";import"./label-DSOeyQ5r.js";import{t as z}from"./use-toast-VMwxor12.js";import{T as L}from"./target-Cbkey8_6.js";import{B as X}from"./book-open-BN8GTFXN.js";import{C as H}from"./chart-column-Ba9dXnEb.js";import{T as Z}from"./trending-up-BnoBnv7_.js";import{R as ee,C as te,X as se,Y as ae,T as re}from"./CartesianChart-Cr81OV8k.js";import{L as ne,a as ie}from"./LineChart-C8Ed1Af7.js";import{U as oe}from"./users-CZvcSbj_.js";import{L as ce}from"./lightbulb-7OgEO99C.js";import{T as le}from"./triangle-alert-CQ0YCHAm.js";import{T as de}from"./trending-down-Cu0dHZWp.js";import{T as me}from"./trophy-jP6CMKfo.js";import{S as F}from"./sparkles-D96F1LDE.js";import"./bell-jlu-i0nu.js";import"./user-IPdw0V9z.js";import"./file-text-WNEYLkuB.js";import"./settings-BAc4VZJo.js";import"./graduation-cap-BTPeK0uK.js";import"./index-DvZMkTcl.js";import"./x-7WqOwCJm.js";import"./index-CWQpaRb1.js";import"./tokens-BPdvztvj.js";import"./chevron-right-5LVKKztM.js";import"./check-8UqrO2_7.js";const ue=async(o,a)=>{try{const{data:i,error:s}=await f.from("submissions").select(`
        grade,
        submitted_at,
        activities!inner(class_id)
      `).eq("student_id",o).eq("activities.class_id",a).not("grade","is",null).order("submitted_at",{ascending:!0});if(s)throw s;if(!i||i.length<3)return{prediction:null,confidence:0,trend:"insufficient_data",message:"Mínimo 3 atividades necessárias"};const e=i.map(b=>parseFloat(b.grade)),r=e.length,c=e.slice(-5),d=c.reduce((b,w)=>b+w,0)/c.length,u=e.reduce((b,w)=>b+w,0)/r,m=d>u+5?"improving":d<u-5?"declining":"stable",x=[.1,.15,.2,.25,.3];let _=0;const g=e.slice(-5);for(let b=0;b<g.length;b++)_+=g[b]*(x[b]||.2);const h=e.reduce((b,w)=>b+Math.pow(w-u,2),0)/r,N=Math.sqrt(h),y=Math.max(0,Math.min(100,100-N*2));return{prediction:Math.round(_*10)/10,confidence:Math.round(y),trend:m,avgRecent:Math.round(d*10)/10,avgTotal:Math.round(u*10)/10,totalSubmissions:r,message:m==="improving"?"Aluno em evolução!":m==="declining"?"Atenção: queda de desempenho":"Desempenho estável"}}catch(i){return console.error("Erro ao prever desempenho:",i),null}},ge=async o=>{try{const{data:a,error:i}=await f.from("class_members").select(`
        user_id,
        role,
        profiles:user_id(full_name, email)
      `).eq("class_id",o).eq("role","student");if(i)throw i;const s=[];for(const e of a){const{data:r}=await f.from("submissions").select("grade, submitted_at, status").eq("student_id",e.user_id).order("submitted_at",{ascending:!1}).limit(10);if(!r||r.length===0)continue;const c=r.filter(y=>y.grade!==null).map(y=>parseFloat(y.grade));if(c.length===0)continue;const d=c.reduce((y,b)=>y+b,0)/c.length,u=c.slice(0,3),m=u.reduce((y,b)=>y+b,0)/u.length,x=d<60,_=m<d-10,g=Math.max(...c)-Math.min(...c)>40;let h=0;const N=[];x&&(h+=3,N.push("Média baixa")),_&&(h+=2,N.push("Queda recente")),g&&(h+=1,N.push("Inconsistente")),h>0&&s.push({studentId:e.user_id,name:e.profiles?.full_name,email:e.profiles?.email,avgGrade:Math.round(d*10)/10,avgRecent:Math.round(m*10)/10,riskLevel:h>=4?"high":h>=2?"medium":"low",reasons:N,totalSubmissions:r.length})}return s.sort((e,r)=>{const c={high:3,medium:2,low:1};return c[r.riskLevel]-c[e.riskLevel]})}catch(a){return console.error("Erro ao identificar alunos em risco:",a),[]}},he=async o=>{try{const{data:a}=await f.from("class_members").select(`
        student_id,
        profiles!inner(full_name)
      `).eq("class_id",o);if(!a||a.length<3)return{clusters:[],message:"Mínimo 3 alunos necessários"};const i=[];for(const e of a){const{data:r}=await f.from("submissions").select("grade, submitted_at").eq("student_id",e.student_id).not("grade","is",null);if(!r||r.length===0)continue;const c=r.map(m=>parseFloat(m.grade)),d=c.reduce((m,x)=>m+x,0)/c.length,u=c.reduce((m,x)=>m+Math.pow(x-d,2),0)/c.length;i.push({studentId:e.student_id,name:e.profiles.full_name,avgGrade:d,consistency:100-Math.sqrt(u),totalSubmissions:r.length})}const s={excelente:i.filter(e=>e.avgGrade>=85),bom:i.filter(e=>e.avgGrade>=70&&e.avgGrade<85),regular:i.filter(e=>e.avgGrade>=60&&e.avgGrade<70),atencao:i.filter(e=>e.avgGrade<60)};return{clusters:[{name:"Excelente",color:"green",students:s.excelente,avgGrade:s.excelente.length>0?Math.round(s.excelente.reduce((e,r)=>e+r.avgGrade,0)/s.excelente.length*10)/10:0,count:s.excelente.length},{name:"Bom",color:"blue",students:s.bom,avgGrade:s.bom.length>0?Math.round(s.bom.reduce((e,r)=>e+r.avgGrade,0)/s.bom.length*10)/10:0,count:s.bom.length},{name:"Regular",color:"yellow",students:s.regular,avgGrade:s.regular.length>0?Math.round(s.regular.reduce((e,r)=>e+r.avgGrade,0)/s.regular.length*10)/10:0,count:s.regular.length},{name:"Atenção",color:"red",students:s.atencao,avgGrade:s.atencao.length>0?Math.round(s.atencao.reduce((e,r)=>e+r.avgGrade,0)/s.atencao.length*10)/10:0,count:s.atencao.length}],totalStudents:i.length}}catch(a){return console.error("Erro ao clusterizar alunos:",a),{clusters:[],message:"Erro ao processar"}}},pe=o=>{if(!o)return{score:0,label:"neutral"};const a=o.toLowerCase(),i=["ruim","difícil","complicado","confuso","péssimo","horrível","não entendi","muito difícil","impossível","frustrado"],s=["bom","ótimo","excelente","legal","entendi","fácil","claro","adorei","perfeito","incrível"];let e=0;return i.forEach(r=>{a.includes(r)&&(e-=1)}),s.forEach(r=>{a.includes(r)&&(e+=1)}),{score:e,label:e<-1?"negative":e>1?"positive":"neutral",needsAttention:e<-1}},fe=async(o,a)=>{try{const{data:i}=await f.from("submissions").select(`
        grade,
        activities!inner(
          title,
          activity_type,
          class_id
        )
      `).eq("student_id",o).eq("activities.class_id",a).not("grade","is",null);if(!i||i.length<3)return{recommendations:[],message:"Mais atividades necessárias para recomendações"};const s=i.filter(c=>parseFloat(c.grade)<70).map(c=>c.activities),e=[];return s.length>0&&e.push({type:"review",priority:"high",title:"Revisão Necessária",description:`Revisar conceitos de ${s.length} atividade(s) com baixo desempenho`,activities:s.slice(0,3)}),i.filter(c=>c.activities.activity_type==="quiz").length<3&&e.push({type:"practice",priority:"medium",title:"Prática com Quizzes",description:"Fazer mais quizzes para fixar conteúdo",suggestion:"Banco de Questões disponível"}),{recommendations:e,totalAnalyzed:i.length,weakAreas:s.length}}catch(i){return console.error("Erro ao gerar recomendações:",i),{recommendations:[],message:"Erro ao processar"}}},xe=async o=>{try{const{data:a}=await f.from("class_members").select(`
        student_id,
        joined_at,
        profiles!inner(full_name, email)
      `).eq("class_id",o);if(!a)return[];const i=[],s=new Date;for(const e of a){const{data:r}=await f.from("submissions").select("submitted_at").eq("student_id",e.student_id).order("submitted_at",{ascending:!1}).limit(1).single();if(!r){i.push({studentId:e.student_id,name:e.profiles.full_name,email:e.profiles.email,riskLevel:"high",reason:"Nenhuma atividade realizada",daysSinceActivity:Math.floor((s-new Date(e.joined_at))/(1e3*60*60*24))});continue}const c=Math.floor((s-new Date(r.submitted_at))/(1e3*60*60*24));c>14&&i.push({studentId:e.student_id,name:e.profiles.full_name,email:e.profiles.email,riskLevel:c>30?"high":"medium",reason:`${c} dias sem atividade`,daysSinceActivity:c})}return i.sort((e,r)=>r.daysSinceActivity-e.daysSinceActivity)}catch(a){return console.error("Erro ao prever churn:",a),[]}},I=async o=>{try{const{data:a}=await f.from("submissions").select(`
        grade,
        submitted_at,
        student_id,
        activities!inner(class_id, activity_type)
      `).eq("activities.class_id",o).not("grade","is",null);if(!a||a.length===0)return null;const{data:i}=await f.from("xp_log").select("amount, source, student_id, created_at").in("student_id",[...new Set(a.map(n=>n.student_id))]),s=a.map(n=>parseFloat(n.grade)),e=s.reduce((n,p)=>n+p,0)/s.length,r=s.reduce((n,p)=>n+Math.pow(p-e,2),0)/s.length,c=Math.sqrt(r),d=i?.reduce((n,p)=>n+p.amount,0)||0,u={};i?.forEach(n=>{u[n.source]=(u[n.source]||0)+n.amount});const m=new Date,x=new Date(m.getTime()-672*60*60*1e3),g=a.filter(n=>new Date(n.submitted_at)>x).map(n=>parseFloat(n.grade)),h=g.length>0?g.reduce((n,p)=>n+p,0)/g.length:e,N=h>e+3?"improving":h<e-3?"declining":"stable",y=Math.min(5,d/1e3),b=e*.9+y*.1,w={"0-49":0,"50-69":0,"70-84":0,"85-100":0};s.forEach(n=>{const p=Math.round(n);p<=49?w["0-49"]++:p<=69?w["50-69"]++:p<=84?w["70-84"]++:w["85-100"]++});const G=a.slice().sort((n,p)=>new Date(n.submitted_at)-new Date(p.submitted_at));let q=0,M=0;for(let n=1;n<G.length;n++){const p=(new Date(G[n].submitted_at)-new Date(G[n-1].submitted_at))/864e5;isFinite(p)&&p>=0&&(q+=p,M++)}const $=M>0?Math.round(q/M*10)/10:null,k={};a.forEach(n=>{k[n.student_id]=(k[n.student_id]||0)+1});const l=Object.keys(k).length>0?Math.round(Object.values(k).reduce((n,p)=>n+p,0)/Object.keys(k).length*10)/10:0;return{avgGrade:Math.round(e*10)/10,adjustedAvg:Math.round(b*10)/10,stdDev:Math.round(c*10)/10,trend:N,totalSubmissions:a.length,totalStudents:new Set(a.map(n=>n.student_id)).size,totalXP:d,xpSources:u,gradeBuckets:w,avgDaysBetweenSubmissions:$,submissionsPerStudentAvg:l,consistency:c<15?"high":c<25?"medium":"low",engagement:d>5e3?"high":d>2e3?"medium":"low"}}catch(a){return console.error("Erro ao analisar turma:",a),null}},U=async o=>{try{const{data:a}=await f.from("classes").select("id, name").eq("created_by",o);if(!a||a.length===0)return null;const i=[];let s=0,e=0,r=0,c=0,d=0;for(const m of a){const x=await I(m.id);x&&(i.push({classId:m.id,className:m.name,...x}),s+=x.totalStudents,r+=x.totalSubmissions,c+=x.totalXP,d+=x.avgGrade);const{count:_}=await f.from("activities").select("*",{count:"exact",head:!0}).eq("class_id",m.id);e+=_||0}const u=i.length>0?d/i.length:0;return{teacherId:o,totalClasses:a.length,totalStudents:s,totalActivities:e,totalSubmissions:r,totalXP:c,avgGrade:Math.round(u*10)/10,classAnalyses:i,engagementScore:c/s||0,activityRate:e/a.length||0}}catch(a){return console.error("Erro ao analisar professor:",a),null}},be=async o=>{try{const{data:a}=await f.from("school_teachers").select("user_id, status").eq("school_id",o).eq("status","active");if(!a||a.length===0)return[];const i=a.map(e=>e.user_id),s=[];for(const e of i){const{data:r}=await f.from("profiles").select("name").eq("id",e).single(),c=await U(e);c&&r&&s.push({teacherId:e,name:r.name,...c})}return s.sort((e,r)=>r.avgGrade-e.avgGrade)}catch(a){return console.error("Erro ao comparar professores:",a),[]}},ve=async o=>{try{const{data:a}=await f.from("school_classes").select("class_id").eq("school_id",o),i=(a||[]).map(d=>d.class_id);if(!i||i.length===0)return[];const{data:s}=await f.from("classes").select("id, name, created_by").in("id",i),e=[...new Set((s||[]).map(d=>d.created_by).filter(Boolean))];let r={};if(e.length>0){const{data:d}=await f.from("profiles").select("id, name").in("id",e);r=(d||[]).reduce((u,m)=>(u[m.id]=m.name,u),{})}const c=[];for(const d of s||[]){const u=await I(d.id);u&&c.push({classId:d.id,className:d.name,teacherName:r[d.created_by]||"Professor",...u})}return c.sort((d,u)=>u.avgGrade-d.avgGrade)}catch(a){return console.error("Erro ao comparar turmas:",a),[]}},ye=async(o,a="student")=>{try{const{data:{user:i}}=await f.auth.getUser();if(!i)throw new Error("Não autenticado");let s="";if(a==="student")s=`Analise este aluno e forneça insights educacionais:
      
Dados:
- Média: ${o.avgGrade}
- Tendência: ${o.trend}
- Total XP: ${o.totalXP||0}
- Submissões: ${o.totalSubmissions}
- Consistência: ${o.consistency||"N/A"}
 - Observação: XP tem peso menor (10%) em análises de desempenho.

Forneça em JSON:
{
  "strengths": ["força 1", "força 2"],
  "weaknesses": ["fraqueza 1", "fraqueza 2"],
  "recommendations": ["recomendação 1", "recomendação 2"],
  "motivationalMessage": "mensagem motivacional"
}`;else if(a==="class")s=`Analise esta turma e forneça insights educacionais:
      
Dados:
- Média: ${o.avgGrade}
- Desvio Padrão: ${o.stdDev}
- Tendência: ${o.trend}
- Total XP: ${o.totalXP}
- Alunos: ${o.totalStudents}
- Engajamento: ${o.engagement}
 - Fontes de XP (top 5): ${JSON.stringify(o.xpSources||{})}
 - Observação: XP tem peso reduzido (10%) para média ajustada.
 - Distribuição de notas: ${JSON.stringify(o.gradeBuckets||{})}
 - Dias médios entre submissões: ${o.avgDaysBetweenSubmissions??"N/D"}
 - Submissões por aluno (média): ${o.submissionsPerStudentAvg??"N/D"}

Forneça em JSON:
{
  "strengths": ["força 1", "força 2"],
  "concerns": ["preocupação 1", "preocupação 2"],
  "recommendations": ["recomendação 1", "recomendação 2"],
  "teachingTips": ["dica 1", "dica 2"]
}`;else if(a==="teacher"){const d=o.totalClasses??(o.classAnalyses?.length||0),u=(o.classAnalyses||[]).reduce((g,h)=>(g[h.trend||"stable"]=(g[h.trend||"stable"]||0)+1,g),{}),m=(o.classAnalyses||[]).slice().sort((g,h)=>(h.avgGrade||0)-(g.avgGrade||0))[0]||null,x=(o.classAnalyses||[]).slice().sort((g,h)=>(g.avgGrade||0)-(h.avgGrade||0))[0]||null,_=(o.classAnalyses||[]).reduce((g,h)=>{const N=h.xpSources||{};return Object.keys(N).forEach(y=>{g[y]=(g[y]||0)+N[y]}),g},{});s=`Analise este professor e forneça insights:
      
Dados:
- Turmas: ${o.totalClasses}
- Alunos: ${o.totalStudents}
- Média Geral: ${o.avgGrade}
- Total XP gerado: ${o.totalXP}
- Taxa de atividades: ${o.activityRate}
 - Tendências por turma: ${JSON.stringify(u)}
 - Turma com melhor desempenho: ${m?`${m.className} (média ${m.avgGrade}, engajamento ${m.engagement})`:"N/D"}
 - Turma com pior desempenho: ${x?`${x.className} (média ${x.avgGrade}, engajamento ${x.engagement})`:"N/D"}
 - Fontes de XP agregadas (top 5): ${JSON.stringify(Object.fromEntries(Object.entries(_).sort((g,h)=>h[1]-g[1]).slice(0,5)))}
 - Observação: XP influencia apenas 10% da média ajustada.

Forneça em JSON:
{
  "strengths": ["força 1", "força 2"],
  "improvements": ["melhoria 1", "melhoria 2"],
  "recommendations": ["recomendação 1", "recomendação 2"],
  "recognition": "mensagem de reconhecimento"
}`}const{data:e,error:r}=await f.functions.invoke("openai-chat",{body:{messages:[{role:"system",content:"Você é um especialista em análise educacional. Responda APENAS em JSON válido."},{role:"user",content:s}],temperature:.7}});if(r)throw r;const c=e.choices?.[0]?.message?.content||"{}";return JSON.parse(c)}catch(i){return console.error("Erro ao gerar insights AI:",i),null}},je=async o=>{try{const{data:a}=await f.from("submissions").select("grade, activity:activities(title, type)").eq("student_id",o).not("grade","is",null).order("submitted_at",{ascending:!1}).limit(10);if(!a||a.length===0)return[];const i=a.reduce((e,r)=>e+r.grade,0)/a.length,s=[];return i<6?(s.push({text:"Revise os conceitos fundamentais da disciplina",icon:"BookOpen"}),s.push({text:"Procure ajuda do professor ou monitoria",icon:"Users"})):i<7.5?(s.push({text:"Pratique mais exercícios para fixar o conteúdo",icon:"Target"}),s.push({text:"Faça resumos dos tópicos principais",icon:"FileText"})):(s.push({text:"Continue seu excelente trabalho!",icon:"Trophy"}),s.push({text:"Ajude colegas que têm dificuldades",icon:"Users"})),s}catch(a){return console.error("Erro ao obter sugestões:",a),[{text:"Continue praticando regularmente",icon:"Target"},{text:"Revise conceitos fundamentais",icon:"BookOpen"}]}},we=async o=>{try{const{data:a}=await f.from("submissions").select(`
        grade,
        activity:activities(
          title,
          activity_class_assignments(
            class:classes(name, subject)
          )
        )
      `).eq("student_id",o).not("grade","is",null);if(!a||a.length===0)return[];const i={};a.forEach(e=>{const r=e.activity?.activity_class_assignments?.[0]?.class?.subject||"Geral";i[r]||(i[r]=[]),i[r].push(e.grade)});const s=[];return Object.entries(i).forEach(([e,r])=>{const c=r.reduce((d,u)=>d+u,0)/r.length;c<7&&s.push({subject:e,title:e,description:`Média atual: ${c.toFixed(1)}. Foque mais nesta disciplina.`,avgGrade:c})}),s}catch(a){return console.error("Erro ao identificar áreas de atenção:",a),[]}},J={predictPerformance:ue,identifyAtRiskStudents:ge,clusterStudents:he,analyzeSentiment:pe,generateRecommendations:fe,predictChurn:xe,analyzeClassPerformance:I,analyzeTeacherPerformance:U,compareTeachers:be,compareClasses:ve,generateAIInsights:ye,getStudentGradeBuckets:Ne,getStudySuggestions:je,getAttentionAreas:we};async function Ne(o,a){try{const{data:i,error:s}=await f.from("submissions").select("grade, activities!inner(class_id)").eq("student_id",o).eq("activities.class_id",a).not("grade","is",null);if(s)throw s;const e={"0-49":0,"50-69":0,"70-84":0,"85-100":0};return(i||[]).forEach(r=>{const c=Math.round(parseFloat(r.grade));c<=49?e["0-49"]++:c<=69?e["50-69"]++:c<=84?e["70-84"]++:e["85-100"]++}),e}catch(i){return console.error("Erro ao calcular buckets do aluno:",i),{"0-49":0,"50-69":0,"70-84":0,"85-100":0}}}const at=()=>{const{user:o}=Q(),[a,i]=S.useState(!0),[s,e]=S.useState(!1),[r,c]=S.useState({avgGrade:0,totalActivities:0,completionRate:0}),[d,u]=S.useState([]),[m,x]=S.useState([]),[_,g]=S.useState([]),[h,N]=S.useState([]),[y,b]=S.useState([]),[w,G]=S.useState(null);S.useEffect(()=>{o?.id?(q(),$()):i(!1)},[o]);const q=async()=>{if(!o?.id){i(!1);return}try{i(!0);const{data:l}=await f.from("submissions").select(`
          grade,
          submitted_at,
          graded_at,
          activity:activities(
            id,
            title,
            max_score,
            activity_class_assignments(
              class_id,
              class:classes(id, name, subject)
            )
          )
        `).eq("student_id",o.id).not("grade","is",null).order("submitted_at",{ascending:!0}),n=l?.filter(j=>j.grade!==null)||[],p=n.length>0?n.reduce((j,A)=>j+A.grade,0)/n.length:0;c({avgGrade:p.toFixed(1),totalActivities:l?.length||0,completionRate:85});const v=n.slice(-10).map((j,A)=>({name:`A${A+1}`,nota:Number(j.grade.toFixed(1)),date:j.submitted_at}));u(v),await M(l),G(l)}catch(l){console.error("Erro:",l)}finally{i(!1)}},M=async l=>{try{const n={};l.forEach(v=>{const j=v.activity?.activity_class_assignments?.[0]?.class;j&&(n[j.id]||(n[j.id]={classId:j.id,className:j.name,subject:j.subject,studentGrades:[],activityIds:[]}),n[j.id].studentGrades.push(v.grade),n[j.id].activityIds.push(v.activity.id))});const p=await Promise.all(Object.values(n).map(async v=>{const{data:j}=await f.from("submissions").select("grade, activity_id").in("activity_id",v.activityIds).not("grade","is",null),A=j?.map(C=>C.grade)||[],O=A.length>0?A.reduce((C,P)=>C+P,0)/A.length:0,B=v.studentGrades.reduce((C,P)=>C+P,0)/v.studentGrades.length;return{className:v.className,subject:v.subject,studentAvg:Number(B.toFixed(1)),classAvg:Number(O.toFixed(1)),difference:Number((B-O).toFixed(1))}}));x(p)}catch(n){console.error("Erro ao calcular comparação:",n)}},$=async()=>{try{const l=await J.getStudySuggestions(o.id),n=await J.getAttentionAreas(o.id);g(l||[]),N(n||[])}catch(l){console.error("Analytics ML não disponível:",l),g([{text:"Continue praticando regularmente",icon:L},{text:"Revise conceitos fundamentais",icon:X}])}},k=async()=>{if(!w||w.length===0){z({title:"Sem dados suficientes",description:"Complete mais atividades para receber recomendações personalizadas.",variant:"destructive"});return}try{e(!0);const l={avgGrade:r.avgGrade,totalActivities:r.totalActivities,recentGrades:w.slice(-5).map(v=>({grade:v.grade,maxScore:v.activity?.max_score,subject:v.activity?.activity_class_assignments?.[0]?.class?.subject})),classComparison:m.map(v=>({subject:v.subject,studentAvg:v.studentAvg,classAvg:v.classAvg}))},n=await fetch("/api/ai-study-recommendations",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${o.access_token}`},body:JSON.stringify({studentId:o.id,performanceData:l})});if(!n.ok)throw new Error("Falha ao obter recomendações");const p=await n.json();b(p.recommendations||[]),z({title:"Recomendações atualizadas!",description:"Confira suas sugestões personalizadas de estudo."})}catch(l){console.error("Erro ao carregar recomendações:",l),z({title:"Erro ao carregar recomendações",description:"Tente novamente mais tarde.",variant:"destructive"})}finally{e(!1)}};return a?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx(K,{size:"lg"})}):t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-sky-50 to-slate-200 dark:from-slate-950 dark:via-slate-900 dark:to-slate-950 p-6",children:[t.jsxs("div",{className:"relative mb-6 overflow-hidden rounded-2xl bg-gradient-to-r from-blue-600 to-cyan-500 p-8 text-white shadow-lg",children:[t.jsx("div",{className:"absolute inset-0 bg-grid-white/[0.05] bg-[size:20px_20px]"}),t.jsxs(T.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative z-10",children:[t.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Meu Desempenho"}),t.jsx("p",{className:"text-cyan-100",children:"Análise completa com IA e comparação com a turma"})]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[t.jsx(R,{title:"Média Geral",value:r.avgGrade,icon:H,gradient:"from-blue-500 to-cyan-600",delay:0}),t.jsx(R,{title:"Atividades Concluídas",value:r.totalActivities,icon:V,gradient:"from-cyan-500 to-blue-700",delay:.1}),t.jsx(R,{title:"Taxa de Conclusão",value:`${r.completionRate}%`,icon:Z,gradient:"from-emerald-500 to-cyan-500",format:"text",delay:.2})]}),t.jsxs(E,{className:"p-6 bg-white dark:bg-slate-900 mb-6 border border-slate-200 dark:border-slate-800",children:[t.jsx("h3",{className:"font-bold text-lg mb-4 text-slate-900 dark:text-white",children:"Evolução de Notas"}),t.jsx(ee,{width:"100%",height:300,children:t.jsxs(ne,{data:d,children:[t.jsx(te,{strokeDasharray:"3 3"}),t.jsx(se,{dataKey:"name"}),t.jsx(ae,{domain:[0,10]}),t.jsx(re,{}),t.jsx(ie,{type:"monotone",dataKey:"nota",stroke:"#3B82F6",strokeWidth:2})]})})]}),m.length>0&&t.jsxs(E,{className:"p-6 bg-white dark:bg-slate-900 mb-6 border border-slate-200 dark:border-slate-800",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(oe,{className:"w-5 h-5 text-blue-600"}),t.jsx("h3",{className:"font-bold text-lg text-slate-900 dark:text-white",children:"Comparação com a Turma"})]}),t.jsx(D,{variant:"secondary",className:"text-xs",children:"Dados anônimos"})]}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:"Veja como você está em relação à média da turma"}),t.jsx("div",{className:"space-y-4",children:m.map((l,n)=>t.jsxs(T.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},transition:{delay:n*.1},className:"p-4 rounded-lg border border-slate-200 dark:border-slate-800 bg-slate-50 dark:bg-slate-900/50",children:[t.jsxs("div",{className:"flex items-center justify-between mb-2",children:[t.jsxs("div",{children:[t.jsx("h4",{className:"font-semibold text-slate-900 dark:text-white",children:l.className}),t.jsx("p",{className:"text-xs text-slate-500",children:l.subject})]}),t.jsxs(D,{className:l.difference>0?"bg-green-100 text-green-700 dark:bg-green-900/40 dark:text-green-300":l.difference<0?"bg-red-100 text-red-700 dark:bg-red-900/40 dark:text-red-300":"bg-slate-100 text-slate-700",children:[l.difference>0?"+":"",l.difference]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-4 mt-3",children:[t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Sua média"}),t.jsx("p",{className:"text-2xl font-bold text-blue-600",children:l.studentAvg})]}),t.jsxs("div",{children:[t.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Média da turma"}),t.jsx("p",{className:"text-2xl font-bold text-slate-600 dark:text-slate-400",children:l.classAvg})]})]}),t.jsx(Y,{value:l.studentAvg/10*100,className:"h-2 mt-3"})]},n))})]}),t.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[t.jsxs(E,{className:"p-6 bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-950/20 dark:to-cyan-950/20 border border-blue-200 dark:border-blue-800",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(ce,{className:"w-5 h-5 text-blue-600"}),t.jsx("h3",{className:"font-bold text-lg text-slate-900 dark:text-white",children:"Sugestões de Estudo"})]}),_.length>0?t.jsx("div",{className:"space-y-3",children:_.map((l,n)=>t.jsxs(T.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:n*.1},className:"flex items-start gap-3 p-3 bg-white dark:bg-slate-900 rounded-lg",children:[t.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/40",children:t.jsx(L,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),t.jsx("div",{className:"flex-1",children:t.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:l.text||l})})]},n))}):t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Complete mais atividades para receber sugestões personalizadas."})]}),t.jsxs(E,{className:"p-6 bg-gradient-to-br from-yellow-50 to-orange-50 dark:from-yellow-950/20 dark:to-orange-950/20 border border-yellow-200 dark:border-yellow-800",children:[t.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[t.jsx(le,{className:"w-5 h-5 text-yellow-600"}),t.jsx("h3",{className:"font-bold text-lg text-slate-900 dark:text-white",children:"Áreas de Atenção"})]}),h.length>0?t.jsx("div",{className:"space-y-3",children:h.map((l,n)=>t.jsxs(T.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:n*.1},className:"flex items-start gap-3 p-3 bg-white dark:bg-slate-900 rounded-lg",children:[t.jsx("div",{className:"p-2 rounded-lg bg-yellow-100 dark:bg-yellow-900/40",children:t.jsx(de,{className:"w-4 h-4 text-yellow-600 dark:text-yellow-400"})}),t.jsxs("div",{className:"flex-1",children:[t.jsx("p",{className:"text-sm font-medium text-slate-900 dark:text-white",children:l.subject||l.title}),t.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400 mt-1",children:l.description||l.text})]})]},n))}):t.jsxs("div",{className:"text-center py-4",children:[t.jsx(me,{className:"w-12 h-12 mx-auto mb-2 text-yellow-600"}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Excelente! Não há áreas críticas no momento."})]})]})]}),t.jsxs(E,{className:"p-6 bg-gradient-to-br from-blue-50 to-cyan-50 dark:from-blue-950/20 dark:to-cyan-950/20 border border-blue-200 dark:border-blue-800",children:[t.jsxs("div",{className:"flex items-center justify-between mb-4",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx(F,{className:"w-5 h-5 text-blue-600"}),t.jsx("h3",{className:"font-bold text-lg text-slate-900 dark:text-white",children:"Recomendações Personalizadas com IA"})]}),t.jsx(W,{onClick:k,disabled:s,size:"sm",className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:s?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"w-4 h-4 border-2 border-white border-t-transparent rounded-full animate-spin mr-2"}),"Gerando..."]}):t.jsxs(t.Fragment,{children:[t.jsx(F,{className:"w-4 h-4 mr-2"}),"Gerar Recomendações"]})})]}),y.length>0?t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mt-4",children:y.map((l,n)=>t.jsx(T.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:n*.1},className:"p-4 bg-white dark:bg-slate-900 rounded-lg border border-blue-200 dark:border-blue-800",children:t.jsxs("div",{className:"flex items-start gap-3",children:[t.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/40 flex-shrink-0",children:t.jsx(X,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h4",{className:"font-semibold text-sm text-slate-900 dark:text-white mb-1",children:l.title}),t.jsx("p",{className:"text-xs text-slate-600 dark:text-slate-400",children:l.description}),l.reason&&t.jsx(D,{variant:"outline",className:"mt-2 text-xs",children:l.reason})]})]})},n))}):t.jsxs("div",{className:"text-center py-8",children:[t.jsx(F,{className:"w-16 h-16 mx-auto mb-4 text-blue-400 opacity-50"}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:"Clique no botão acima para gerar recomendações personalizadas baseadas no seu desempenho."}),t.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-500",children:"A IA analisará suas notas, compara com a turma e sugere materiais de estudo ideais para você."})]})]})]})};export{at as default};
