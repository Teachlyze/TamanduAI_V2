import{u as q,b as E,r as m,s as n,l as p,j as t,q as T}from"./main-BSajwT7t.js";import{B as i}from"./button-49_9eRW2.js";import{C as v}from"./card-Bocxgg1Q.js";import{B as z}from"./badge-CfC7p-Az.js";import{S as x}from"./StatsCard-CRzmcd_P.js";import"./DashboardHeader-DHleEAdk.js";import{E as D}from"./EmptyState-iKaJFnss.js";import"./input-xqPBO_Zl.js";import"./dropdown-menu-Ni8Q_KuQ.js";import"./label-Dd1EhhTc.js";import{B as j}from"./bot-Bz9nu5qi.js";import{M}from"./message-square-CBa73Nge.js";import{U as $}from"./users-De1bkoUV.js";import{S as I}from"./star-CpuiYB3v.js";import{m as N}from"./proxy-Bb-A2TUD.js";import{S as b}from"./settings-Blsx5C_z.js";import{C as L}from"./chart-column-BmPD_DCR.js";import{P as U}from"./pause-D1KOQ4Vr.js";import{P as F}from"./play-znFOAaAd.js";import"./chevron-right-DUVlURpD.js";import"./index-BSMAqeIB.js";import"./index-DmwWW5NH.js";import"./index-qH7N8Pcj.js";import"./index-D0BS1fLY.js";import"./Combination-DKLEa6f3.js";import"./SidebarPremium-C1f4icTt.js";import"./house-BkBGIUz8.js";import"./book-open-BqVBcqQl.js";import"./file-text-Bwu_iaa-.js";import"./graduation-cap-pwvok64K.js";import"./calendar-DetO6w5d.js";import"./message-circle-DVaucFfj.js";import"./brain-BPIciAtW.js";import"./index-DV-1B3c4.js";import"./x-Wvu9FBm3.js";import"./index-C1usw-Qd.js";import"./check-BLcdb3Nz.js";const St=()=>{const l=q(),{user:u}=E(),[y,h]=m.useState(!0),[g,C]=m.useState([]),[c,k]=m.useState({activeBots:0,totalConversations:0,studentsServed:0,avgSatisfaction:0});m.useEffect(()=>{f()},[u]);const S=async(a,e)=>{try{const s=e==="active",{data:d}=await n.from("classes").select("settings").eq("id",a).single(),r=d?.settings||{},{error:o}=await n.from("classes").update({settings:{...r,chatbot_paused:s}}).eq("id",a);if(o)throw o;await f()}catch(s){p.error("Erro ao alternar chatbot:",s)}},f=async()=>{if(u)try{h(!0);const{data:a}=await n.from("classes").select("id, name, subject, color").eq("created_by",u.id).eq("is_active",!0),e=await Promise.all((a||[]).map(async r=>{const{data:o}=await n.from("classes").select("settings").eq("id",r.id).single(),_=o?.settings?.chatbot_enabled||!1,A=o?.settings?.chatbot_paused||!1,{data:B}=await n.from("rag_training_sources").select("id").eq("class_id",r.id),P=B?.length||0;return{...r,chatbot:{status:_?A?"paused":"active":"not_configured",activitiesTrained:P,conversations:0,satisfaction:0}}}));C(e);const s=e.filter(r=>r.chatbot.status==="active").length,d=e.reduce((r,o)=>r+o.chatbot.conversations,0);k({activeBots:s,totalConversations:d,studentsServed:Math.floor(d*.6),avgSatisfaction:s>0?90:0})}catch(a){p.error("Erro:",a)}finally{h(!1)}},w=a=>{const e={active:{label:"Ativo",color:"bg-green-100 dark:bg-green-900/30 text-green-700 dark:text-green-300"},paused:{label:"Pausado",color:"bg-amber-100 dark:bg-amber-900/30 text-amber-700 dark:text-amber-300"},not_configured:{label:"NÃ£o Configurado",color:"bg-slate-100 dark:bg-slate-800 text-slate-700 dark:text-slate-400"}};return e[a]||e.not_configured};return y?t.jsx("div",{className:"flex items-center justify-center min-h-screen",children:t.jsx(T,{size:"lg"})}):t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[t.jsx("div",{className:"mb-8",children:t.jsxs("div",{className:"rounded-xl bg-gradient-to-r from-blue-500 via-cyan-500 to-blue-600 p-8 text-white shadow-lg",children:[t.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Assistente IA para Turmas"}),t.jsx("p",{className:"text-blue-50 text-lg",children:"Configure chatbots inteligentes para auxiliar seus alunos"})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[t.jsx(x,{title:"Chatbots Ativos",value:c.activeBots,icon:j,gradient:"from-blue-500 to-cyan-500",delay:0}),t.jsx(x,{title:"Conversas (30 dias)",value:c.totalConversations,icon:M,gradient:"from-cyan-500 to-blue-500",delay:.1}),t.jsx(x,{title:"Alunos Atendidos",value:c.studentsServed,icon:$,gradient:"from-rose-500 to-orange-500",delay:.2}),t.jsx(x,{title:"SatisfaÃ§Ã£o MÃ©dia",value:`${c.avgSatisfaction}%`,icon:I,gradient:"from-amber-500 to-yellow-500",format:"text",delay:.3})]}),t.jsxs(v,{className:"p-6 bg-blue-50 dark:bg-blue-950/30 border-blue-200 dark:border-blue-800 mb-8",children:[t.jsx("h3",{className:"font-bold text-blue-900 dark:text-blue-100 mb-2",children:"â“ Como funciona o chatbot?"}),t.jsx("p",{className:"text-sm text-blue-800 dark:text-blue-200 mb-3",children:"Configure um assistente IA para cada turma. O chatbot aprende com as atividades e materiais que vocÃª seleciona, e ajuda os alunos a tirarem dÃºvidas 24/7."}),t.jsxs("div",{className:"flex gap-2",children:[t.jsx(i,{variant:"outline",size:"sm",className:"text-blue-700",children:"ðŸ“– DocumentaÃ§Ã£o"}),t.jsx(i,{variant:"outline",size:"sm",className:"text-blue-700",children:"ðŸŽ¥ Ver Tutorial"})]})]}),g.length>0?t.jsx(N.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:g.map((a,e)=>{const s=w(a.chatbot.status);return t.jsx(N.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:e*.05},children:t.jsxs(v,{className:"p-6 hover:shadow-lg transition-shadow bg-white dark:bg-slate-900",children:[t.jsxs("div",{className:"flex items-start justify-between mb-4",children:[t.jsxs("div",{className:"flex-1",children:[t.jsx("h3",{className:"font-bold text-lg text-slate-900 dark:text-white mb-1",children:a.name}),t.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:a.subject||"Sem matÃ©ria"})]}),t.jsx(z,{className:s.color,children:s.label})]}),a.chatbot.status!=="not_configured"&&t.jsxs("div",{className:"grid grid-cols-3 gap-4 mb-4 p-3 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-xl font-bold text-blue-600 dark:text-blue-400",children:a.chatbot.activitiesTrained}),t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Atividades"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-xl font-bold text-cyan-600 dark:text-cyan-400",children:a.chatbot.conversations}),t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Conversas"})]}),t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"text-xl font-bold text-amber-600 dark:text-amber-400",children:[a.chatbot.satisfaction,"%"]}),t.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"SatisfaÃ§Ã£o"})]})]}),t.jsx("div",{className:"flex gap-2",children:a.chatbot.status==="not_configured"?t.jsxs(i,{onClick:()=>l(`/dashboard/chatbot/${a.id}/config`),className:"flex-1 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white",children:[t.jsx(b,{className:"w-4 h-4 mr-2"}),"Configurar"]}):t.jsxs(t.Fragment,{children:[t.jsxs(i,{variant:"outline",onClick:()=>l(`/dashboard/chatbot/${a.id}/config`),className:"flex-1",children:[t.jsx(b,{className:"w-4 h-4 mr-2"}),"Editar"]}),t.jsxs(i,{variant:"outline",onClick:()=>l(`/dashboard/chatbot/${a.id}/analytics`),className:"flex-1",children:[t.jsx(L,{className:"w-4 h-4 mr-2"}),"Analytics"]}),t.jsx(i,{variant:"outline",size:"icon",onClick:()=>S(a.id,a.chatbot.status),className:a.chatbot.status==="active"?"text-amber-600 hover:text-amber-700":"text-green-600 hover:text-green-700",title:a.chatbot.status==="active"?"Pausar chatbot":"Ativar chatbot",children:a.chatbot.status==="active"?t.jsx(U,{className:"w-4 h-4"}):t.jsx(F,{className:"w-4 h-4"})})]})})]})},a.id)})}):t.jsx(D,{icon:j,title:"Nenhuma turma encontrada",description:"Crie uma turma para configurar seu primeiro chatbot IA",actionLabel:"Criar Turma",actionIcon:b,action:()=>l("/dashboard/classes")})]})};export{St as default};
