import{l as F,s as H,r as u,j as o,f as kt,b as Jt,R as S,u as ds,C as us,q as fs}from"./main-BtydHokz.js";import{c as ms,u as xe,B as K}from"./button-pkZcz0fw.js";import{C as be}from"./card-BLN8IVBT.js";import{I as rt}from"./input-DevW5dIO.js";import{S as Be,a as Ye,b as ze,c as $e,d as ee,e as hs}from"./select-D2GCnsr7.js";import"./tabs-CcynQOeo.js";import{D as ps,g as vt}from"./DashboardHeader-Do_OLCE8.js";import{S as tt}from"./StatsCard-CQPBdi-L.js";import{E as gs}from"./EmptyState-B9PjJzZx.js";import{D as vs,a as ys,b as bs,e as Yt}from"./dropdown-menu-DQk5WS44.js";import{L}from"./label-Do1Gcpls.js";import{u as Dt}from"./use-toast-BD7ojcJx.js";import{a as xs,N as ws,C as Ss}from"./classService-Ljb7If2H.js";import{D as Ct,a as Nt,b as Qt,c as er}from"./dialog-BI66C03T.js";import{T as zt}from"./textarea-BolYe6PH.js";import{S as $t}from"./slider-DFnbTLTw.js";import{u as Cs,c as tr,P as De,a as ne,b as Ns}from"./index-BRR_QA-l.js";import{c as rr,b as _s,a as js,A as sr,P as ks,D as Ds,e as Ms,d as Os,u as je}from"./index-C0ZNntAv.js";import{h as Es,R as Ts,u as Ps,F as As}from"./Combination-DK-gSie6.js";import{P as Re}from"./SidebarPremium-BEHUuQck.js";import{R as Lt,a as Te}from"./radio-group-CNgnnve0.js";import{s as yt}from"./toastUtils-CQiYPKw9.js";import{B as qe}from"./badge-DpVvk9bK.js";import{C as _t}from"./checkbox-ByVj5oTw.js";import{c as Pe}from"./utils-BhjHi5UJ.js";import{C as nr}from"./calendar-xkfkZRmm.js";import{S as Ws}from"./shield-BHq0XlYy.js";import{E as Rs}from"./ellipsis-vertical-HuCXUnP1.js";import{F as or}from"./file-text-GwBv-P3B.js";import{U as Fs}from"./user-CD_i74Py.js";import{f as Ve,d as Is,g as Bs,a as Ys,i as zs,s as $s,b as Ls,c as Hs,e as qs}from"./format-B5colFmK.js";import{p as Le}from"./pt-BR-D0BJ_iDf.js";import{c as ve,t as oe,n as Vs,e as ar}from"./en-US-DaE-csDX.js";import{a as ir}from"./addDays-ByTXhFEf.js";import{a as lr,n as cr,i as Us,s as Gs}from"./isSameMonth-DXWacbVA.js";import{d as Zs}from"./differenceInCalendarMonths-CtUCBvak.js";import{e as dr}from"./endOfWeek-r8OyeZbF.js";import{i as Xs}from"./isSameDay-D48s9Jab.js";import{e as Ks}from"./endOfMonth-B3jF8fTW.js";import{X as Js}from"./x-BtLVjj0F.js";import{u as Qs}from"./index-sWFH3d_M.js";import{U as en}from"./users-CntpuLnR.js";import{T as tn}from"./triangle-alert-BxEcMhlL.js";import{C as rn}from"./clock-cyyJEg8O.js";import{C as sn}from"./circle-check-big-odCM7i_Y.js";import{T as nn}from"./trending-up-C5ypBnjG.js";import{C as on}from"./circle-alert-COBXyI8K.js";import{S as an}from"./search-B-7BMQB5.js";import{F as ln}from"./funnel-CJBaT3bZ.js";import{D as cn}from"./download-BR6aT-hQ.js";import{m as dn}from"./proxy-BKNTM3tf.js";import"./index-DOzlJ45Y.js";import"./index-C35Ckziv.js";import"./chevron-down-BPlSfXS4.js";import"./check-B1zY7uXK.js";import"./chevron-up-B8VCb_df.js";import"./index-DsrKRt14.js";import"./chevron-right-Bh44L5jc.js";import"./house-dUPObbYn.js";import"./book-open-BQJiPDff.js";import"./graduation-cap-Bm5psu3Q.js";import"./chart-column-B3n9ZMAW.js";import"./message-circle-DTeSrK_w.js";import"./settings-BNGXdjmZ.js";import"./brain-DIkHdpFj.js";import"./index-BpBd5wiB.js";function un(e,t,r){return ir(e,t*7,r)}function fn(e,t,r){return lr(e,t*12,r)}function mn(e,t){let r,s=t?.in;return e.forEach(n=>{!s&&typeof n=="object"&&(s=ve.bind(null,n));const l=oe(n,s);(!r||r<l||isNaN(+l))&&(r=l)}),ve(s,r||NaN)}function hn(e,t){let r,s=t?.in;return e.forEach(n=>{!s&&typeof n=="object"&&(s=ve.bind(null,n));const l=oe(n,s);(!r||r>l||isNaN(+l))&&(r=l)}),ve(s,r||NaN)}function pn(e,t){const{start:r,end:s}=cr(t?.in,e);let n=+r>+s;const l=n?+r:+s,a=n?s:r;a.setHours(0,0,0,0),a.setDate(1);let i=1;const c=[];for(;+a<=l;)c.push(ve(r,a)),a.setMonth(a.getMonth()+i);return n?c.reverse():c}function gn(e,t){const r=oe(e,t?.in),s=r.getFullYear();return r.setFullYear(s+1,0,0),r.setHours(23,59,59,999),r}function vn(e,t){const{start:r,end:s}=cr(t?.in,e);let n=+r>+s;const l=n?+r:+s,a=n?s:r;a.setHours(0,0,0,0),a.setMonth(0,1);let i=1;const c=[];for(;+a<=l;)c.push(ve(r,a)),a.setFullYear(a.getFullYear()+i);return n?c.reverse():c}function yn(e,t){return dr(e,{...t,weekStartsOn:1})}function bn(e,t){const r=oe(e,t?.in),s=r.getFullYear(),n=r.getMonth(),l=ve(r,0);return l.setFullYear(s,n+1,0),l.setHours(0,0,0,0),l.getDate()}function xn(e,t){return oe(e,t?.in).getMonth()}function wn(e,t){return oe(e,t?.in).getFullYear()}function Sn(e,t){return+oe(e)>+oe(t)}function Cn(e,t){return+oe(e)<+oe(t)}function Nn(e,t,r){const[s,n]=Vs(r?.in,e,t);return s.getFullYear()===n.getFullYear()}function _n(e,t,r){const s=oe(e,r?.in),n=s.getFullYear(),l=s.getDate(),a=ve(e,0);a.setFullYear(n,t,15),a.setHours(0,0,0,0);const i=bn(a);return s.setMonth(t,Math.min(l,i)),s}function jn(e,t,r){const s=oe(e,r?.in);return isNaN(+s)?ve(e,NaN):(s.setFullYear(t),s)}const Mt={"0-10":{min:0,max:10,type:"numeric",decimals:2},"0-100":{min:0,max:100,type:"numeric",decimals:0},"A-F":{type:"letter",scale:[{letter:"A",min:9,max:10},{letter:"B",min:7,max:8.9},{letter:"C",min:5,max:6.9},{letter:"D",min:3,max:4.9},{letter:"F",min:0,max:2.9}]},"pass-fail":{type:"binary",scale:[{label:"Aprovado",min:6,max:10},{label:"Reprovado",min:0,max:5.9}]},"excellent-poor":{type:"concept",scale:[{label:"Excelente",min:9,max:10},{label:"Ã“timo",min:7.5,max:8.9},{label:"Bom",min:6,max:7.4},{label:"Regular",min:4,max:5.9},{label:"Insuficiente",min:0,max:3.9}]}};function kn(e,t="0-10"){const r=Mt[t];if(!r)return F.warn(`Sistema de notas desconhecido: ${t}, usando 0-10`),parseFloat(e);if(t==="0-10")return parseFloat(e);if(r.type==="numeric")return parseFloat(e)/r.max*10;if(r.type==="letter"){const n=r.scale.find(l=>l.letter===e.toUpperCase());if(n)return(n.min+n.max)/2}if(r.type==="binary"||r.type==="concept"){const n=r.scale.find(l=>l.label===e);if(n)return(n.min+n.max)/2}const s=parseFloat(e);return isNaN(s)?0:s}function Dn(e,t="0-10"){const r=Mt[t],s=parseFloat(e);if(isNaN(s))return"";if(!r)return s;if(t==="0-10")return s.toFixed(r.decimals);if(r.type==="numeric"){const n=s/10*r.max;return Math.round(n)}if(r.type==="letter"){const n=r.scale.find(l=>s>=l.min&&s<=l.max);return n?n.letter:"F"}if(r.type==="binary"||r.type==="concept"){const n=r.scale.find(l=>s>=l.min&&s<=l.max);return n?n.label:r.scale[r.scale.length-1].label}return s}const Mn=async(e={})=>{try{let t=H.from("submissions").select(`
        *,
        activity:activities(
          id,
          title,
          type,
          max_score,
          content,
          plagiarism_enabled,
          created_by,
          activity_class_assignments(
            class_id,
            class:classes(
              id,
              name,
              grading_system
            )
          )
        ),
        student:profiles!student_id(
          id,
          full_name,
          avatar_url,
          email
        ),
        answers(
          id,
          question_id,
          answer_json,
          points_earned
        )
      `).in("status",["submitted","graded","needs_revision"]);switch(e.classId&&(t=t.eq("activity.activity_class_assignments.class_id",e.classId)),e.activityId&&(t=t.eq("activity_id",e.activityId)),e.status&&(t=t.eq("status",e.status)),e.studentId&&(t=t.eq("student_id",e.studentId)),e.flagged&&(t=t.eq("status","needs_review")),e.plagiarism&&e.plagiarism<100&&(t=t.lt("plagiarism_score",e.plagiarism)),e.sortBy||"oldest"){case"newest":t=t.order("submitted_at",{ascending:!1});break;case"student":t=t.order("student.full_name",{ascending:!0});break;case"grade":t=t.order("grade",{ascending:!1});break;default:t=t.order("submitted_at",{ascending:!0})}const{data:s,error:n}=await t;if(n)throw n;return{data:s,error:null}}catch(t){return F.error("Erro ao buscar submissÃµes:",t),{data:null,error:t}}},On=async e=>{try{const{data:t,error:r}=await H.from("submissions").select(`
        *,
        activity:activities(
          id,
          title,
          description,
          type,
          max_score,
          content,
          plagiarism_enabled,
          due_date,
          created_by,
          activity_class_assignments(
            class:classes(
              grading_system
            )
          )
        ),
        student:profiles!student_id(
          id,
          full_name,
          avatar_url,
          email
        ),
        answers(*)
      `).eq("id",e).single();if(r)throw r;if(t.activity.plagiarism_enabled){const{data:s}=await H.from("plagiarism_checks").select("*").eq("submission_id",e).order("checked_at",{ascending:!1}).limit(1).single();t.plagiarism_check=s}return{data:t,error:null}}catch(t){return F.error("Erro ao buscar detalhes da submissÃ£o:",t),{data:null,error:t}}},En=async(e,t)=>{try{const{grade:r,feedback:s,rubricScores:n=[],status:l="graded",teacherId:a}=t;F.debug("ðŸ“ Salvando correÃ§Ã£o:",{submissionId:e,grade:r,gradeType:typeof r,feedback:s?.substring(0,50),status:l});const{data:i}=await H.from("submissions").select(`
        activity:activities(
          max_score,
          activity_class_assignments(
            class:classes(grading_system)
          )
        )
      `).eq("id",e).single(),c=i?.activity?.max_score||10,d=i?.activity?.activity_class_assignments?.[0]?.class?.grading_system||"0-10";F.debug("ðŸ“Š Convertendo nota:",{gradeInput:r,gradingSystem:d,maxScore:c});let f;const m=r;try{f=kn(r,d),F.debug(`âœ… ConversÃ£o: "${r}" (${d}) â†’ ${f.toFixed(2)}/10`)}catch(C){throw F.error("âŒ Erro na conversÃ£o:",C),new Error(`Nota invÃ¡lida para o sistema ${d}: ${r}`)}if(f>10)throw new Error(`Nota ${r} resultou em ${f.toFixed(2)}/10, excedendo o limite.`);if(f<0)throw new Error("Nota nÃ£o pode ser negativa.");if(isNaN(f))throw new Error(`Nota invÃ¡lida: ${r}`);const h={grade:f,feedback:s||"",status:l,graded_at:new Date().toISOString()};F.debug("ðŸ“¤ Update payload:",h);const{data:p,error:g}=await H.from("submissions").update(h).eq("id",e).select().single();if(g)throw F.error("âŒ Erro no update:",g),g;if(F.debug("âœ… CorreÃ§Ã£o salva com sucesso"),n.length>0){const C=n.map(y=>({submission_id:e,rubric_id:y.rubricId,score:y.score,comment:y.comment||null})),{error:b}=await H.from("submission_rubric_scores").upsert(C);if(b)throw b}return await H.from("correction_history").insert({submission_id:e,teacher_id:a,action:"corrected",new_grade:f,notes:d!=="0-10"?`CorreÃ§Ã£o realizada: "${m}" (${d}) = ${f.toFixed(2)}/10`:`CorreÃ§Ã£o realizada: ${f} pontos`}),{data:p,error:null,converted:d!=="0-10",gradingSystem:d,originalGrade:m,normalizedGrade:f,maxScore:c}}catch(r){return F.error("Erro ao salvar correÃ§Ã£o:",r),{data:null,error:r}}},Tn=async(e,t,r)=>{try{const s=[],n=[],l=t?.method||"same_grade",a=t?.feedback||"";for(const c of e){const d=c.id;try{const f={feedback:a,teacherId:r};if(l==="same_grade")f.grade=t.grade;else if(l==="adjust"){const h=c.activity?.activity_class_assignments?.[0]?.class?.grading_system||"0-10",p=Mt[h];if(!p||p.type!=="numeric")throw new Error(`Sistema de notas ${h} nÃ£o suporta ajuste numÃ©rico em lote.`);const g=Dn(c.grade??0,h),C=Number(g)||0,b=Number(t.adjustValue||0),y=t.adjustType||"add";let D=C;y==="add"?D=C+b:y==="subtract"?D=C-b:y==="multiply"&&(D=C*b);const w=p.min??0,N=p.max??10;D>N&&(D=N),D<w&&(D=w),f.grade=D}else throw new Error(`MÃ©todo de correÃ§Ã£o em lote nÃ£o suportado: ${l}`);const m=await En(d,f);if(m.error)n.push({submissionId:d,error:m.error});else{s.push(m.data);try{const h=c.activity?.title||"Atividade",p=c.activity?.max_score||10,g=typeof f.grade=="number"?f.grade:parseFloat(f.grade);await xs.sendCorrectionNotification({submissionId:d,studentId:c.student_id,activityTitle:h,grade:Number.isFinite(g)?g:0,maxScore:p})}catch(h){F.warn("Falha ao enviar notificaÃ§Ã£o de correÃ§Ã£o em lote:",h)}}}catch(f){F.error("Erro ao processar submissÃ£o em lote:",f),n.push({submissionId:c.id,error:f})}}const i=t?.newDueDate;if(i)try{const c=t?.classScope||"all",d=new Set;c==="all"?(e||[]).forEach(m=>{m.activity_id&&d.add(m.activity_id)}):(e||[]).forEach(m=>{(m.activity?.activity_class_assignments||[]).some(g=>g.class_id===c||g.class?.id===c)&&m.activity_id&&d.add(m.activity_id)});const f=Array.from(d);if(f.length>0){const{error:m}=await H.from("activities").update({due_date:i,updated_at:new Date().toISOString()}).in("id",f);m&&F.error("Erro ao atualizar prazo de atividades em lote:",m)}}catch(c){F.error("Erro inesperado ao atualizar prazos em lote:",c)}return{data:{success:s,failed:n,successCount:s.length,failedCount:n.length},error:null}}catch(s){return F.error("Erro na correÃ§Ã£o em lote:",s),{data:null,error:s}}},Pn=async(e,t="week")=>{try{const r=new Date,s=new Date;switch(t){case"day":s.setDate(r.getDate()-1);break;case"week":s.setDate(r.getDate()-7);break;case"month":s.setMonth(r.getMonth()-1);break;default:s.setDate(r.getDate()-7)}const{data:n,error:l}=await H.from("correction_metrics").select("*").eq("teacher_id",e).gte("date",s.toISOString().split("T")[0]).order("date",{ascending:!1});if(l)throw l;if(!n||n.length===0)return{data:{corrections_count:0,total_time_seconds:0,avg_grade:0,avg_feedback_length:0,avg_time_per_correction:0,daily_metrics:[]},error:null};const a={corrections_count:0,total_time_seconds:0,grades:[],lengths:[]},i=n.reduce((m,h)=>{const p=Number(h.corrections_count)||0,g=Number(h.total_time_seconds)||0,C=Number(h.avg_grade_given)||0,b=Number(h.feedback_avg_length)||0;return{corrections_count:m.corrections_count+p,total_time_seconds:m.total_time_seconds+g,grades:[...m.grades,C],lengths:[...m.lengths,b]}},a),c=i.grades.length>0?parseFloat((i.grades.reduce((m,h)=>m+h,0)/i.grades.length).toFixed(1)):0,d=i.lengths.length>0?Math.round(i.lengths.reduce((m,h)=>m+h,0)/i.lengths.length):0,f=i.corrections_count>0?Math.round(i.total_time_seconds/i.corrections_count):0;return{data:{...i,avg_grade:c,avg_feedback_length:d,avg_time_per_correction:f,daily_metrics:n},error:null}}catch(r){return F.error("Erro ao buscar mÃ©tricas:",r),{data:null,error:r}}},An={async createActivity(e){const{title:t,description:r,created_by:s,max_score:n=100,due_date:l,type:a="assignment",plagiarism_enabled:i=!1,plagiarism_threshold:c=35,instructions:d,content:f}=e,{data:m,error:h}=await H.from("activities").insert({title:t,description:r,instructions:d||r,content:f||{},created_by:s,max_score:n,max_grade:n,due_date:l,type:a,status:"draft",is_draft:!0,is_published:!1,plagiarism_enabled:i,plagiarism_threshold:c,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(h)throw F.error("Error creating activity:",h),h;return m},async updateActivity(e,t){const{data:r,error:s}=await H.from("activities").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw F.error("Error updating activity:",s),s;return r},async publishActivity(e,t,r=!1){const{data:s,error:n}=await H.from("activities").update({status:"active",is_published:!0,is_draft:!1,plagiarism_enabled:r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw F.error("Error publishing activity:",n),n;if(t&&t.length>0){const l=t.map(i=>({activity_id:e,class_id:i,assigned_at:new Date().toISOString()})),{error:a}=await H.from("activity_class_assignments").insert(l);if(a&&a.code!=="23505")throw F.error("Error assigning activity to classes:",a),a;try{for(const i of t){const{data:c}=await H.from("class_members").select("user_id").eq("class_id",i).eq("role","student"),d=c?.map(f=>f.user_id)||[];for(const f of d)await ws.send("activityPublished",{userId:f,variables:{activityTitle:s.title,dueDate:s.due_date?new Date(s.due_date).toLocaleDateString("pt-BR"):"Sem prazo"},channelOverride:"push",metadata:{activityId:e,classId:i}})}}catch(i){F.warn("Failed to notify students:",i)}}return s},async getActivityById(e){const{data:t,error:r}=await H.from("activities").select(`
        *,
        created_by_user:profiles!activities_created_by_fkey(id, full_name, avatar_url),
        assignments:activity_class_assignments(
          class_id,
          class:classes(id, name, subject, color)
        )
      `).eq("id",e).single();if(r)throw F.error("Error fetching activity:",r),r;return t},async getActivitiesByTeacher(e,{status:t,includeDrafts:r=!0}={}){let s=H.from("activities").select(`
        *,
        assignments:activity_class_assignments(
          class_id,
          class:classes(id, name, subject)
        )
      `).eq("created_by",e).order("created_at",{ascending:!1});t&&(s=s.eq("status",t)),r||(s=s.eq("is_draft",!1));const{data:n,error:l}=await s;if(l)throw F.error("Error fetching activities:",l),l;return n},async getActivitySubmissions(e){const{data:t,error:r}=await H.from("submissions").select(`
        *,
        student:profiles!submissions_student_id_fkey(id, full_name, name, avatar_url)
      `).eq("activity_id",e).order("submitted_at",{ascending:!1});if(r)throw F.error("Error fetching submissions:",r),r;return t},async deleteActivity(e){const{error:t}=await H.from("activities").delete().eq("id",e);if(t)throw F.error("Error deleting activity:",t),t;return!0},async getActivitiesByClass(e){const{data:t,error:r}=await H.from("activity_class_assignments").select(`
        activity_id,
        activity:activities(
          id,
          title,
          description,
          due_date,
          created_at,
          created_by_user:profiles!activities_created_by_fkey(id, full_name, avatar_url)
        )
      `).eq("class_id",e);if(r)throw F.error("Error fetching activities:",r),r;return t.map(s=>s.activity)},async getActivityStats(e){const{data:t}=await H.from("submissions").select("id, status, grade, submitted_at").eq("activity_id",e),r=t?.length||0,s=t?.filter(c=>c.submitted_at).length||0,n=t?.filter(c=>c.grade!==null).length||0,l=s-n,a=t?.filter(c=>c.grade!==null).map(c=>parseFloat(c.grade))||[],i=a.length>0?a.reduce((c,d)=>c+d,0)/a.length:0;return{total:r,submitted:s,graded:n,pending:l,avgGrade:i.toFixed(2),submissionRate:r>0?(s/r*100).toFixed(1):0}}};function Wn(e){const t=Rn(e),r=u.forwardRef((s,n)=>{const{children:l,...a}=s,i=u.Children.toArray(l),c=i.find(In);if(c){const d=c.props.children,f=i.map(m=>m===c?u.Children.count(d)>1?u.Children.only(null):u.isValidElement(d)?d.props.children:null:m);return o.jsx(t,{...a,ref:n,children:u.isValidElement(d)?u.cloneElement(d,void 0,f):null})}return o.jsx(t,{...a,ref:n,children:l})});return r.displayName=`${e}.Slot`,r}function Rn(e){const t=u.forwardRef((r,s)=>{const{children:n,...l}=r;if(u.isValidElement(n)){const a=Yn(n),i=Bn(l,n.props);return n.type!==u.Fragment&&(i.ref=s?ms(s,a):a),u.cloneElement(n,i)}return u.Children.count(n)>1?u.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Fn=Symbol("radix.slottable");function In(e){return u.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Fn}function Bn(e,t){const r={...t};for(const s in t){const n=e[s],l=t[s];/^on[A-Z]/.test(s)?n&&l?r[s]=(...i)=>{const c=l(...i);return n(...i),c}:n&&(r[s]=n):s==="style"?r[s]={...n,...l}:s==="className"&&(r[s]=[n,l].filter(Boolean).join(" "))}return{...e,...r}}function Yn(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var ot="Popover",[ur]=tr(ot,[rr]),Ue=rr(),[zn,we]=ur(ot),fr=e=>{const{__scopePopover:t,children:r,open:s,defaultOpen:n,onOpenChange:l,modal:a=!1}=e,i=Ue(t),c=u.useRef(null),[d,f]=u.useState(!1),[m,h]=Cs({prop:s,defaultProp:n??!1,onChange:l,caller:ot});return o.jsx(_s,{...i,children:o.jsx(zn,{scope:t,contentId:js(),triggerRef:c,open:m,onOpenChange:h,onOpenToggle:u.useCallback(()=>h(p=>!p),[h]),hasCustomAnchor:d,onCustomAnchorAdd:u.useCallback(()=>f(!0),[]),onCustomAnchorRemove:u.useCallback(()=>f(!1),[]),modal:a,children:r})})};fr.displayName=ot;var mr="PopoverAnchor",$n=u.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,n=we(mr,r),l=Ue(r),{onCustomAnchorAdd:a,onCustomAnchorRemove:i}=n;return u.useEffect(()=>(a(),()=>i()),[a,i]),o.jsx(sr,{...l,...s,ref:t})});$n.displayName=mr;var hr="PopoverTrigger",pr=u.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,n=we(hr,r),l=Ue(r),a=xe(t,n.triggerRef),i=o.jsx(De.button,{type:"button","aria-haspopup":"dialog","aria-expanded":n.open,"aria-controls":n.contentId,"data-state":xr(n.open),...s,ref:a,onClick:ne(e.onClick,n.onOpenToggle)});return n.hasCustomAnchor?i:o.jsx(sr,{asChild:!0,...l,children:i})});pr.displayName=hr;var Ot="PopoverPortal",[Ln,Hn]=ur(Ot,{forceMount:void 0}),gr=e=>{const{__scopePopover:t,forceMount:r,children:s,container:n}=e,l=we(Ot,t);return o.jsx(Ln,{scope:t,forceMount:r,children:o.jsx(Re,{present:r||l.open,children:o.jsx(ks,{asChild:!0,container:n,children:s})})})};gr.displayName=Ot;var Ae="PopoverContent",vr=u.forwardRef((e,t)=>{const r=Hn(Ae,e.__scopePopover),{forceMount:s=r.forceMount,...n}=e,l=we(Ae,e.__scopePopover);return o.jsx(Re,{present:s||l.open,children:l.modal?o.jsx(Vn,{...n,ref:t}):o.jsx(Un,{...n,ref:t})})});vr.displayName=Ae;var qn=Wn("PopoverContent.RemoveScroll"),Vn=u.forwardRef((e,t)=>{const r=we(Ae,e.__scopePopover),s=u.useRef(null),n=xe(t,s),l=u.useRef(!1);return u.useEffect(()=>{const a=s.current;if(a)return Es(a)},[]),o.jsx(Ts,{as:qn,allowPinchZoom:!0,children:o.jsx(yr,{...e,ref:n,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:ne(e.onCloseAutoFocus,a=>{a.preventDefault(),l.current||r.triggerRef.current?.focus()}),onPointerDownOutside:ne(e.onPointerDownOutside,a=>{const i=a.detail.originalEvent,c=i.button===0&&i.ctrlKey===!0,d=i.button===2||c;l.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:ne(e.onFocusOutside,a=>a.preventDefault(),{checkForDefaultPrevented:!1})})})}),Un=u.forwardRef((e,t)=>{const r=we(Ae,e.__scopePopover),s=u.useRef(!1),n=u.useRef(!1);return o.jsx(yr,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:l=>{e.onCloseAutoFocus?.(l),l.defaultPrevented||(s.current||r.triggerRef.current?.focus(),l.preventDefault()),s.current=!1,n.current=!1},onInteractOutside:l=>{e.onInteractOutside?.(l),l.defaultPrevented||(s.current=!0,l.detail.originalEvent.type==="pointerdown"&&(n.current=!0));const a=l.target;r.triggerRef.current?.contains(a)&&l.preventDefault(),l.detail.originalEvent.type==="focusin"&&n.current&&l.preventDefault()}})}),yr=u.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:s,onOpenAutoFocus:n,onCloseAutoFocus:l,disableOutsidePointerEvents:a,onEscapeKeyDown:i,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:f,...m}=e,h=we(Ae,r),p=Ue(r);return Ps(),o.jsx(As,{asChild:!0,loop:!0,trapped:s,onMountAutoFocus:n,onUnmountAutoFocus:l,children:o.jsx(Ds,{asChild:!0,disableOutsidePointerEvents:a,onInteractOutside:f,onEscapeKeyDown:i,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>h.onOpenChange(!1),children:o.jsx(Ms,{"data-state":xr(h.open),role:"dialog",id:h.contentId,...p,...m,ref:t,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),br="PopoverClose",Gn=u.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,n=we(br,r);return o.jsx(De.button,{type:"button",...s,ref:t,onClick:ne(e.onClick,()=>n.onOpenChange(!1))})});Gn.displayName=br;var Zn="PopoverArrow",Xn=u.forwardRef((e,t)=>{const{__scopePopover:r,...s}=e,n=Ue(r);return o.jsx(Os,{...n,...s,ref:t})});Xn.displayName=Zn;function xr(e){return e?"open":"closed"}var Kn=fr,Jn=pr,Qn=gr,wr=vr;const eo=Kn,to=Jn,Sr=u.forwardRef(({className:e,align:t="center",sideOffset:r=4,...s},n)=>o.jsx(Qn,{children:o.jsx(wr,{ref:n,align:t,sideOffset:r,className:kt("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...s})}));Sr.displayName=wr.displayName;const ro=({submission:e,onCorrect:t,isSelected:r,onSelect:s})=>{const n=d=>{const f={submitted:{label:"Aguardando",color:"bg-yellow-500 text-white"},graded:{label:"Corrigida",color:"bg-green-500 text-white"},needs_revision:{label:"RevisÃ£o",color:"bg-orange-500 text-white"}};return f[d]||f.submitted},l=d=>{const f={assignment:{label:"Aberta",color:"bg-green-100 text-green-700"},quiz:{label:"Fechada",color:"bg-blue-100 text-blue-700"},project:{label:"Mista",color:"bg-purple-100 text-purple-700"}};return f[d]||f.assignment},a=e.submitted_at&&e.activity?.due_date&&new Date(e.submitted_at)>new Date(e.activity.due_date),i=n(e.status),c=l(e.activity?.type);return o.jsx(be,{className:Pe("p-4 hover:shadow-md transition-all duration-200",e.status==="needs_review"&&"border-l-4 border-l-red-500",r&&"ring-2 ring-blue-500 bg-blue-50"),children:o.jsxs("div",{className:"flex items-center gap-4",children:[s&&o.jsx(_t,{checked:r,onCheckedChange:s}),o.jsx("div",{className:"flex-shrink-0",children:e.student?.avatar_url?o.jsx("img",{src:e.student.avatar_url,alt:e.student.full_name,className:"w-12 h-12 rounded-full"}):o.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold",children:e.student?.full_name?.[0]||"A"})}),o.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[o.jsxs("div",{className:"flex items-start justify-between",children:[o.jsxs("div",{className:"flex-1 min-w-0",children:[o.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 truncate",children:e.student?.full_name||"Aluno Desconhecido"}),o.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:e.activity?.title||"Atividade"})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(qe,{className:Pe("text-xs",c.color),children:c.label}),o.jsx(qe,{className:Pe("text-xs",i.color),children:i.label})]})]}),o.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(nr,{className:"w-4 h-4"}),o.jsx("span",{children:e.submitted_at?Ve(new Date(e.submitted_at),"dd/MM/yyyy 'Ã s' HH:mm",{locale:Le}):"NÃ£o submetida"})]}),a&&o.jsx(qe,{variant:"destructive",className:"text-xs",children:"Atrasada"}),e.activity?.plagiarism_enabled&&e.plagiarism_score!==null&&o.jsxs("div",{className:"flex items-center gap-1",children:[o.jsx(Ws,{className:Pe("w-4 h-4",e.plagiarism_score>=90?"text-green-600":e.plagiarism_score>=70?"text-yellow-600":"text-red-600")}),o.jsxs("span",{children:[e.plagiarism_score,"% original"]})]}),e.grade!==null&&o.jsxs("div",{className:"font-semibold",children:["Nota: ",e.grade,"/",e.activity?.max_score||10]})]})]}),o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(K,{onClick:t,className:Pe(e.status==="graded"?"bg-blue-600 hover:bg-blue-700":"bg-green-600 hover:bg-green-700"),children:e.status==="graded"?"Revisar":"Corrigir"}),o.jsxs(vs,{children:[o.jsx(ys,{asChild:!0,children:o.jsx(K,{variant:"ghost",size:"icon",children:o.jsx(Rs,{className:"w-5 h-5"})})}),o.jsxs(bs,{align:"end",children:[o.jsxs(Yt,{children:[o.jsx(or,{className:"w-4 h-4 mr-2"}),"Ver Atividade"]}),o.jsxs(Yt,{children:[o.jsx(Fs,{className:"w-4 h-4 mr-2"}),"Ver Perfil do Aluno"]})]})]})]})]})})},so=({submissions:e,onClose:t,onCompleted:r})=>{const{user:s}=Jt(),{toast:n}=Dt(),[l,a]=u.useState(!1),[i,c]=u.useState("same_grade"),[d,f]=u.useState(""),[m,h]=u.useState(""),[p,g]=u.useState(""),[C,b]=u.useState("add"),[y,D]=u.useState(""),[w,N]=u.useState("all"),_=u.useMemo(()=>{const x=new Map;return(e||[]).forEach(O=>{(O.activity?.activity_class_assignments||[]).forEach(P=>{const Y=P.class_id||P.class?.id,J=P.class?.name||"Turma";Y&&!x.has(Y)&&x.set(Y,{id:Y,name:J})})}),Array.from(x.values())},[e]),v=e[0]?.activity?.max_score||10,j=async()=>{a(!0);try{let x={feedback:m,method:i};if(i==="same_grade"){if(!d||parseFloat(d)<0||parseFloat(d)>v){n({title:"Erro",description:`Nota deve estar entre 0 e ${v}`,variant:"destructive"}),a(!1);return}x.grade=parseFloat(d)}else if(i==="adjust"){if(!p||isNaN(parseFloat(p))){n({title:"Erro",description:"Informe um valor numÃ©rico vÃ¡lido para o ajuste.",variant:"destructive"}),a(!1);return}x.adjustValue=parseFloat(p),x.adjustType=C}else if(i==="by_criteria"){n({title:"Em breve",description:"CorreÃ§Ã£o por critÃ©rio ainda nÃ£o estÃ¡ disponÃ­vel na correÃ§Ã£o em lote."}),a(!1);return}if(x.status="graded",y){const P=new Date(y);Number.isNaN(P.getTime())||(x.newDueDate=P.toISOString(),w&&w!=="all"&&(x.classScope=w))}const{data:O,error:T}=await Tn(e,x,s.id);if(T)throw T;n({title:"Sucesso",description:`${O.successCount} submissÃµes corrigidas. ${O.failedCount} falharam.`}),r(),t()}catch(x){F.error("Erro na correÃ§Ã£o em lote:",x),n({title:"Erro",description:"NÃ£o foi possÃ­vel completar a correÃ§Ã£o em lote",variant:"destructive"})}finally{a(!1)}};return o.jsx(Ct,{open:!0,onOpenChange:t,children:o.jsxs(Nt,{className:"max-w-3xl",children:[o.jsxs(Qt,{children:[o.jsx(er,{children:"CorreÃ§Ã£o em Lote"}),o.jsxs("p",{className:"text-sm text-gray-600",children:[e.length," submissÃµes selecionadas"]})]}),o.jsxs("div",{className:"space-y-6 py-4",children:[o.jsxs(be,{className:"p-4 max-h-40 overflow-y-auto",children:[o.jsx("h4",{className:"font-semibold mb-2",children:"SubmissÃµes:"}),o.jsx("ul",{className:"space-y-1 text-sm",children:e.map(x=>o.jsxs("li",{className:"flex justify-between",children:[o.jsx("span",{children:x.student?.full_name}),o.jsx("span",{className:"text-gray-500",children:x.activity?.title})]},x.id))})]}),o.jsxs("div",{children:[o.jsx(L,{className:"text-base font-semibold mb-3 block",children:"MÃ©todo de CorreÃ§Ã£o"}),o.jsx(Lt,{value:i,onValueChange:c,children:o.jsxs("div",{className:"space-y-3",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Te,{value:"same_grade",id:"same_grade"}),o.jsx(L,{htmlFor:"same_grade",className:"cursor-pointer",children:"Mesma nota para todas"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Te,{value:"by_criteria",id:"by_criteria"}),o.jsx(L,{htmlFor:"by_criteria",className:"cursor-pointer",children:"Nota baseada em critÃ©rio (em breve)"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Te,{value:"adjust",id:"adjust"}),o.jsx(L,{htmlFor:"adjust",className:"cursor-pointer",children:"Ajuste proporcional"})]})]})})]}),i==="same_grade"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsxs(L,{children:["Nota (0 - ",v,")"]}),o.jsx(rt,{type:"number",min:"0",max:v,step:"0.1",value:d,onChange:x=>f(x.target.value),className:"mt-1"})]}),o.jsxs("div",{children:[o.jsx(L,{children:"Feedback PadrÃ£o"}),o.jsx(zt,{value:m,onChange:x=>h(x.target.value),placeholder:"Digite um feedback que serÃ¡ aplicado a todas as submissÃµes...",className:"mt-1",rows:4})]})]}),i==="adjust"&&o.jsxs("div",{className:"space-y-4",children:[o.jsxs("div",{children:[o.jsx(L,{className:"block mb-2",children:"Tipo de ajuste"}),o.jsxs(Lt,{value:C,onValueChange:b,className:"flex flex-col space-y-2",children:[o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Te,{value:"add",id:"adjust_add"}),o.jsx(L,{htmlFor:"adjust_add",className:"cursor-pointer",children:"Somar pontos"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Te,{value:"subtract",id:"adjust_subtract"}),o.jsx(L,{htmlFor:"adjust_subtract",className:"cursor-pointer",children:"Subtrair pontos"})]}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(Te,{value:"multiply",id:"adjust_multiply"}),o.jsx(L,{htmlFor:"adjust_multiply",className:"cursor-pointer",children:"Multiplicar por fator"})]})]})]}),o.jsxs("div",{children:[o.jsxs(L,{children:["Valor de ajuste ",C==="multiply"?"(fator, ex: 1.1)":`(pontos na escala da turma, mÃ¡x. ${v})`]}),o.jsx(rt,{type:"number",step:"0.1",value:p,onChange:x=>g(x.target.value),className:"mt-1"})]}),o.jsxs("div",{children:[o.jsx(L,{children:"Feedback PadrÃ£o (opcional)"}),o.jsx(zt,{value:m,onChange:x=>h(x.target.value),placeholder:"Digite um feedback que serÃ¡ aplicado a todas as submissÃµes...",className:"mt-1",rows:3})]})]}),o.jsxs(be,{className:"p-4 bg-slate-50 dark:bg-slate-900/40 space-y-3",children:[o.jsxs("div",{children:[o.jsx("h4",{className:"font-semibold mb-1",children:"Status e notificaÃ§Ãµes"}),o.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-300",children:["Todas as submissÃµes selecionadas serÃ£o marcadas como ",o.jsx("strong",{children:"corrigidas"})," e os alunos receberÃ£o uma notificaÃ§Ã£o de atividade corrigida."]})]}),o.jsxs("div",{className:"space-y-1",children:[o.jsx(L,{htmlFor:"bulk-deadline",className:"text-sm font-medium",children:"Atualizar prazo da atividade (opcional)"}),o.jsx(rt,{id:"bulk-deadline",type:"datetime-local",value:y,onChange:x=>D(x.target.value),className:"mt-1 max-w-xs"}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Se preenchido, o prazo serÃ¡ atualizado para todas as atividades relacionadas Ã s submissÃµes selecionadas."})]}),_.length>1&&o.jsxs("div",{className:"space-y-1",children:[o.jsx(L,{className:"text-sm font-medium",children:"Aplicar novo prazo para"}),o.jsxs(Be,{value:w,onValueChange:N,children:[o.jsx(Ye,{className:"mt-1 max-w-xs",children:o.jsx(ze,{placeholder:"Selecione a turma"})}),o.jsxs($e,{children:[o.jsx(ee,{value:"all",children:"Todas as turmas destas atividades"}),_.map(x=>o.jsx(ee,{value:x.id,children:x.name},x.id))]})]}),o.jsx("p",{className:"text-xs text-gray-500 dark:text-gray-400",children:"Use esta opÃ§Ã£o se a mesma atividade estiver em mais de uma turma e vocÃª quiser atualizar o prazo apenas para uma turma especÃ­fica."})]})]}),o.jsxs(be,{className:"p-4 bg-blue-50 dark:bg-blue-950/30",children:[o.jsx("h4",{className:"font-semibold mb-2",children:"Preview do Resultado"}),o.jsxs("div",{className:"text-sm space-y-1",children:[o.jsxs("p",{children:[o.jsx("strong",{children:"SubmissÃµes afetadas:"})," ",e.length]}),i==="same_grade"&&d&&o.jsxs("p",{children:[o.jsx("strong",{children:"Nota a ser atribuÃ­da:"})," ",d,"/",v]}),i==="adjust"&&p&&o.jsxs("p",{children:[o.jsx("strong",{children:"Ajuste:"})," ",C==="add"&&"+",C==="subtract"&&"-",C==="multiply"&&"Ã—"," ",p]}),y&&o.jsxs("p",{children:[o.jsx("strong",{children:"Novo prazo:"})," ",(()=>{const x=new Date(y);return Number.isNaN(x.getTime())?y:x.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"})})()]}),o.jsxs("p",{children:[o.jsx("strong",{children:"Feedback:"})," ",m?`${m.substring(0,50)}...`:"Nenhum"]})]})]})]}),o.jsxs("div",{className:"flex justify-end gap-2",children:[o.jsx(K,{variant:"outline",onClick:t,disabled:l,children:"Cancelar"}),o.jsx(K,{onClick:j,disabled:l||i==="same_grade"&&!d||i==="adjust"&&!p,className:"bg-green-600 hover:bg-green-700",children:l?"Aplicando...":"Aplicar CorreÃ§Ãµes"})]})]})})};function no(e,t,r="long"){return new Intl.DateTimeFormat("en-US",{hour:"numeric",timeZone:e,timeZoneName:r}).format(t).split(/\s/g).slice(2).join(" ")}const oo={},He={};function ke(e,t){try{const s=(oo[e]||=new Intl.DateTimeFormat("en-US",{timeZone:e,timeZoneName:"longOffset"}).format)(t).split("GMT")[1];return s in He?He[s]:Ht(s,s.split(":"))}catch{if(e in He)return He[e];const r=e?.match(ao);return r?Ht(e,r.slice(1)):NaN}}const ao=/([+-]\d\d):?(\d\d)?/;function Ht(e,t){const r=+(t[0]||0),s=+(t[1]||0),n=+(t[2]||0)/60;return He[e]=r*60+s>0?r*60+s+n:r*60-s-n}class de extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(ke(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),Cr(this),jt(this)):this.setTime(Date.now())}static tz(t,...r){return r.length?new de(...r,t):new de(Date.now(),t)}withTimeZone(t){return new de(+this,t)}getTimezoneOffset(){const t=-ke(this.timeZone,this);return t>0?Math.floor(t):Math.ceil(t)}setTime(t){return Date.prototype.setTime.apply(this,arguments),jt(this),+this}[Symbol.for("constructDateFrom")](t){return new de(+new Date(t),this.timeZone)}}const qt=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!qt.test(e))return;const t=e.replace(qt,"$1UTC");de.prototype[t]&&(e.startsWith("get")?de.prototype[e]=function(){return this.internal[t]()}:(de.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),io(this),+this},de.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),jt(this),+this}))});function jt(e){e.internal.setTime(+e),e.internal.setUTCSeconds(e.internal.getUTCSeconds()-Math.round(-ke(e.timeZone,e)*60))}function io(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),Cr(e)}function Cr(e){const t=ke(e.timeZone,e),r=t>0?Math.floor(t):Math.ceil(t),s=new Date(+e);s.setUTCHours(s.getUTCHours()-1);const n=-new Date(+e).getTimezoneOffset(),l=-new Date(+s).getTimezoneOffset(),a=n-l,i=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();a&&i&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+a);const c=n-r;c&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+c);const d=new Date(+e);d.setUTCSeconds(0);const f=n>0?d.getSeconds():(d.getSeconds()-60)%60,m=Math.round(-(ke(e.timeZone,e)*60))%60;(m||f)&&(e.internal.setUTCSeconds(e.internal.getUTCSeconds()+m),Date.prototype.setUTCSeconds.call(e,Date.prototype.getUTCSeconds.call(e)+m+f));const h=ke(e.timeZone,e),p=h>0?Math.floor(h):Math.ceil(h),C=-new Date(+e).getTimezoneOffset()-p,b=p!==r,y=C-c;if(b&&y){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+y);const D=ke(e.timeZone,e),w=D>0?Math.floor(D):Math.ceil(D),N=p-w;N&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+N),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+N))}}class he extends de{static tz(t,...r){return r.length?new he(...r,t):new he(Date.now(),t)}toISOString(){const[t,r,s]=this.tzComponents(),n=`${t}${r}:${s}`;return this.internal.toISOString().slice(0,-1)+n}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,r,s,n]=this.internal.toUTCString().split(" ");return`${t?.slice(0,-1)} ${s} ${r} ${n}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[r,s,n]=this.tzComponents();return`${t} GMT${r}${s}${n} (${no(this.timeZone,this)})`}toLocaleString(t,r){return Date.prototype.toLocaleString.call(this,t,{...r,timeZone:r?.timeZone||this.timeZone})}toLocaleDateString(t,r){return Date.prototype.toLocaleDateString.call(this,t,{...r,timeZone:r?.timeZone||this.timeZone})}toLocaleTimeString(t,r){return Date.prototype.toLocaleTimeString.call(this,t,{...r,timeZone:r?.timeZone||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),r=t>0?"-":"+",s=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),n=String(Math.abs(t)%60).padStart(2,"0");return[r,s,n]}withTimeZone(t){return new he(+this,t)}[Symbol.for("constructDateFrom")](t){return new he(+new Date(t),this.timeZone)}}const Vt=5,lo=4;function co(e,t){const r=t.startOfMonth(e),s=r.getDay()>0?r.getDay():7,n=t.addDays(e,-s+1),l=t.addDays(n,Vt*7-1);return t.getMonth(e)===t.getMonth(l)?Vt:lo}function Nr(e,t){const r=t.startOfMonth(e),s=r.getDay();return s===1?r:s===0?t.addDays(r,-6):t.addDays(r,-1*(s-1))}function uo(e,t){const r=Nr(e,t),s=co(e,t);return t.addDays(r,s*7-1)}class re{constructor(t,r){this.Date=Date,this.today=()=>this.overrides?.today?this.overrides.today():this.options.timeZone?he.tz(this.options.timeZone):new this.Date,this.newDate=(s,n,l)=>this.overrides?.newDate?this.overrides.newDate(s,n,l):this.options.timeZone?new he(s,n,l,this.options.timeZone):new Date(s,n,l),this.addDays=(s,n)=>this.overrides?.addDays?this.overrides.addDays(s,n):ir(s,n),this.addMonths=(s,n)=>this.overrides?.addMonths?this.overrides.addMonths(s,n):lr(s,n),this.addWeeks=(s,n)=>this.overrides?.addWeeks?this.overrides.addWeeks(s,n):un(s,n),this.addYears=(s,n)=>this.overrides?.addYears?this.overrides.addYears(s,n):fn(s,n),this.differenceInCalendarDays=(s,n)=>this.overrides?.differenceInCalendarDays?this.overrides.differenceInCalendarDays(s,n):Is(s,n),this.differenceInCalendarMonths=(s,n)=>this.overrides?.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(s,n):Zs(s,n),this.eachMonthOfInterval=s=>this.overrides?.eachMonthOfInterval?this.overrides.eachMonthOfInterval(s):pn(s),this.eachYearOfInterval=s=>{const n=this.overrides?.eachYearOfInterval?this.overrides.eachYearOfInterval(s):vn(s),l=new Set(n.map(i=>this.getYear(i)));if(l.size===n.length)return n;const a=[];return l.forEach(i=>{a.push(new Date(i,0,1))}),a},this.endOfBroadcastWeek=s=>this.overrides?.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(s):uo(s,this),this.endOfISOWeek=s=>this.overrides?.endOfISOWeek?this.overrides.endOfISOWeek(s):yn(s),this.endOfMonth=s=>this.overrides?.endOfMonth?this.overrides.endOfMonth(s):Ks(s),this.endOfWeek=(s,n)=>this.overrides?.endOfWeek?this.overrides.endOfWeek(s,n):dr(s,this.options),this.endOfYear=s=>this.overrides?.endOfYear?this.overrides.endOfYear(s):gn(s),this.format=(s,n,l)=>{const a=this.overrides?.format?this.overrides.format(s,n,this.options):Ve(s,n,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(a):a},this.getISOWeek=s=>this.overrides?.getISOWeek?this.overrides.getISOWeek(s):Bs(s),this.getMonth=(s,n)=>this.overrides?.getMonth?this.overrides.getMonth(s,this.options):xn(s,this.options),this.getYear=(s,n)=>this.overrides?.getYear?this.overrides.getYear(s,this.options):wn(s,this.options),this.getWeek=(s,n)=>this.overrides?.getWeek?this.overrides.getWeek(s,this.options):Ys(s,this.options),this.isAfter=(s,n)=>this.overrides?.isAfter?this.overrides.isAfter(s,n):Sn(s,n),this.isBefore=(s,n)=>this.overrides?.isBefore?this.overrides.isBefore(s,n):Cn(s,n),this.isDate=s=>this.overrides?.isDate?this.overrides.isDate(s):zs(s),this.isSameDay=(s,n)=>this.overrides?.isSameDay?this.overrides.isSameDay(s,n):Xs(s,n),this.isSameMonth=(s,n)=>this.overrides?.isSameMonth?this.overrides.isSameMonth(s,n):Us(s,n),this.isSameYear=(s,n)=>this.overrides?.isSameYear?this.overrides.isSameYear(s,n):Nn(s,n),this.max=s=>this.overrides?.max?this.overrides.max(s):mn(s),this.min=s=>this.overrides?.min?this.overrides.min(s):hn(s),this.setMonth=(s,n)=>this.overrides?.setMonth?this.overrides.setMonth(s,n):_n(s,n),this.setYear=(s,n)=>this.overrides?.setYear?this.overrides.setYear(s,n):jn(s,n),this.startOfBroadcastWeek=(s,n)=>this.overrides?.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(s,this):Nr(s,this),this.startOfDay=s=>this.overrides?.startOfDay?this.overrides.startOfDay(s):$s(s),this.startOfISOWeek=s=>this.overrides?.startOfISOWeek?this.overrides.startOfISOWeek(s):Ls(s),this.startOfMonth=s=>this.overrides?.startOfMonth?this.overrides.startOfMonth(s):Gs(s),this.startOfWeek=(s,n)=>this.overrides?.startOfWeek?this.overrides.startOfWeek(s,this.options):Hs(s,this.options),this.startOfYear=s=>this.overrides?.startOfYear?this.overrides.startOfYear(s):qs(s),this.options={locale:ar,...t},this.overrides=r}getDigitMap(){const{numerals:t="latn"}=this.options,r=new Intl.NumberFormat("en-US",{numberingSystem:t}),s={};for(let n=0;n<10;n++)s[n.toString()]=r.format(n);return s}replaceDigits(t){const r=this.getDigitMap();return t.replace(/\d/g,s=>r[s]||s)}formatNumber(t){return this.replaceDigits(t.toString())}getMonthYearOrder(){const t=this.options.locale?.code;return t&&re.yearFirstLocales.has(t)?"year-first":"month-first"}formatMonthYear(t){const{locale:r,timeZone:s,numerals:n}=this.options,l=r?.code;if(l&&re.yearFirstLocales.has(l))try{return new Intl.DateTimeFormat(l,{month:"long",year:"numeric",timeZone:s,numberingSystem:n}).format(t)}catch{}const a=this.getMonthYearOrder()==="year-first"?"y LLLL":"LLLL y";return this.format(t,a)}}re.yearFirstLocales=new Set(["eu","hu","ja","ja-Hira","ja-JP","ko","ko-KR","lt","lt-LT","lv","lv-LV","mn","mn-MN","zh","zh-CN","zh-HK","zh-TW"]);const ue=new re;class _r{constructor(t,r,s=ue){this.date=t,this.displayMonth=r,this.outside=!!(r&&!s.isSameMonth(t,r)),this.dateLib=s,this.isoDate=s.format(t,"yyyy-MM-dd"),this.displayMonthId=s.format(r,"yyyy-MM"),this.dateMonthId=s.format(t,"yyyy-MM")}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class fo{constructor(t,r){this.date=t,this.weeks=r}}class mo{constructor(t,r){this.days=r,this.weekNumber=t}}function ho(e){return S.createElement("button",{...e})}function po(e){return S.createElement("span",{...e})}function go(e){const{size:t=24,orientation:r="left",className:s}=e;return S.createElement("svg",{className:s,width:t,height:t,viewBox:"0 0 24 24"},r==="up"&&S.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),r==="down"&&S.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),r==="left"&&S.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),r==="right"&&S.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function vo(e){const{day:t,modifiers:r,...s}=e;return S.createElement("td",{...s})}function yo(e){const{day:t,modifiers:r,...s}=e,n=S.useRef(null);return S.useEffect(()=>{r.focused&&n.current?.focus()},[r.focused]),S.createElement("button",{ref:n,...s})}var M;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(M||(M={}));var z;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(z||(z={}));var ie;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(ie||(ie={}));var te;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(te||(te={}));function bo(e){const{options:t,className:r,components:s,classNames:n,...l}=e,a=[n[M.Dropdown],r].join(" "),i=t?.find(({value:c})=>c===l.value);return S.createElement("span",{"data-disabled":l.disabled,className:n[M.DropdownRoot]},S.createElement(s.Select,{className:a,...l},t?.map(({value:c,label:d,disabled:f})=>S.createElement(s.Option,{key:c,value:c,disabled:f},d))),S.createElement("span",{className:n[M.CaptionLabel],"aria-hidden":!0},i?.label,S.createElement(s.Chevron,{orientation:"down",size:18,className:n[M.Chevron]})))}function xo(e){return S.createElement("div",{...e})}function wo(e){return S.createElement("div",{...e})}function So(e){const{calendarMonth:t,displayIndex:r,...s}=e;return S.createElement("div",{...s},e.children)}function Co(e){const{calendarMonth:t,displayIndex:r,...s}=e;return S.createElement("div",{...s})}function No(e){return S.createElement("table",{...e})}function _o(e){return S.createElement("div",{...e})}const jr=u.createContext(void 0);function Ge(){const e=u.useContext(jr);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function jo(e){const{components:t}=Ge();return S.createElement(t.Dropdown,{...e})}function ko(e){const{onPreviousClick:t,onNextClick:r,previousMonth:s,nextMonth:n,...l}=e,{components:a,classNames:i,labels:{labelPrevious:c,labelNext:d}}=Ge(),f=u.useCallback(h=>{n&&r?.(h)},[n,r]),m=u.useCallback(h=>{s&&t?.(h)},[s,t]);return S.createElement("nav",{...l},S.createElement(a.PreviousMonthButton,{type:"button",className:i[M.PreviousMonthButton],tabIndex:s?void 0:-1,"aria-disabled":s?void 0:!0,"aria-label":c(s),onClick:m},S.createElement(a.Chevron,{disabled:s?void 0:!0,className:i[M.Chevron],orientation:"left"})),S.createElement(a.NextMonthButton,{type:"button",className:i[M.NextMonthButton],tabIndex:n?void 0:-1,"aria-disabled":n?void 0:!0,"aria-label":d(n),onClick:f},S.createElement(a.Chevron,{disabled:n?void 0:!0,orientation:"right",className:i[M.Chevron]})))}function Do(e){const{components:t}=Ge();return S.createElement(t.Button,{...e})}function Mo(e){return S.createElement("option",{...e})}function Oo(e){const{components:t}=Ge();return S.createElement(t.Button,{...e})}function Eo(e){const{rootRef:t,...r}=e;return S.createElement("div",{...r,ref:t})}function To(e){return S.createElement("select",{...e})}function Po(e){const{week:t,...r}=e;return S.createElement("tr",{...r})}function Ao(e){return S.createElement("th",{...e})}function Wo(e){return S.createElement("thead",{"aria-hidden":!0},S.createElement("tr",{...e}))}function Ro(e){const{week:t,...r}=e;return S.createElement("th",{...r})}function Fo(e){return S.createElement("th",{...e})}function Io(e){return S.createElement("tbody",{...e})}function Bo(e){const{components:t}=Ge();return S.createElement(t.Dropdown,{...e})}const Yo=Object.freeze(Object.defineProperty({__proto__:null,Button:ho,CaptionLabel:po,Chevron:go,Day:vo,DayButton:yo,Dropdown:bo,DropdownNav:xo,Footer:wo,Month:So,MonthCaption:Co,MonthGrid:No,Months:_o,MonthsDropdown:jo,Nav:ko,NextMonthButton:Do,Option:Mo,PreviousMonthButton:Oo,Root:Eo,Select:To,Week:Po,WeekNumber:Ro,WeekNumberHeader:Fo,Weekday:Ao,Weekdays:Wo,Weeks:Io,YearsDropdown:Bo},Symbol.toStringTag,{value:"Module"}));function pe(e,t,r=!1,s=ue){let{from:n,to:l}=e;const{differenceInCalendarDays:a,isSameDay:i}=s;return n&&l?(a(l,n)<0&&([n,l]=[l,n]),a(t,n)>=(r?1:0)&&a(l,t)>=(r?1:0)):!r&&l?i(l,t):!r&&n?i(n,t):!1}function Et(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function at(e){return!!(e&&typeof e=="object"&&"from"in e)}function Tt(e){return!!(e&&typeof e=="object"&&"after"in e)}function Pt(e){return!!(e&&typeof e=="object"&&"before"in e)}function kr(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function Dr(e,t){return Array.isArray(e)&&e.every(t.isDate)}function ge(e,t,r=ue){const s=Array.isArray(t)?t:[t],{isSameDay:n,differenceInCalendarDays:l,isAfter:a}=r;return s.some(i=>{if(typeof i=="boolean")return i;if(r.isDate(i))return n(e,i);if(Dr(i,r))return i.includes(e);if(at(i))return pe(i,e,!1,r);if(kr(i))return Array.isArray(i.dayOfWeek)?i.dayOfWeek.includes(e.getDay()):i.dayOfWeek===e.getDay();if(Et(i)){const c=l(i.before,e),d=l(i.after,e),f=c>0,m=d<0;return a(i.before,i.after)?m&&f:f||m}return Tt(i)?l(e,i.after)>0:Pt(i)?l(i.before,e)>0:typeof i=="function"?i(e):!1})}function zo(e,t,r,s,n){const{disabled:l,hidden:a,modifiers:i,showOutsideDays:c,broadcastCalendar:d,today:f=n.today()}=t,{isSameDay:m,isSameMonth:h,startOfMonth:p,isBefore:g,endOfMonth:C,isAfter:b}=n,y=r&&p(r),D=s&&C(s),w={[z.focused]:[],[z.outside]:[],[z.disabled]:[],[z.hidden]:[],[z.today]:[]},N={};for(const _ of e){const{date:v,displayMonth:j}=_,x=!!(j&&!h(v,j)),O=!!(y&&g(v,y)),T=!!(D&&b(v,D)),P=!!(l&&ge(v,l,n)),Y=!!(a&&ge(v,a,n))||O||T||!d&&!c&&x||d&&c===!1&&x,J=m(v,f);x&&w.outside.push(_),P&&w.disabled.push(_),Y&&w.hidden.push(_),J&&w.today.push(_),i&&Object.keys(i).forEach(q=>{const se=i?.[q];se&&ge(v,se,n)&&(N[q]?N[q].push(_):N[q]=[_])})}return _=>{const v={[z.focused]:!1,[z.disabled]:!1,[z.hidden]:!1,[z.outside]:!1,[z.today]:!1},j={};for(const x in w){const O=w[x];v[x]=O.some(T=>T===_)}for(const x in N)j[x]=N[x].some(O=>O===_);return{...v,...j}}}function $o(e,t,r={}){return Object.entries(e).filter(([,n])=>n===!0).reduce((n,[l])=>(r[l]?n.push(r[l]):t[z[l]]?n.push(t[z[l]]):t[ie[l]]&&n.push(t[ie[l]]),n),[t[M.Day]])}function Lo(e){return{...Yo,...e}}function Ho(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([r,s])=>{r.startsWith("data-")&&(t[r]=s)}),t}function qo(){const e={};for(const t in M)e[M[t]]=`rdp-${M[t]}`;for(const t in z)e[z[t]]=`rdp-${z[t]}`;for(const t in ie)e[ie[t]]=`rdp-${ie[t]}`;for(const t in te)e[te[t]]=`rdp-${te[t]}`;return e}function Mr(e,t,r){return(r??new re(t)).formatMonthYear(e)}const Vo=Mr;function Uo(e,t,r){return(r??new re(t)).format(e,"d")}function Go(e,t=ue){return t.format(e,"LLLL")}function Zo(e,t,r){return(r??new re(t)).format(e,"cccccc")}function Xo(e,t=ue){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function Ko(){return""}function Or(e,t=ue){return t.format(e,"yyyy")}const Jo=Or,Qo=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:Mr,formatDay:Uo,formatMonthCaption:Vo,formatMonthDropdown:Go,formatWeekNumber:Xo,formatWeekNumberHeader:Ko,formatWeekdayName:Zo,formatYearCaption:Jo,formatYearDropdown:Or},Symbol.toStringTag,{value:"Module"}));function ea(e){return e?.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e?.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...Qo,...e}}function ta(e,t,r,s,n){const{startOfMonth:l,startOfYear:a,endOfYear:i,eachMonthOfInterval:c,getMonth:d}=n;return c({start:a(e),end:i(e)}).map(h=>{const p=s.formatMonthDropdown(h,n),g=d(h),C=t&&h<l(t)||r&&h>l(r)||!1;return{value:g,label:p,disabled:C}})}function ra(e,t={},r={}){let s={...t?.[M.Day]};return Object.entries(e).filter(([,n])=>n===!0).forEach(([n])=>{s={...s,...r?.[n]}}),s}function sa(e,t,r,s){const n=s??e.today(),l=r?e.startOfBroadcastWeek(n,e):t?e.startOfISOWeek(n):e.startOfWeek(n),a=[];for(let i=0;i<7;i++){const c=e.addDays(l,i);a.push(c)}return a}function na(e,t,r,s,n=!1){if(!e||!t)return;const{startOfYear:l,endOfYear:a,eachYearOfInterval:i,getYear:c}=s,d=l(e),f=a(t),m=i({start:d,end:f});return n&&m.reverse(),m.map(h=>{const p=r.formatYearDropdown(h,s);return{value:c(h),label:p,disabled:!1}})}function Er(e,t,r,s){let n=(s??new re(r)).format(e,"PPPP");return t.today&&(n=`Today, ${n}`),t.selected&&(n=`${n}, selected`),n}const oa=Er;function Tr(e,t,r){return(r??new re(t)).formatMonthYear(e)}const aa=Tr;function ia(e,t,r,s){let n=(s??new re(r)).format(e,"PPPP");return t?.today&&(n=`Today, ${n}`),n}function la(e){return"Choose the Month"}function ca(){return""}function da(e){return"Go to the Next Month"}function ua(e){return"Go to the Previous Month"}function fa(e,t,r){return(r??new re(t)).format(e,"cccc")}function ma(e,t){return`Week ${e}`}function ha(e){return"Week Number"}function pa(e){return"Choose the Year"}const ga=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:aa,labelDay:oa,labelDayButton:Er,labelGrid:Tr,labelGridcell:ia,labelMonthDropdown:la,labelNav:ca,labelNext:da,labelPrevious:ua,labelWeekNumber:ma,labelWeekNumberHeader:ha,labelWeekday:fa,labelYearDropdown:pa},Symbol.toStringTag,{value:"Module"})),Ze=e=>e instanceof HTMLElement?e:null,bt=e=>[...e.querySelectorAll("[data-animated-month]")??[]],va=e=>Ze(e.querySelector("[data-animated-month]")),xt=e=>Ze(e.querySelector("[data-animated-caption]")),wt=e=>Ze(e.querySelector("[data-animated-weeks]")),ya=e=>Ze(e.querySelector("[data-animated-nav]")),ba=e=>Ze(e.querySelector("[data-animated-weekdays]"));function xa(e,t,{classNames:r,months:s,focused:n,dateLib:l}){const a=u.useRef(null),i=u.useRef(s),c=u.useRef(!1);u.useLayoutEffect(()=>{const d=i.current;if(i.current=s,!t||!e.current||!(e.current instanceof HTMLElement)||s.length===0||d.length===0||s.length!==d.length)return;const f=l.isSameMonth(s[0].date,d[0].date),m=l.isAfter(s[0].date,d[0].date),h=m?r[te.caption_after_enter]:r[te.caption_before_enter],p=m?r[te.weeks_after_enter]:r[te.weeks_before_enter],g=a.current,C=e.current.cloneNode(!0);if(C instanceof HTMLElement?(bt(C).forEach(w=>{if(!(w instanceof HTMLElement))return;const N=va(w);N&&w.contains(N)&&w.removeChild(N);const _=xt(w);_&&_.classList.remove(h);const v=wt(w);v&&v.classList.remove(p)}),a.current=C):a.current=null,c.current||f||n)return;const b=g instanceof HTMLElement?bt(g):[],y=bt(e.current);if(y?.every(D=>D instanceof HTMLElement)&&b&&b.every(D=>D instanceof HTMLElement)){c.current=!0,e.current.style.isolation="isolate";const D=ya(e.current);D&&(D.style.zIndex="1"),y.forEach((w,N)=>{const _=b[N];if(!_)return;w.style.position="relative",w.style.overflow="hidden";const v=xt(w);v&&v.classList.add(h);const j=wt(w);j&&j.classList.add(p);const x=()=>{c.current=!1,e.current&&(e.current.style.isolation=""),D&&(D.style.zIndex=""),v&&v.classList.remove(h),j&&j.classList.remove(p),w.style.position="",w.style.overflow="",w.contains(_)&&w.removeChild(_)};_.style.pointerEvents="none",_.style.position="absolute",_.style.overflow="hidden",_.setAttribute("aria-hidden","true");const O=ba(_);O&&(O.style.opacity="0");const T=xt(_);T&&(T.classList.add(m?r[te.caption_before_exit]:r[te.caption_after_exit]),T.addEventListener("animationend",x));const P=wt(_);P&&P.classList.add(m?r[te.weeks_before_exit]:r[te.weeks_after_exit]),w.insertBefore(_,w.firstChild)})}})}function wa(e,t,r,s){const n=e[0],l=e[e.length-1],{ISOWeek:a,fixedWeeks:i,broadcastCalendar:c}=r??{},{addDays:d,differenceInCalendarDays:f,differenceInCalendarMonths:m,endOfBroadcastWeek:h,endOfISOWeek:p,endOfMonth:g,endOfWeek:C,isAfter:b,startOfBroadcastWeek:y,startOfISOWeek:D,startOfWeek:w}=s,N=c?y(n,s):a?D(n):w(n),_=c?h(l):a?p(g(l)):C(g(l)),v=f(_,N),j=m(l,n)+1,x=[];for(let P=0;P<=v;P++){const Y=d(N,P);if(t&&b(Y,t))break;x.push(Y)}const T=(c?35:42)*j;if(i&&x.length<T){const P=T-x.length;for(let Y=0;Y<P;Y++){const J=d(x[x.length-1],1);x.push(J)}}return x}function Sa(e){const t=[];return e.reduce((r,s)=>{const n=s.weeks.reduce((l,a)=>l.concat(a.days.slice()),t.slice());return r.concat(n.slice())},t.slice())}function Ca(e,t,r,s){const{numberOfMonths:n=1}=r,l=[];for(let a=0;a<n;a++){const i=s.addMonths(e,a);if(t&&i>t)break;l.push(i)}return l}function Ut(e,t,r,s){const{month:n,defaultMonth:l,today:a=s.today(),numberOfMonths:i=1}=e;let c=n||l||a;const{differenceInCalendarMonths:d,addMonths:f,startOfMonth:m}=s;if(r&&d(r,c)<i-1){const h=-1*(i-1);c=f(r,h)}return t&&d(c,t)<0&&(c=t),m(c)}function Na(e,t,r,s){const{addDays:n,endOfBroadcastWeek:l,endOfISOWeek:a,endOfMonth:i,endOfWeek:c,getISOWeek:d,getWeek:f,startOfBroadcastWeek:m,startOfISOWeek:h,startOfWeek:p}=s,g=e.reduce((C,b)=>{const y=r.broadcastCalendar?m(b,s):r.ISOWeek?h(b):p(b),D=r.broadcastCalendar?l(b):r.ISOWeek?a(i(b)):c(i(b)),w=t.filter(j=>j>=y&&j<=D),N=r.broadcastCalendar?35:42;if(r.fixedWeeks&&w.length<N){const j=t.filter(x=>{const O=N-w.length;return x>D&&x<=n(D,O)});w.push(...j)}const _=w.reduce((j,x)=>{const O=r.ISOWeek?d(x):f(x),T=j.find(Y=>Y.weekNumber===O),P=new _r(x,b,s);return T?T.days.push(P):j.push(new mo(O,[P])),j},[]),v=new fo(b,_);return C.push(v),C},[]);return r.reverseMonths?g.reverse():g}function _a(e,t){let{startMonth:r,endMonth:s}=e;const{startOfYear:n,startOfDay:l,startOfMonth:a,endOfMonth:i,addYears:c,endOfYear:d,newDate:f,today:m}=t,{fromYear:h,toYear:p,fromMonth:g,toMonth:C}=e;!r&&g&&(r=g),!r&&h&&(r=t.newDate(h,0,1)),!s&&C&&(s=C),!s&&p&&(s=f(p,11,31));const b=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return r?r=a(r):h?r=f(h,0,1):!r&&b&&(r=n(c(e.today??m(),-100))),s?s=i(s):p?s=f(p,11,31):!s&&b&&(s=d(e.today??m())),[r&&l(r),s&&l(s)]}function ja(e,t,r,s){if(r.disableNavigation)return;const{pagedNavigation:n,numberOfMonths:l=1}=r,{startOfMonth:a,addMonths:i,differenceInCalendarMonths:c}=s,d=n?l:1,f=a(e);if(!t)return i(f,d);if(!(c(t,e)<l))return i(f,d)}function ka(e,t,r,s){if(r.disableNavigation)return;const{pagedNavigation:n,numberOfMonths:l}=r,{startOfMonth:a,addMonths:i,differenceInCalendarMonths:c}=s,d=n?l??1:1,f=a(e);if(!t)return i(f,-d);if(!(c(f,t)<=0))return i(f,-d)}function Da(e){const t=[];return e.reduce((r,s)=>r.concat(s.weeks.slice()),t.slice())}function it(e,t){const[r,s]=u.useState(e);return[t===void 0?r:t,s]}function Ma(e,t){const[r,s]=_a(e,t),{startOfMonth:n,endOfMonth:l}=t,a=Ut(e,r,s,t),[i,c]=it(a,e.month?a:void 0);u.useEffect(()=>{const N=Ut(e,r,s,t);c(N)},[e.timeZone]);const{months:d,weeks:f,days:m,previousMonth:h,nextMonth:p}=u.useMemo(()=>{const N=Ca(i,s,{numberOfMonths:e.numberOfMonths},t),_=wa(N,e.endMonth?l(e.endMonth):void 0,{ISOWeek:e.ISOWeek,fixedWeeks:e.fixedWeeks,broadcastCalendar:e.broadcastCalendar},t),v=Na(N,_,{broadcastCalendar:e.broadcastCalendar,fixedWeeks:e.fixedWeeks,ISOWeek:e.ISOWeek,reverseMonths:e.reverseMonths},t),j=Da(v),x=Sa(v),O=ka(i,r,e,t),T=ja(i,s,e,t);return{months:v,weeks:j,days:x,previousMonth:O,nextMonth:T}},[t,i.getTime(),s?.getTime(),r?.getTime(),e.disableNavigation,e.broadcastCalendar,e.endMonth?.getTime(),e.fixedWeeks,e.ISOWeek,e.numberOfMonths,e.pagedNavigation,e.reverseMonths]),{disableNavigation:g,onMonthChange:C}=e,b=N=>f.some(_=>_.days.some(v=>v.isEqualTo(N))),y=N=>{if(g)return;let _=n(N);r&&_<n(r)&&(_=n(r)),s&&_>n(s)&&(_=n(s)),c(_),C?.(_)};return{months:d,weeks:f,days:m,navStart:r,navEnd:s,previousMonth:h,nextMonth:p,goToMonth:y,goToDay:N=>{b(N)||y(N.date)}}}var ce;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(ce||(ce={}));function Gt(e){return!e[z.disabled]&&!e[z.hidden]&&!e[z.outside]}function Oa(e,t,r,s){let n,l=-1;for(const a of e){const i=t(a);Gt(i)&&(i[z.focused]&&l<ce.FocusedModifier?(n=a,l=ce.FocusedModifier):s?.isEqualTo(a)&&l<ce.LastFocused?(n=a,l=ce.LastFocused):r(a.date)&&l<ce.Selected?(n=a,l=ce.Selected):i[z.today]&&l<ce.Today&&(n=a,l=ce.Today))}return n||(n=e.find(a=>Gt(t(a)))),n}function Ea(e,t,r,s,n,l,a){const{ISOWeek:i,broadcastCalendar:c}=l,{addDays:d,addMonths:f,addWeeks:m,addYears:h,endOfBroadcastWeek:p,endOfISOWeek:g,endOfWeek:C,max:b,min:y,startOfBroadcastWeek:D,startOfISOWeek:w,startOfWeek:N}=a;let v={day:d,week:m,month:f,year:h,startOfWeek:j=>c?D(j,a):i?w(j):N(j),endOfWeek:j=>c?p(j):i?g(j):C(j)}[e](r,t==="after"?1:-1);return t==="before"&&s?v=b([s,v]):t==="after"&&n&&(v=y([n,v])),v}function Pr(e,t,r,s,n,l,a,i=0){if(i>365)return;const c=Ea(e,t,r.date,s,n,l,a),d=!!(l.disabled&&ge(c,l.disabled,a)),f=!!(l.hidden&&ge(c,l.hidden,a)),m=c,h=new _r(c,m,a);return!d&&!f?h:Pr(e,t,h,s,n,l,a,i+1)}function Ta(e,t,r,s,n){const{autoFocus:l}=e,[a,i]=u.useState(),c=Oa(t.days,r,s||(()=>!1),a),[d,f]=u.useState(l?c:void 0);return{isFocusTarget:C=>!!c?.isEqualTo(C),setFocused:f,focused:d,blur:()=>{i(d),f(void 0)},moveFocus:(C,b)=>{if(!d)return;const y=Pr(C,b,d,t.navStart,t.navEnd,e,n);y&&(e.disableNavigation&&!t.days.some(w=>w.isEqualTo(y))||(t.goToDay(y),f(y)))}}}function Pa(e,t){const{selected:r,required:s,onSelect:n}=e,[l,a]=it(r,n?r:void 0),i=n?r:l,{isSameDay:c}=t,d=p=>i?.some(g=>c(g,p))??!1,{min:f,max:m}=e;return{selected:i,select:(p,g,C)=>{let b=[...i??[]];if(d(p)){if(i?.length===f||s&&i?.length===1)return;b=i?.filter(y=>!c(y,p))}else i?.length===m?b=[p]:b=[...b,p];return n||a(b),n?.(b,p,g,C),b},isSelected:d}}function Aa(e,t,r=0,s=0,n=!1,l=ue){const{from:a,to:i}=t||{},{isSameDay:c,isAfter:d,isBefore:f}=l;let m;if(!a&&!i)m={from:e,to:r>0?void 0:e};else if(a&&!i)c(a,e)?r===0?m={from:a,to:e}:n?m={from:a,to:void 0}:m=void 0:f(e,a)?m={from:e,to:a}:m={from:a,to:e};else if(a&&i)if(c(a,e)&&c(i,e))n?m={from:a,to:i}:m=void 0;else if(c(a,e))m={from:a,to:r>0?void 0:e};else if(c(i,e))m={from:e,to:r>0?void 0:e};else if(f(e,a))m={from:e,to:i};else if(d(e,a))m={from:a,to:e};else if(d(e,i))m={from:a,to:e};else throw new Error("Invalid range");if(m?.from&&m?.to){const h=l.differenceInCalendarDays(m.to,m.from);s>0&&h>s?m={from:e,to:void 0}:r>1&&h<r&&(m={from:e,to:void 0})}return m}function Wa(e,t,r=ue){const s=Array.isArray(t)?t:[t];let n=e.from;const l=r.differenceInCalendarDays(e.to,e.from),a=Math.min(l,6);for(let i=0;i<=a;i++){if(s.includes(n.getDay()))return!0;n=r.addDays(n,1)}return!1}function Zt(e,t,r=ue){return pe(e,t.from,!1,r)||pe(e,t.to,!1,r)||pe(t,e.from,!1,r)||pe(t,e.to,!1,r)}function Ra(e,t,r=ue){const s=Array.isArray(t)?t:[t];if(s.filter(i=>typeof i!="function").some(i=>typeof i=="boolean"?i:r.isDate(i)?pe(e,i,!1,r):Dr(i,r)?i.some(c=>pe(e,c,!1,r)):at(i)?i.from&&i.to?Zt(e,{from:i.from,to:i.to},r):!1:kr(i)?Wa(e,i.dayOfWeek,r):Et(i)?r.isAfter(i.before,i.after)?Zt(e,{from:r.addDays(i.after,1),to:r.addDays(i.before,-1)},r):ge(e.from,i,r)||ge(e.to,i,r):Tt(i)||Pt(i)?ge(e.from,i,r)||ge(e.to,i,r):!1))return!0;const a=s.filter(i=>typeof i=="function");if(a.length){let i=e.from;const c=r.differenceInCalendarDays(e.to,e.from);for(let d=0;d<=c;d++){if(a.some(f=>f(i)))return!0;i=r.addDays(i,1)}}return!1}function Fa(e,t){const{disabled:r,excludeDisabled:s,selected:n,required:l,onSelect:a}=e,[i,c]=it(n,a?n:void 0),d=a?n:i;return{selected:d,select:(h,p,g)=>{const{min:C,max:b}=e,y=h?Aa(h,d,C,b,l,t):void 0;return s&&r&&y?.from&&y.to&&Ra({from:y.from,to:y.to},r,t)&&(y.from=h,y.to=void 0),a||c(y),a?.(y,h,p,g),y},isSelected:h=>d&&pe(d,h,!1,t)}}function Ia(e,t){const{selected:r,required:s,onSelect:n}=e,[l,a]=it(r,n?r:void 0),i=n?r:l,{isSameDay:c}=t;return{selected:i,select:(m,h,p)=>{let g=m;return!s&&i&&i&&c(m,i)&&(g=void 0),n||a(g),n?.(g,m,h,p),g},isSelected:m=>i?c(i,m):!1}}function Ba(e,t){const r=Ia(e,t),s=Pa(e,t),n=Fa(e,t);switch(e.mode){case"single":return r;case"multiple":return s;case"range":return n;default:return}}function V(e,t){return e instanceof he&&e.timeZone===t?e:new he(e,t)}function Xt(e,t){return typeof e=="boolean"||typeof e=="function"?e:e instanceof Date?V(e,t):Array.isArray(e)?e.map(r=>r instanceof Date?V(r,t):r):at(e)?{...e,from:e.from?V(e.from,t):e.from,to:e.to?V(e.to,t):e.to}:Et(e)?{before:V(e.before,t),after:V(e.after,t)}:Tt(e)?{after:V(e.after,t)}:Pt(e)?{before:V(e.before,t)}:e}function St(e,t){return e&&(Array.isArray(e)?e.map(r=>Xt(r,t)):Xt(e,t))}function Ya(e){let t=e;const r=t.timeZone;if(r&&(t={...e,timeZone:r},t.today&&(t.today=V(t.today,r)),t.month&&(t.month=V(t.month,r)),t.defaultMonth&&(t.defaultMonth=V(t.defaultMonth,r)),t.startMonth&&(t.startMonth=V(t.startMonth,r)),t.endMonth&&(t.endMonth=V(t.endMonth,r)),t.mode==="single"&&t.selected?t.selected=V(t.selected,r):t.mode==="multiple"&&t.selected?t.selected=t.selected?.map(A=>V(A,r)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?V(t.selected.from,r):t.selected.from,to:t.selected.to?V(t.selected.to,r):t.selected.to}),t.disabled!==void 0&&(t.disabled=St(t.disabled,r)),t.hidden!==void 0&&(t.hidden=St(t.hidden,r)),t.modifiers)){const A={};Object.keys(t.modifiers).forEach(B=>{A[B]=St(t.modifiers?.[B],r)}),t.modifiers=A}const{components:s,formatters:n,labels:l,dateLib:a,locale:i,classNames:c}=u.useMemo(()=>{const A={...ar,...t.locale};return{dateLib:new re({locale:A,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:Lo(t.components),formatters:ea(t.formatters),labels:{...ga,...t.labels},locale:A,classNames:{...qo(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]);t.today||(t={...t,today:a.today()});const{captionLayout:d,mode:f,navLayout:m,numberOfMonths:h=1,onDayBlur:p,onDayClick:g,onDayFocus:C,onDayKeyDown:b,onDayMouseEnter:y,onDayMouseLeave:D,onNextClick:w,onPrevClick:N,showWeekNumber:_,styles:v}=t,{formatCaption:j,formatDay:x,formatMonthDropdown:O,formatWeekNumber:T,formatWeekNumberHeader:P,formatWeekdayName:Y,formatYearDropdown:J}=n,q=Ma(t,a),{days:se,months:Me,navStart:Z,navEnd:Se,previousMonth:Q,nextMonth:U,goToMonth:G}=q,me=zo(se,t,Z,Se,a),{isSelected:Oe,select:Ee,selected:Ce}=Ba(t,a)??{},{blur:Fe,focused:ye,isFocusTarget:Xe,moveFocus:Ie,setFocused:Ne}=Ta(t,q,me,Oe??(()=>!1),a),{labelDayButton:Ke,labelGridcell:Je,labelGrid:Qe,labelMonthDropdown:dt,labelNav:et,labelPrevious:ut,labelNext:ft,labelWeekday:k,labelWeekNumber:W,labelWeekNumberHeader:$,labelYearDropdown:X}=l,_e=u.useMemo(()=>sa(a,t.ISOWeek,t.broadcastCalendar,t.today),[a,t.ISOWeek,t.broadcastCalendar,t.today]),It=f!==void 0||g!==void 0,mt=u.useCallback(()=>{Q&&(G(Q),N?.(Q))},[Q,G,N]),ht=u.useCallback(()=>{U&&(G(U),w?.(U))},[G,U,w]),Zr=u.useCallback((A,B)=>E=>{E.preventDefault(),E.stopPropagation(),Ne(A),Ee?.(A.date,B,E),g?.(A.date,B,E)},[Ee,g,Ne]),Xr=u.useCallback((A,B)=>E=>{Ne(A),C?.(A.date,B,E)},[C,Ne]),Kr=u.useCallback((A,B)=>E=>{Fe(),p?.(A.date,B,E)},[Fe,p]),Jr=u.useCallback((A,B)=>E=>{const I={ArrowLeft:[E.shiftKey?"month":"day",t.dir==="rtl"?"after":"before"],ArrowRight:[E.shiftKey?"month":"day",t.dir==="rtl"?"before":"after"],ArrowDown:[E.shiftKey?"year":"week","after"],ArrowUp:[E.shiftKey?"year":"week","before"],PageUp:[E.shiftKey?"year":"month","before"],PageDown:[E.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(I[E.key]){E.preventDefault(),E.stopPropagation();const[le,R]=I[E.key];Ie(le,R)}b?.(A.date,B,E)},[Ie,b,t.dir]),Qr=u.useCallback((A,B)=>E=>{y?.(A.date,B,E)},[y]),es=u.useCallback((A,B)=>E=>{D?.(A.date,B,E)},[D]),ts=u.useCallback(A=>B=>{const E=Number(B.target.value),I=a.setMonth(a.startOfMonth(A),E);G(I)},[a,G]),rs=u.useCallback(A=>B=>{const E=Number(B.target.value),I=a.setYear(a.startOfMonth(A),E);G(I)},[a,G]),{className:ss,style:ns}=u.useMemo(()=>({className:[c[M.Root],t.className].filter(Boolean).join(" "),style:{...v?.[M.Root],...t.style}}),[c,t.className,t.style,v]),os=Ho(t),Bt=u.useRef(null);xa(Bt,!!t.animate,{classNames:c,months:Me,focused:ye,dateLib:a});const as={dayPickerProps:t,selected:Ce,select:Ee,isSelected:Oe,months:Me,nextMonth:U,previousMonth:Q,goToMonth:G,getModifiers:me,components:s,classNames:c,styles:v,labels:l,formatters:n};return S.createElement(jr.Provider,{value:as},S.createElement(s.Root,{rootRef:t.animate?Bt:void 0,className:ss,style:ns,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],"aria-labelledby":t["aria-labelledby"],...os},S.createElement(s.Months,{className:c[M.Months],style:v?.[M.Months]},!t.hideNavigation&&!m&&S.createElement(s.Nav,{"data-animated-nav":t.animate?"true":void 0,className:c[M.Nav],style:v?.[M.Nav],"aria-label":et(),onPreviousClick:mt,onNextClick:ht,previousMonth:Q,nextMonth:U}),Me.map((A,B)=>S.createElement(s.Month,{"data-animated-month":t.animate?"true":void 0,className:c[M.Month],style:v?.[M.Month],key:B,displayIndex:B,calendarMonth:A},m==="around"&&!t.hideNavigation&&B===0&&S.createElement(s.PreviousMonthButton,{type:"button",className:c[M.PreviousMonthButton],tabIndex:Q?void 0:-1,"aria-disabled":Q?void 0:!0,"aria-label":ut(Q),onClick:mt,"data-animated-button":t.animate?"true":void 0},S.createElement(s.Chevron,{disabled:Q?void 0:!0,className:c[M.Chevron],orientation:t.dir==="rtl"?"right":"left"})),S.createElement(s.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:c[M.MonthCaption],style:v?.[M.MonthCaption],calendarMonth:A,displayIndex:B},d?.startsWith("dropdown")?S.createElement(s.DropdownNav,{className:c[M.Dropdowns],style:v?.[M.Dropdowns]},(()=>{const E=d==="dropdown"||d==="dropdown-months"?S.createElement(s.MonthsDropdown,{key:"month",className:c[M.MonthsDropdown],"aria-label":dt(),classNames:c,components:s,disabled:!!t.disableNavigation,onChange:ts(A.date),options:ta(A.date,Z,Se,n,a),style:v?.[M.Dropdown],value:a.getMonth(A.date)}):S.createElement("span",{key:"month"},O(A.date,a)),I=d==="dropdown"||d==="dropdown-years"?S.createElement(s.YearsDropdown,{key:"year",className:c[M.YearsDropdown],"aria-label":X(a.options),classNames:c,components:s,disabled:!!t.disableNavigation,onChange:rs(A.date),options:na(Z,Se,n,a,!!t.reverseYears),style:v?.[M.Dropdown],value:a.getYear(A.date)}):S.createElement("span",{key:"year"},J(A.date,a));return a.getMonthYearOrder()==="year-first"?[I,E]:[E,I]})(),S.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},j(A.date,a.options,a))):S.createElement(s.CaptionLabel,{className:c[M.CaptionLabel],role:"status","aria-live":"polite"},j(A.date,a.options,a))),m==="around"&&!t.hideNavigation&&B===h-1&&S.createElement(s.NextMonthButton,{type:"button",className:c[M.NextMonthButton],tabIndex:U?void 0:-1,"aria-disabled":U?void 0:!0,"aria-label":ft(U),onClick:ht,"data-animated-button":t.animate?"true":void 0},S.createElement(s.Chevron,{disabled:U?void 0:!0,className:c[M.Chevron],orientation:t.dir==="rtl"?"left":"right"})),B===h-1&&m==="after"&&!t.hideNavigation&&S.createElement(s.Nav,{"data-animated-nav":t.animate?"true":void 0,className:c[M.Nav],style:v?.[M.Nav],"aria-label":et(),onPreviousClick:mt,onNextClick:ht,previousMonth:Q,nextMonth:U}),S.createElement(s.MonthGrid,{role:"grid","aria-multiselectable":f==="multiple"||f==="range","aria-label":Qe(A.date,a.options,a)||void 0,className:c[M.MonthGrid],style:v?.[M.MonthGrid]},!t.hideWeekdays&&S.createElement(s.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:c[M.Weekdays],style:v?.[M.Weekdays]},_&&S.createElement(s.WeekNumberHeader,{"aria-label":$(a.options),className:c[M.WeekNumberHeader],style:v?.[M.WeekNumberHeader],scope:"col"},P()),_e.map(E=>S.createElement(s.Weekday,{"aria-label":k(E,a.options,a),className:c[M.Weekday],key:String(E),style:v?.[M.Weekday],scope:"col"},Y(E,a.options,a)))),S.createElement(s.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:c[M.Weeks],style:v?.[M.Weeks]},A.weeks.map(E=>S.createElement(s.Week,{className:c[M.Week],key:E.weekNumber,style:v?.[M.Week],week:E},_&&S.createElement(s.WeekNumber,{week:E,style:v?.[M.WeekNumber],"aria-label":W(E.weekNumber,{locale:i}),className:c[M.WeekNumber],scope:"row",role:"rowheader"},T(E.weekNumber,a)),E.days.map(I=>{const{date:le}=I,R=me(I);if(R[z.focused]=!R.hidden&&!!ye?.isEqualTo(I),R[ie.selected]=Oe?.(le)||R.selected,at(Ce)){const{from:pt,to:gt}=Ce;R[ie.range_start]=!!(pt&&gt&&a.isSameDay(le,pt)),R[ie.range_end]=!!(pt&&gt&&a.isSameDay(le,gt)),R[ie.range_middle]=pe(Ce,le,!0,a)}const is=ra(R,v,t.modifiersStyles),ls=$o(R,c,t.modifiersClassNames),cs=!It&&!R.hidden?Je(le,R,a.options,a):void 0;return S.createElement(s.Day,{key:`${I.isoDate}_${I.displayMonthId}`,day:I,modifiers:R,className:ls.join(" "),style:is,role:"gridcell","aria-selected":R.selected||void 0,"aria-label":cs,"data-day":I.isoDate,"data-month":I.outside?I.dateMonthId:void 0,"data-selected":R.selected||void 0,"data-disabled":R.disabled||void 0,"data-hidden":R.hidden||void 0,"data-outside":I.outside||void 0,"data-focused":R.focused||void 0,"data-today":R.today||void 0},!R.hidden&&It?S.createElement(s.DayButton,{className:c[M.DayButton],style:v?.[M.DayButton],type:"button",day:I,modifiers:R,disabled:!R.focused&&R.disabled||void 0,"aria-disabled":R.focused&&R.disabled||void 0,tabIndex:Xe(I)?0:-1,"aria-label":Ke(le,R,a.options,a),onClick:Zr(I,R),onBlur:Kr(I,R),onFocus:Xr(I,R),onKeyDown:Jr(I,R),onMouseEnter:Qr(I,R),onMouseLeave:es(I,R)},x(le,a.options,a)):!R.hidden&&x(I.date,a.options,a))})))))))),t.footer&&S.createElement(s.Footer,{className:c[M.Footer],style:v?.[M.Footer],role:"status","aria-live":"polite"},t.footer)))}const za=({mode:e="single",selected:t,onSelect:r,numberOfMonths:s=1,locale:n,initialFocus:l,...a})=>o.jsx(Ya,{mode:e,selected:t,onSelect:r,numberOfMonths:s,locale:n,initialFocus:l,...a}),$a=({onApply:e,onClear:t})=>{const[r,s]=u.useState({classes:[],activities:[],statuses:[],gradeRange:[0,10],dateRange:{from:null,to:null},plagiarismThreshold:70,onlyFlagged:!1}),n=()=>{e(r)},l=()=>{s({classes:[],activities:[],statuses:[],gradeRange:[0,10],dateRange:{from:null,to:null},plagiarismThreshold:70,onlyFlagged:!1}),t()};return o.jsxs(be,{className:"p-6 space-y-6",children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsx("h3",{className:"text-lg font-semibold",children:"Filtros AvanÃ§ados"}),o.jsxs(K,{variant:"ghost",size:"sm",onClick:l,children:[o.jsx(Js,{className:"w-4 h-4 mr-2"}),"Limpar Todos"]})]}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx(L,{className:"font-semibold",children:"Status da CorreÃ§Ã£o"}),o.jsx("div",{className:"space-y-2",children:["submitted","graded","needs_revision"].map(a=>o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(_t,{id:`status-${a}`,checked:r.statuses.includes(a),onCheckedChange:i=>{s(c=>({...c,statuses:i?[...c.statuses,a]:c.statuses.filter(d=>d!==a)}))}}),o.jsx(L,{htmlFor:`status-${a}`,className:"cursor-pointer text-sm",children:a==="submitted"?"NÃ£o Corrigidas":a==="graded"?"Corrigidas":"Necessitam RevisÃ£o"})]},a))})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(L,{className:"font-semibold",children:"Faixa de Nota (apenas corrigidas)"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx($t,{value:r.gradeRange,onValueChange:a=>s(i=>({...i,gradeRange:a})),min:0,max:10,step:.5,className:"w-full"}),o.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[o.jsx("span",{children:r.gradeRange[0]}),o.jsx("span",{children:r.gradeRange[1]})]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(L,{className:"font-semibold",children:"Data de SubmissÃ£o"}),o.jsxs(eo,{children:[o.jsx(to,{asChild:!0,children:o.jsxs(K,{variant:"outline",className:Pe("w-full justify-start text-left font-normal",!r.dateRange.from&&"text-muted-foreground"),children:[o.jsx(nr,{className:"mr-2 h-4 w-4"}),r.dateRange.from?r.dateRange.to?o.jsxs(o.Fragment,{children:[Ve(r.dateRange.from,"dd/MM/yyyy",{locale:Le})," -"," ",Ve(r.dateRange.to,"dd/MM/yyyy",{locale:Le})]}):Ve(r.dateRange.from,"dd/MM/yyyy",{locale:Le}):o.jsx("span",{children:"Selecione perÃ­odo"})]})}),o.jsx(Sr,{className:"w-auto p-0",align:"start",children:o.jsx(za,{initialFocus:!0,mode:"range",selected:r.dateRange,onSelect:a=>s(i=>({...i,dateRange:a||{from:null,to:null}})),numberOfMonths:2,locale:Le})})]})]}),o.jsxs("div",{className:"space-y-3",children:[o.jsx(L,{className:"font-semibold",children:"Originalidade MÃ­nima (%)"}),o.jsxs("div",{className:"space-y-2",children:[o.jsx($t,{value:[r.plagiarismThreshold],onValueChange:([a])=>s(i=>({...i,plagiarismThreshold:a})),min:0,max:100,step:5,className:"w-full"}),o.jsxs("div",{className:"text-sm text-center text-gray-600",children:["Mostrar apenas com originalidade < ",r.plagiarismThreshold,"%"]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx(L,{className:"font-semibold",children:"Outros Filtros"}),o.jsxs("div",{className:"flex items-center space-x-2",children:[o.jsx(_t,{id:"flagged",checked:r.onlyFlagged,onCheckedChange:a=>s(i=>({...i,onlyFlagged:a}))}),o.jsx(L,{htmlFor:"flagged",className:"cursor-pointer text-sm",children:"Apenas marcadas para revisÃ£o"})]})]})]}),o.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[o.jsx(K,{variant:"outline",onClick:l,children:"Limpar"}),o.jsx(K,{onClick:n,className:"bg-blue-600 hover:bg-blue-700",children:"Aplicar Filtros"})]})]})};function La(e,t){return u.useReducer((r,s)=>t[r][s]??r,e)}var At="ScrollArea",[Ar]=tr(At),[Ha,ae]=Ar(At),Wr=u.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:s="hover",dir:n,scrollHideDelay:l=600,...a}=e,[i,c]=u.useState(null),[d,f]=u.useState(null),[m,h]=u.useState(null),[p,g]=u.useState(null),[C,b]=u.useState(null),[y,D]=u.useState(0),[w,N]=u.useState(0),[_,v]=u.useState(!1),[j,x]=u.useState(!1),O=xe(t,P=>c(P)),T=Qs(n);return o.jsx(Ha,{scope:r,type:s,dir:T,scrollHideDelay:l,scrollArea:i,viewport:d,onViewportChange:f,content:m,onContentChange:h,scrollbarX:p,onScrollbarXChange:g,scrollbarXEnabled:_,onScrollbarXEnabledChange:v,scrollbarY:C,onScrollbarYChange:b,scrollbarYEnabled:j,onScrollbarYEnabledChange:x,onCornerWidthChange:D,onCornerHeightChange:N,children:o.jsx(De.div,{dir:T,...a,ref:O,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":w+"px",...e.style}})})});Wr.displayName=At;var Rr="ScrollAreaViewport",Fr=u.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:s,nonce:n,...l}=e,a=ae(Rr,r),i=u.useRef(null),c=xe(t,i,a.onViewportChange);return o.jsxs(o.Fragment,{children:[o.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:n}),o.jsx(De.div,{"data-radix-scroll-area-viewport":"",...l,ref:c,style:{overflowX:a.scrollbarXEnabled?"scroll":"hidden",overflowY:a.scrollbarYEnabled?"scroll":"hidden",...e.style},children:o.jsx("div",{ref:a.onContentChange,style:{minWidth:"100%",display:"table"},children:s})})]})});Fr.displayName=Rr;var fe="ScrollAreaScrollbar",Wt=u.forwardRef((e,t)=>{const{forceMount:r,...s}=e,n=ae(fe,e.__scopeScrollArea),{onScrollbarXEnabledChange:l,onScrollbarYEnabledChange:a}=n,i=e.orientation==="horizontal";return u.useEffect(()=>(i?l(!0):a(!0),()=>{i?l(!1):a(!1)}),[i,l,a]),n.type==="hover"?o.jsx(qa,{...s,ref:t,forceMount:r}):n.type==="scroll"?o.jsx(Va,{...s,ref:t,forceMount:r}):n.type==="auto"?o.jsx(Ir,{...s,ref:t,forceMount:r}):n.type==="always"?o.jsx(Rt,{...s,ref:t}):null});Wt.displayName=fe;var qa=u.forwardRef((e,t)=>{const{forceMount:r,...s}=e,n=ae(fe,e.__scopeScrollArea),[l,a]=u.useState(!1);return u.useEffect(()=>{const i=n.scrollArea;let c=0;if(i){const d=()=>{window.clearTimeout(c),a(!0)},f=()=>{c=window.setTimeout(()=>a(!1),n.scrollHideDelay)};return i.addEventListener("pointerenter",d),i.addEventListener("pointerleave",f),()=>{window.clearTimeout(c),i.removeEventListener("pointerenter",d),i.removeEventListener("pointerleave",f)}}},[n.scrollArea,n.scrollHideDelay]),o.jsx(Re,{present:r||l,children:o.jsx(Ir,{"data-state":l?"visible":"hidden",...s,ref:t})})}),Va=u.forwardRef((e,t)=>{const{forceMount:r,...s}=e,n=ae(fe,e.__scopeScrollArea),l=e.orientation==="horizontal",a=ct(()=>c("SCROLL_END"),100),[i,c]=La("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return u.useEffect(()=>{if(i==="idle"){const d=window.setTimeout(()=>c("HIDE"),n.scrollHideDelay);return()=>window.clearTimeout(d)}},[i,n.scrollHideDelay,c]),u.useEffect(()=>{const d=n.viewport,f=l?"scrollLeft":"scrollTop";if(d){let m=d[f];const h=()=>{const p=d[f];m!==p&&(c("SCROLL"),a()),m=p};return d.addEventListener("scroll",h),()=>d.removeEventListener("scroll",h)}},[n.viewport,l,c,a]),o.jsx(Re,{present:r||i!=="hidden",children:o.jsx(Rt,{"data-state":i==="hidden"?"hidden":"visible",...s,ref:t,onPointerEnter:ne(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:ne(e.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),Ir=u.forwardRef((e,t)=>{const r=ae(fe,e.__scopeScrollArea),{forceMount:s,...n}=e,[l,a]=u.useState(!1),i=e.orientation==="horizontal",c=ct(()=>{if(r.viewport){const d=r.viewport.offsetWidth<r.viewport.scrollWidth,f=r.viewport.offsetHeight<r.viewport.scrollHeight;a(i?d:f)}},10);return We(r.viewport,c),We(r.content,c),o.jsx(Re,{present:s||l,children:o.jsx(Rt,{"data-state":l?"visible":"hidden",...n,ref:t})})}),Rt=u.forwardRef((e,t)=>{const{orientation:r="vertical",...s}=e,n=ae(fe,e.__scopeScrollArea),l=u.useRef(null),a=u.useRef(0),[i,c]=u.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=Lr(i.viewport,i.content),f={...s,sizes:i,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:h=>l.current=h,onThumbPointerUp:()=>a.current=0,onThumbPointerDown:h=>a.current=h};function m(h,p){return Ja(h,a.current,i,p)}return r==="horizontal"?o.jsx(Ua,{...f,ref:t,onThumbPositionChange:()=>{if(n.viewport&&l.current){const h=n.viewport.scrollLeft,p=Kt(h,i,n.dir);l.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:h=>{n.viewport&&(n.viewport.scrollLeft=h)},onDragScroll:h=>{n.viewport&&(n.viewport.scrollLeft=m(h,n.dir))}}):r==="vertical"?o.jsx(Ga,{...f,ref:t,onThumbPositionChange:()=>{if(n.viewport&&l.current){const h=n.viewport.scrollTop,p=Kt(h,i);l.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:h=>{n.viewport&&(n.viewport.scrollTop=h)},onDragScroll:h=>{n.viewport&&(n.viewport.scrollTop=m(h))}}):null}),Ua=u.forwardRef((e,t)=>{const{sizes:r,onSizesChange:s,...n}=e,l=ae(fe,e.__scopeScrollArea),[a,i]=u.useState(),c=u.useRef(null),d=xe(t,c,l.onScrollbarXChange);return u.useEffect(()=>{c.current&&i(getComputedStyle(c.current))},[c]),o.jsx(Yr,{"data-orientation":"horizontal",...n,ref:d,sizes:r,style:{bottom:0,left:l.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:l.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":lt(r)+"px",...e.style},onThumbPointerDown:f=>e.onThumbPointerDown(f.x),onDragScroll:f=>e.onDragScroll(f.x),onWheelScroll:(f,m)=>{if(l.viewport){const h=l.viewport.scrollLeft+f.deltaX;e.onWheelScroll(h),qr(h,m)&&f.preventDefault()}},onResize:()=>{c.current&&l.viewport&&a&&s({content:l.viewport.scrollWidth,viewport:l.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:nt(a.paddingLeft),paddingEnd:nt(a.paddingRight)}})}})}),Ga=u.forwardRef((e,t)=>{const{sizes:r,onSizesChange:s,...n}=e,l=ae(fe,e.__scopeScrollArea),[a,i]=u.useState(),c=u.useRef(null),d=xe(t,c,l.onScrollbarYChange);return u.useEffect(()=>{c.current&&i(getComputedStyle(c.current))},[c]),o.jsx(Yr,{"data-orientation":"vertical",...n,ref:d,sizes:r,style:{top:0,right:l.dir==="ltr"?0:void 0,left:l.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":lt(r)+"px",...e.style},onThumbPointerDown:f=>e.onThumbPointerDown(f.y),onDragScroll:f=>e.onDragScroll(f.y),onWheelScroll:(f,m)=>{if(l.viewport){const h=l.viewport.scrollTop+f.deltaY;e.onWheelScroll(h),qr(h,m)&&f.preventDefault()}},onResize:()=>{c.current&&l.viewport&&a&&s({content:l.viewport.scrollHeight,viewport:l.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:nt(a.paddingTop),paddingEnd:nt(a.paddingBottom)}})}})}),[Za,Br]=Ar(fe),Yr=u.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:s,hasThumb:n,onThumbChange:l,onThumbPointerUp:a,onThumbPointerDown:i,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:f,onResize:m,...h}=e,p=ae(fe,r),[g,C]=u.useState(null),b=xe(t,O=>C(O)),y=u.useRef(null),D=u.useRef(""),w=p.viewport,N=s.content-s.viewport,_=je(f),v=je(c),j=ct(m,10);function x(O){if(y.current){const T=O.clientX-y.current.left,P=O.clientY-y.current.top;d({x:T,y:P})}}return u.useEffect(()=>{const O=T=>{const P=T.target;g?.contains(P)&&_(T,N)};return document.addEventListener("wheel",O,{passive:!1}),()=>document.removeEventListener("wheel",O,{passive:!1})},[w,g,N,_]),u.useEffect(v,[s,v]),We(g,j),We(p.content,j),o.jsx(Za,{scope:r,scrollbar:g,hasThumb:n,onThumbChange:je(l),onThumbPointerUp:je(a),onThumbPositionChange:v,onThumbPointerDown:je(i),children:o.jsx(De.div,{...h,ref:b,style:{position:"absolute",...h.style},onPointerDown:ne(e.onPointerDown,O=>{O.button===0&&(O.target.setPointerCapture(O.pointerId),y.current=g.getBoundingClientRect(),D.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),x(O))}),onPointerMove:ne(e.onPointerMove,x),onPointerUp:ne(e.onPointerUp,O=>{const T=O.target;T.hasPointerCapture(O.pointerId)&&T.releasePointerCapture(O.pointerId),document.body.style.webkitUserSelect=D.current,p.viewport&&(p.viewport.style.scrollBehavior=""),y.current=null})})})}),st="ScrollAreaThumb",zr=u.forwardRef((e,t)=>{const{forceMount:r,...s}=e,n=Br(st,e.__scopeScrollArea);return o.jsx(Re,{present:r||n.hasThumb,children:o.jsx(Xa,{ref:t,...s})})}),Xa=u.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:s,...n}=e,l=ae(st,r),a=Br(st,r),{onThumbPositionChange:i}=a,c=xe(t,m=>a.onThumbChange(m)),d=u.useRef(void 0),f=ct(()=>{d.current&&(d.current(),d.current=void 0)},100);return u.useEffect(()=>{const m=l.viewport;if(m){const h=()=>{if(f(),!d.current){const p=Qa(m,i);d.current=p,i()}};return i(),m.addEventListener("scroll",h),()=>m.removeEventListener("scroll",h)}},[l.viewport,f,i]),o.jsx(De.div,{"data-state":a.hasThumb?"visible":"hidden",...n,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...s},onPointerDownCapture:ne(e.onPointerDownCapture,m=>{const p=m.target.getBoundingClientRect(),g=m.clientX-p.left,C=m.clientY-p.top;a.onThumbPointerDown({x:g,y:C})}),onPointerUp:ne(e.onPointerUp,a.onThumbPointerUp)})});zr.displayName=st;var Ft="ScrollAreaCorner",$r=u.forwardRef((e,t)=>{const r=ae(Ft,e.__scopeScrollArea),s=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&s?o.jsx(Ka,{...e,ref:t}):null});$r.displayName=Ft;var Ka=u.forwardRef((e,t)=>{const{__scopeScrollArea:r,...s}=e,n=ae(Ft,r),[l,a]=u.useState(0),[i,c]=u.useState(0),d=!!(l&&i);return We(n.scrollbarX,()=>{const f=n.scrollbarX?.offsetHeight||0;n.onCornerHeightChange(f),c(f)}),We(n.scrollbarY,()=>{const f=n.scrollbarY?.offsetWidth||0;n.onCornerWidthChange(f),a(f)}),d?o.jsx(De.div,{...s,ref:t,style:{width:l,height:i,position:"absolute",right:n.dir==="ltr"?0:void 0,left:n.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function nt(e){return e?parseInt(e,10):0}function Lr(e,t){const r=e/t;return isNaN(r)?0:r}function lt(e){const t=Lr(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,s=(e.scrollbar.size-r)*t;return Math.max(s,18)}function Ja(e,t,r,s="ltr"){const n=lt(r),l=n/2,a=t||l,i=n-a,c=r.scrollbar.paddingStart+a,d=r.scrollbar.size-r.scrollbar.paddingEnd-i,f=r.content-r.viewport,m=s==="ltr"?[0,f]:[f*-1,0];return Hr([c,d],m)(e)}function Kt(e,t,r="ltr"){const s=lt(t),n=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,l=t.scrollbar.size-n,a=t.content-t.viewport,i=l-s,c=r==="ltr"?[0,a]:[a*-1,0],d=hs(e,c);return Hr([0,a],[0,i])(d)}function Hr(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const s=(t[1]-t[0])/(e[1]-e[0]);return t[0]+s*(r-e[0])}}function qr(e,t){return e>0&&e<t}var Qa=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},s=0;return(function n(){const l={left:e.scrollLeft,top:e.scrollTop},a=r.left!==l.left,i=r.top!==l.top;(a||i)&&t(),r=l,s=window.requestAnimationFrame(n)})(),()=>window.cancelAnimationFrame(s)};function ct(e,t){const r=je(e),s=u.useRef(0);return u.useEffect(()=>()=>window.clearTimeout(s.current),[]),u.useCallback(()=>{window.clearTimeout(s.current),s.current=window.setTimeout(r,t)},[r,t])}function We(e,t){const r=je(t);Ns(()=>{let s=0;if(e){const n=new ResizeObserver(()=>{cancelAnimationFrame(s),s=window.requestAnimationFrame(r)});return n.observe(e),()=>{window.cancelAnimationFrame(s),n.unobserve(e)}}},[e,r])}var Vr=Wr,ei=Fr,ti=$r;const Ur=u.forwardRef(({className:e,children:t,...r},s)=>o.jsxs(Vr,{ref:s,className:kt("relative overflow-hidden",e),...r,children:[o.jsx(ei,{className:"h-full w-full rounded-[inherit]",children:t}),o.jsx(Gr,{}),o.jsx(ti,{})]}));Ur.displayName=Vr.displayName;const Gr=u.forwardRef(({className:e,orientation:t="vertical",...r},s)=>o.jsx(Wt,{ref:s,orientation:t,className:kt("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 border-t border-t-transparent p-[1px]",e),...r,children:o.jsx(zr,{className:"relative flex-1 rounded-full bg-border"})}));Gr.displayName=Wt.displayName;const ri=({submissionIds:e,onClose:t})=>{const{toast:r}=Dt(),[s,n]=u.useState([]),[l,a]=u.useState(!0),[i,c]=u.useState(null),d=p=>{if(!p)return"";const g=p.content,C=p.activity;if(!g)return"";if(typeof g=="string")try{const b=JSON.parse(g);if(b&&typeof b=="object"){if(typeof b.answer=="string"&&b.answer.trim())return b.answer;if(typeof b.text=="string"&&b.text.trim())return b.text;const y=C?.content?.questions||[],D=b.selectedAnswers||b.answers||(y.length>0?b:null);if(D&&typeof D=="object"&&y.length>0){const w=[];if(y.forEach((N,_)=>{const v=N.id??_,j=D[v]??D[String(v)]??D[`question_${_}`];if(j==null||j==="")return;let x=null;if(N.alternatives&&N.alternatives.length>0){const T=String(j),P=N.alternatives.find(se=>String(se.id)===T),Y=N.alternatives.find(se=>String(se.letter)===T),J=N.alternatives.find(se=>se.text===j);x=(P||Y||J)?.text||T}else x=typeof j=="string"?j:JSON.stringify(j);const O=N.text||N.question||`QuestÃ£o ${_+1}`;w.push(`${O}: ${x}`)}),w.length>0)return w.join(`
`)}}return g}catch{return g}if(typeof g=="object"){if(typeof g.answer=="string"&&g.answer.trim())return g.answer;if(typeof g.text=="string"&&g.text.trim())return g.text;const b=C?.content?.questions||[],y=g.selectedAnswers||g.answers||(b.length>0?g:null);if(y&&typeof y=="object"&&b.length>0){const D=[];if(b.forEach((w,N)=>{const _=w.id??N,v=y[_]??y[String(_)]??y[`question_${N}`];if(v==null||v==="")return;let j=null;if(w.alternatives&&w.alternatives.length>0){const O=String(v),T=w.alternatives.find(q=>String(q.id)===O),P=w.alternatives.find(q=>String(q.letter)===O),Y=w.alternatives.find(q=>q.text===v);j=(T||P||Y)?.text||O}else j=typeof v=="string"?v:JSON.stringify(v);const x=w.text||w.question||`QuestÃ£o ${N+1}`;D.push(`${x}: ${j}`)}),D.length>0)return D.join(`
`)}try{return JSON.stringify(g)}catch{return""}}return""};u.useEffect(()=>{f()},[e]);const f=async()=>{a(!0);try{const p=e.map(b=>On(b)),C=(await Promise.all(p)).map(b=>b.data).filter(Boolean);if(n(C),C.length===2){const b=m(C[0],C[1]);c(b)}}catch(p){F.error("Erro ao carregar submissÃµes:",p)}finally{a(!1)}},m=(p,g)=>{const C=d(p)||"",b=d(g)||"",y=C.toLowerCase().split(/\s+/),D=b.toLowerCase().split(/\s+/),N=y.filter(_=>D.includes(_)).length/Math.max(y.length,D.length)*100;return Math.round(N)},h=p=>p>=80?"text-red-600 bg-red-100":p>=60?"text-yellow-600 bg-yellow-100":"text-green-600 bg-green-100";return l?o.jsx(Ct,{open:!0,onOpenChange:t,children:o.jsx(Nt,{className:"max-w-6xl h-[80vh]",children:o.jsx("div",{className:"flex items-center justify-center h-full",children:o.jsx("p",{children:"Carregando comparaÃ§Ã£o..."})})})}):o.jsx(Ct,{open:!0,onOpenChange:t,children:o.jsxs(Nt,{className:"max-w-7xl h-[90vh]",children:[o.jsx(Qt,{children:o.jsxs(er,{className:"flex items-center gap-2",children:[o.jsx(en,{className:"w-5 h-5"}),"ComparaÃ§Ã£o de SubmissÃµes"]})}),i!==null&&o.jsxs(be,{className:`p-4 ${h(i)}`,children:[o.jsxs("div",{className:"flex items-center justify-between",children:[o.jsxs("div",{className:"flex items-center gap-2",children:[o.jsx(tn,{className:"w-5 h-5"}),o.jsx("span",{className:"font-semibold",children:"Similaridade Detectada:"})]}),o.jsxs("div",{className:"text-2xl font-bold",children:[i,"%"]})]}),i>=60&&o.jsx("p",{className:"text-sm mt-2",children:"Alta similaridade detectada entre as submissÃµes. Recomenda-se revisÃ£o manual detalhada."})]}),o.jsx("div",{className:"grid grid-cols-2 gap-4 flex-1 overflow-hidden",children:s.map((p,g)=>o.jsxs(be,{className:"p-4 flex flex-col",children:[o.jsxs("div",{className:"mb-4",children:[o.jsx("h3",{className:"font-semibold text-lg",children:p.student?.full_name}),o.jsx("p",{className:"text-sm text-gray-600",children:p.activity?.title}),o.jsxs("div",{className:"flex gap-2 mt-2",children:[p.grade!==null&&o.jsxs(qe,{children:["Nota: ",p.grade]}),o.jsx(qe,{variant:"outline",children:p.status==="graded"?"Corrigida":"Pendente"})]})]}),o.jsx(Ur,{className:"flex-1",children:o.jsxs("div",{className:"pr-4",children:[o.jsx("h4",{className:"font-semibold mb-2",children:"SubmissÃ£o:"}),o.jsx("div",{className:"bg-gray-50 p-3 rounded whitespace-pre-wrap text-sm",children:d(p)||"Sem conteÃºdo"}),p.feedback&&o.jsxs(o.Fragment,{children:[o.jsx("h4",{className:"font-semibold mt-4 mb-2",children:"Feedback:"}),o.jsx("div",{className:"bg-blue-50 p-3 rounded text-sm",children:p.feedback})]})]})})]},p.id))}),o.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[o.jsxs("div",{className:"text-sm text-gray-600",children:["Comparando ",s.length," submissÃµes"]}),o.jsxs("div",{className:"flex gap-2",children:[o.jsx(K,{variant:"outline",onClick:t,children:"Fechar"}),o.jsx(K,{variant:"destructive",disabled:i<60,onClick:()=>{r({title:"ðŸš§ Em desenvolvimento",description:"Funcionalidade de marcar plÃ¡gio serÃ¡ implementada em breve."})},children:"Marcar como Suspeita"})]})]})]})})},pl=()=>{const{user:e}=Jt(),{toast:t}=Dt(),r=ds();us();const[s,n]=u.useState(!1),[l,a]=u.useState(!0),[i,c]=u.useState([]),[d,f]=u.useState([]),[m,h]=u.useState(null),[p,g]=u.useState(0),[C,b]=u.useState(!1),[y,D]=u.useState([]),[w,N]=u.useState(!1),[_,v]=u.useState(!1),[j,x]=u.useState("all"),[O,T]=u.useState(""),[P,Y]=u.useState("oldest"),[J,q]=u.useState(!1),[se,Me]=u.useState([]),[Z,Se]=u.useState(""),[Q,U]=u.useState([]),[G,me]=u.useState("all"),[Oe,Ee]=u.useState(!0),[Ce,Fe]=u.useState(!1),[ye,Xe]=u.useState({totalPending:0,correctedToday:0,avgGrade:0,avgTime:0}),Ie=u.useCallback(async()=>{if(e?.id)try{Ee(!0);const k=await Ss.getTeacherClasses(e.id);Me(k),(k.length===1||k.length>1)&&Se(k[0].id)}catch(k){yt(t,"NÃ£o foi possÃ­vel carregar as turmas.",k,{logPrefix:"[TeacherCorrectionsPage] Erro ao carregar turmas do professor"})}finally{Ee(!1)}},[e]),Ne=u.useCallback(async k=>{if(!k){U([]),me("all");return}try{Fe(!0);const W=await An.getActivitiesByClass(k),$=Array.isArray(W)?W.map(X=>({id:X.id,title:X.title,description:X.description,due_date:X.due_date,created_at:X.created_at,status:X.status,max_score:X.max_score})):[];U($),$.length===1?me($[0].id):me("all")}catch(W){yt(t,"NÃ£o foi possÃ­vel carregar as atividades desta turma.",W,{logPrefix:"[TeacherCorrectionsPage] Erro ao carregar atividades da turma"})}finally{Fe(!1)}},[]);u.useEffect(()=>{(async()=>{await Ie(),await Qe(),a(!1)})()},[Ie]),u.useEffect(()=>{Z?Ne(Z):(U([]),me(""))},[Z,Ne]),u.useEffect(()=>{Z&&Je()},[Z]);const Ke=u.useMemo(()=>{if(!i||i.length===0)return[];let k=[...i];if(G&&G!=="all"&&(k=k.filter(W=>W.activity_id===G)),j==="pending"?k=k.filter(W=>W.status==="submitted"):j==="graded"?k=k.filter(W=>W.status==="graded"):j==="flagged"&&(k=k.filter(W=>W.status==="needs_review")),O){const W=O.toLowerCase();k=k.filter($=>$.student?.full_name?.toLowerCase().includes(W)||$.activity?.title?.toLowerCase().includes(W))}return P==="newest"?k.sort((W,$)=>new Date($.submitted_at)-new Date(W.submitted_at)):P==="oldest"?k.sort((W,$)=>new Date(W.submitted_at)-new Date($.submitted_at)):P==="grade_asc"?k.sort((W,$)=>(W.grade||0)-($.grade||0)):P==="grade_desc"&&k.sort((W,$)=>($.grade||0)-(W.grade||0)),k},[i,G,j,O,P]);u.useEffect(()=>{f(Ke)},[Ke]);const Je=async()=>{if(!(!e||!Z))try{n(!0);const k={classId:Z,activityId:null,status:null,sortBy:P},{data:W,error:$}=await Mn(k);if($)throw $;c(W||[]);const X=W?.filter(_e=>_e.status==="submitted").length||0;Xe(_e=>({..._e,totalPending:X}))}catch(k){yt(t,"NÃ£o foi possÃ­vel carregar as submissÃµes.",k,{logPrefix:"[TeacherCorrectionsPage] Erro ao carregar submissÃµes para correÃ§Ã£o"})}finally{n(!1)}},Qe=async()=>{if(e)try{const{data:k}=await Pn(e.id,"day");k&&Xe(W=>({...W,correctedToday:k.corrections_count||0,avgGrade:k.avg_grade?.toFixed(1)||0,avgTime:Math.round(k.avg_time_per_correction/60)||0}))}catch(k){F.error("Erro ao carregar mÃ©tricas:",k)}},dt=(k,W=0)=>{r(`/dashboard/grading/${k.id}`)},et=()=>{if(y.length===0){t({title:"Erro",description:"Selecione pelo menos uma submissÃ£o",variant:"destructive"});return}N(!0)},ut=()=>{if(y.length!==2){t({title:"Erro",description:"Selecione exatamente 2 submissÃµes para comparar",variant:"destructive"});return}v(!0)},ft=()=>{t({title:"Em breve",description:"FunÃ§Ã£o de exportaÃ§Ã£o serÃ¡ implementada em breve."})};return l?o.jsx("div",{className:"flex items-center justify-center min-h-screen",children:o.jsx(fs,{size:"lg",text:"Carregando correÃ§Ãµes..."})}):o.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[o.jsx(ps,{title:"CorreÃ§Ãµes Pendentes",subtitle:`${ye.totalPending} submissÃµes aguardando correÃ§Ã£o`,role:"teacher"}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[o.jsx(tt,{title:"Pendentes",value:ye.totalPending,icon:rn,gradient:vt.warning,bgColor:"bg-yellow-50 dark:bg-yellow-950/30"}),o.jsx(tt,{title:"Corrigidas Hoje",value:ye.correctedToday,icon:sn,gradient:vt.success,bgColor:"bg-green-50 dark:bg-green-950/30"}),o.jsx(tt,{title:"MÃ©dia de Notas",value:ye.avgGrade,icon:nn,gradient:vt.info,bgColor:"bg-blue-50 dark:bg-blue-950/30"}),o.jsx(tt,{title:"Tempo MÃ©dio",value:`${ye.avgTime}min`,icon:on,gradient:"from-purple-500 to-pink-500",bgColor:"bg-purple-50 dark:bg-purple-950/30"})]}),o.jsx(be,{className:"p-6 mb-6",children:o.jsxs("div",{className:"space-y-6",children:[o.jsxs("div",{className:"space-y-4",children:[o.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:o.jsxs("div",{children:[o.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"CorreÃ§Ãµes"}),o.jsx("p",{className:"text-muted-foreground",children:j==="all"?"Todas as submissÃµes":j==="pending"?"SubmissÃµes aguardando correÃ§Ã£o":j==="graded"?"SubmissÃµes jÃ¡ corrigidas":"SubmissÃµes sinalizadas"})]})}),o.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium leading-none",children:"Turma"}),o.jsxs(Be,{value:Z,onValueChange:Se,disabled:Oe,children:[o.jsx(Ye,{children:o.jsx(ze,{placeholder:Oe?"Carregando turmas...":"Selecione uma turma"})}),o.jsx($e,{children:se.map(k=>o.jsx(ee,{value:k.id,children:k.name},k.id))})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium leading-none",children:"Atividade"}),o.jsxs(Be,{value:G,onValueChange:me,disabled:!Z||Ce,children:[o.jsx(Ye,{children:o.jsx(ze,{placeholder:Z?Ce?"Carregando atividades...":"Todas as atividades":"Selecione uma turma primeiro"})}),o.jsxs($e,{children:[o.jsx(ee,{value:"all",children:"Todas as atividades"}),Q.map(k=>o.jsx(ee,{value:k.id,children:k.title},k.id))]})]})]}),o.jsxs("div",{className:"space-y-2",children:[o.jsx("label",{className:"text-sm font-medium leading-none",children:"Status"}),o.jsxs(Be,{value:j,onValueChange:x,children:[o.jsx(Ye,{children:o.jsx(ze,{placeholder:"Todas"})}),o.jsxs($e,{children:[o.jsx(ee,{value:"all",children:"Todas"}),o.jsx(ee,{value:"pending",children:"Pendentes"}),o.jsx(ee,{value:"graded",children:"Corrigidas"}),o.jsx(ee,{value:"flagged",children:"Sinalizadas"})]})]})]})]}),o.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[o.jsxs("div",{className:"relative flex-1",children:[o.jsx(an,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),o.jsx(rt,{placeholder:"Buscar por aluno ou atividade...",className:"pl-9 w-full",value:O,onChange:k=>T(k.target.value)})]}),o.jsxs(Be,{value:P,onValueChange:Y,children:[o.jsx(Ye,{className:"w-full sm:w-[180px]",children:o.jsx(ze,{placeholder:"Ordenar por"})}),o.jsxs($e,{children:[o.jsx(ee,{value:"oldest",children:"Mais antigas primeiro"}),o.jsx(ee,{value:"newest",children:"Mais recentes primeiro"}),o.jsx(ee,{value:"grade_asc",children:"Nota: menor para maior"}),o.jsx(ee,{value:"grade_desc",children:"Nota: maior para menor"})]})]}),o.jsxs(K,{variant:"outline",onClick:()=>q(!J),className:"w-full sm:w-auto",children:[o.jsx(ln,{className:"mr-2 h-4 w-4"}),"Mais filtros"]})]})]}),o.jsxs("div",{className:"flex flex-wrap gap-3",children:[o.jsxs(K,{variant:"outline",onClick:ft,children:[o.jsx(cn,{className:"w-4 h-4 mr-2"}),"Exportar"]}),y.length>0&&o.jsxs(o.Fragment,{children:[o.jsxs(K,{variant:"outline",onClick:et,children:["CorreÃ§Ã£o em Lote (",y.length,")"]}),y.length===2&&o.jsx(K,{variant:"outline",onClick:ut,children:"Comparar SubmissÃµes"})]})]})]})}),J&&o.jsx("div",{className:"mb-6",children:o.jsx($a,{onApply:k=>{F.debug("Aplicar filtros avanÃ§ados:",k),t({title:"Filtros aplicados"})},onClear:()=>{q(!1)}})}),d.length>0?o.jsx("div",{className:"space-y-3",children:d.map((k,W)=>o.jsx(dn.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:W*.05},children:o.jsx(ro,{submission:k,onCorrect:()=>dt(k,W),isSelected:y.includes(k.id),onSelect:$=>{D(X=>$?[...X,k.id]:X.filter(_e=>_e!==k.id))}})},k.id))}):o.jsx(gs,{icon:or,title:"Nenhuma submissÃ£o encontrada",description:"NÃ£o hÃ¡ submissÃµes pendentes de correÃ§Ã£o no momento."}),w&&o.jsx(so,{submissions:i.filter(k=>y.includes(k.id)),onClose:()=>N(!1),onCompleted:()=>{N(!1),D([]),Je(),Qe()}}),_&&o.jsx(ri,{submissionIds:y,onClose:()=>v(!1)})]})};export{pl as default};
