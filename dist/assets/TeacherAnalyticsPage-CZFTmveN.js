import{c as ka,r as l,e as _a,b as Aa,u as wa,s as T,l as V,j as e,q as Ca}from"./main-5T23t4PA.js";import{C as X}from"./card-DPEV4PIe.js";import{B as se}from"./button-D1pRabHc.js";import{B as Fe}from"./badge-CHD2ppHT.js";import{D as Sa,a as Ea,b as Da,e as Me}from"./dropdown-menu-DW8ZoiSE.js";import{S as Oe,a as ze,b as Le,c as Re,d as q}from"./select-HrlLxAIu.js";import{C as Ge}from"./checkbox-1XgMgFvg.js";import"./tabs-BxEDXXe9.js";import{P as Pa}from"./progress-Bm8FaGK4.js";import{D as Ia,g as Y}from"./DashboardHeader-DpjdxJig.js";import{S as Q}from"./StatsCard-KdM1WoCa.js";import"./input-CtDVRTm_.js";import"./label-CaEiuH7k.js";import{u as Ta}from"./use-toast-DizLYaPb.js";import{a as Fa}from"./exportService-BZgAMV3f.js";import{B as Ma}from"./bell-CnpEDubq.js";import{D as Oa}from"./download-aE9qC_yh.js";import{C as za}from"./calendar-BTZ9lOjb.js";import{U as ke}from"./users-BHFcZ460.js";import{F as Be}from"./funnel-BCEbMUzy.js";import{C as La}from"./clipboard-list-Bq8RUal4.js";import{C as Ra}from"./clock-DrcV20p-.js";import{C as Ga}from"./circle-alert-C3Gp5cKN.js";import{T as Ba}from"./trending-up-CeaM1II1.js";import{C as $a}from"./circle-check-big-BLcs0CRD.js";import{c as we,s as Ce,a as He,b as Je,d as Ka,e as Wa,f as $e,g as Va,i as Qe,h as Ke,j as qa,r as ea,D as Ua,u as aa,R as Xa,S as Ya,k as Za,l as Ha,m as Ja,G as Qa,n as ta,o as et,p as at,q as tt,t as st,v as it,w as rt,x as nt,Z as lt,L as he,y as ot,A as We,z as Ve,B as qe,C as te,E as dt,J as ct,F as ee,H as mt,I as ut,K as pt,M as xt,N as sa,O as ht,P as _e,Q as gt,T as ge,U as vt,V as ft,W as de,X as ce,Y as me,_ as ue,$ as pe}from"./CartesianChart-DD1q50QC.js";import{C as Ue}from"./chart-column-CiTHaPgQ.js";import{B as Ae,a as xe,C as Xe}from"./BarChart-C9s0GytU.js";import{L as bt}from"./Legend-BpUhHeDW.js";import{C as yt}from"./chart-pie-33hDKOx2.js";import{S as jt}from"./shield-C-fhaxd6.js";import{A as Nt}from"./award-BxLZOqUu.js";import{T as kt}from"./trending-down-CmkNyxbj.js";import{Z as _t}from"./zap-Cg7y_y56.js";import{f as ie}from"./format-BdDrz3ZT.js";import{s as re}from"./subDays-C76KfxB7.js";import"./index-BSvf8Gkf.js";import"./index-BYh_3E0O.js";import"./index-Hrv3wGwr.js";import"./index-BEPDIlbQ.js";import"./Combination-CK754xyO.js";import"./SidebarPremium-b8AcD6aG.js";import"./house-C21pZqGK.js";import"./book-open-DbJlkSkE.js";import"./file-text-D1pM-cGT.js";import"./graduation-cap-CGvbZ17f.js";import"./message-circle-Bm4-2rso.js";import"./settings-CA-HrSVc.js";import"./brain-dpI-w2IQ.js";import"./index-CcRuMwBB.js";import"./proxy-CTHD_aal.js";import"./chevron-right-BZvTPqku.js";import"./x-C8LZHbUR.js";import"./index-WTFzhl0e.js";import"./check-BGvYUlN_.js";import"./index-D8pw72a5.js";import"./chevron-down-C0ABIcLs.js";import"./chevron-up-B5cmfjQz.js";import"./_commonjs-dynamic-modules-TDtrdbi3.js";import"./index-B7VwQr8s.js";import"./en-US-ChNhCS9W.js";import"./addDays-jaRQZo3H.js";const At=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"m19 9-5 5-4-4-3 3",key:"2osh9i"}]],wt=ka("chart-line",At);var ia=(s,t,i,r)=>He(s,"xAxis",t,r),ra=(s,t,i,r)=>Je(s,"xAxis",t,r),na=(s,t,i,r)=>He(s,"yAxis",i,r),la=(s,t,i,r)=>Je(s,"yAxis",i,r),Ct=we([Ce,ia,na,ra,la],(s,t,i,r,m)=>Qe(s,"xAxis")?Ke(t,r,!1):Ke(i,m,!1)),St=(s,t,i,r,m)=>m,oa=we([qa,St],(s,t)=>s.filter(i=>i.type==="area").find(i=>i.id===t)),Et=(s,t,i,r,m)=>{var o,c=oa(s,t,i,r,m);if(c!=null){var d=Ce(s),n=Qe(d,"xAxis"),h;if(n?h=$e(s,"yAxis",i,r):h=$e(s,"xAxis",t,r),h!=null){var{stackId:E}=c,D=Va(c);if(!(E==null||D==null)){var A=(o=h[E])===null||o===void 0?void 0:o.stackedData;return A?.find(_=>_.key===D)}}}},Dt=we([Ce,ia,na,ra,la,Et,Ka,Ct,oa,Wa],(s,t,i,r,m,o,c,d,n,h)=>{var{chartData:E,dataStartIndex:D,dataEndIndex:A}=c;if(!(n==null||s!=="horizontal"&&s!=="vertical"||t==null||i==null||r==null||m==null||r.length===0||m.length===0||d==null)){var{data:_}=n,w;if(_&&_.length>0?w=_:w=E?.slice(D,A+1),w!=null)return Yt({layout:s,xAxis:t,yAxis:i,xAxisTicks:r,yAxisTicks:m,dataStartIndex:D,areaSettings:n,stackedData:o,displayedData:w,chartBaseValue:h,bandSize:d})}}),Pt=["id"],It=["activeDot","animationBegin","animationDuration","animationEasing","connectNulls","dot","fill","fillOpacity","hide","isAnimationActive","legendType","stroke","xAxisId","yAxisId"];function Z(){return Z=Object.assign?Object.assign.bind():function(s){for(var t=1;t<arguments.length;t++){var i=arguments[t];for(var r in i)({}).hasOwnProperty.call(i,r)&&(s[r]=i[r])}return s},Z.apply(null,arguments)}function da(s,t){if(s==null)return{};var i,r,m=Tt(s,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(s);for(r=0;r<o.length;r++)i=o[r],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(s,i)&&(m[i]=s[i])}return m}function Tt(s,t){if(s==null)return{};var i={};for(var r in s)if({}.hasOwnProperty.call(s,r)){if(t.indexOf(r)!==-1)continue;i[r]=s[r]}return i}function Ye(s,t){var i=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);t&&(r=r.filter(function(m){return Object.getOwnPropertyDescriptor(s,m).enumerable})),i.push.apply(i,r)}return i}function ae(s){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Ye(Object(i),!0).forEach(function(r){Ft(s,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(i)):Ye(Object(i)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(i,r))})}return s}function Ft(s,t,i){return(t=Mt(t))in s?Object.defineProperty(s,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):s[t]=i,s}function Mt(s){var t=Ot(s,"string");return typeof t=="symbol"?t:t+""}function Ot(s,t){if(typeof s!="object"||!s)return s;var i=s[Symbol.toPrimitive];if(i!==void 0){var r=i.call(s,t);if(typeof r!="object")return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(s)}function ve(s,t){return s&&s!=="none"?s:t}var zt=s=>{var{dataKey:t,name:i,stroke:r,fill:m,legendType:o,hide:c}=s;return[{inactive:c,dataKey:t,type:o,color:ve(r,m),value:ta(i,t),payload:s}]};function Lt(s){var{dataKey:t,data:i,stroke:r,strokeWidth:m,fill:o,name:c,hide:d,unit:n}=s;return{dataDefinedOnItem:i,positions:void 0,settings:{stroke:r,strokeWidth:m,fill:o,dataKey:t,nameKey:void 0,name:ta(c,t),hide:d,type:s.tooltipType,color:ve(r,o),unit:n}}}function Rt(s){var{clipPathId:t,points:i,props:r}=s,{needClip:m,dot:o,dataKey:c}=r,d=sa(r);return l.createElement(gt,{points:i,dot:o,className:"recharts-area-dots",dotClassName:"recharts-area-dot",dataKey:c,baseProps:d,needClip:m,clipPathId:t})}function Gt(s){var{showLabels:t,children:i,points:r}=s,m=r.map(o=>{var c,d,n={x:(c=o.x)!==null&&c!==void 0?c:0,y:(d=o.y)!==null&&d!==void 0?d:0,width:0,lowerWidth:0,upperWidth:0,height:0};return ae(ae({},n),{},{value:o.value,payload:o.payload,parentViewBox:void 0,viewBox:n,fill:void 0})});return l.createElement(xt,{value:t?m:void 0},i)}function Ze(s){var{points:t,baseLine:i,needClip:r,clipPathId:m,props:o}=s,{layout:c,type:d,stroke:n,connectNulls:h,isRange:E}=o,{id:D}=o,A=da(o,Pt),_=sa(A),w=ht(A);return l.createElement(l.Fragment,null,t?.length>1&&l.createElement(he,{clipPath:r?"url(#clipPath-".concat(m,")"):void 0},l.createElement(_e,Z({},w,{id:D,points:t,connectNulls:h,type:d,baseLine:i,layout:c,stroke:"none",className:"recharts-area-area"})),n!=="none"&&l.createElement(_e,Z({},_,{className:"recharts-area-curve",layout:c,type:d,connectNulls:h,fill:"none",points:t})),n!=="none"&&E&&l.createElement(_e,Z({},_,{className:"recharts-area-curve",layout:c,type:d,connectNulls:h,fill:"none",points:i}))),l.createElement(Rt,{points:t,props:A,clipPathId:m}))}function Bt(s){var{alpha:t,baseLine:i,points:r,strokeWidth:m}=s,o=r[0].y,c=r[r.length-1].y;if(!ge(o)||!ge(c))return null;var d=t*Math.abs(o-c),n=Math.max(...r.map(h=>h.x||0));return te(i)?n=Math.max(i,n):i&&Array.isArray(i)&&i.length&&(n=Math.max(...i.map(h=>h.x||0),n)),te(n)?l.createElement("rect",{x:0,y:o<c?o:o-d,width:n+(m?parseInt("".concat(m),10):1),height:Math.floor(d)}):null}function $t(s){var{alpha:t,baseLine:i,points:r,strokeWidth:m}=s,o=r[0].x,c=r[r.length-1].x;if(!ge(o)||!ge(c))return null;var d=t*Math.abs(o-c),n=Math.max(...r.map(h=>h.y||0));return te(i)?n=Math.max(i,n):i&&Array.isArray(i)&&i.length&&(n=Math.max(...i.map(h=>h.y||0),n)),te(n)?l.createElement("rect",{x:o<c?o:o-d,y:0,width:d,height:Math.floor(n+(m?parseInt("".concat(m),10):1))}):null}function Kt(s){var{alpha:t,layout:i,points:r,baseLine:m,strokeWidth:o}=s;return i==="vertical"?l.createElement(Bt,{alpha:t,points:r,baseLine:m,strokeWidth:o}):l.createElement($t,{alpha:t,points:r,baseLine:m,strokeWidth:o})}function Wt(s){var{needClip:t,clipPathId:i,props:r,previousPointsRef:m,previousBaselineRef:o}=s,{points:c,baseLine:d,isAnimationActive:n,animationBegin:h,animationDuration:E,animationEasing:D,onAnimationStart:A,onAnimationEnd:_}=r,w=dt(r,"recharts-area-"),[F,P]=l.useState(!1),$=!F,k=l.useCallback(()=>{typeof _=="function"&&_(),P(!1)},[_]),M=l.useCallback(()=>{typeof A=="function"&&A(),P(!0)},[A]),u=m.current,C=o.current;return l.createElement(Gt,{showLabels:$,points:c},r.children,l.createElement(ct,{animationId:w,begin:h,duration:E,isActive:n,easing:D,onAnimationEnd:k,onAnimationStart:M,key:w},j=>{if(u){var K=u.length/c.length,z=j===1?c:c.map((I,W)=>{var R=Math.floor(W*K);if(u[R]){var G=u[R];return ae(ae({},I),{},{x:ee(G.x,I.x,j),y:ee(G.y,I.y,j)})}return I}),L;return te(d)?L=ee(C,d,j):mt(d)||ut(d)?L=ee(C,0,j):L=d.map((I,W)=>{var R=Math.floor(W*K);if(Array.isArray(C)&&C[R]){var G=C[R];return ae(ae({},I),{},{x:ee(G.x,I.x,j),y:ee(G.y,I.y,j)})}return I}),j>0&&(m.current=z,o.current=L),l.createElement(Ze,{points:z,baseLine:L,needClip:t,clipPathId:i,props:r})}return j>0&&(m.current=c,o.current=d),l.createElement(he,null,n&&l.createElement("defs",null,l.createElement("clipPath",{id:"animationClipPath-".concat(i)},l.createElement(Kt,{alpha:j,points:c,baseLine:d,layout:r.layout,strokeWidth:r.strokeWidth}))),l.createElement(he,{clipPath:"url(#animationClipPath-".concat(i,")")},l.createElement(Ze,{points:c,baseLine:d,needClip:t,clipPathId:i,props:r})))}),l.createElement(pt,{label:r.label}))}function Vt(s){var{needClip:t,clipPathId:i,props:r}=s,m=l.useRef(null),o=l.useRef();return l.createElement(Wt,{needClip:t,clipPathId:i,props:r,previousPointsRef:m,previousBaselineRef:o})}class qt extends l.PureComponent{render(){var{hide:t,dot:i,points:r,className:m,top:o,left:c,needClip:d,xAxisId:n,yAxisId:h,width:E,height:D,id:A,baseLine:_,zIndex:w}=this.props;if(t)return null;var F=_a("recharts-area",m),P=A,{r:$,strokeWidth:k}=rt(i),M=nt(i),u=$*2+k;return l.createElement(lt,{zIndex:w},l.createElement(he,{className:F},d&&l.createElement("defs",null,l.createElement(ot,{clipPathId:P,xAxisId:n,yAxisId:h}),!M&&l.createElement("clipPath",{id:"clipPath-dots-".concat(P)},l.createElement("rect",{x:c-u/2,y:o-u/2,width:E+u,height:D+u}))),l.createElement(Vt,{needClip:d,clipPathId:P,props:this.props})),l.createElement(We,{points:r,mainColor:ve(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}),this.props.isRange&&Array.isArray(_)&&l.createElement(We,{points:_,mainColor:ve(this.props.stroke,this.props.fill),itemDataKey:this.props.dataKey,activeDot:this.props.activeDot}))}}var ca={activeDot:!0,animationBegin:0,animationDuration:1500,animationEasing:"ease",connectNulls:!1,dot:!1,fill:"#3182bd",fillOpacity:.6,hide:!1,isAnimationActive:!Qa.isSsr,legendType:"line",stroke:"#3182bd",xAxisId:0,yAxisId:0,zIndex:Ua.area};function Ut(s){var t,i=ea(s,ca),{activeDot:r,animationBegin:m,animationDuration:o,animationEasing:c,connectNulls:d,dot:n,fill:h,fillOpacity:E,hide:D,isAnimationActive:A,legendType:_,stroke:w,xAxisId:F,yAxisId:P}=i,$=da(i,It),k=et(),M=at(),{needClip:u}=tt(F,P),C=aa(),{points:j,isRange:K,baseLine:z}=(t=st(H=>Dt(H,F,P,C,s.id)))!==null&&t!==void 0?t:{},L=it();if(k!=="horizontal"&&k!=="vertical"||L==null||M!=="AreaChart"&&M!=="ComposedChart")return null;var{height:I,width:W,x:R,y:G}=L;return!j||!j.length?null:l.createElement(qt,Z({},$,{activeDot:r,animationBegin:m,animationDuration:o,animationEasing:c,baseLine:z,connectNulls:d,dot:n,fill:h,fillOpacity:E,height:I,hide:D,layout:k,isAnimationActive:A,isRange:K,legendType:_,needClip:u,points:j,stroke:w,width:W,left:R,top:G,xAxisId:F,yAxisId:P}))}var Xt=(s,t,i,r,m)=>{var o=i??t;if(te(o))return o;var c=s==="horizontal"?m:r,d=c.scale.domain();if(c.type==="number"){var n=Math.max(d[0],d[1]),h=Math.min(d[0],d[1]);return o==="dataMin"?h:o==="dataMax"||n<0?n:Math.max(Math.min(d[0],d[1]),0)}return o==="dataMin"?d[0]:o==="dataMax"?d[1]:d[0]};function Yt(s){var{areaSettings:{connectNulls:t,baseValue:i,dataKey:r},stackedData:m,layout:o,chartBaseValue:c,xAxis:d,yAxis:n,displayedData:h,dataStartIndex:E,xAxisTicks:D,yAxisTicks:A,bandSize:_}=s,w=m&&m.length,F=Xt(o,c,i,d,n),P=o==="horizontal",$=!1,k=h.map((u,C)=>{var j;w?j=m[E+C]:(j=Ve(u,r),Array.isArray(j)?$=!0:j=[F,j]);var K=j[1]==null||w&&!t&&Ve(u,r)==null;return P?{x:qe({axis:d,ticks:D,bandSize:_,entry:u,index:C}),y:K?null:n.scale(j[1]),value:j,payload:u}:{x:K?null:d.scale(j[1]),y:qe({axis:n,ticks:A,bandSize:_,entry:u,index:C}),value:j,payload:u}}),M;return w||$?M=k.map(u=>{var C=Array.isArray(u.value)?u.value[0]:null;return P?{x:u.x,y:C!=null&&u.y!=null?n.scale(C):null,payload:u.payload}:{x:C!=null?d.scale(C):null,y:u.y,payload:u.payload}}):M=P?n.scale(F):d.scale(F),{points:k,baseLine:M,isRange:$}}function Zt(s){var t=ea(s,ca),i=aa();return l.createElement(Xa,{id:t.id,type:"area"},r=>l.createElement(l.Fragment,null,l.createElement(Ya,{legendPayload:zt(t)}),l.createElement(Za,{fn:Lt,args:t}),l.createElement(Ha,{type:"area",id:r,data:t.data,dataKey:t.dataKey,xAxisId:t.xAxisId,yAxisId:t.yAxisId,zAxisId:0,stackId:Ja(t.stackId),hide:t.hide,barSize:void 0,baseValue:t.baseValue,isPanorama:i,connectNulls:t.connectNulls}),l.createElement(Ut,Z({},t,{id:r}))))}var ma=l.memo(Zt);ma.displayName="Area";var Ht=["axis"],Jt=l.forwardRef((s,t)=>l.createElement(vt,{chartName:"AreaChart",defaultTooltipEventType:"axis",validateTooltipEventTypes:Ht,tooltipPayloadSearcher:ft,categoricalChartProps:s,ref:t}));const oi=()=>{const{user:s}=Aa(),{toast:t}=Ta();wa();const[i,r]=l.useState(!0),[m,o]=l.useState(!0),[c,d]=l.useState("30"),[n,h]=l.useState([]),[E,D]=l.useState(["all"]),[A,_]=l.useState(["graded"]),[w,F]=l.useState(!1),[P,$]=l.useState(!0),[k,M]=l.useState([]),[u,C]=l.useState({totalStudents:0,totalActivities:0,pendingCorrections:0,avgGrade:0,onTimeRate:0,openActivities:0}),[j,K]=l.useState([]),[z,L]=l.useState([]),[I,W]=l.useState([]),[R,G]=l.useState([]),[H,ne]=l.useState([]),[fe,be]=l.useState([]),[J,ye]=l.useState(null),[Qt,ua]=l.useState(null);l.useEffect(()=>{je()},[s,c,n,E,A]),l.useEffect(()=>{let a;return w&&(a=setInterval(je,300*1e3)),()=>clearInterval(a)},[w]);const je=async()=>{if(s?.id){r(!0);try{if(await pa(),P){const{data:a}=await T.auth.getSession(),x=a?.session?.access_token,g=await fetch("https://wapbwaimkurbuihatmix.supabase.co/functions/v1/get-teacher-analytics",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${x}`},body:JSON.stringify({period:c,selectedClasses:n.length>0?n:k.map(b=>b.id)})});if(!g.ok)throw new Error("Erro ao carregar analytics");const v=await g.json(),N=v.data;C(N.kpis),ne(N.topStudents||[]),await Promise.all([Se(),Ee(),De(),Pe(),Ie(),Te()]),v.cached&&t({title:"‚ö° Cache",description:"Dados carregados do cache (5min)",duration:2e3})}else await Promise.all([xa(),Se(),Ee(),De(),Pe(),ha(),Ie(),Te()])}catch(a){V.error("Erro ao carregar analytics:",a),t({title:"Erro",description:"N√£o foi poss√≠vel carregar os dados de analytics",variant:"destructive"})}finally{r(!1),m&&o(!1)}}},pa=async()=>{try{const{data:a,error:x}=await T.from("classes").select("id, name, subject, color").eq("created_by",s.id).eq("is_active",!0).order("name",{ascending:!0});if(x)throw x;const g=a||[];M(g),n.length===0&&g.length>0&&h(g.map(v=>v.id)),V.debug("[TeacherAnalytics] Classes carregadas:",g.length)}catch(a){V.error("Erro ao carregar turmas:",a),M([])}},xa=async()=>{if(n.length===0){C({totalStudents:0,totalActivities:0,pendingCorrections:0,avgGrade:0,onTimeRate:0,openActivities:0});return}const a=c==="all"?null:ie(re(new Date,parseInt(c)),"yyyy-MM-dd"),{data:x}=await T.from("class_members").select("user_id").in("class_id",n).eq("role","student"),g=new Set(x?.map(U=>U.user_id)||[]).size;let v=T.from("activity_class_assignments").select("activity_id, activities!inner(id, created_at, status)").in("class_id",n);a&&(v=v.gte("activities.created_at",a));const{data:N}=await v,b=new Set(N?.map(U=>U.activity_id)||[]).size,{data:f}=await T.from("submissions").select("id, activity_id, activities!inner(id, activity_class_assignments!inner(class_id))").eq("status","submitted").in("activities.activity_class_assignments.class_id",n),p=f?.length||0;let y=T.from("submissions").select("grade, activity_id, activities!inner(id, activity_class_assignments!inner(class_id))").not("grade","is",null).in("activities.activity_class_assignments.class_id",n);a&&(y=y.gte("graded_at",a));const{data:O}=await y,S=O?.length>0?(O.reduce((U,Na)=>U+(Na.grade||0),0)/O.length).toFixed(1):0,{data:B}=await T.from("submissions").select("submitted_at, activity_id, activities!inner(due_date, activity_class_assignments!inner(class_id))").eq("status","submitted").in("activities.activity_class_assignments.class_id",n).not("submitted_at","is",null).not("activities.due_date","is",null),le=B?.filter(U=>new Date(U.submitted_at)<=new Date(U.activities.due_date)).length||0,Ne=B?.length>0?Math.round(le/B.length*100):0,{data:oe}=await T.from("activity_class_assignments").select("activity_id, activities!inner(status, due_date)").in("class_id",n).eq("activities.status","active").gte("activities.due_date",new Date().toISOString()),ja=oe?.length||0;C({totalStudents:g,totalActivities:b,pendingCorrections:p,avgGrade:parseFloat(S),onTimeRate:Ne,openActivities:ja})},Se=async()=>{const a=c==="all"?90:parseInt(c),x=ie(re(new Date,a),"yyyy-MM-dd"),{data:g}=await T.from("submissions").select("grade, graded_at, activity_id, activities!inner(activity_class_assignments!inner(class_id))").not("grade","is",null).in("activities.activity_class_assignments.class_id",n).gte("graded_at",x).order("graded_at",{ascending:!0}),v={};g?.forEach(b=>{const f=ie(new Date(b.graded_at),"dd/MM");v[f]||(v[f]=[]),v[f].push(b.grade)});const N=Object.entries(v).map(([b,f])=>({date:b,media:parseFloat((f.reduce((p,y)=>p+y,0)/f.length).toFixed(2)),submissoes:f.length}));K(N.slice(-30))},Ee=async()=>{if(n.length===0){L([]);return}const{data:a}=await T.from("submissions").select(`
        grade, 
        activity_id, 
        activities!inner(
          activity_class_assignments!inner(class_id)
        )
      `).not("grade","is",null).in("activities.activity_class_assignments.class_id",n),{data:x}=await T.from("class_members").select("class_id, user_id").in("class_id",n).eq("role","student"),{data:g}=await T.from("activity_class_assignments").select("class_id, activity_id").in("class_id",n),v=[],N={},b={};x?.forEach(f=>{N[f.class_id]=(N[f.class_id]||0)+1}),g?.forEach(f=>{b[f.class_id]=(b[f.class_id]||0)+1});for(const f of k.filter(p=>n.includes(p.id))){const p=a?.filter(O=>O.activities?.activity_class_assignments?.some(S=>S.class_id===f.id))||[],y=p.length>0?p.reduce((O,S)=>O+S.grade,0)/p.length:0;v.push({name:f.name,media:parseFloat(y.toFixed(2)),alunos:N[f.id]||0,atividades:b[f.id]||0,color:f.color||"#3B82F6"})}L(v.sort((f,p)=>p.media-f.media))},De=async()=>{if(n.length===0){W([]);return}const{data:a,error:x}=await T.from("submissions").select("grade, activity_id, activities!inner(max_score, activity_class_assignments!inner(class_id))").not("grade","is",null).in("activities.activity_class_assignments.class_id",n).limit(1e3);if(x){V.error("Erro ao carregar distribui√ß√£o de notas:",x),W([]);return}const g=[{range:"0-2",count:0,color:"#EF4444"},{range:"2-4",count:0,color:"#F97316"},{range:"4-6",count:0,color:"#F59E0B"},{range:"6-8",count:0,color:"#3B82F6"},{range:"8-10",count:0,color:"#10B981"}];a?.forEach(({grade:v,activities:N})=>{const b=parseFloat(v),f=parseFloat(N?.max_score||10);if(isNaN(b))return;let p=b;f>0&&f!==10&&(p=b/f*10),p=Math.max(0,Math.min(10,p)),p<2?g[0].count++:p<4?g[1].count++:p<6?g[2].count++:p<8?g[3].count++:g[4].count++}),W(g)},Pe=async()=>{if(n.length===0){G([]);return}const a=ie(re(new Date,84),"yyyy-MM-dd"),{data:x,error:g}=await T.from("submissions").select("submitted_at, status, activity_id, activities!inner(due_date, activity_class_assignments!inner(class_id))").in("status",["submitted","graded"]).in("activities.activity_class_assignments.class_id",n).gte("submitted_at",a).limit(1e3);if(g){V.error("Erro ao carregar tend√™ncia semanal de entregas:",g),G([]);return}const v=[];for(let N=0;N<12;N++){const b=re(new Date,(12-N)*7),f=re(new Date,(11-N)*7),p=x?.filter(S=>{const B=new Date(S.submitted_at);return B>=b&&B<=f})||[],y=p.filter(S=>S.activities?.due_date&&new Date(S.submitted_at)<=new Date(S.activities.due_date)).length,O=p.filter(S=>S.activities?.due_date&&new Date(S.submitted_at)>new Date(S.activities.due_date)).length;v.push({week:`S${12-N}`,noPrazo:y,atrasadas:O,total:p.length})}V.debug("[TeacherAnalytics] Weekly trends calculadas:",{totalSubmissions:x?.length||0,weeksCount:v.length}),G(v)},ha=async()=>{if(n.length===0){ne([]),be([]);return}const{data:a,error:x}=await T.from("submissions").select(`
        grade,
        status,
        submitted_at,
        student_id,
        student:profiles!submissions_student_id_fkey(id, full_name, avatar_url),
        activity_id,
        activities!inner(max_score, due_date, activity_class_assignments!inner(class_id))
      `).not("grade","is",null).in("activities.activity_class_assignments.class_id",n).limit(500);if(x){V.error("Erro ao carregar top/bottom students:",x),ne([]),be([]);return}const g=k.reduce((p,y)=>(p[y.id]=y,p),{}),v={};a?.forEach(p=>{v[p.student_id]||(v[p.student_id]={student:p.student,grades:[],total:0,onTime:0,classes:new Set});const y=v[p.student_id],O=parseFloat(p.grade)||0;y.grades.push(O),y.total++;const S=p.submitted_at?new Date(p.submitted_at):null,B=p.activities?.due_date?new Date(p.activities.due_date):null;S&&B&&S<=B&&y.onTime++,(p.activities?.activity_class_assignments||[]).forEach(Ne=>{const oe=g[Ne.class_id];oe&&y.classes.add(oe.name)})});const N=Object.entries(v).map(([p,y])=>{const O=y.grades.length>0?y.grades.reduce((B,le)=>B+le,0)/y.grades.length:0,S=y.total>0?Math.round(y.onTime/y.total*100):0;return{id:p,name:y.student?.full_name||"Sem nome",avatar:y.student?.avatar_url,avgGrade:O,activities:y.total,onTimeRate:S,classes:Array.from(y.classes).slice(0,3)}}).sort((p,y)=>y.avgGrade-p.avgGrade),b=N.slice(0,10),f=N.filter(p=>p.activities>=3).slice(-10).sort((p,y)=>p.avgGrade-y.avgGrade);ne(b),be(f)},Ie=async()=>{if(n.length===0){ye(null);return}const{data:a}=await T.from("plagiarism_checks").select(`
        plagiarism_percentage,
        ai_generated,
        submission_id,
        submissions!inner(activity_id, activities!inner(activity_class_assignments!inner(class_id)))
      `).in("submissions.activities.activity_class_assignments.class_id",n).limit(500);if(!a||a.length===0){ye(null);return}const x=a.reduce((v,N)=>v+(100-(N.plagiarism_percentage||0)),0)/a.length,g=a.filter(v=>100-v.plagiarism_percentage<70).length;ye({avgOriginality:Math.round(x),totalChecks:a.length,casesDetected:g,aiDetected:a.filter(v=>v.ai_generated).length})},Te=async()=>{ua({uniqueAccess:0,avgSessionTime:0,returnRate:0,interactions:0})},ga=async()=>{try{const a=[];a.push("TamanduAI - Analytics Dashboard"),a.push(`Per√≠odo: √öltimos ${c} dias`),a.push(`Data de Exporta√ß√£o: ${new Date().toLocaleString("pt-BR")}`),a.push(""),a.push("KPIs Principais"),a.push("Indicador,Valor"),a.push(`Total de Alunos,${u.totalStudents}`),a.push(`Total de Atividades,${u.totalActivities}`),a.push(`Corre√ß√µes Pendentes,${u.pendingCorrections}`),a.push(`M√©dia Geral,${u.avgGrade.toFixed(2)}`),a.push(`Taxa de Entrega no Prazo,${u.onTimeRate.toFixed(1)}%`),a.push(""),a.push("Evolu√ß√£o de Notas"),a.push("Dia,M√©dia"),j.forEach(b=>{a.push(`${b.date},${b.media}`)}),a.push(""),a.push("Compara√ß√£o de Turmas"),a.push("Turma,M√©dia"),z.forEach(b=>{a.push(`${b.name},${b.media}`)}),a.push(""),a.push("Top 10 Alunos"),a.push("Posi√ß√£o,Nome,M√©dia,Atividades,Entregas no Prazo (%),Turmas"),H.forEach((b,f)=>{const p=(b.classes||[]).join(" | ");a.push(`${f+1},${b.name},${b.avgGrade.toFixed(2)},${b.activities},${b.onTimeRate},${p}`)});const x=a.join(`
`),g=new Blob([x],{type:"text/csv;charset=utf-8;"}),v=URL.createObjectURL(g),N=document.createElement("a");N.setAttribute("href",v),N.setAttribute("download",`analytics-dashboard-${ie(new Date,"yyyy-MM-dd")}.csv`),document.body.appendChild(N),N.click(),document.body.removeChild(N),t({title:"‚úÖ Dashboard exportado!",description:"Arquivo CSV baixado com sucesso"})}catch(a){V.error("Erro ao exportar:",a),t({title:"‚ùå Erro ao exportar",description:a.message,variant:"destructive"})}},va=async()=>{try{await Fa({period:c,kpis:u,gradeEvolution:j,classComparison:z,gradeDistribution:I,weeklyTrends:R,topStudents:H,bottomStudents:fe}),t({title:"‚úÖ Dashboard exportado!",description:"PDF gerado com sucesso"})}catch(a){V.error("Erro ao exportar PDF:",a),t({title:"‚ùå Erro ao exportar PDF",description:a.message,variant:"destructive"})}},fa=()=>{const a=[];u.avgGrade<6&&a.push("‚ö†Ô∏è M√©dia da turma est√° abaixo de 6.0"),u.pendingCorrections>10&&a.push(`‚ö†Ô∏è ${u.pendingCorrections} corre√ß√µes pendentes`),u.onTimeRate<70&&a.push(`‚ö†Ô∏è Taxa de entrega no prazo est√° em ${u.onTimeRate.toFixed(1)}%`),a.length>0?t({title:"üîî Alertas Ativos",description:a.join(" ‚Ä¢ "),duration:5e3}):t({title:"‚úÖ Tudo certo!",description:"Nenhum alerta ativo no momento"})},ba=()=>{je(),t({title:"Filtros aplicados"})},ya=()=>{d("30"),h(k.map(a=>a.id)),D(["all"]),_(["graded"]),t({title:"Filtros limpos"})};return i&&m?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(Ca,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsx(Ia,{title:"Analytics e Insights",subtitle:"An√°lise completa de desempenho e tend√™ncias",role:"teacher",actions:e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(se,{variant:"outline",onClick:fa,children:[e.jsx(Ma,{className:"w-4 h-4 mr-2"}),"Configurar Alertas"]}),e.jsxs(Sa,{children:[e.jsx(Ea,{asChild:!0,children:e.jsxs(se,{variant:"outline",children:[e.jsx(Oa,{className:"w-4 h-4 mr-2"}),"Exportar"]})}),e.jsxs(Da,{align:"end",children:[e.jsx(Me,{onClick:ga,children:"Exportar CSV"}),e.jsx(Me,{onClick:va,children:"Exportar PDF"})]})]})]})}),e.jsxs(X,{className:"p-6 mb-6 sticky top-0 z-10 bg-white dark:bg-slate-900 shadow-lg",children:[e.jsxs("div",{className:"flex flex-wrap items-end gap-4",children:[e.jsxs("div",{className:"flex-1 min-w-[200px]",children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(za,{className:"w-4 h-4 inline mr-2"}),"Per√≠odo"]}),e.jsxs(Oe,{value:c,onValueChange:d,children:[e.jsx(ze,{children:e.jsx(Le,{})}),e.jsxs(Re,{children:[e.jsx(q,{value:"7",children:"√öltimos 7 dias"}),e.jsx(q,{value:"15",children:"√öltimos 15 dias"}),e.jsx(q,{value:"30",children:"√öltimos 30 dias"}),e.jsx(q,{value:"60",children:"√öltimos 60 dias"}),e.jsx(q,{value:"90",children:"√öltimos 90 dias"}),e.jsx(q,{value:"180",children:"√öltimos 180 dias"}),e.jsx(q,{value:"all",children:"Todo o Per√≠odo"})]})]})]}),e.jsxs("div",{className:"flex-1 min-w-[250px]",children:[e.jsxs("label",{className:"block text-sm font-medium mb-2",children:[e.jsx(ke,{className:"w-4 h-4 inline mr-2"}),"Turmas"]}),e.jsxs("div",{className:"relative",children:[e.jsxs(Oe,{value:n.length===k.length?"all":"custom",onValueChange:a=>{a==="all"?h(k.map(x=>x.id)):n.length===k.length&&h([])},children:[e.jsx(ze,{children:e.jsx(Le,{children:n.length===k.length?"Todas as turmas":n.length===0?"Selecione turmas":`${n.length} turma(s)`})}),e.jsxs(Re,{children:[e.jsx(q,{value:"all",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(ke,{className:"w-4 h-4 mr-2"}),"Todas as turmas"]})}),e.jsx(q,{value:"custom",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),"Selecionar turmas espec√≠ficas"]})})]})]}),n.length<k.length&&n.length>0&&e.jsx("div",{className:"absolute top-full mt-1 w-full z-50 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-700 rounded-lg shadow-lg p-2",children:e.jsx("div",{className:"max-h-40 overflow-y-auto",children:k.map(a=>e.jsxs("div",{className:"flex items-center p-2 hover:bg-slate-50 dark:hover:bg-slate-800 rounded",children:[e.jsx(Ge,{id:`class-${a.id}`,checked:n.includes(a.id),onCheckedChange:x=>{h(x?[...n,a.id]:n.filter(g=>g!==a.id))}}),e.jsxs("label",{htmlFor:`class-${a.id}`,className:"ml-2 text-sm cursor-pointer flex-1",children:[a.name," ",a.subject&&`- ${a.subject}`]})]},a.id))})})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(se,{onClick:ba,children:[e.jsx(Be,{className:"w-4 h-4 mr-2"}),"Aplicar Filtros"]}),e.jsx(se,{variant:"outline",onClick:ya,children:"Limpar"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Ge,{checked:w,onCheckedChange:F,id:"auto-refresh"}),e.jsx("label",{htmlFor:"auto-refresh",className:"text-sm cursor-pointer",children:"Auto-atualizar (5min)"})]})]}),n.length>0&&n.length<k.length&&e.jsx("div",{className:"mt-3 flex flex-wrap gap-2",children:n.map(a=>{const x=k.find(g=>g.id===a);return x?e.jsxs(Fe,{variant:"secondary",className:"text-xs",children:[x.name,e.jsx("button",{onClick:()=>h(n.filter(g=>g!==a)),className:"ml-1 hover:text-red-500",children:"√ó"})]},a):null})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-6 gap-4 mb-8",children:[e.jsx(Q,{title:"Total de Alunos",value:u.totalStudents,icon:ke,gradient:Y.primary,bgColor:"bg-blue-50 dark:bg-blue-950/30"}),e.jsx(Q,{title:"Atividades Postadas",value:u.totalActivities,icon:La,gradient:Y.info,bgColor:"bg-cyan-50 dark:bg-cyan-950/30"}),e.jsx(Q,{title:"Atividades Abertas",value:u.openActivities,icon:Ra,gradient:Y.warning,bgColor:"bg-yellow-50 dark:bg-yellow-950/30"}),e.jsx(Q,{title:"Aguardando Corre√ß√£o",value:u.pendingCorrections,icon:Ga,gradient:Y.danger,bgColor:"bg-red-50 dark:bg-red-950/30"}),e.jsx(Q,{title:"Nota M√©dia Geral",value:u.avgGrade.toFixed(1),icon:Ba,gradient:u.avgGrade>=7?Y.success:u.avgGrade>=5?Y.warning:Y.danger,bgColor:u.avgGrade>=7?"bg-green-50 dark:bg-green-950/30":"bg-yellow-50 dark:bg-yellow-950/30"}),e.jsx(Q,{title:"Taxa Entrega no Prazo",value:`${u.onTimeRate}%`,icon:$a,gradient:Y.success,bgColor:"bg-green-50 dark:bg-green-950/30"})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 mb-8",children:[e.jsxs(X,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/40",children:e.jsx(wt,{className:"w-5 h-5 text-blue-600 dark:text-blue-300"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:"Evolu√ß√£o das notas"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"M√©dia por dia de corre√ß√£o no per√≠odo selecionado"})]})]})}),j.length>0?e.jsx("div",{className:"h-64",children:e.jsx(de,{width:"100%",height:"100%",children:e.jsxs(Jt,{data:j,margin:{left:-20,right:10},children:[e.jsx(ce,{strokeDasharray:"3 3",className:"stroke-slate-200 dark:stroke-slate-800"}),e.jsx(me,{dataKey:"date",tick:{fontSize:10}}),e.jsx(ue,{domain:[0,10],tick:{fontSize:10}}),e.jsx(pe,{labelFormatter:a=>`Dia ${a}`,formatter:a=>[`M√©dia ${a.toFixed(2)}`,"Nota"]}),e.jsx(ma,{type:"monotone",dataKey:"media",stroke:"#2563EB",fillOpacity:.15,fill:"#60A5FA"})]})})}):e.jsx("p",{className:"text-xs text-slate-500",children:"Ainda n√£o h√° notas suficientes para calcular a evolu√ß√£o."})]}),e.jsxs(X,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-emerald-100 dark:bg-emerald-900/40",children:e.jsx(Ue,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-300"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:"Tend√™ncia semanal de entregas"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Entregues no prazo x atrasadas (√∫ltimas 12 semanas)"})]})]})}),R.length>0?e.jsx("div",{className:"h-64",children:e.jsx(de,{width:"100%",height:"100%",children:e.jsxs(Ae,{data:R,margin:{left:-20,right:10},children:[e.jsx(ce,{strokeDasharray:"3 3",className:"stroke-slate-200 dark:stroke-slate-800"}),e.jsx(me,{dataKey:"week",tick:{fontSize:10}}),e.jsx(ue,{tick:{fontSize:10}}),e.jsx(pe,{}),e.jsx(bt,{}),e.jsx(xe,{dataKey:"noPrazo",name:"No prazo",stackId:"a",fill:"#22C55E"}),e.jsx(xe,{dataKey:"atrasadas",name:"Atrasadas",stackId:"a",fill:"#F97316"})]})})}):e.jsx("p",{className:"text-xs text-slate-500",children:"Nenhuma entrega registrada neste per√≠odo."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6 mb-8",children:[e.jsxs(X,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-indigo-100 dark:bg-indigo-900/40",children:e.jsx(yt,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-300"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:"Distribui√ß√£o de notas"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Faixas de desempenho das avalia√ß√µes"})]})]})}),I.length>0?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"h-56",children:e.jsx(de,{width:"100%",height:"100%",children:e.jsxs(Ae,{data:I,children:[e.jsx(ce,{strokeDasharray:"3 3",className:"stroke-slate-200 dark:stroke-slate-800"}),e.jsx(me,{dataKey:"range",tick:{fontSize:10}}),e.jsx(ue,{tick:{fontSize:10}}),e.jsx(pe,{}),e.jsx(xe,{dataKey:"count",children:I.map((a,x)=>e.jsx(Xe,{fill:a.color},x))})]})})}),e.jsxs("div",{className:"mt-3 flex flex-wrap items-center justify-between gap-2",children:[e.jsx(Fe,{variant:"outline",className:"text-[10px]",children:"‚úì Notas normalizadas para escala 0-10"}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400",children:"As notas s√£o exibidas em faixas de 0 a 10 apenas para visualiza√ß√£o."})]})]}):e.jsx("p",{className:"text-xs text-slate-500",children:"Nenhuma nota registrada ainda para montar a distribui√ß√£o."})]}),e.jsxs(X,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-purple-100 dark:bg-purple-900/40",children:e.jsx(Ue,{className:"w-5 h-5 text-purple-600 dark:text-purple-300"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:"Compara√ß√£o entre turmas"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"M√©dia geral por turma"})]})]})}),z.length>0?e.jsx("div",{className:"h-56 overflow-x-auto",children:e.jsx("div",{className:z.length>6?"min-w-[640px]":"min-w-full",children:e.jsx(de,{width:"100%",height:"100%",children:e.jsxs(Ae,{data:z,children:[e.jsx(ce,{strokeDasharray:"3 3",className:"stroke-slate-200 dark:stroke-slate-800"}),e.jsx(me,{dataKey:"name",tick:{fontSize:10}}),e.jsx(ue,{domain:[0,10],tick:{fontSize:10}}),e.jsx(pe,{}),e.jsx(xe,{dataKey:"media",name:"M√©dia",children:z.map((a,x)=>e.jsx(Xe,{fill:a.color||"#3B82F6"},x))})]})})})}):e.jsx("p",{className:"text-xs text-slate-500",children:"Selecione pelo menos uma turma para ver a compara√ß√£o."})]}),e.jsxs(X,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-emerald-100 dark:bg-emerald-900/40",children:e.jsx(jt,{className:"w-5 h-5 text-emerald-600 dark:text-emerald-300"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:"Originalidade e pl√°gio"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Resumo das verifica√ß√µes de pl√°gio"})]})]})}),J?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-1 text-xs",children:[e.jsx("span",{className:"text-slate-500 dark:text-slate-400",children:"Originalidade m√©dia"}),e.jsxs("span",{className:"font-semibold text-emerald-600 dark:text-emerald-300",children:[J.avgOriginality,"%"]})]}),e.jsx(Pa,{value:J.avgOriginality,className:"h-2"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3 text-xs",children:[e.jsxs("div",{className:"p-2 rounded-lg bg-slate-50 dark:bg-slate-900/60",children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Verifica√ß√µes realizadas"}),e.jsx("p",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:J.totalChecks})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-amber-50 dark:bg-amber-900/40",children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Casos cr√≠ticos"}),e.jsx("p",{className:"text-lg font-semibold text-amber-700 dark:text-amber-300",children:J.casesDetected})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-purple-50 dark:bg-purple-900/40",children:[e.jsx("p",{className:"text-slate-500 dark:text-slate-400",children:"Poss√≠vel IA"}),e.jsx("p",{className:"text-lg font-semibold text-purple-700 dark:text-purple-300",children:J.aiDetected})]})]})]}):e.jsx("p",{className:"text-xs text-slate-500",children:"Nenhuma verifica√ß√£o de pl√°gio registrada neste per√≠odo."})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-12",children:[e.jsxs(X,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-blue-100 dark:bg-blue-900/40",children:e.jsx(Nt,{className:"w-5 h-5 text-blue-600 dark:text-blue-300"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:"Top alunos"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Desempenho m√©dio dos alunos mais ativos"})]})]})}),H.length>0?e.jsx("div",{className:"space-y-2 max-h-72 overflow-y-auto pr-1",children:H.map((a,x)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-900/60",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-full bg-gradient-to-br from-blue-500 to-indigo-500 flex items-center justify-center text-white text-xs font-bold",children:(a.name||"?").charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-sm font-semibold text-slate-900 dark:text-slate-50",children:[x+1,". ",a.name]}),e.jsxs("p",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:[a.activities," atividades ‚Ä¢ ",a.onTimeRate,"% no prazo"]}),a.classes&&a.classes.length>0&&e.jsxs("p",{className:"text-[10px] text-slate-400 dark:text-slate-500 mt-0.5",children:["Turmas: ",a.classes.join(", ")]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-emerald-600 dark:text-emerald-300",children:a.avgGrade.toFixed(1)}),e.jsx("p",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:"nota m√©dia"})]})]},a.id))}):e.jsx("p",{className:"text-xs text-slate-500",children:"Ainda n√£o h√° dados suficientes para ranquear os alunos."}),e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsxs("h3",{className:"text-sm font-semibold text-slate-900 dark:text-slate-50 flex items-center gap-1",children:[e.jsx(kt,{className:"w-4 h-4 text-amber-500"}),"Alunos que precisam de aten√ß√£o"]})}),fe.length>0?e.jsx("div",{className:"space-y-2 max-h-56 overflow-y-auto pr-1",children:fe.map((a,x)=>e.jsxs("div",{className:"flex items-center justify-between p-2 rounded-lg bg-amber-50/60 dark:bg-amber-900/20",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-7 h-7 rounded-full bg-amber-500 flex items-center justify-center text-white text-[11px] font-bold",children:(a.name||"?").charAt(0).toUpperCase()}),e.jsxs("div",{children:[e.jsxs("p",{className:"text-xs font-semibold text-slate-900 dark:text-slate-50",children:[x+1,". ",a.name]}),e.jsxs("p",{className:"text-[10px] text-slate-600 dark:text-slate-400",children:[a.activities," atividades ‚Ä¢ ",a.onTimeRate,"% no prazo"]}),a.classes&&a.classes.length>0&&e.jsxs("p",{className:"text-[10px] text-slate-500 dark:text-slate-500 mt-0.5",children:["Turmas: ",a.classes.join(", ")]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"text-sm font-semibold text-amber-700 dark:text-amber-300",children:a.avgGrade.toFixed(1)}),e.jsx("p",{className:"text-[10px] text-slate-500 dark:text-slate-400",children:"nota m√©dia"}),e.jsx(se,{size:"sm",variant:"outline",className:"mt-1 text-xs h-6 px-2",onClick:()=>{window.location.href=`/dashboard/students/${a.id}`},children:"Ver Detalhes"})]})]},a.id))}):e.jsx("p",{className:"text-[11px] text-slate-500 dark:text-slate-400",children:"Nenhum aluno em destaque negativo neste per√≠odo."})]})]}),e.jsxs(X,{className:"p-6",children:[e.jsx("div",{className:"flex items-center justify-between mb-4",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"p-2 rounded-lg bg-sky-100 dark:bg-sky-900/40",children:e.jsx(_t,{className:"w-5 h-5 text-sky-600 dark:text-sky-300"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-lg font-semibold text-slate-900 dark:text-slate-50",children:"Engajamento (beta)"}),e.jsx("p",{className:"text-xs text-slate-500 dark:text-slate-400",children:"Vis√£o geral do engajamento dos alunos"})]})]})}),e.jsxs("div",{className:"space-y-4 text-xs text-slate-500 dark:text-slate-400",children:[e.jsx("p",{children:"Estes indicadores ser√£o enriquecidos com dados de uso da plataforma (acessos, tempo de sess√£o, intera√ß√µes). Por enquanto, use as demais m√©tricas para monitorar participa√ß√£o e desempenho."}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"p-2 rounded-lg bg-slate-50 dark:bg-slate-900/60",children:[e.jsx("p",{children:"Acessos √∫nicos (em breve)"}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-slate-400 dark:text-slate-500",children:"‚Äî"})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-slate-50 dark:bg-slate-900/60",children:[e.jsx("p",{children:"Tempo m√©dio de estudo"}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-slate-400 dark:text-slate-500",children:"‚Äî"})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-slate-50 dark:bg-slate-900/60",children:[e.jsx("p",{children:"Taxa de retorno"}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-slate-400 dark:text-slate-500",children:"‚Äî"})]}),e.jsxs("div",{className:"p-2 rounded-lg bg-slate-50 dark:bg-slate-900/60",children:[e.jsx("p",{children:"Intera√ß√µes na plataforma"}),e.jsx("p",{className:"mt-1 text-lg font-semibold text-slate-400 dark:text-slate-500",children:"‚Äî"})]})]})]})]})]})]})};export{oi as default};
