import{c as E,k as D,u as T,a as L,r as a,j as e,i as I}from"./main-BYt0atFx.js";import{B as l}from"./card-OcUoX-wQ.js";import{D as z,g}from"./dropdown-menu-SP7CzJJe.js";import{S as b}from"./StatsCard-CeLbUark.js";import{E as B}from"./EmptyState-Bdw76lE5.js";import{S as $}from"./SearchInput-DluosGzB.js";import{C as P}from"./CopyButton-BkjOy7ww.js";import{D as q}from"./DataTable-DK3Pvz1t.js";import"./label-Co3Fv3aZ.js";import{C as m}from"./classService-DDEMbQ3F.js";import{A as U}from"./arrow-left-BLRXZrhk.js";import{U as v}from"./users-BrdfOXWs.js";import{M as F}from"./mail-CiL9tdOl.js";import{T as G}from"./trash-2-8IqO6dEf.js";import"./index-B8z1bzn5.js";import"./chevron-right-D-kejNpi.js";import"./x-D6AaFmWt.js";import"./index-XSWTJnEf.js";import"./badge-CqY1vF3c.js";import"./chevron-down-CQZHTFv6.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]],j=E("user-plus",H),de=()=>{const{classId:n}=D(),d=T(),{user:Q}=L(),[u,x]=a.useState(!0),[i,y]=a.useState(null),[c,C]=a.useState([]),[h,p]=a.useState([]),[r,S]=a.useState(""),[N,k]=a.useState({totalStudents:0,activeStudents:0,inactiveStudents:0});a.useEffect(()=>{f()},[n]),a.useEffect(()=>{A()},[c,r]);const f=async()=>{try{x(!0);const s=await m.getClassById(n);y(s);const t=await m.getClassMembers(n,{role:"student"});C(t||[]);const o=t?.filter(w=>w.user?.role==="student").length||0;k({totalStudents:t?.length||0,activeStudents:o,inactiveStudents:0})}catch(s){console.error("Erro ao carregar membros:",s)}finally{x(!1)}},A=()=>{if(!r){p(c);return}const s=r.toLowerCase(),t=c.filter(o=>o.user?.name?.toLowerCase().includes(s)||o.user?.email?.toLowerCase().includes(s));p(t)},M=async(s,t)=>{if(confirm("Tem certeza que deseja remover este aluno da turma?"))try{await m.removeStudentsFromClass(n,[t]),await f()}catch(o){console.error("Erro ao remover membro:",o),alert("Erro ao remover membro. Tente novamente.")}},_=[{key:"name",label:"Aluno",sortable:!0,render:(s,t)=>e.jsxs("div",{className:"flex items-center gap-3",children:[t.user?.avatar_url?e.jsx("img",{src:t.user.avatar_url,alt:t.user.name,className:"w-10 h-10 rounded-full object-cover"}):e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold",children:t.user?.name?.[0]||"A"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-slate-900 dark:text-white",children:t.user?.name||"Sem nome"}),e.jsx("div",{className:"text-sm text-slate-600 dark:text-slate-400",children:t.user?.email||"Sem email"})]})]})},{key:"joined_at",label:"Data de Entrada",sortable:!0,type:"date"},{key:"actions",label:"Ações",align:"right",render:(s,t)=>e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>d(`/teacher/students/${t.user_id}`),children:"Ver Perfil"}),e.jsx(l,{variant:"ghost",size:"sm",onClick:()=>M(t.id,t.user_id),className:"text-red-600 hover:text-red-700 dark:text-red-400",children:e.jsx(G,{className:"w-4 h-4"})})]})}];return u?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(I,{size:"lg",text:"Carregando membros..."})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsxs(l,{variant:"ghost",onClick:()=>d(`/teacher/classes/${n}`),className:"mb-4",children:[e.jsx(U,{className:"w-4 h-4 mr-2"}),"Voltar para Turma"]}),e.jsx(z,{title:`Membros - ${i?.name||"Turma"}`,subtitle:`Gerencie os alunos da turma ${i?.subject?`• ${i.subject}`:""}`,role:"teacher"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-8",children:[e.jsx(b,{title:"Total de Alunos",value:N.totalStudents,icon:v,gradient:g.stats.students,bgColor:"bg-purple-50 dark:bg-purple-950/30",delay:0}),e.jsx(b,{title:"Código de Convite",value:i?.invite_code||"N/A",icon:F,gradient:g.primary,bgColor:"bg-blue-50 dark:bg-blue-950/30",delay:.1,format:"text"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(P,{text:i?.invite_code||"",label:"Copiar Código",successMessage:"Copiado!"}),e.jsx(l,{variant:"outline",size:"sm",onClick:()=>{},children:"Gerar Novo Código"})]})]}),e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 mb-8",children:[e.jsx("div",{className:"flex-1",children:e.jsx($,{placeholder:"Buscar por nome ou email...",value:r,onChange:S})}),e.jsxs(l,{className:"bg-gradient-to-r from-blue-600 to-purple-600 hover:from-blue-700 hover:to-purple-700 text-white",children:[e.jsx(j,{className:"w-4 h-4 mr-2"}),"Adicionar Aluno"]})]}),h.length>0?e.jsx(q,{columns:_,data:h,loading:u}):e.jsx(B,{icon:v,title:r?"Nenhum aluno encontrado":"Nenhum aluno na turma",description:r?"Tente buscar por outro termo.":"Adicione alunos usando o código de convite ou convide-os manualmente.",actionLabel:"Adicionar Aluno",actionIcon:j,action:()=>{}})]})};export{de as default};
