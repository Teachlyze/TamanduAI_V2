import{l as F,s as $,r as u,j as i,f as St,b as Yt,R as S,u as rn,C as nn,q as sn}from"./main-CI5_MmIm.js";import{c as on,u as be,B as X}from"./button-D7H9d9Gd.js";import{C as ke}from"./card-DpcnMbcE.js";import{I as Lt}from"./input-BJMmyirp.js";import{e as an,S as Ge,a as Xe,b as Ke,c as Je,d as ie}from"./select-DSQCR6Pt.js";import"./tabs-ZdS4mBpd.js";import{D as ln,g as mt}from"./DashboardHeader-CYuk3ql1.js";import{S as Qe}from"./StatsCard-C6i8pjlS.js";import{E as cn}from"./EmptyState-2SgC2yO6.js";import{D as dn,a as un,b as fn,e as Et}from"./dropdown-menu-dTrFNQHD.js";import{L as te}from"./label-Nf4YzbUq.js";import{u as Ct}from"./use-toast-D7N2H9RC.js";import{N as mn,C as hn}from"./classService-BCL3qFwZ.js";import{D as yt,a as bt,b as $t,c as Ht}from"./dialog-DzyprNmz.js";import{T as pn}from"./textarea-BEqUT7e4.js";import{S as Pt}from"./slider-DodFceYL.js";import{u as gn,c as zt,P as De,a as se,b as vn}from"./index-D4BuPd_i.js";import{c as qt,b as yn,a as bn,A as Ut,P as xn,D as wn,e as Sn,d as Cn,u as _e}from"./index-DHrdJ99Z.js";import{h as _n,R as Nn,u as kn,F as Dn}from"./Combination-BfETjw1A.js";import{P as Te}from"./SidebarPremium-0_wHXPj0.js";import{R as jn,a as ht}from"./radio-group-BsXpMCyf.js";import{B as Be}from"./badge-BOI6M_d9.js";import{C as xt}from"./checkbox-BZl8Vl57.js";import{c as Oe}from"./utils-CMYNPDpH.js";import{C as Vt}from"./calendar-Dbm_7POQ.js";import{S as Mn}from"./shield-Cghu_EeU.js";import{E as On}from"./ellipsis-vertical-z1DFc2DX.js";import{F as Zt}from"./file-text-CtozP3gh.js";import{U as En}from"./user-BVmzLDrp.js";import{f as Ye,d as Pn,g as Tn,a as An,i as Wn,s as Rn,b as Fn,c as In,e as Bn}from"./format-BdDrz3ZT.js";import{p as Fe}from"./pt-BR-C6XVmIDX.js";import{c as ve,t as oe,n as Yn,f as Gt}from"./en-US-ChNhCS9W.js";import{a as Xt}from"./addDays-jaRQZo3H.js";import{a as Kt,n as Jt,i as Ln,s as $n}from"./isSameMonth-DsEUhuTc.js";import{d as Hn}from"./differenceInCalendarMonths-ka4FvHlb.js";import{e as Qt}from"./endOfWeek-mkYP87Lk.js";import{i as zn}from"./isSameDay-COhndXI7.js";import{e as qn}from"./endOfMonth-rhMYNEE8.js";import{X as Un}from"./x-DGmYUGM5.js";import{u as Vn}from"./index-CtvfaZbL.js";import{U as Zn}from"./users-ChR7WEeh.js";import{T as Gn}from"./triangle-alert-ta0gV1VM.js";import{C as Xn}from"./clock-3X7dheFj.js";import{C as Kn}from"./circle-check-big-KDmohnfK.js";import{T as Jn}from"./trending-up-1zEvTPQM.js";import{C as Qn}from"./circle-alert-X86u08ZX.js";import{S as es}from"./search-C3Ws2_PV.js";import{F as ts}from"./funnel-XFXxK7Il.js";import{D as rs}from"./download-Crb5Tmz4.js";import{m as ns}from"./proxy-CT7Xtxle.js";import"./index-CRRraFTu.js";import"./index-DrPD6SFW.js";import"./chevron-down-DXVEpPD6.js";import"./check-GhIpAKm1.js";import"./chevron-up-CrZ13wWo.js";import"./index-jkBwDHc_.js";import"./chevron-right-CHSrP1xQ.js";import"./house-B6Hparzo.js";import"./book-open-DlGI5eOy.js";import"./graduation-cap-mPfDCRgT.js";import"./chart-column-G5dLAdkQ.js";import"./message-circle-CRpVuYq9.js";import"./settings-BWUwUKXK.js";import"./brain-DVBX4Id_.js";import"./index-RHGs5twt.js";function ss(e,t,r){return Xt(e,t*7,r)}function os(e,t,r){return Kt(e,t*12,r)}function as(e,t){let r,n=t?.in;return e.forEach(s=>{!n&&typeof s=="object"&&(n=ve.bind(null,s));const a=oe(s,n);(!r||r<a||isNaN(+a))&&(r=a)}),ve(n,r||NaN)}function is(e,t){let r,n=t?.in;return e.forEach(s=>{!n&&typeof s=="object"&&(n=ve.bind(null,s));const a=oe(s,n);(!r||r>a||isNaN(+a))&&(r=a)}),ve(n,r||NaN)}function ls(e,t){const{start:r,end:n}=Jt(t?.in,e);let s=+r>+n;const a=s?+r:+n,l=s?n:r;l.setHours(0,0,0,0),l.setDate(1);let o=1;const c=[];for(;+l<=a;)c.push(ve(r,l)),l.setMonth(l.getMonth()+o);return s?c.reverse():c}function cs(e,t){const r=oe(e,t?.in),n=r.getFullYear();return r.setFullYear(n+1,0,0),r.setHours(23,59,59,999),r}function ds(e,t){const{start:r,end:n}=Jt(t?.in,e);let s=+r>+n;const a=s?+r:+n,l=s?n:r;l.setHours(0,0,0,0),l.setMonth(0,1);let o=1;const c=[];for(;+l<=a;)c.push(ve(r,l)),l.setFullYear(l.getFullYear()+o);return s?c.reverse():c}function us(e,t){return Qt(e,{...t,weekStartsOn:1})}function fs(e,t){const r=oe(e,t?.in),n=r.getFullYear(),s=r.getMonth(),a=ve(r,0);return a.setFullYear(n,s+1,0),a.setHours(0,0,0,0),a.getDate()}function ms(e,t){return oe(e,t?.in).getMonth()}function hs(e,t){return oe(e,t?.in).getFullYear()}function ps(e,t){return+oe(e)>+oe(t)}function gs(e,t){return+oe(e)<+oe(t)}function vs(e,t,r){const[n,s]=Yn(r?.in,e,t);return n.getFullYear()===s.getFullYear()}function ys(e,t,r){const n=oe(e,r?.in),s=n.getFullYear(),a=n.getDate(),l=ve(e,0);l.setFullYear(s,t,15),l.setHours(0,0,0,0);const o=fs(l);return n.setMonth(t,Math.min(a,o)),n}function bs(e,t,r){const n=oe(e,r?.in);return isNaN(+n)?ve(e,NaN):(n.setFullYear(t),n)}const xs={"0-10":{min:0,max:10,type:"numeric",decimals:2},"0-100":{min:0,max:100,type:"numeric",decimals:0},"A-F":{type:"letter",scale:[{letter:"A",min:9,max:10},{letter:"B",min:7,max:8.9},{letter:"C",min:5,max:6.9},{letter:"D",min:3,max:4.9},{letter:"F",min:0,max:2.9}]},"pass-fail":{type:"binary",scale:[{label:"Aprovado",min:6,max:10},{label:"Reprovado",min:0,max:5.9}]},"excellent-poor":{type:"concept",scale:[{label:"Excelente",min:9,max:10},{label:"Ã“timo",min:7.5,max:8.9},{label:"Bom",min:6,max:7.4},{label:"Regular",min:4,max:5.9},{label:"Insuficiente",min:0,max:3.9}]}};function ws(e,t="0-10"){const r=xs[t];if(!r)return F.warn(`Sistema de notas desconhecido: ${t}, usando 0-10`),parseFloat(e);if(t==="0-10")return parseFloat(e);if(r.type==="numeric")return parseFloat(e)/r.max*10;if(r.type==="letter"){const s=r.scale.find(a=>a.letter===e.toUpperCase());if(s)return(s.min+s.max)/2}if(r.type==="binary"||r.type==="concept"){const s=r.scale.find(a=>a.label===e);if(s)return(s.min+s.max)/2}const n=parseFloat(e);return isNaN(n)?0:n}const Ss=async(e={})=>{try{let t=$.from("submissions").select(`
        *,
        activity:activities(
          id,
          title,
          type,
          max_score,
          content,
          plagiarism_enabled,
          created_by,
          activity_class_assignments(
            class:classes(
              grading_system
            )
          )
        ),
        student:profiles!student_id(
          id,
          full_name,
          avatar_url,
          email
        ),
        answers(
          id,
          question_id,
          answer_json,
          points_earned
        )
      `).in("status",["submitted","graded","needs_revision"]);switch(e.classId&&(t=t.eq("activity.activity_class_assignments.class_id",e.classId)),e.activityId&&(t=t.eq("activity_id",e.activityId)),e.status&&(t=t.eq("status",e.status)),e.studentId&&(t=t.eq("student_id",e.studentId)),e.flagged&&(t=t.eq("status","needs_review")),e.plagiarism&&e.plagiarism<100&&(t=t.lt("plagiarism_score",e.plagiarism)),e.sortBy||"oldest"){case"newest":t=t.order("submitted_at",{ascending:!1});break;case"student":t=t.order("student.full_name",{ascending:!0});break;case"grade":t=t.order("grade",{ascending:!1});break;default:t=t.order("submitted_at",{ascending:!0})}const{data:n,error:s}=await t;if(s)throw s;return{data:n,error:null}}catch(t){return F.error("Erro ao buscar submissÃµes:",t),{data:null,error:t}}},Cs=async e=>{try{const{data:t,error:r}=await $.from("submissions").select(`
        *,
        activity:activities(
          id,
          title,
          description,
          type,
          max_score,
          content,
          plagiarism_enabled,
          due_date,
          created_by,
          activity_class_assignments(
            class:classes(
              grading_system
            )
          )
        ),
        student:profiles!student_id(
          id,
          full_name,
          avatar_url,
          email
        ),
        answers(*)
      `).eq("id",e).single();if(r)throw r;if(t.activity.plagiarism_enabled){const{data:n}=await $.from("plagiarism_checks").select("*").eq("submission_id",e).order("checked_at",{ascending:!1}).limit(1).single();t.plagiarism_check=n}return{data:t,error:null}}catch(t){return F.error("Erro ao buscar detalhes da submissÃ£o:",t),{data:null,error:t}}},_s=async(e,t)=>{try{const{grade:r,feedback:n,rubricScores:s=[],status:a="graded",teacherId:l}=t;console.log("ðŸ“ Salvando correÃ§Ã£o:",{submissionId:e,grade:r,gradeType:typeof r,feedback:n?.substring(0,50),status:a});const{data:o}=await $.from("submissions").select(`
        activity:activities(
          max_score,
          activity_class_assignments(
            class:classes(grading_system)
          )
        )
      `).eq("id",e).single(),c=o?.activity?.max_score||10,d=o?.activity?.activity_class_assignments?.[0]?.class?.grading_system||"0-10";console.log("ðŸ“Š Convertendo nota:",{gradeInput:r,gradingSystem:d,maxScore:c});let f;const m=r;try{f=ws(r,d),F.debug(`âœ… ConversÃ£o: "${r}" (${d}) â†’ ${f.toFixed(2)}/10`)}catch(N){throw F.error("âŒ Erro na conversÃ£o:",N),new Error(`Nota invÃ¡lida para o sistema ${d}: ${r}`)}if(f>10)throw new Error(`Nota ${r} resultou em ${f.toFixed(2)}/10, excedendo o limite.`);if(f<0)throw new Error("Nota nÃ£o pode ser negativa.");if(isNaN(f))throw new Error(`Nota invÃ¡lida: ${r}`);const h={grade:f,feedback:n||"",status:a,graded_at:new Date().toISOString()};F.debug("ðŸ“¤ Update payload:",h);const{data:p,error:g}=await $.from("submissions").update(h).eq("id",e).select().single();if(g)throw F.error("âŒ Erro no update:",g),g;if(F.debug("âœ… CorreÃ§Ã£o salva com sucesso"),s.length>0){const N=s.map(y=>({submission_id:e,rubric_id:y.rubricId,score:y.score,comment:y.comment||null})),{error:v}=await $.from("submission_rubric_scores").upsert(N);if(v)throw v}return await $.from("correction_history").insert({submission_id:e,teacher_id:l,action:"corrected",new_grade:f,notes:d!=="0-10"?`CorreÃ§Ã£o realizada: "${m}" (${d}) = ${f.toFixed(2)}/10`:`CorreÃ§Ã£o realizada: ${f} pontos`}),{data:p,error:null,converted:d!=="0-10",gradingSystem:d,originalGrade:m,normalizedGrade:f,maxScore:c}}catch(r){return F.error("Erro ao salvar correÃ§Ã£o:",r),{data:null,error:r}}},Ns=async(e,t,r)=>{try{const n=[],s=[];for(const a of e){const l=await _s(a,{...t,teacherId:r});l.error?s.push({submissionId:a,error:l.error}):n.push(l.data)}return{data:{success:n,failed:s,successCount:n.length,failedCount:s.length},error:null}}catch(n){return F.error("Erro na correÃ§Ã£o em lote:",n),{data:null,error:n}}},ks=async(e,t="week")=>{try{const r=new Date,n=new Date;switch(t){case"day":n.setDate(r.getDate()-1);break;case"week":n.setDate(r.getDate()-7);break;case"month":n.setMonth(r.getMonth()-1);break;default:n.setDate(r.getDate()-7)}const{data:s,error:a}=await $.from("correction_metrics").select("*").eq("teacher_id",e).gte("date",n.toISOString().split("T")[0]).order("date",{ascending:!1});if(a)throw a;if(!s||s.length===0)return{data:{corrections_count:0,total_time_seconds:0,avg_grade:0,avg_feedback_length:0,avg_time_per_correction:0,daily_metrics:[]},error:null};const l={corrections_count:0,total_time_seconds:0,grades:[],lengths:[]},o=s.reduce((m,h)=>{const p=Number(h.corrections_count)||0,g=Number(h.total_time_seconds)||0,N=Number(h.avg_grade_given)||0,v=Number(h.feedback_avg_length)||0;return{corrections_count:m.corrections_count+p,total_time_seconds:m.total_time_seconds+g,grades:[...m.grades,N],lengths:[...m.lengths,v]}},l),c=o.grades.length>0?parseFloat((o.grades.reduce((m,h)=>m+h,0)/o.grades.length).toFixed(1)):0,d=o.lengths.length>0?Math.round(o.lengths.reduce((m,h)=>m+h,0)/o.lengths.length):0,f=o.corrections_count>0?Math.round(o.total_time_seconds/o.corrections_count):0;return{data:{...o,avg_grade:c,avg_feedback_length:d,avg_time_per_correction:f,daily_metrics:s},error:null}}catch(r){return F.error("Erro ao buscar mÃ©tricas:",r),{data:null,error:r}}},Ds={async createActivity(e){const{title:t,description:r,created_by:n,max_score:s=100,due_date:a,type:l="assignment",plagiarism_enabled:o=!1,plagiarism_threshold:c=35,instructions:d,content:f}=e,{data:m,error:h}=await $.from("activities").insert({title:t,description:r,instructions:d||r,content:f||{},created_by:n,max_score:s,max_grade:s,due_date:a,type:l,status:"draft",is_draft:!0,is_published:!1,plagiarism_enabled:o,plagiarism_threshold:c,created_at:new Date().toISOString(),updated_at:new Date().toISOString()}).select().single();if(h)throw F.error("Error creating activity:",h),h;return m},async updateActivity(e,t){const{data:r,error:n}=await $.from("activities").update({...t,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(n)throw F.error("Error updating activity:",n),n;return r},async publishActivity(e,t,r=!1){const{data:n,error:s}=await $.from("activities").update({status:"active",is_published:!0,is_draft:!1,plagiarism_enabled:r,updated_at:new Date().toISOString()}).eq("id",e).select().single();if(s)throw F.error("Error publishing activity:",s),s;if(t&&t.length>0){const a=t.map(o=>({activity_id:e,class_id:o,assigned_at:new Date().toISOString()})),{error:l}=await $.from("activity_class_assignments").insert(a);if(l&&l.code!=="23505")throw F.error("Error assigning activity to classes:",l),l;try{for(const o of t){const{data:c}=await $.from("class_members").select("user_id").eq("class_id",o).eq("role","student"),d=c?.map(f=>f.user_id)||[];for(const f of d)await mn.send("activityPublished",{userId:f,variables:{activityTitle:n.title,dueDate:n.due_date?new Date(n.due_date).toLocaleDateString("pt-BR"):"Sem prazo"},channelOverride:"push",metadata:{activityId:e,classId:o}})}}catch(o){F.warn("Failed to notify students:",o)}}return n},async getActivityById(e){const{data:t,error:r}=await $.from("activities").select(`
        *,
        created_by_user:profiles!activities_created_by_fkey(id, full_name, avatar_url),
        assignments:activity_class_assignments(
          class_id,
          class:classes(id, name, subject, color)
        )
      `).eq("id",e).single();if(r)throw F.error("Error fetching activity:",r),r;return t},async getActivitiesByTeacher(e,{status:t,includeDrafts:r=!0}={}){let n=$.from("activities").select(`
        *,
        assignments:activity_class_assignments(
          class_id,
          class:classes(id, name, subject)
        )
      `).eq("created_by",e).order("created_at",{ascending:!1});t&&(n=n.eq("status",t)),r||(n=n.eq("is_draft",!1));const{data:s,error:a}=await n;if(a)throw F.error("Error fetching activities:",a),a;return s},async getActivitySubmissions(e){const{data:t,error:r}=await $.from("submissions").select(`
        *,
        student:profiles!submissions_student_id_fkey(id, full_name, name, avatar_url)
      `).eq("activity_id",e).order("submitted_at",{ascending:!1});if(r)throw F.error("Error fetching submissions:",r),r;return t},async deleteActivity(e){const{error:t}=await $.from("activities").delete().eq("id",e);if(t)throw F.error("Error deleting activity:",t),t;return!0},async getActivitiesByClass(e){const{data:t,error:r}=await $.from("activity_class_assignments").select(`
        activity_id,
        activity:activities(
          id,
          title,
          description,
          due_date,
          created_at,
          created_by_user:profiles!activities_created_by_fkey(id, full_name, avatar_url)
        )
      `).eq("class_id",e);if(r)throw F.error("Error fetching activities:",r),r;return t.map(n=>n.activity)},async getActivityStats(e){const{data:t}=await $.from("submissions").select("id, status, grade, submitted_at").eq("activity_id",e),r=t?.length||0,n=t?.filter(c=>c.submitted_at).length||0,s=t?.filter(c=>c.grade!==null).length||0,a=n-s,l=t?.filter(c=>c.grade!==null).map(c=>parseFloat(c.grade))||[],o=l.length>0?l.reduce((c,d)=>c+d,0)/l.length:0;return{total:r,submitted:n,graded:s,pending:a,avgGrade:o.toFixed(2),submissionRate:r>0?(n/r*100).toFixed(1):0}}};function js(e){const t=Ms(e),r=u.forwardRef((n,s)=>{const{children:a,...l}=n,o=u.Children.toArray(a),c=o.find(Es);if(c){const d=c.props.children,f=o.map(m=>m===c?u.Children.count(d)>1?u.Children.only(null):u.isValidElement(d)?d.props.children:null:m);return i.jsx(t,{...l,ref:s,children:u.isValidElement(d)?u.cloneElement(d,void 0,f):null})}return i.jsx(t,{...l,ref:s,children:a})});return r.displayName=`${e}.Slot`,r}function Ms(e){const t=u.forwardRef((r,n)=>{const{children:s,...a}=r;if(u.isValidElement(s)){const l=Ts(s),o=Ps(a,s.props);return s.type!==u.Fragment&&(o.ref=n?on(n,l):l),u.cloneElement(s,o)}return u.Children.count(s)>1?u.Children.only(null):null});return t.displayName=`${e}.SlotClone`,t}var Os=Symbol("radix.slottable");function Es(e){return u.isValidElement(e)&&typeof e.type=="function"&&"__radixId"in e.type&&e.type.__radixId===Os}function Ps(e,t){const r={...t};for(const n in t){const s=e[n],a=t[n];/^on[A-Z]/.test(n)?s&&a?r[n]=(...o)=>{const c=a(...o);return s(...o),c}:s&&(r[n]=s):n==="style"?r[n]={...s,...a}:n==="className"&&(r[n]=[s,a].filter(Boolean).join(" "))}return{...e,...r}}function Ts(e){let t=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning;return r?e.ref:(t=Object.getOwnPropertyDescriptor(e,"ref")?.get,r=t&&"isReactWarning"in t&&t.isReactWarning,r?e.props.ref:e.props.ref||e.ref)}var rt="Popover",[er]=zt(rt,[qt]),Le=qt(),[As,xe]=er(rt),tr=e=>{const{__scopePopover:t,children:r,open:n,defaultOpen:s,onOpenChange:a,modal:l=!1}=e,o=Le(t),c=u.useRef(null),[d,f]=u.useState(!1),[m,h]=gn({prop:n,defaultProp:s??!1,onChange:a,caller:rt});return i.jsx(yn,{...o,children:i.jsx(As,{scope:t,contentId:bn(),triggerRef:c,open:m,onOpenChange:h,onOpenToggle:u.useCallback(()=>h(p=>!p),[h]),hasCustomAnchor:d,onCustomAnchorAdd:u.useCallback(()=>f(!0),[]),onCustomAnchorRemove:u.useCallback(()=>f(!1),[]),modal:l,children:r})})};tr.displayName=rt;var rr="PopoverAnchor",Ws=u.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=xe(rr,r),a=Le(r),{onCustomAnchorAdd:l,onCustomAnchorRemove:o}=s;return u.useEffect(()=>(l(),()=>o()),[l,o]),i.jsx(Ut,{...a,...n,ref:t})});Ws.displayName=rr;var nr="PopoverTrigger",sr=u.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=xe(nr,r),a=Le(r),l=be(t,s.triggerRef),o=i.jsx(De.button,{type:"button","aria-haspopup":"dialog","aria-expanded":s.open,"aria-controls":s.contentId,"data-state":cr(s.open),...n,ref:l,onClick:se(e.onClick,s.onOpenToggle)});return s.hasCustomAnchor?o:i.jsx(Ut,{asChild:!0,...a,children:o})});sr.displayName=nr;var _t="PopoverPortal",[Rs,Fs]=er(_t,{forceMount:void 0}),or=e=>{const{__scopePopover:t,forceMount:r,children:n,container:s}=e,a=xe(_t,t);return i.jsx(Rs,{scope:t,forceMount:r,children:i.jsx(Te,{present:r||a.open,children:i.jsx(xn,{asChild:!0,container:s,children:n})})})};or.displayName=_t;var Ee="PopoverContent",ar=u.forwardRef((e,t)=>{const r=Fs(Ee,e.__scopePopover),{forceMount:n=r.forceMount,...s}=e,a=xe(Ee,e.__scopePopover);return i.jsx(Te,{present:n||a.open,children:a.modal?i.jsx(Bs,{...s,ref:t}):i.jsx(Ys,{...s,ref:t})})});ar.displayName=Ee;var Is=js("PopoverContent.RemoveScroll"),Bs=u.forwardRef((e,t)=>{const r=xe(Ee,e.__scopePopover),n=u.useRef(null),s=be(t,n),a=u.useRef(!1);return u.useEffect(()=>{const l=n.current;if(l)return _n(l)},[]),i.jsx(Nn,{as:Is,allowPinchZoom:!0,children:i.jsx(ir,{...e,ref:s,trapFocus:r.open,disableOutsidePointerEvents:!0,onCloseAutoFocus:se(e.onCloseAutoFocus,l=>{l.preventDefault(),a.current||r.triggerRef.current?.focus()}),onPointerDownOutside:se(e.onPointerDownOutside,l=>{const o=l.detail.originalEvent,c=o.button===0&&o.ctrlKey===!0,d=o.button===2||c;a.current=d},{checkForDefaultPrevented:!1}),onFocusOutside:se(e.onFocusOutside,l=>l.preventDefault(),{checkForDefaultPrevented:!1})})})}),Ys=u.forwardRef((e,t)=>{const r=xe(Ee,e.__scopePopover),n=u.useRef(!1),s=u.useRef(!1);return i.jsx(ir,{...e,ref:t,trapFocus:!1,disableOutsidePointerEvents:!1,onCloseAutoFocus:a=>{e.onCloseAutoFocus?.(a),a.defaultPrevented||(n.current||r.triggerRef.current?.focus(),a.preventDefault()),n.current=!1,s.current=!1},onInteractOutside:a=>{e.onInteractOutside?.(a),a.defaultPrevented||(n.current=!0,a.detail.originalEvent.type==="pointerdown"&&(s.current=!0));const l=a.target;r.triggerRef.current?.contains(l)&&a.preventDefault(),a.detail.originalEvent.type==="focusin"&&s.current&&a.preventDefault()}})}),ir=u.forwardRef((e,t)=>{const{__scopePopover:r,trapFocus:n,onOpenAutoFocus:s,onCloseAutoFocus:a,disableOutsidePointerEvents:l,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:d,onInteractOutside:f,...m}=e,h=xe(Ee,r),p=Le(r);return kn(),i.jsx(Dn,{asChild:!0,loop:!0,trapped:n,onMountAutoFocus:s,onUnmountAutoFocus:a,children:i.jsx(wn,{asChild:!0,disableOutsidePointerEvents:l,onInteractOutside:f,onEscapeKeyDown:o,onPointerDownOutside:c,onFocusOutside:d,onDismiss:()=>h.onOpenChange(!1),children:i.jsx(Sn,{"data-state":cr(h.open),role:"dialog",id:h.contentId,...p,...m,ref:t,style:{...m.style,"--radix-popover-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-popover-content-available-width":"var(--radix-popper-available-width)","--radix-popover-content-available-height":"var(--radix-popper-available-height)","--radix-popover-trigger-width":"var(--radix-popper-anchor-width)","--radix-popover-trigger-height":"var(--radix-popper-anchor-height)"}})})})}),lr="PopoverClose",Ls=u.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=xe(lr,r);return i.jsx(De.button,{type:"button",...n,ref:t,onClick:se(e.onClick,()=>s.onOpenChange(!1))})});Ls.displayName=lr;var $s="PopoverArrow",Hs=u.forwardRef((e,t)=>{const{__scopePopover:r,...n}=e,s=Le(r);return i.jsx(Cn,{...s,...n,ref:t})});Hs.displayName=$s;function cr(e){return e?"open":"closed"}var zs=tr,qs=sr,Us=or,dr=ar;const Vs=zs,Zs=qs,ur=u.forwardRef(({className:e,align:t="center",sideOffset:r=4,...n},s)=>i.jsx(Us,{children:i.jsx(dr,{ref:s,align:t,sideOffset:r,className:St("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none animate-in data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",e),...n})}));ur.displayName=dr.displayName;const Gs=({submission:e,onCorrect:t,isSelected:r,onSelect:n})=>{const s=d=>{const f={submitted:{label:"Aguardando",color:"bg-yellow-500 text-white"},graded:{label:"Corrigida",color:"bg-green-500 text-white"},needs_revision:{label:"RevisÃ£o",color:"bg-orange-500 text-white"}};return f[d]||f.submitted},a=d=>{const f={assignment:{label:"Aberta",color:"bg-green-100 text-green-700"},quiz:{label:"Fechada",color:"bg-blue-100 text-blue-700"},project:{label:"Mista",color:"bg-purple-100 text-purple-700"}};return f[d]||f.assignment},l=e.submitted_at&&e.activity?.due_date&&new Date(e.submitted_at)>new Date(e.activity.due_date),o=s(e.status),c=a(e.activity?.type);return i.jsx(ke,{className:Oe("p-4 hover:shadow-md transition-all duration-200",e.status==="needs_review"&&"border-l-4 border-l-red-500",r&&"ring-2 ring-blue-500 bg-blue-50"),children:i.jsxs("div",{className:"flex items-center gap-4",children:[n&&i.jsx(xt,{checked:r,onCheckedChange:n}),i.jsx("div",{className:"flex-shrink-0",children:e.student?.avatar_url?i.jsx("img",{src:e.student.avatar_url,alt:e.student.full_name,className:"w-12 h-12 rounded-full"}):i.jsx("div",{className:"w-12 h-12 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold",children:e.student?.full_name?.[0]||"A"})}),i.jsxs("div",{className:"flex-1 min-w-0 space-y-2",children:[i.jsxs("div",{className:"flex items-start justify-between",children:[i.jsxs("div",{className:"flex-1 min-w-0",children:[i.jsx("h3",{className:"text-base font-semibold text-gray-900 dark:text-gray-100 truncate",children:e.student?.full_name||"Aluno Desconhecido"}),i.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 truncate",children:e.activity?.title||"Atividade"})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Be,{className:Oe("text-xs",c.color),children:c.label}),i.jsx(Be,{className:Oe("text-xs",o.color),children:o.label})]})]}),i.jsxs("div",{className:"flex items-center gap-4 text-sm text-gray-600 dark:text-gray-400",children:[i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Vt,{className:"w-4 h-4"}),i.jsx("span",{children:e.submitted_at?Ye(new Date(e.submitted_at),"dd/MM/yyyy 'Ã s' HH:mm",{locale:Fe}):"NÃ£o submetida"})]}),l&&i.jsx(Be,{variant:"destructive",className:"text-xs",children:"Atrasada"}),e.activity?.plagiarism_enabled&&e.plagiarism_score!==null&&i.jsxs("div",{className:"flex items-center gap-1",children:[i.jsx(Mn,{className:Oe("w-4 h-4",e.plagiarism_score>=90?"text-green-600":e.plagiarism_score>=70?"text-yellow-600":"text-red-600")}),i.jsxs("span",{children:[e.plagiarism_score,"% original"]})]}),e.grade!==null&&i.jsxs("div",{className:"font-semibold",children:["Nota: ",e.grade,"/",e.activity?.max_score||10]})]})]}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(X,{onClick:t,className:Oe(e.status==="graded"?"bg-blue-600 hover:bg-blue-700":"bg-green-600 hover:bg-green-700"),children:e.status==="graded"?"Revisar":"Corrigir"}),i.jsxs(dn,{children:[i.jsx(un,{asChild:!0,children:i.jsx(X,{variant:"ghost",size:"icon",children:i.jsx(On,{className:"w-5 h-5"})})}),i.jsxs(fn,{align:"end",children:[i.jsxs(Et,{children:[i.jsx(Zt,{className:"w-4 h-4 mr-2"}),"Ver Atividade"]}),i.jsxs(Et,{children:[i.jsx(En,{className:"w-4 h-4 mr-2"}),"Ver Perfil do Aluno"]})]})]})]})]})})},Xs=({submissions:e,onClose:t,onCompleted:r})=>{const{user:n}=Yt(),{toast:s}=Ct(),[a,l]=u.useState(!1),[o,c]=u.useState("same_grade"),[d,f]=u.useState(""),[m,h]=u.useState(""),[p,g]=u.useState(""),[N,v]=u.useState("add"),y=e[0]?.activity?.max_score||10,D=async()=>{l(!0);try{let b={feedback:m};if(o==="same_grade"){if(!d||parseFloat(d)<0||parseFloat(d)>y){s({title:"Erro",description:`Nota deve estar entre 0 e ${y}`,variant:"destructive"}),l(!1);return}b.grade=parseFloat(d)}const j=e.map(w=>w.id),{data:x,error:C}=await Ns(j,b,n.id);if(C)throw C;s({title:"Sucesso",description:`${x.successCount} submissÃµes corrigidas. ${x.failedCount} falharam.`}),r(),t()}catch(b){F.error("Erro na correÃ§Ã£o em lote:",b),s({title:"Erro",description:"NÃ£o foi possÃ­vel completar a correÃ§Ã£o em lote",variant:"destructive"})}finally{l(!1)}};return i.jsx(yt,{open:!0,onOpenChange:t,children:i.jsxs(bt,{className:"max-w-3xl",children:[i.jsxs($t,{children:[i.jsx(Ht,{children:"CorreÃ§Ã£o em Lote"}),i.jsxs("p",{className:"text-sm text-gray-600",children:[e.length," submissÃµes selecionadas"]})]}),i.jsxs("div",{className:"space-y-6 py-4",children:[i.jsxs(ke,{className:"p-4 max-h-40 overflow-y-auto",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"SubmissÃµes:"}),i.jsx("ul",{className:"space-y-1 text-sm",children:e.map(b=>i.jsxs("li",{className:"flex justify-between",children:[i.jsx("span",{children:b.student?.full_name}),i.jsx("span",{className:"text-gray-500",children:b.activity?.title})]},b.id))})]}),i.jsxs("div",{children:[i.jsx(te,{className:"text-base font-semibold mb-3 block",children:"MÃ©todo de CorreÃ§Ã£o"}),i.jsx(jn,{value:o,onValueChange:c,children:i.jsxs("div",{className:"space-y-3",children:[i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ht,{value:"same_grade",id:"same_grade"}),i.jsx(te,{htmlFor:"same_grade",className:"cursor-pointer",children:"Mesma nota para todas"})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ht,{value:"by_criteria",id:"by_criteria"}),i.jsx(te,{htmlFor:"by_criteria",className:"cursor-pointer",children:"Nota baseada em critÃ©rio (em breve)"})]}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(ht,{value:"adjust",id:"adjust"}),i.jsx(te,{htmlFor:"adjust",className:"cursor-pointer",children:"Ajuste proporcional (em breve)"})]})]})})]}),o==="same_grade"&&i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsxs(te,{children:["Nota (0 - ",y,")"]}),i.jsx(Lt,{type:"number",min:"0",max:y,step:"0.1",value:d,onChange:b=>f(b.target.value),className:"mt-1"})]}),i.jsxs("div",{children:[i.jsx(te,{children:"Feedback PadrÃ£o"}),i.jsx(pn,{value:m,onChange:b=>h(b.target.value),placeholder:"Digite um feedback que serÃ¡ aplicado a todas as submissÃµes...",className:"mt-1",rows:4})]})]}),i.jsxs(ke,{className:"p-4 bg-blue-50 dark:bg-blue-950/30",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"Preview do Resultado"}),i.jsxs("div",{className:"text-sm space-y-1",children:[i.jsxs("p",{children:[i.jsx("strong",{children:"SubmissÃµes afetadas:"})," ",e.length]}),o==="same_grade"&&d&&i.jsxs("p",{children:[i.jsx("strong",{children:"Nota a ser atribuÃ­da:"})," ",d,"/",y]}),i.jsxs("p",{children:[i.jsx("strong",{children:"Feedback:"})," ",m?`${m.substring(0,50)}...`:"Nenhum"]})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-2",children:[i.jsx(X,{variant:"outline",onClick:t,disabled:a,children:"Cancelar"}),i.jsx(X,{onClick:D,disabled:a||!d,className:"bg-green-600 hover:bg-green-700",children:a?"Aplicando...":"Aplicar CorreÃ§Ãµes"})]})]})})};function Ks(e,t,r="long"){return new Intl.DateTimeFormat("en-US",{hour:"numeric",timeZone:e,timeZoneName:r}).format(t).split(/\s/g).slice(2).join(" ")}const Js={},Ie={};function Ne(e,t){try{const n=(Js[e]||=new Intl.DateTimeFormat("en-US",{timeZone:e,timeZoneName:"longOffset"}).format)(t).split("GMT")[1];return n in Ie?Ie[n]:Tt(n,n.split(":"))}catch{if(e in Ie)return Ie[e];const r=e?.match(Qs);return r?Tt(e,r.slice(1)):NaN}}const Qs=/([+-]\d\d):?(\d\d)?/;function Tt(e,t){const r=+(t[0]||0),n=+(t[1]||0),s=+(t[2]||0)/60;return Ie[e]=r*60+n>0?r*60+n+s:r*60-n-s}class de extends Date{constructor(...t){super(),t.length>1&&typeof t[t.length-1]=="string"&&(this.timeZone=t.pop()),this.internal=new Date,isNaN(Ne(this.timeZone,this))?this.setTime(NaN):t.length?typeof t[0]=="number"&&(t.length===1||t.length===2&&typeof t[1]!="number")?this.setTime(t[0]):typeof t[0]=="string"?this.setTime(+new Date(t[0])):t[0]instanceof Date?this.setTime(+t[0]):(this.setTime(+new Date(...t)),fr(this),wt(this)):this.setTime(Date.now())}static tz(t,...r){return r.length?new de(...r,t):new de(Date.now(),t)}withTimeZone(t){return new de(+this,t)}getTimezoneOffset(){const t=-Ne(this.timeZone,this);return t>0?Math.floor(t):Math.ceil(t)}setTime(t){return Date.prototype.setTime.apply(this,arguments),wt(this),+this}[Symbol.for("constructDateFrom")](t){return new de(+new Date(t),this.timeZone)}}const At=/^(get|set)(?!UTC)/;Object.getOwnPropertyNames(Date.prototype).forEach(e=>{if(!At.test(e))return;const t=e.replace(At,"$1UTC");de.prototype[t]&&(e.startsWith("get")?de.prototype[e]=function(){return this.internal[t]()}:(de.prototype[e]=function(){return Date.prototype[t].apply(this.internal,arguments),eo(this),+this},de.prototype[t]=function(){return Date.prototype[t].apply(this,arguments),wt(this),+this}))});function wt(e){e.internal.setTime(+e),e.internal.setUTCSeconds(e.internal.getUTCSeconds()-Math.round(-Ne(e.timeZone,e)*60))}function eo(e){Date.prototype.setFullYear.call(e,e.internal.getUTCFullYear(),e.internal.getUTCMonth(),e.internal.getUTCDate()),Date.prototype.setHours.call(e,e.internal.getUTCHours(),e.internal.getUTCMinutes(),e.internal.getUTCSeconds(),e.internal.getUTCMilliseconds()),fr(e)}function fr(e){const t=Ne(e.timeZone,e),r=t>0?Math.floor(t):Math.ceil(t),n=new Date(+e);n.setUTCHours(n.getUTCHours()-1);const s=-new Date(+e).getTimezoneOffset(),a=-new Date(+n).getTimezoneOffset(),l=s-a,o=Date.prototype.getHours.apply(e)!==e.internal.getUTCHours();l&&o&&e.internal.setUTCMinutes(e.internal.getUTCMinutes()+l);const c=s-r;c&&Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+c);const d=new Date(+e);d.setUTCSeconds(0);const f=s>0?d.getSeconds():(d.getSeconds()-60)%60,m=Math.round(-(Ne(e.timeZone,e)*60))%60;(m||f)&&(e.internal.setUTCSeconds(e.internal.getUTCSeconds()+m),Date.prototype.setUTCSeconds.call(e,Date.prototype.getUTCSeconds.call(e)+m+f));const h=Ne(e.timeZone,e),p=h>0?Math.floor(h):Math.ceil(h),N=-new Date(+e).getTimezoneOffset()-p,v=p!==r,y=N-c;if(v&&y){Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+y);const D=Ne(e.timeZone,e),b=D>0?Math.floor(D):Math.ceil(D),j=p-b;j&&(e.internal.setUTCMinutes(e.internal.getUTCMinutes()+j),Date.prototype.setUTCMinutes.call(e,Date.prototype.getUTCMinutes.call(e)+j))}}class q extends de{static tz(t,...r){return r.length?new q(...r,t):new q(Date.now(),t)}toISOString(){const[t,r,n]=this.tzComponents(),s=`${t}${r}:${n}`;return this.internal.toISOString().slice(0,-1)+s}toString(){return`${this.toDateString()} ${this.toTimeString()}`}toDateString(){const[t,r,n,s]=this.internal.toUTCString().split(" ");return`${t?.slice(0,-1)} ${n} ${r} ${s}`}toTimeString(){const t=this.internal.toUTCString().split(" ")[4],[r,n,s]=this.tzComponents();return`${t} GMT${r}${n}${s} (${Ks(this.timeZone,this)})`}toLocaleString(t,r){return Date.prototype.toLocaleString.call(this,t,{...r,timeZone:r?.timeZone||this.timeZone})}toLocaleDateString(t,r){return Date.prototype.toLocaleDateString.call(this,t,{...r,timeZone:r?.timeZone||this.timeZone})}toLocaleTimeString(t,r){return Date.prototype.toLocaleTimeString.call(this,t,{...r,timeZone:r?.timeZone||this.timeZone})}tzComponents(){const t=this.getTimezoneOffset(),r=t>0?"-":"+",n=String(Math.floor(Math.abs(t)/60)).padStart(2,"0"),s=String(Math.abs(t)%60).padStart(2,"0");return[r,n,s]}withTimeZone(t){return new q(+this,t)}[Symbol.for("constructDateFrom")](t){return new q(+new Date(t),this.timeZone)}}const Wt=5,to=4;function ro(e,t){const r=t.startOfMonth(e),n=r.getDay()>0?r.getDay():7,s=t.addDays(e,-n+1),a=t.addDays(s,Wt*7-1);return t.getMonth(e)===t.getMonth(a)?Wt:to}function mr(e,t){const r=t.startOfMonth(e),n=r.getDay();return n===1?r:n===0?t.addDays(r,-6):t.addDays(r,-1*(n-1))}function no(e,t){const r=mr(e,t),n=ro(e,t);return t.addDays(r,n*7-1)}class re{constructor(t,r){this.Date=Date,this.today=()=>this.overrides?.today?this.overrides.today():this.options.timeZone?q.tz(this.options.timeZone):new this.Date,this.newDate=(n,s,a)=>this.overrides?.newDate?this.overrides.newDate(n,s,a):this.options.timeZone?new q(n,s,a,this.options.timeZone):new Date(n,s,a),this.addDays=(n,s)=>this.overrides?.addDays?this.overrides.addDays(n,s):Xt(n,s),this.addMonths=(n,s)=>this.overrides?.addMonths?this.overrides.addMonths(n,s):Kt(n,s),this.addWeeks=(n,s)=>this.overrides?.addWeeks?this.overrides.addWeeks(n,s):ss(n,s),this.addYears=(n,s)=>this.overrides?.addYears?this.overrides.addYears(n,s):os(n,s),this.differenceInCalendarDays=(n,s)=>this.overrides?.differenceInCalendarDays?this.overrides.differenceInCalendarDays(n,s):Pn(n,s),this.differenceInCalendarMonths=(n,s)=>this.overrides?.differenceInCalendarMonths?this.overrides.differenceInCalendarMonths(n,s):Hn(n,s),this.eachMonthOfInterval=n=>this.overrides?.eachMonthOfInterval?this.overrides.eachMonthOfInterval(n):ls(n),this.eachYearOfInterval=n=>{const s=this.overrides?.eachYearOfInterval?this.overrides.eachYearOfInterval(n):ds(n),a=new Set(s.map(o=>this.getYear(o)));if(a.size===s.length)return s;const l=[];return a.forEach(o=>{l.push(new Date(o,0,1))}),l},this.endOfBroadcastWeek=n=>this.overrides?.endOfBroadcastWeek?this.overrides.endOfBroadcastWeek(n):no(n,this),this.endOfISOWeek=n=>this.overrides?.endOfISOWeek?this.overrides.endOfISOWeek(n):us(n),this.endOfMonth=n=>this.overrides?.endOfMonth?this.overrides.endOfMonth(n):qn(n),this.endOfWeek=(n,s)=>this.overrides?.endOfWeek?this.overrides.endOfWeek(n,s):Qt(n,this.options),this.endOfYear=n=>this.overrides?.endOfYear?this.overrides.endOfYear(n):cs(n),this.format=(n,s,a)=>{const l=this.overrides?.format?this.overrides.format(n,s,this.options):Ye(n,s,this.options);return this.options.numerals&&this.options.numerals!=="latn"?this.replaceDigits(l):l},this.getISOWeek=n=>this.overrides?.getISOWeek?this.overrides.getISOWeek(n):Tn(n),this.getMonth=(n,s)=>this.overrides?.getMonth?this.overrides.getMonth(n,this.options):ms(n,this.options),this.getYear=(n,s)=>this.overrides?.getYear?this.overrides.getYear(n,this.options):hs(n,this.options),this.getWeek=(n,s)=>this.overrides?.getWeek?this.overrides.getWeek(n,this.options):An(n,this.options),this.isAfter=(n,s)=>this.overrides?.isAfter?this.overrides.isAfter(n,s):ps(n,s),this.isBefore=(n,s)=>this.overrides?.isBefore?this.overrides.isBefore(n,s):gs(n,s),this.isDate=n=>this.overrides?.isDate?this.overrides.isDate(n):Wn(n),this.isSameDay=(n,s)=>this.overrides?.isSameDay?this.overrides.isSameDay(n,s):zn(n,s),this.isSameMonth=(n,s)=>this.overrides?.isSameMonth?this.overrides.isSameMonth(n,s):Ln(n,s),this.isSameYear=(n,s)=>this.overrides?.isSameYear?this.overrides.isSameYear(n,s):vs(n,s),this.max=n=>this.overrides?.max?this.overrides.max(n):as(n),this.min=n=>this.overrides?.min?this.overrides.min(n):is(n),this.setMonth=(n,s)=>this.overrides?.setMonth?this.overrides.setMonth(n,s):ys(n,s),this.setYear=(n,s)=>this.overrides?.setYear?this.overrides.setYear(n,s):bs(n,s),this.startOfBroadcastWeek=(n,s)=>this.overrides?.startOfBroadcastWeek?this.overrides.startOfBroadcastWeek(n,this):mr(n,this),this.startOfDay=n=>this.overrides?.startOfDay?this.overrides.startOfDay(n):Rn(n),this.startOfISOWeek=n=>this.overrides?.startOfISOWeek?this.overrides.startOfISOWeek(n):Fn(n),this.startOfMonth=n=>this.overrides?.startOfMonth?this.overrides.startOfMonth(n):$n(n),this.startOfWeek=(n,s)=>this.overrides?.startOfWeek?this.overrides.startOfWeek(n,this.options):In(n,this.options),this.startOfYear=n=>this.overrides?.startOfYear?this.overrides.startOfYear(n):Bn(n),this.options={locale:Gt,...t},this.overrides=r}getDigitMap(){const{numerals:t="latn"}=this.options,r=new Intl.NumberFormat("en-US",{numberingSystem:t}),n={};for(let s=0;s<10;s++)n[s.toString()]=r.format(s);return n}replaceDigits(t){const r=this.getDigitMap();return t.replace(/\d/g,n=>r[n]||n)}formatNumber(t){return this.replaceDigits(t.toString())}getMonthYearOrder(){const t=this.options.locale?.code;return t&&re.yearFirstLocales.has(t)?"year-first":"month-first"}formatMonthYear(t){const{locale:r,timeZone:n,numerals:s}=this.options,a=r?.code;if(a&&re.yearFirstLocales.has(a))try{return new Intl.DateTimeFormat(a,{month:"long",year:"numeric",timeZone:n,numberingSystem:s}).format(t)}catch{}const l=this.getMonthYearOrder()==="year-first"?"y LLLL":"LLLL y";return this.format(t,l)}}re.yearFirstLocales=new Set(["eu","hu","ja","ja-Hira","ja-JP","ko","ko-KR","lt","lt-LT","lv","lv-LV","mn","mn-MN","zh","zh-CN","zh-HK","zh-TW"]);const ue=new re;class hr{constructor(t,r,n=ue){this.date=t,this.displayMonth=r,this.outside=!!(r&&!n.isSameMonth(t,r)),this.dateLib=n}isEqualTo(t){return this.dateLib.isSameDay(t.date,this.date)&&this.dateLib.isSameMonth(t.displayMonth,this.displayMonth)}}class so{constructor(t,r){this.date=t,this.weeks=r}}class oo{constructor(t,r){this.days=r,this.weekNumber=t}}function ao(e){return S.createElement("button",{...e})}function io(e){return S.createElement("span",{...e})}function lo(e){const{size:t=24,orientation:r="left",className:n}=e;return S.createElement("svg",{className:n,width:t,height:t,viewBox:"0 0 24 24"},r==="up"&&S.createElement("polygon",{points:"6.77 17 12.5 11.43 18.24 17 20 15.28 12.5 8 5 15.28"}),r==="down"&&S.createElement("polygon",{points:"6.77 8 12.5 13.57 18.24 8 20 9.72 12.5 17 5 9.72"}),r==="left"&&S.createElement("polygon",{points:"16 18.112 9.81111111 12 16 5.87733333 14.0888889 4 6 12 14.0888889 20"}),r==="right"&&S.createElement("polygon",{points:"8 18.112 14.18888889 12 8 5.87733333 9.91111111 4 18 12 9.91111111 20"}))}function co(e){const{day:t,modifiers:r,...n}=e;return S.createElement("td",{...n})}function uo(e){const{day:t,modifiers:r,...n}=e,s=S.useRef(null);return S.useEffect(()=>{r.focused&&s.current?.focus()},[r.focused]),S.createElement("button",{ref:s,...n})}var k;(function(e){e.Root="root",e.Chevron="chevron",e.Day="day",e.DayButton="day_button",e.CaptionLabel="caption_label",e.Dropdowns="dropdowns",e.Dropdown="dropdown",e.DropdownRoot="dropdown_root",e.Footer="footer",e.MonthGrid="month_grid",e.MonthCaption="month_caption",e.MonthsDropdown="months_dropdown",e.Month="month",e.Months="months",e.Nav="nav",e.NextMonthButton="button_next",e.PreviousMonthButton="button_previous",e.Week="week",e.Weeks="weeks",e.Weekday="weekday",e.Weekdays="weekdays",e.WeekNumber="week_number",e.WeekNumberHeader="week_number_header",e.YearsDropdown="years_dropdown"})(k||(k={}));var Y;(function(e){e.disabled="disabled",e.hidden="hidden",e.outside="outside",e.focused="focused",e.today="today"})(Y||(Y={}));var le;(function(e){e.range_end="range_end",e.range_middle="range_middle",e.range_start="range_start",e.selected="selected"})(le||(le={}));var ee;(function(e){e.weeks_before_enter="weeks_before_enter",e.weeks_before_exit="weeks_before_exit",e.weeks_after_enter="weeks_after_enter",e.weeks_after_exit="weeks_after_exit",e.caption_after_enter="caption_after_enter",e.caption_after_exit="caption_after_exit",e.caption_before_enter="caption_before_enter",e.caption_before_exit="caption_before_exit"})(ee||(ee={}));function fo(e){const{options:t,className:r,components:n,classNames:s,...a}=e,l=[s[k.Dropdown],r].join(" "),o=t?.find(({value:c})=>c===a.value);return S.createElement("span",{"data-disabled":a.disabled,className:s[k.DropdownRoot]},S.createElement(n.Select,{className:l,...a},t?.map(({value:c,label:d,disabled:f})=>S.createElement(n.Option,{key:c,value:c,disabled:f},d))),S.createElement("span",{className:s[k.CaptionLabel],"aria-hidden":!0},o?.label,S.createElement(n.Chevron,{orientation:"down",size:18,className:s[k.Chevron]})))}function mo(e){return S.createElement("div",{...e})}function ho(e){return S.createElement("div",{...e})}function po(e){const{calendarMonth:t,displayIndex:r,...n}=e;return S.createElement("div",{...n},e.children)}function go(e){const{calendarMonth:t,displayIndex:r,...n}=e;return S.createElement("div",{...n})}function vo(e){return S.createElement("table",{...e})}function yo(e){return S.createElement("div",{...e})}const pr=u.createContext(void 0);function $e(){const e=u.useContext(pr);if(e===void 0)throw new Error("useDayPicker() must be used within a custom component.");return e}function bo(e){const{components:t}=$e();return S.createElement(t.Dropdown,{...e})}function xo(e){const{onPreviousClick:t,onNextClick:r,previousMonth:n,nextMonth:s,...a}=e,{components:l,classNames:o,labels:{labelPrevious:c,labelNext:d}}=$e(),f=u.useCallback(h=>{s&&r?.(h)},[s,r]),m=u.useCallback(h=>{n&&t?.(h)},[n,t]);return S.createElement("nav",{...a},S.createElement(l.PreviousMonthButton,{type:"button",className:o[k.PreviousMonthButton],tabIndex:n?void 0:-1,"aria-disabled":n?void 0:!0,"aria-label":c(n),onClick:m},S.createElement(l.Chevron,{disabled:n?void 0:!0,className:o[k.Chevron],orientation:"left"})),S.createElement(l.NextMonthButton,{type:"button",className:o[k.NextMonthButton],tabIndex:s?void 0:-1,"aria-disabled":s?void 0:!0,"aria-label":d(s),onClick:f},S.createElement(l.Chevron,{disabled:s?void 0:!0,orientation:"right",className:o[k.Chevron]})))}function wo(e){const{components:t}=$e();return S.createElement(t.Button,{...e})}function So(e){return S.createElement("option",{...e})}function Co(e){const{components:t}=$e();return S.createElement(t.Button,{...e})}function _o(e){const{rootRef:t,...r}=e;return S.createElement("div",{...r,ref:t})}function No(e){return S.createElement("select",{...e})}function ko(e){const{week:t,...r}=e;return S.createElement("tr",{...r})}function Do(e){return S.createElement("th",{...e})}function jo(e){return S.createElement("thead",{"aria-hidden":!0},S.createElement("tr",{...e}))}function Mo(e){const{week:t,...r}=e;return S.createElement("th",{...r})}function Oo(e){return S.createElement("th",{...e})}function Eo(e){return S.createElement("tbody",{...e})}function Po(e){const{components:t}=$e();return S.createElement(t.Dropdown,{...e})}const To=Object.freeze(Object.defineProperty({__proto__:null,Button:ao,CaptionLabel:io,Chevron:lo,Day:co,DayButton:uo,Dropdown:fo,DropdownNav:mo,Footer:ho,Month:po,MonthCaption:go,MonthGrid:vo,Months:yo,MonthsDropdown:bo,Nav:xo,NextMonthButton:wo,Option:So,PreviousMonthButton:Co,Root:_o,Select:No,Week:ko,WeekNumber:Mo,WeekNumberHeader:Oo,Weekday:Do,Weekdays:jo,Weeks:Eo,YearsDropdown:Po},Symbol.toStringTag,{value:"Module"}));function pe(e,t,r=!1,n=ue){let{from:s,to:a}=e;const{differenceInCalendarDays:l,isSameDay:o}=n;return s&&a?(l(a,s)<0&&([s,a]=[a,s]),l(t,s)>=(r?1:0)&&l(a,t)>=(r?1:0)):!r&&a?o(a,t):!r&&s?o(s,t):!1}function gr(e){return!!(e&&typeof e=="object"&&"before"in e&&"after"in e)}function Nt(e){return!!(e&&typeof e=="object"&&"from"in e)}function vr(e){return!!(e&&typeof e=="object"&&"after"in e)}function yr(e){return!!(e&&typeof e=="object"&&"before"in e)}function br(e){return!!(e&&typeof e=="object"&&"dayOfWeek"in e)}function xr(e,t){return Array.isArray(e)&&e.every(t.isDate)}function ge(e,t,r=ue){const n=Array.isArray(t)?t:[t],{isSameDay:s,differenceInCalendarDays:a,isAfter:l}=r;return n.some(o=>{if(typeof o=="boolean")return o;if(r.isDate(o))return s(e,o);if(xr(o,r))return o.includes(e);if(Nt(o))return pe(o,e,!1,r);if(br(o))return Array.isArray(o.dayOfWeek)?o.dayOfWeek.includes(e.getDay()):o.dayOfWeek===e.getDay();if(gr(o)){const c=a(o.before,e),d=a(o.after,e),f=c>0,m=d<0;return l(o.before,o.after)?m&&f:f||m}return vr(o)?a(e,o.after)>0:yr(o)?a(o.before,e)>0:typeof o=="function"?o(e):!1})}function Ao(e,t,r,n,s){const{disabled:a,hidden:l,modifiers:o,showOutsideDays:c,broadcastCalendar:d,today:f}=t,{isSameDay:m,isSameMonth:h,startOfMonth:p,isBefore:g,endOfMonth:N,isAfter:v}=s,y=r&&p(r),D=n&&N(n),b={[Y.focused]:[],[Y.outside]:[],[Y.disabled]:[],[Y.hidden]:[],[Y.today]:[]},j={};for(const x of e){const{date:C,displayMonth:w}=x,O=!!(w&&!h(C,w)),M=!!(y&&g(C,y)),T=!!(D&&v(C,D)),A=!!(a&&ge(C,a,s)),H=!!(l&&ge(C,l,s))||M||T||!d&&!c&&O||d&&c===!1&&O,ne=m(C,f??s.today());O&&b.outside.push(x),A&&b.disabled.push(x),H&&b.hidden.push(x),ne&&b.today.push(x),o&&Object.keys(o).forEach(z=>{const V=o?.[z];V&&ge(C,V,s)&&(j[z]?j[z].push(x):j[z]=[x])})}return x=>{const C={[Y.focused]:!1,[Y.disabled]:!1,[Y.hidden]:!1,[Y.outside]:!1,[Y.today]:!1},w={};for(const O in b){const M=b[O];C[O]=M.some(T=>T===x)}for(const O in j)w[O]=j[O].some(M=>M===x);return{...C,...w}}}function Wo(e,t,r={}){return Object.entries(e).filter(([,s])=>s===!0).reduce((s,[a])=>(r[a]?s.push(r[a]):t[Y[a]]?s.push(t[Y[a]]):t[le[a]]&&s.push(t[le[a]]),s),[t[k.Day]])}function Ro(e){return{...To,...e}}function Fo(e){const t={"data-mode":e.mode??void 0,"data-required":"required"in e?e.required:void 0,"data-multiple-months":e.numberOfMonths&&e.numberOfMonths>1||void 0,"data-week-numbers":e.showWeekNumber||void 0,"data-broadcast-calendar":e.broadcastCalendar||void 0,"data-nav-layout":e.navLayout||void 0};return Object.entries(e).forEach(([r,n])=>{r.startsWith("data-")&&(t[r]=n)}),t}function Io(){const e={};for(const t in k)e[k[t]]=`rdp-${k[t]}`;for(const t in Y)e[Y[t]]=`rdp-${Y[t]}`;for(const t in le)e[le[t]]=`rdp-${le[t]}`;for(const t in ee)e[ee[t]]=`rdp-${ee[t]}`;return e}function wr(e,t,r){return(r??new re(t)).formatMonthYear(e)}const Bo=wr;function Yo(e,t,r){return(r??new re(t)).format(e,"d")}function Lo(e,t=ue){return t.format(e,"LLLL")}function $o(e,t,r){return(r??new re(t)).format(e,"cccccc")}function Ho(e,t=ue){return e<10?t.formatNumber(`0${e.toLocaleString()}`):t.formatNumber(`${e.toLocaleString()}`)}function zo(){return""}function Sr(e,t=ue){return t.format(e,"yyyy")}const qo=Sr,Uo=Object.freeze(Object.defineProperty({__proto__:null,formatCaption:wr,formatDay:Yo,formatMonthCaption:Bo,formatMonthDropdown:Lo,formatWeekNumber:Ho,formatWeekNumberHeader:zo,formatWeekdayName:$o,formatYearCaption:qo,formatYearDropdown:Sr},Symbol.toStringTag,{value:"Module"}));function Vo(e){return e?.formatMonthCaption&&!e.formatCaption&&(e.formatCaption=e.formatMonthCaption),e?.formatYearCaption&&!e.formatYearDropdown&&(e.formatYearDropdown=e.formatYearCaption),{...Uo,...e}}function Zo(e,t,r,n,s){const{startOfMonth:a,startOfYear:l,endOfYear:o,eachMonthOfInterval:c,getMonth:d}=s;return c({start:l(e),end:o(e)}).map(h=>{const p=n.formatMonthDropdown(h,s),g=d(h),N=t&&h<a(t)||r&&h>a(r)||!1;return{value:g,label:p,disabled:N}})}function Go(e,t={},r={}){let n={...t?.[k.Day]};return Object.entries(e).filter(([,s])=>s===!0).forEach(([s])=>{n={...n,...r?.[s]}}),n}function Xo(e,t,r){const n=e.today(),s=t?e.startOfISOWeek(n):e.startOfWeek(n),a=[];for(let l=0;l<7;l++){const o=e.addDays(s,l);a.push(o)}return a}function Ko(e,t,r,n,s=!1){if(!e||!t)return;const{startOfYear:a,endOfYear:l,eachYearOfInterval:o,getYear:c}=n,d=a(e),f=l(t),m=o({start:d,end:f});return s&&m.reverse(),m.map(h=>{const p=r.formatYearDropdown(h,n);return{value:c(h),label:p,disabled:!1}})}function Cr(e,t,r,n){let s=(n??new re(r)).format(e,"PPPP");return t.today&&(s=`Today, ${s}`),t.selected&&(s=`${s}, selected`),s}const Jo=Cr;function _r(e,t,r){return(r??new re(t)).formatMonthYear(e)}const Qo=_r;function ea(e,t,r,n){let s=(n??new re(r)).format(e,"PPPP");return t?.today&&(s=`Today, ${s}`),s}function ta(e){return"Choose the Month"}function ra(){return""}function na(e){return"Go to the Next Month"}function sa(e){return"Go to the Previous Month"}function oa(e,t,r){return(r??new re(t)).format(e,"cccc")}function aa(e,t){return`Week ${e}`}function ia(e){return"Week Number"}function la(e){return"Choose the Year"}const ca=Object.freeze(Object.defineProperty({__proto__:null,labelCaption:Qo,labelDay:Jo,labelDayButton:Cr,labelGrid:_r,labelGridcell:ea,labelMonthDropdown:ta,labelNav:ra,labelNext:na,labelPrevious:sa,labelWeekNumber:aa,labelWeekNumberHeader:ia,labelWeekday:oa,labelYearDropdown:la},Symbol.toStringTag,{value:"Module"})),He=e=>e instanceof HTMLElement?e:null,pt=e=>[...e.querySelectorAll("[data-animated-month]")??[]],da=e=>He(e.querySelector("[data-animated-month]")),gt=e=>He(e.querySelector("[data-animated-caption]")),vt=e=>He(e.querySelector("[data-animated-weeks]")),ua=e=>He(e.querySelector("[data-animated-nav]")),fa=e=>He(e.querySelector("[data-animated-weekdays]"));function ma(e,t,{classNames:r,months:n,focused:s,dateLib:a}){const l=u.useRef(null),o=u.useRef(n),c=u.useRef(!1);u.useLayoutEffect(()=>{const d=o.current;if(o.current=n,!t||!e.current||!(e.current instanceof HTMLElement)||n.length===0||d.length===0||n.length!==d.length)return;const f=a.isSameMonth(n[0].date,d[0].date),m=a.isAfter(n[0].date,d[0].date),h=m?r[ee.caption_after_enter]:r[ee.caption_before_enter],p=m?r[ee.weeks_after_enter]:r[ee.weeks_before_enter],g=l.current,N=e.current.cloneNode(!0);if(N instanceof HTMLElement?(pt(N).forEach(b=>{if(!(b instanceof HTMLElement))return;const j=da(b);j&&b.contains(j)&&b.removeChild(j);const x=gt(b);x&&x.classList.remove(h);const C=vt(b);C&&C.classList.remove(p)}),l.current=N):l.current=null,c.current||f||s)return;const v=g instanceof HTMLElement?pt(g):[],y=pt(e.current);if(y?.every(D=>D instanceof HTMLElement)&&v&&v.every(D=>D instanceof HTMLElement)){c.current=!0,e.current.style.isolation="isolate";const D=ua(e.current);D&&(D.style.zIndex="1"),y.forEach((b,j)=>{const x=v[j];if(!x)return;b.style.position="relative",b.style.overflow="hidden";const C=gt(b);C&&C.classList.add(h);const w=vt(b);w&&w.classList.add(p);const O=()=>{c.current=!1,e.current&&(e.current.style.isolation=""),D&&(D.style.zIndex=""),C&&C.classList.remove(h),w&&w.classList.remove(p),b.style.position="",b.style.overflow="",b.contains(x)&&b.removeChild(x)};x.style.pointerEvents="none",x.style.position="absolute",x.style.overflow="hidden",x.setAttribute("aria-hidden","true");const M=fa(x);M&&(M.style.opacity="0");const T=gt(x);T&&(T.classList.add(m?r[ee.caption_before_exit]:r[ee.caption_after_exit]),T.addEventListener("animationend",O));const A=vt(x);A&&A.classList.add(m?r[ee.weeks_before_exit]:r[ee.weeks_after_exit]),b.insertBefore(x,b.firstChild)})}})}function ha(e,t,r,n){const s=e[0],a=e[e.length-1],{ISOWeek:l,fixedWeeks:o,broadcastCalendar:c}=r??{},{addDays:d,differenceInCalendarDays:f,differenceInCalendarMonths:m,endOfBroadcastWeek:h,endOfISOWeek:p,endOfMonth:g,endOfWeek:N,isAfter:v,startOfBroadcastWeek:y,startOfISOWeek:D,startOfWeek:b}=n,j=c?y(s,n):l?D(s):b(s),x=c?h(a):l?p(g(a)):N(g(a)),C=f(x,j),w=m(a,s)+1,O=[];for(let A=0;A<=C;A++){const H=d(j,A);if(t&&v(H,t))break;O.push(H)}const T=(c?35:42)*w;if(o&&O.length<T){const A=T-O.length;for(let H=0;H<A;H++){const ne=d(O[O.length-1],1);O.push(ne)}}return O}function pa(e){const t=[];return e.reduce((r,n)=>{const s=n.weeks.reduce((a,l)=>a.concat(l.days.slice()),t.slice());return r.concat(s.slice())},t.slice())}function ga(e,t,r,n){const{numberOfMonths:s=1}=r,a=[];for(let l=0;l<s;l++){const o=n.addMonths(e,l);if(t&&o>t)break;a.push(o)}return a}function Rt(e,t,r,n){const{month:s,defaultMonth:a,today:l=n.today(),numberOfMonths:o=1}=e;let c=s||a||l;const{differenceInCalendarMonths:d,addMonths:f,startOfMonth:m}=n;if(r&&d(r,c)<o-1){const h=-1*(o-1);c=f(r,h)}return t&&d(c,t)<0&&(c=t),m(c)}function va(e,t,r,n){const{addDays:s,endOfBroadcastWeek:a,endOfISOWeek:l,endOfMonth:o,endOfWeek:c,getISOWeek:d,getWeek:f,startOfBroadcastWeek:m,startOfISOWeek:h,startOfWeek:p}=n,g=e.reduce((N,v)=>{const y=r.broadcastCalendar?m(v,n):r.ISOWeek?h(v):p(v),D=r.broadcastCalendar?a(v):r.ISOWeek?l(o(v)):c(o(v)),b=t.filter(w=>w>=y&&w<=D),j=r.broadcastCalendar?35:42;if(r.fixedWeeks&&b.length<j){const w=t.filter(O=>{const M=j-b.length;return O>D&&O<=s(D,M)});b.push(...w)}const x=b.reduce((w,O)=>{const M=r.ISOWeek?d(O):f(O),T=w.find(H=>H.weekNumber===M),A=new hr(O,v,n);return T?T.days.push(A):w.push(new oo(M,[A])),w},[]),C=new so(v,x);return N.push(C),N},[]);return r.reverseMonths?g.reverse():g}function ya(e,t){let{startMonth:r,endMonth:n}=e;const{startOfYear:s,startOfDay:a,startOfMonth:l,endOfMonth:o,addYears:c,endOfYear:d,newDate:f,today:m}=t,{fromYear:h,toYear:p,fromMonth:g,toMonth:N}=e;!r&&g&&(r=g),!r&&h&&(r=t.newDate(h,0,1)),!n&&N&&(n=N),!n&&p&&(n=f(p,11,31));const v=e.captionLayout==="dropdown"||e.captionLayout==="dropdown-years";return r?r=l(r):h?r=f(h,0,1):!r&&v&&(r=s(c(e.today??m(),-100))),n?n=o(n):p?n=f(p,11,31):!n&&v&&(n=d(e.today??m())),[r&&a(r),n&&a(n)]}function ba(e,t,r,n){if(r.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:a=1}=r,{startOfMonth:l,addMonths:o,differenceInCalendarMonths:c}=n,d=s?a:1,f=l(e);if(!t)return o(f,d);if(!(c(t,e)<a))return o(f,d)}function xa(e,t,r,n){if(r.disableNavigation)return;const{pagedNavigation:s,numberOfMonths:a}=r,{startOfMonth:l,addMonths:o,differenceInCalendarMonths:c}=n,d=s?a??1:1,f=l(e);if(!t)return o(f,-d);if(!(c(f,t)<=0))return o(f,-d)}function wa(e){const t=[];return e.reduce((r,n)=>r.concat(n.weeks.slice()),t.slice())}function nt(e,t){const[r,n]=u.useState(e);return[t===void 0?r:t,n]}function Sa(e,t){const[r,n]=ya(e,t),{startOfMonth:s,endOfMonth:a}=t,l=Rt(e,r,n,t),[o,c]=nt(l,e.month?l:void 0);u.useEffect(()=>{const C=Rt(e,r,n,t);c(C)},[e.timeZone]);const d=ga(o,n,e,t),f=ha(d,e.endMonth?a(e.endMonth):void 0,e,t),m=va(d,f,e,t),h=wa(m),p=pa(m),g=xa(o,r,e,t),N=ba(o,n,e,t),{disableNavigation:v,onMonthChange:y}=e,D=C=>h.some(w=>w.days.some(O=>O.isEqualTo(C))),b=C=>{if(v)return;let w=s(C);r&&w<s(r)&&(w=s(r)),n&&w>s(n)&&(w=s(n)),c(w),y?.(w)};return{months:m,weeks:h,days:p,navStart:r,navEnd:n,previousMonth:g,nextMonth:N,goToMonth:b,goToDay:C=>{D(C)||b(C.date)}}}var ce;(function(e){e[e.Today=0]="Today",e[e.Selected=1]="Selected",e[e.LastFocused=2]="LastFocused",e[e.FocusedModifier=3]="FocusedModifier"})(ce||(ce={}));function Ft(e){return!e[Y.disabled]&&!e[Y.hidden]&&!e[Y.outside]}function Ca(e,t,r,n){let s,a=-1;for(const l of e){const o=t(l);Ft(o)&&(o[Y.focused]&&a<ce.FocusedModifier?(s=l,a=ce.FocusedModifier):n?.isEqualTo(l)&&a<ce.LastFocused?(s=l,a=ce.LastFocused):r(l.date)&&a<ce.Selected?(s=l,a=ce.Selected):o[Y.today]&&a<ce.Today&&(s=l,a=ce.Today))}return s||(s=e.find(l=>Ft(t(l)))),s}function _a(e,t,r,n,s,a,l){const{ISOWeek:o,broadcastCalendar:c}=a,{addDays:d,addMonths:f,addWeeks:m,addYears:h,endOfBroadcastWeek:p,endOfISOWeek:g,endOfWeek:N,max:v,min:y,startOfBroadcastWeek:D,startOfISOWeek:b,startOfWeek:j}=l;let C={day:d,week:m,month:f,year:h,startOfWeek:w=>c?D(w,l):o?b(w):j(w),endOfWeek:w=>c?p(w):o?g(w):N(w)}[e](r,t==="after"?1:-1);return t==="before"&&n?C=v([n,C]):t==="after"&&s&&(C=y([s,C])),C}function Nr(e,t,r,n,s,a,l,o=0){if(o>365)return;const c=_a(e,t,r.date,n,s,a,l),d=!!(a.disabled&&ge(c,a.disabled,l)),f=!!(a.hidden&&ge(c,a.hidden,l)),m=c,h=new hr(c,m,l);return!d&&!f?h:Nr(e,t,h,n,s,a,l,o+1)}function Na(e,t,r,n,s){const{autoFocus:a}=e,[l,o]=u.useState(),c=Ca(t.days,r,n||(()=>!1),l),[d,f]=u.useState(a?c:void 0);return{isFocusTarget:N=>!!c?.isEqualTo(N),setFocused:f,focused:d,blur:()=>{o(d),f(void 0)},moveFocus:(N,v)=>{if(!d)return;const y=Nr(N,v,d,t.navStart,t.navEnd,e,s);y&&(e.disableNavigation&&!t.days.some(b=>b.isEqualTo(y))||(t.goToDay(y),f(y)))}}}function ka(e,t){const{selected:r,required:n,onSelect:s}=e,[a,l]=nt(r,s?r:void 0),o=s?r:a,{isSameDay:c}=t,d=p=>o?.some(g=>c(g,p))??!1,{min:f,max:m}=e;return{selected:o,select:(p,g,N)=>{let v=[...o??[]];if(d(p)){if(o?.length===f||n&&o?.length===1)return;v=o?.filter(y=>!c(y,p))}else o?.length===m?v=[p]:v=[...v,p];return s||l(v),s?.(v,p,g,N),v},isSelected:d}}function Da(e,t,r=0,n=0,s=!1,a=ue){const{from:l,to:o}=t||{},{isSameDay:c,isAfter:d,isBefore:f}=a;let m;if(!l&&!o)m={from:e,to:r>0?void 0:e};else if(l&&!o)c(l,e)?r===0?m={from:l,to:e}:s?m={from:l,to:void 0}:m=void 0:f(e,l)?m={from:e,to:l}:m={from:l,to:e};else if(l&&o)if(c(l,e)&&c(o,e))s?m={from:l,to:o}:m=void 0;else if(c(l,e))m={from:l,to:r>0?void 0:e};else if(c(o,e))m={from:e,to:r>0?void 0:e};else if(f(e,l))m={from:e,to:o};else if(d(e,l))m={from:l,to:e};else if(d(e,o))m={from:l,to:e};else throw new Error("Invalid range");if(m?.from&&m?.to){const h=a.differenceInCalendarDays(m.to,m.from);n>0&&h>n?m={from:e,to:void 0}:r>1&&h<r&&(m={from:e,to:void 0})}return m}function ja(e,t,r=ue){const n=Array.isArray(t)?t:[t];let s=e.from;const a=r.differenceInCalendarDays(e.to,e.from),l=Math.min(a,6);for(let o=0;o<=l;o++){if(n.includes(s.getDay()))return!0;s=r.addDays(s,1)}return!1}function It(e,t,r=ue){return pe(e,t.from,!1,r)||pe(e,t.to,!1,r)||pe(t,e.from,!1,r)||pe(t,e.to,!1,r)}function Ma(e,t,r=ue){const n=Array.isArray(t)?t:[t];if(n.filter(o=>typeof o!="function").some(o=>typeof o=="boolean"?o:r.isDate(o)?pe(e,o,!1,r):xr(o,r)?o.some(c=>pe(e,c,!1,r)):Nt(o)?o.from&&o.to?It(e,{from:o.from,to:o.to},r):!1:br(o)?ja(e,o.dayOfWeek,r):gr(o)?r.isAfter(o.before,o.after)?It(e,{from:r.addDays(o.after,1),to:r.addDays(o.before,-1)},r):ge(e.from,o,r)||ge(e.to,o,r):vr(o)||yr(o)?ge(e.from,o,r)||ge(e.to,o,r):!1))return!0;const l=n.filter(o=>typeof o=="function");if(l.length){let o=e.from;const c=r.differenceInCalendarDays(e.to,e.from);for(let d=0;d<=c;d++){if(l.some(f=>f(o)))return!0;o=r.addDays(o,1)}}return!1}function Oa(e,t){const{disabled:r,excludeDisabled:n,selected:s,required:a,onSelect:l}=e,[o,c]=nt(s,l?s:void 0),d=l?s:o;return{selected:d,select:(h,p,g)=>{const{min:N,max:v}=e,y=h?Da(h,d,N,v,a,t):void 0;return n&&r&&y?.from&&y.to&&Ma({from:y.from,to:y.to},r,t)&&(y.from=h,y.to=void 0),l||c(y),l?.(y,h,p,g),y},isSelected:h=>d&&pe(d,h,!1,t)}}function Ea(e,t){const{selected:r,required:n,onSelect:s}=e,[a,l]=nt(r,s?r:void 0),o=s?r:a,{isSameDay:c}=t;return{selected:o,select:(m,h,p)=>{let g=m;return!n&&o&&o&&c(m,o)&&(g=void 0),s||l(g),s?.(g,m,h,p),g},isSelected:m=>o?c(o,m):!1}}function Pa(e,t){const r=Ea(e,t),n=ka(e,t),s=Oa(e,t);switch(e.mode){case"single":return r;case"multiple":return n;case"range":return s;default:return}}function Ta(e){let t=e;t.timeZone&&(t={...e},t.today&&(t.today=new q(t.today,t.timeZone)),t.month&&(t.month=new q(t.month,t.timeZone)),t.defaultMonth&&(t.defaultMonth=new q(t.defaultMonth,t.timeZone)),t.startMonth&&(t.startMonth=new q(t.startMonth,t.timeZone)),t.endMonth&&(t.endMonth=new q(t.endMonth,t.timeZone)),t.mode==="single"&&t.selected?t.selected=new q(t.selected,t.timeZone):t.mode==="multiple"&&t.selected?t.selected=t.selected?.map(P=>new q(P,t.timeZone)):t.mode==="range"&&t.selected&&(t.selected={from:t.selected.from?new q(t.selected.from,t.timeZone):void 0,to:t.selected.to?new q(t.selected.to,t.timeZone):void 0}));const{components:r,formatters:n,labels:s,dateLib:a,locale:l,classNames:o}=u.useMemo(()=>{const P={...Gt,...t.locale};return{dateLib:new re({locale:P,weekStartsOn:t.broadcastCalendar?1:t.weekStartsOn,firstWeekContainsDate:t.firstWeekContainsDate,useAdditionalWeekYearTokens:t.useAdditionalWeekYearTokens,useAdditionalDayOfYearTokens:t.useAdditionalDayOfYearTokens,timeZone:t.timeZone,numerals:t.numerals},t.dateLib),components:Ro(t.components),formatters:Vo(t.formatters),labels:{...ca,...t.labels},locale:P,classNames:{...Io(),...t.classNames}}},[t.locale,t.broadcastCalendar,t.weekStartsOn,t.firstWeekContainsDate,t.useAdditionalWeekYearTokens,t.useAdditionalDayOfYearTokens,t.timeZone,t.numerals,t.dateLib,t.components,t.formatters,t.labels,t.classNames]),{captionLayout:c,mode:d,navLayout:f,numberOfMonths:m=1,onDayBlur:h,onDayClick:p,onDayFocus:g,onDayKeyDown:N,onDayMouseEnter:v,onDayMouseLeave:y,onNextClick:D,onPrevClick:b,showWeekNumber:j,styles:x}=t,{formatCaption:C,formatDay:w,formatMonthDropdown:O,formatWeekNumber:M,formatWeekNumberHeader:T,formatWeekdayName:A,formatYearDropdown:H}=n,ne=Sa(t,a),{days:z,months:V,navStart:je,navEnd:Z,previousMonth:U,nextMonth:K,goToMonth:J}=ne,me=Ao(z,t,je,Z,a),{isSelected:he,select:Me,selected:we}=Pa(t,a)??{},{blur:Ae,focused:We,isFocusTarget:Se,moveFocus:Re,setFocused:Ce}=Na(t,ne,me,he??(()=>!1),a),{labelDayButton:ze,labelGridcell:qe,labelGrid:Ue,labelMonthDropdown:Ve,labelNav:Ze,labelPrevious:at,labelNext:it,labelWeekday:lt,labelWeekNumber:_,labelWeekNumberHeader:W,labelYearDropdown:L}=s,G=u.useMemo(()=>Xo(a,t.ISOWeek),[a,t.ISOWeek]),ye=d!==void 0||p!==void 0,ct=u.useCallback(()=>{U&&(J(U),b?.(U))},[U,J,b]),dt=u.useCallback(()=>{K&&(J(K),D?.(K))},[J,K,D]),Lr=u.useCallback((P,B)=>E=>{E.preventDefault(),E.stopPropagation(),Ce(P),Me?.(P.date,B,E),p?.(P.date,B,E)},[Me,p,Ce]),$r=u.useCallback((P,B)=>E=>{Ce(P),g?.(P.date,B,E)},[g,Ce]),Hr=u.useCallback((P,B)=>E=>{Ae(),h?.(P.date,B,E)},[Ae,h]),zr=u.useCallback((P,B)=>E=>{const I={ArrowLeft:[E.shiftKey?"month":"day",t.dir==="rtl"?"after":"before"],ArrowRight:[E.shiftKey?"month":"day",t.dir==="rtl"?"before":"after"],ArrowDown:[E.shiftKey?"year":"week","after"],ArrowUp:[E.shiftKey?"year":"week","before"],PageUp:[E.shiftKey?"year":"month","before"],PageDown:[E.shiftKey?"year":"month","after"],Home:["startOfWeek","before"],End:["endOfWeek","after"]};if(I[E.key]){E.preventDefault(),E.stopPropagation();const[Q,R]=I[E.key];Re(Q,R)}N?.(P.date,B,E)},[Re,N,t.dir]),qr=u.useCallback((P,B)=>E=>{v?.(P.date,B,E)},[v]),Ur=u.useCallback((P,B)=>E=>{y?.(P.date,B,E)},[y]),Vr=u.useCallback(P=>B=>{const E=Number(B.target.value),I=a.setMonth(a.startOfMonth(P),E);J(I)},[a,J]),Zr=u.useCallback(P=>B=>{const E=Number(B.target.value),I=a.setYear(a.startOfMonth(P),E);J(I)},[a,J]),{className:Gr,style:Xr}=u.useMemo(()=>({className:[o[k.Root],t.className].filter(Boolean).join(" "),style:{...x?.[k.Root],...t.style}}),[o,t.className,t.style,x]),Kr=Fo(t),Ot=u.useRef(null);ma(Ot,!!t.animate,{classNames:o,months:V,focused:We,dateLib:a});const Jr={dayPickerProps:t,selected:we,select:Me,isSelected:he,months:V,nextMonth:K,previousMonth:U,goToMonth:J,getModifiers:me,components:r,classNames:o,styles:x,labels:s,formatters:n};return S.createElement(pr.Provider,{value:Jr},S.createElement(r.Root,{rootRef:t.animate?Ot:void 0,className:Gr,style:Xr,dir:t.dir,id:t.id,lang:t.lang,nonce:t.nonce,title:t.title,role:t.role,"aria-label":t["aria-label"],"aria-labelledby":t["aria-labelledby"],...Kr},S.createElement(r.Months,{className:o[k.Months],style:x?.[k.Months]},!t.hideNavigation&&!f&&S.createElement(r.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[k.Nav],style:x?.[k.Nav],"aria-label":Ze(),onPreviousClick:ct,onNextClick:dt,previousMonth:U,nextMonth:K}),V.map((P,B)=>S.createElement(r.Month,{"data-animated-month":t.animate?"true":void 0,className:o[k.Month],style:x?.[k.Month],key:B,displayIndex:B,calendarMonth:P},f==="around"&&!t.hideNavigation&&B===0&&S.createElement(r.PreviousMonthButton,{type:"button",className:o[k.PreviousMonthButton],tabIndex:U?void 0:-1,"aria-disabled":U?void 0:!0,"aria-label":at(U),onClick:ct,"data-animated-button":t.animate?"true":void 0},S.createElement(r.Chevron,{disabled:U?void 0:!0,className:o[k.Chevron],orientation:t.dir==="rtl"?"right":"left"})),S.createElement(r.MonthCaption,{"data-animated-caption":t.animate?"true":void 0,className:o[k.MonthCaption],style:x?.[k.MonthCaption],calendarMonth:P,displayIndex:B},c?.startsWith("dropdown")?S.createElement(r.DropdownNav,{className:o[k.Dropdowns],style:x?.[k.Dropdowns]},(()=>{const E=c==="dropdown"||c==="dropdown-months"?S.createElement(r.MonthsDropdown,{key:"month",className:o[k.MonthsDropdown],"aria-label":Ve(),classNames:o,components:r,disabled:!!t.disableNavigation,onChange:Vr(P.date),options:Zo(P.date,je,Z,n,a),style:x?.[k.Dropdown],value:a.getMonth(P.date)}):S.createElement("span",{key:"month"},O(P.date,a)),I=c==="dropdown"||c==="dropdown-years"?S.createElement(r.YearsDropdown,{key:"year",className:o[k.YearsDropdown],"aria-label":L(a.options),classNames:o,components:r,disabled:!!t.disableNavigation,onChange:Zr(P.date),options:Ko(je,Z,n,a,!!t.reverseYears),style:x?.[k.Dropdown],value:a.getYear(P.date)}):S.createElement("span",{key:"year"},H(P.date,a));return a.getMonthYearOrder()==="year-first"?[I,E]:[E,I]})(),S.createElement("span",{role:"status","aria-live":"polite",style:{border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"absolute",width:"1px",whiteSpace:"nowrap",wordWrap:"normal"}},C(P.date,a.options,a))):S.createElement(r.CaptionLabel,{className:o[k.CaptionLabel],role:"status","aria-live":"polite"},C(P.date,a.options,a))),f==="around"&&!t.hideNavigation&&B===m-1&&S.createElement(r.NextMonthButton,{type:"button",className:o[k.NextMonthButton],tabIndex:K?void 0:-1,"aria-disabled":K?void 0:!0,"aria-label":it(K),onClick:dt,"data-animated-button":t.animate?"true":void 0},S.createElement(r.Chevron,{disabled:K?void 0:!0,className:o[k.Chevron],orientation:t.dir==="rtl"?"left":"right"})),B===m-1&&f==="after"&&!t.hideNavigation&&S.createElement(r.Nav,{"data-animated-nav":t.animate?"true":void 0,className:o[k.Nav],style:x?.[k.Nav],"aria-label":Ze(),onPreviousClick:ct,onNextClick:dt,previousMonth:U,nextMonth:K}),S.createElement(r.MonthGrid,{role:"grid","aria-multiselectable":d==="multiple"||d==="range","aria-label":Ue(P.date,a.options,a)||void 0,className:o[k.MonthGrid],style:x?.[k.MonthGrid]},!t.hideWeekdays&&S.createElement(r.Weekdays,{"data-animated-weekdays":t.animate?"true":void 0,className:o[k.Weekdays],style:x?.[k.Weekdays]},j&&S.createElement(r.WeekNumberHeader,{"aria-label":W(a.options),className:o[k.WeekNumberHeader],style:x?.[k.WeekNumberHeader],scope:"col"},T()),G.map(E=>S.createElement(r.Weekday,{"aria-label":lt(E,a.options,a),className:o[k.Weekday],key:String(E),style:x?.[k.Weekday],scope:"col"},A(E,a.options,a)))),S.createElement(r.Weeks,{"data-animated-weeks":t.animate?"true":void 0,className:o[k.Weeks],style:x?.[k.Weeks]},P.weeks.map(E=>S.createElement(r.Week,{className:o[k.Week],key:E.weekNumber,style:x?.[k.Week],week:E},j&&S.createElement(r.WeekNumber,{week:E,style:x?.[k.WeekNumber],"aria-label":_(E.weekNumber,{locale:l}),className:o[k.WeekNumber],scope:"row",role:"rowheader"},M(E.weekNumber,a)),E.days.map(I=>{const{date:Q}=I,R=me(I);if(R[Y.focused]=!R.hidden&&!!We?.isEqualTo(I),R[le.selected]=he?.(Q)||R.selected,Nt(we)){const{from:ut,to:ft}=we;R[le.range_start]=!!(ut&&ft&&a.isSameDay(Q,ut)),R[le.range_end]=!!(ut&&ft&&a.isSameDay(Q,ft)),R[le.range_middle]=pe(we,Q,!0,a)}const Qr=Go(R,x,t.modifiersStyles),en=Wo(R,o,t.modifiersClassNames),tn=!ye&&!R.hidden?qe(Q,R,a.options,a):void 0;return S.createElement(r.Day,{key:`${a.format(Q,"yyyy-MM-dd")}_${a.format(I.displayMonth,"yyyy-MM")}`,day:I,modifiers:R,className:en.join(" "),style:Qr,role:"gridcell","aria-selected":R.selected||void 0,"aria-label":tn,"data-day":a.format(Q,"yyyy-MM-dd"),"data-month":I.outside?a.format(Q,"yyyy-MM"):void 0,"data-selected":R.selected||void 0,"data-disabled":R.disabled||void 0,"data-hidden":R.hidden||void 0,"data-outside":I.outside||void 0,"data-focused":R.focused||void 0,"data-today":R.today||void 0},!R.hidden&&ye?S.createElement(r.DayButton,{className:o[k.DayButton],style:x?.[k.DayButton],type:"button",day:I,modifiers:R,disabled:R.disabled||void 0,tabIndex:Se(I)?0:-1,"aria-label":ze(Q,R,a.options,a),onClick:Lr(I,R),onBlur:Hr(I,R),onFocus:$r(I,R),onKeyDown:zr(I,R),onMouseEnter:qr(I,R),onMouseLeave:Ur(I,R)},w(Q,a.options,a)):!R.hidden&&w(I.date,a.options,a))})))))))),t.footer&&S.createElement(r.Footer,{className:o[k.Footer],style:x?.[k.Footer],role:"status","aria-live":"polite"},t.footer)))}const Aa=({mode:e="single",selected:t,onSelect:r,numberOfMonths:n=1,locale:s,initialFocus:a,...l})=>i.jsx(Ta,{mode:e,selected:t,onSelect:r,numberOfMonths:n,locale:s,initialFocus:a,...l}),Wa=({onApply:e,onClear:t})=>{const[r,n]=u.useState({classes:[],activities:[],statuses:[],gradeRange:[0,10],dateRange:{from:null,to:null},plagiarismThreshold:70,onlyFlagged:!1}),s=()=>{e(r)},a=()=>{n({classes:[],activities:[],statuses:[],gradeRange:[0,10],dateRange:{from:null,to:null},plagiarismThreshold:70,onlyFlagged:!1}),t()};return i.jsxs(ke,{className:"p-6 space-y-6",children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsx("h3",{className:"text-lg font-semibold",children:"Filtros AvanÃ§ados"}),i.jsxs(X,{variant:"ghost",size:"sm",onClick:a,children:[i.jsx(Un,{className:"w-4 h-4 mr-2"}),"Limpar Todos"]})]}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx(te,{className:"font-semibold",children:"Status da CorreÃ§Ã£o"}),i.jsx("div",{className:"space-y-2",children:["submitted","graded","needs_revision"].map(l=>i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(xt,{id:`status-${l}`,checked:r.statuses.includes(l),onCheckedChange:o=>{n(c=>({...c,statuses:o?[...c.statuses,l]:c.statuses.filter(d=>d!==l)}))}}),i.jsx(te,{htmlFor:`status-${l}`,className:"cursor-pointer text-sm",children:l==="submitted"?"NÃ£o Corrigidas":l==="graded"?"Corrigidas":"Necessitam RevisÃ£o"})]},l))})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx(te,{className:"font-semibold",children:"Faixa de Nota (apenas corrigidas)"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(Pt,{value:r.gradeRange,onValueChange:l=>n(o=>({...o,gradeRange:l})),min:0,max:10,step:.5,className:"w-full"}),i.jsxs("div",{className:"flex justify-between text-sm text-gray-600",children:[i.jsx("span",{children:r.gradeRange[0]}),i.jsx("span",{children:r.gradeRange[1]})]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(te,{className:"font-semibold",children:"Data de SubmissÃ£o"}),i.jsxs(Vs,{children:[i.jsx(Zs,{asChild:!0,children:i.jsxs(X,{variant:"outline",className:Oe("w-full justify-start text-left font-normal",!r.dateRange.from&&"text-muted-foreground"),children:[i.jsx(Vt,{className:"mr-2 h-4 w-4"}),r.dateRange.from?r.dateRange.to?i.jsxs(i.Fragment,{children:[Ye(r.dateRange.from,"dd/MM/yyyy",{locale:Fe})," -"," ",Ye(r.dateRange.to,"dd/MM/yyyy",{locale:Fe})]}):Ye(r.dateRange.from,"dd/MM/yyyy",{locale:Fe}):i.jsx("span",{children:"Selecione perÃ­odo"})]})}),i.jsx(ur,{className:"w-auto p-0",align:"start",children:i.jsx(Aa,{initialFocus:!0,mode:"range",selected:r.dateRange,onSelect:l=>n(o=>({...o,dateRange:l||{from:null,to:null}})),numberOfMonths:2,locale:Fe})})]})]}),i.jsxs("div",{className:"space-y-3",children:[i.jsx(te,{className:"font-semibold",children:"Originalidade MÃ­nima (%)"}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(Pt,{value:[r.plagiarismThreshold],onValueChange:([l])=>n(o=>({...o,plagiarismThreshold:l})),min:0,max:100,step:5,className:"w-full"}),i.jsxs("div",{className:"text-sm text-center text-gray-600",children:["Mostrar apenas com originalidade < ",r.plagiarismThreshold,"%"]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx(te,{className:"font-semibold",children:"Outros Filtros"}),i.jsxs("div",{className:"flex items-center space-x-2",children:[i.jsx(xt,{id:"flagged",checked:r.onlyFlagged,onCheckedChange:l=>n(o=>({...o,onlyFlagged:l}))}),i.jsx(te,{htmlFor:"flagged",className:"cursor-pointer text-sm",children:"Apenas marcadas para revisÃ£o"})]})]})]}),i.jsxs("div",{className:"flex justify-end gap-2 pt-4 border-t",children:[i.jsx(X,{variant:"outline",onClick:a,children:"Limpar"}),i.jsx(X,{onClick:s,className:"bg-blue-600 hover:bg-blue-700",children:"Aplicar Filtros"})]})]})};function Ra(e,t){return u.useReducer((r,n)=>t[r][n]??r,e)}var kt="ScrollArea",[kr]=zt(kt),[Fa,ae]=kr(kt),Dr=u.forwardRef((e,t)=>{const{__scopeScrollArea:r,type:n="hover",dir:s,scrollHideDelay:a=600,...l}=e,[o,c]=u.useState(null),[d,f]=u.useState(null),[m,h]=u.useState(null),[p,g]=u.useState(null),[N,v]=u.useState(null),[y,D]=u.useState(0),[b,j]=u.useState(0),[x,C]=u.useState(!1),[w,O]=u.useState(!1),M=be(t,A=>c(A)),T=Vn(s);return i.jsx(Fa,{scope:r,type:n,dir:T,scrollHideDelay:a,scrollArea:o,viewport:d,onViewportChange:f,content:m,onContentChange:h,scrollbarX:p,onScrollbarXChange:g,scrollbarXEnabled:x,onScrollbarXEnabledChange:C,scrollbarY:N,onScrollbarYChange:v,scrollbarYEnabled:w,onScrollbarYEnabledChange:O,onCornerWidthChange:D,onCornerHeightChange:j,children:i.jsx(De.div,{dir:T,...l,ref:M,style:{position:"relative","--radix-scroll-area-corner-width":y+"px","--radix-scroll-area-corner-height":b+"px",...e.style}})})});Dr.displayName=kt;var jr="ScrollAreaViewport",Mr=u.forwardRef((e,t)=>{const{__scopeScrollArea:r,children:n,nonce:s,...a}=e,l=ae(jr,r),o=u.useRef(null),c=be(t,o,l.onViewportChange);return i.jsxs(i.Fragment,{children:[i.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-scroll-area-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-scroll-area-viewport]::-webkit-scrollbar{display:none}"},nonce:s}),i.jsx(De.div,{"data-radix-scroll-area-viewport":"",...a,ref:c,style:{overflowX:l.scrollbarXEnabled?"scroll":"hidden",overflowY:l.scrollbarYEnabled?"scroll":"hidden",...e.style},children:i.jsx("div",{ref:l.onContentChange,style:{minWidth:"100%",display:"table"},children:n})})]})});Mr.displayName=jr;var fe="ScrollAreaScrollbar",Dt=u.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=ae(fe,e.__scopeScrollArea),{onScrollbarXEnabledChange:a,onScrollbarYEnabledChange:l}=s,o=e.orientation==="horizontal";return u.useEffect(()=>(o?a(!0):l(!0),()=>{o?a(!1):l(!1)}),[o,a,l]),s.type==="hover"?i.jsx(Ia,{...n,ref:t,forceMount:r}):s.type==="scroll"?i.jsx(Ba,{...n,ref:t,forceMount:r}):s.type==="auto"?i.jsx(Or,{...n,ref:t,forceMount:r}):s.type==="always"?i.jsx(jt,{...n,ref:t}):null});Dt.displayName=fe;var Ia=u.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=ae(fe,e.__scopeScrollArea),[a,l]=u.useState(!1);return u.useEffect(()=>{const o=s.scrollArea;let c=0;if(o){const d=()=>{window.clearTimeout(c),l(!0)},f=()=>{c=window.setTimeout(()=>l(!1),s.scrollHideDelay)};return o.addEventListener("pointerenter",d),o.addEventListener("pointerleave",f),()=>{window.clearTimeout(c),o.removeEventListener("pointerenter",d),o.removeEventListener("pointerleave",f)}}},[s.scrollArea,s.scrollHideDelay]),i.jsx(Te,{present:r||a,children:i.jsx(Or,{"data-state":a?"visible":"hidden",...n,ref:t})})}),Ba=u.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=ae(fe,e.__scopeScrollArea),a=e.orientation==="horizontal",l=ot(()=>c("SCROLL_END"),100),[o,c]=Ra("hidden",{hidden:{SCROLL:"scrolling"},scrolling:{SCROLL_END:"idle",POINTER_ENTER:"interacting"},interacting:{SCROLL:"interacting",POINTER_LEAVE:"idle"},idle:{HIDE:"hidden",SCROLL:"scrolling",POINTER_ENTER:"interacting"}});return u.useEffect(()=>{if(o==="idle"){const d=window.setTimeout(()=>c("HIDE"),s.scrollHideDelay);return()=>window.clearTimeout(d)}},[o,s.scrollHideDelay,c]),u.useEffect(()=>{const d=s.viewport,f=a?"scrollLeft":"scrollTop";if(d){let m=d[f];const h=()=>{const p=d[f];m!==p&&(c("SCROLL"),l()),m=p};return d.addEventListener("scroll",h),()=>d.removeEventListener("scroll",h)}},[s.viewport,a,c,l]),i.jsx(Te,{present:r||o!=="hidden",children:i.jsx(jt,{"data-state":o==="hidden"?"hidden":"visible",...n,ref:t,onPointerEnter:se(e.onPointerEnter,()=>c("POINTER_ENTER")),onPointerLeave:se(e.onPointerLeave,()=>c("POINTER_LEAVE"))})})}),Or=u.forwardRef((e,t)=>{const r=ae(fe,e.__scopeScrollArea),{forceMount:n,...s}=e,[a,l]=u.useState(!1),o=e.orientation==="horizontal",c=ot(()=>{if(r.viewport){const d=r.viewport.offsetWidth<r.viewport.scrollWidth,f=r.viewport.offsetHeight<r.viewport.scrollHeight;l(o?d:f)}},10);return Pe(r.viewport,c),Pe(r.content,c),i.jsx(Te,{present:n||a,children:i.jsx(jt,{"data-state":a?"visible":"hidden",...s,ref:t})})}),jt=u.forwardRef((e,t)=>{const{orientation:r="vertical",...n}=e,s=ae(fe,e.__scopeScrollArea),a=u.useRef(null),l=u.useRef(0),[o,c]=u.useState({content:0,viewport:0,scrollbar:{size:0,paddingStart:0,paddingEnd:0}}),d=Wr(o.viewport,o.content),f={...n,sizes:o,onSizesChange:c,hasThumb:d>0&&d<1,onThumbChange:h=>a.current=h,onThumbPointerUp:()=>l.current=0,onThumbPointerDown:h=>l.current=h};function m(h,p){return qa(h,l.current,o,p)}return r==="horizontal"?i.jsx(Ya,{...f,ref:t,onThumbPositionChange:()=>{if(s.viewport&&a.current){const h=s.viewport.scrollLeft,p=Bt(h,o,s.dir);a.current.style.transform=`translate3d(${p}px, 0, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollLeft=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollLeft=m(h,s.dir))}}):r==="vertical"?i.jsx(La,{...f,ref:t,onThumbPositionChange:()=>{if(s.viewport&&a.current){const h=s.viewport.scrollTop,p=Bt(h,o);a.current.style.transform=`translate3d(0, ${p}px, 0)`}},onWheelScroll:h=>{s.viewport&&(s.viewport.scrollTop=h)},onDragScroll:h=>{s.viewport&&(s.viewport.scrollTop=m(h))}}):null}),Ya=u.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,...s}=e,a=ae(fe,e.__scopeScrollArea),[l,o]=u.useState(),c=u.useRef(null),d=be(t,c,a.onScrollbarXChange);return u.useEffect(()=>{c.current&&o(getComputedStyle(c.current))},[c]),i.jsx(Pr,{"data-orientation":"horizontal",...s,ref:d,sizes:r,style:{bottom:0,left:a.dir==="rtl"?"var(--radix-scroll-area-corner-width)":0,right:a.dir==="ltr"?"var(--radix-scroll-area-corner-width)":0,"--radix-scroll-area-thumb-width":st(r)+"px",...e.style},onThumbPointerDown:f=>e.onThumbPointerDown(f.x),onDragScroll:f=>e.onDragScroll(f.x),onWheelScroll:(f,m)=>{if(a.viewport){const h=a.viewport.scrollLeft+f.deltaX;e.onWheelScroll(h),Fr(h,m)&&f.preventDefault()}},onResize:()=>{c.current&&a.viewport&&l&&n({content:a.viewport.scrollWidth,viewport:a.viewport.offsetWidth,scrollbar:{size:c.current.clientWidth,paddingStart:tt(l.paddingLeft),paddingEnd:tt(l.paddingRight)}})}})}),La=u.forwardRef((e,t)=>{const{sizes:r,onSizesChange:n,...s}=e,a=ae(fe,e.__scopeScrollArea),[l,o]=u.useState(),c=u.useRef(null),d=be(t,c,a.onScrollbarYChange);return u.useEffect(()=>{c.current&&o(getComputedStyle(c.current))},[c]),i.jsx(Pr,{"data-orientation":"vertical",...s,ref:d,sizes:r,style:{top:0,right:a.dir==="ltr"?0:void 0,left:a.dir==="rtl"?0:void 0,bottom:"var(--radix-scroll-area-corner-height)","--radix-scroll-area-thumb-height":st(r)+"px",...e.style},onThumbPointerDown:f=>e.onThumbPointerDown(f.y),onDragScroll:f=>e.onDragScroll(f.y),onWheelScroll:(f,m)=>{if(a.viewport){const h=a.viewport.scrollTop+f.deltaY;e.onWheelScroll(h),Fr(h,m)&&f.preventDefault()}},onResize:()=>{c.current&&a.viewport&&l&&n({content:a.viewport.scrollHeight,viewport:a.viewport.offsetHeight,scrollbar:{size:c.current.clientHeight,paddingStart:tt(l.paddingTop),paddingEnd:tt(l.paddingBottom)}})}})}),[$a,Er]=kr(fe),Pr=u.forwardRef((e,t)=>{const{__scopeScrollArea:r,sizes:n,hasThumb:s,onThumbChange:a,onThumbPointerUp:l,onThumbPointerDown:o,onThumbPositionChange:c,onDragScroll:d,onWheelScroll:f,onResize:m,...h}=e,p=ae(fe,r),[g,N]=u.useState(null),v=be(t,M=>N(M)),y=u.useRef(null),D=u.useRef(""),b=p.viewport,j=n.content-n.viewport,x=_e(f),C=_e(c),w=ot(m,10);function O(M){if(y.current){const T=M.clientX-y.current.left,A=M.clientY-y.current.top;d({x:T,y:A})}}return u.useEffect(()=>{const M=T=>{const A=T.target;g?.contains(A)&&x(T,j)};return document.addEventListener("wheel",M,{passive:!1}),()=>document.removeEventListener("wheel",M,{passive:!1})},[b,g,j,x]),u.useEffect(C,[n,C]),Pe(g,w),Pe(p.content,w),i.jsx($a,{scope:r,scrollbar:g,hasThumb:s,onThumbChange:_e(a),onThumbPointerUp:_e(l),onThumbPositionChange:C,onThumbPointerDown:_e(o),children:i.jsx(De.div,{...h,ref:v,style:{position:"absolute",...h.style},onPointerDown:se(e.onPointerDown,M=>{M.button===0&&(M.target.setPointerCapture(M.pointerId),y.current=g.getBoundingClientRect(),D.current=document.body.style.webkitUserSelect,document.body.style.webkitUserSelect="none",p.viewport&&(p.viewport.style.scrollBehavior="auto"),O(M))}),onPointerMove:se(e.onPointerMove,O),onPointerUp:se(e.onPointerUp,M=>{const T=M.target;T.hasPointerCapture(M.pointerId)&&T.releasePointerCapture(M.pointerId),document.body.style.webkitUserSelect=D.current,p.viewport&&(p.viewport.style.scrollBehavior=""),y.current=null})})})}),et="ScrollAreaThumb",Tr=u.forwardRef((e,t)=>{const{forceMount:r,...n}=e,s=Er(et,e.__scopeScrollArea);return i.jsx(Te,{present:r||s.hasThumb,children:i.jsx(Ha,{ref:t,...n})})}),Ha=u.forwardRef((e,t)=>{const{__scopeScrollArea:r,style:n,...s}=e,a=ae(et,r),l=Er(et,r),{onThumbPositionChange:o}=l,c=be(t,m=>l.onThumbChange(m)),d=u.useRef(void 0),f=ot(()=>{d.current&&(d.current(),d.current=void 0)},100);return u.useEffect(()=>{const m=a.viewport;if(m){const h=()=>{if(f(),!d.current){const p=Ua(m,o);d.current=p,o()}};return o(),m.addEventListener("scroll",h),()=>m.removeEventListener("scroll",h)}},[a.viewport,f,o]),i.jsx(De.div,{"data-state":l.hasThumb?"visible":"hidden",...s,ref:c,style:{width:"var(--radix-scroll-area-thumb-width)",height:"var(--radix-scroll-area-thumb-height)",...n},onPointerDownCapture:se(e.onPointerDownCapture,m=>{const p=m.target.getBoundingClientRect(),g=m.clientX-p.left,N=m.clientY-p.top;l.onThumbPointerDown({x:g,y:N})}),onPointerUp:se(e.onPointerUp,l.onThumbPointerUp)})});Tr.displayName=et;var Mt="ScrollAreaCorner",Ar=u.forwardRef((e,t)=>{const r=ae(Mt,e.__scopeScrollArea),n=!!(r.scrollbarX&&r.scrollbarY);return r.type!=="scroll"&&n?i.jsx(za,{...e,ref:t}):null});Ar.displayName=Mt;var za=u.forwardRef((e,t)=>{const{__scopeScrollArea:r,...n}=e,s=ae(Mt,r),[a,l]=u.useState(0),[o,c]=u.useState(0),d=!!(a&&o);return Pe(s.scrollbarX,()=>{const f=s.scrollbarX?.offsetHeight||0;s.onCornerHeightChange(f),c(f)}),Pe(s.scrollbarY,()=>{const f=s.scrollbarY?.offsetWidth||0;s.onCornerWidthChange(f),l(f)}),d?i.jsx(De.div,{...n,ref:t,style:{width:a,height:o,position:"absolute",right:s.dir==="ltr"?0:void 0,left:s.dir==="rtl"?0:void 0,bottom:0,...e.style}}):null});function tt(e){return e?parseInt(e,10):0}function Wr(e,t){const r=e/t;return isNaN(r)?0:r}function st(e){const t=Wr(e.viewport,e.content),r=e.scrollbar.paddingStart+e.scrollbar.paddingEnd,n=(e.scrollbar.size-r)*t;return Math.max(n,18)}function qa(e,t,r,n="ltr"){const s=st(r),a=s/2,l=t||a,o=s-l,c=r.scrollbar.paddingStart+l,d=r.scrollbar.size-r.scrollbar.paddingEnd-o,f=r.content-r.viewport,m=n==="ltr"?[0,f]:[f*-1,0];return Rr([c,d],m)(e)}function Bt(e,t,r="ltr"){const n=st(t),s=t.scrollbar.paddingStart+t.scrollbar.paddingEnd,a=t.scrollbar.size-s,l=t.content-t.viewport,o=a-n,c=r==="ltr"?[0,l]:[l*-1,0],d=an(e,c);return Rr([0,l],[0,o])(d)}function Rr(e,t){return r=>{if(e[0]===e[1]||t[0]===t[1])return t[0];const n=(t[1]-t[0])/(e[1]-e[0]);return t[0]+n*(r-e[0])}}function Fr(e,t){return e>0&&e<t}var Ua=(e,t=()=>{})=>{let r={left:e.scrollLeft,top:e.scrollTop},n=0;return(function s(){const a={left:e.scrollLeft,top:e.scrollTop},l=r.left!==a.left,o=r.top!==a.top;(l||o)&&t(),r=a,n=window.requestAnimationFrame(s)})(),()=>window.cancelAnimationFrame(n)};function ot(e,t){const r=_e(e),n=u.useRef(0);return u.useEffect(()=>()=>window.clearTimeout(n.current),[]),u.useCallback(()=>{window.clearTimeout(n.current),n.current=window.setTimeout(r,t)},[r,t])}function Pe(e,t){const r=_e(t);vn(()=>{let n=0;if(e){const s=new ResizeObserver(()=>{cancelAnimationFrame(n),n=window.requestAnimationFrame(r)});return s.observe(e),()=>{window.cancelAnimationFrame(n),s.unobserve(e)}}},[e,r])}var Ir=Dr,Va=Mr,Za=Ar;const Br=u.forwardRef(({className:e,children:t,...r},n)=>i.jsxs(Ir,{ref:n,className:St("relative overflow-hidden",e),...r,children:[i.jsx(Va,{className:"h-full w-full rounded-[inherit]",children:t}),i.jsx(Yr,{}),i.jsx(Za,{})]}));Br.displayName=Ir.displayName;const Yr=u.forwardRef(({className:e,orientation:t="vertical",...r},n)=>i.jsx(Dt,{ref:n,orientation:t,className:St("flex touch-none select-none transition-colors",t==="vertical"&&"h-full w-2.5 border-l border-l-transparent p-[1px]",t==="horizontal"&&"h-2.5 border-t border-t-transparent p-[1px]",e),...r,children:i.jsx(Tr,{className:"relative flex-1 rounded-full bg-border"})}));Yr.displayName=Dt.displayName;const Ga=({submissionIds:e,onClose:t})=>{const{toast:r}=Ct(),[n,s]=u.useState([]),[a,l]=u.useState(!0),[o,c]=u.useState(null),d=p=>{if(!p)return"";const g=p.content,N=p.activity;if(!g)return"";if(typeof g=="string")try{const v=JSON.parse(g);if(v&&typeof v=="object"){if(typeof v.answer=="string"&&v.answer.trim())return v.answer;if(typeof v.text=="string"&&v.text.trim())return v.text;const y=N?.content?.questions||[],D=v.selectedAnswers||v.answers||(y.length>0?v:null);if(D&&typeof D=="object"&&y.length>0){const b=[];if(y.forEach((j,x)=>{const C=j.id??x,w=D[C]??D[String(C)]??D[`question_${x}`];if(w==null||w==="")return;let O=null;if(j.alternatives&&j.alternatives.length>0){const T=String(w),A=j.alternatives.find(V=>String(V.id)===T),H=j.alternatives.find(V=>String(V.letter)===T),ne=j.alternatives.find(V=>V.text===w);O=(A||H||ne)?.text||T}else O=typeof w=="string"?w:JSON.stringify(w);const M=j.text||j.question||`QuestÃ£o ${x+1}`;b.push(`${M}: ${O}`)}),b.length>0)return b.join(`
`)}}return g}catch{return g}if(typeof g=="object"){if(typeof g.answer=="string"&&g.answer.trim())return g.answer;if(typeof g.text=="string"&&g.text.trim())return g.text;const v=N?.content?.questions||[],y=g.selectedAnswers||g.answers||(v.length>0?g:null);if(y&&typeof y=="object"&&v.length>0){const D=[];if(v.forEach((b,j)=>{const x=b.id??j,C=y[x]??y[String(x)]??y[`question_${j}`];if(C==null||C==="")return;let w=null;if(b.alternatives&&b.alternatives.length>0){const M=String(C),T=b.alternatives.find(z=>String(z.id)===M),A=b.alternatives.find(z=>String(z.letter)===M),H=b.alternatives.find(z=>z.text===C);w=(T||A||H)?.text||M}else w=typeof C=="string"?C:JSON.stringify(C);const O=b.text||b.question||`QuestÃ£o ${j+1}`;D.push(`${O}: ${w}`)}),D.length>0)return D.join(`
`)}try{return JSON.stringify(g)}catch{return""}}return""};u.useEffect(()=>{f()},[e]);const f=async()=>{l(!0);try{const p=e.map(v=>Cs(v)),N=(await Promise.all(p)).map(v=>v.data).filter(Boolean);if(s(N),N.length===2){const v=m(N[0],N[1]);c(v)}}catch(p){F.error("Erro ao carregar submissÃµes:",p)}finally{l(!1)}},m=(p,g)=>{const N=d(p)||"",v=d(g)||"",y=N.toLowerCase().split(/\s+/),D=v.toLowerCase().split(/\s+/),j=y.filter(x=>D.includes(x)).length/Math.max(y.length,D.length)*100;return Math.round(j)},h=p=>p>=80?"text-red-600 bg-red-100":p>=60?"text-yellow-600 bg-yellow-100":"text-green-600 bg-green-100";return a?i.jsx(yt,{open:!0,onOpenChange:t,children:i.jsx(bt,{className:"max-w-6xl h-[80vh]",children:i.jsx("div",{className:"flex items-center justify-center h-full",children:i.jsx("p",{children:"Carregando comparaÃ§Ã£o..."})})})}):i.jsx(yt,{open:!0,onOpenChange:t,children:i.jsxs(bt,{className:"max-w-7xl h-[90vh]",children:[i.jsx($t,{children:i.jsxs(Ht,{className:"flex items-center gap-2",children:[i.jsx(Zn,{className:"w-5 h-5"}),"ComparaÃ§Ã£o de SubmissÃµes"]})}),o!==null&&i.jsxs(ke,{className:`p-4 ${h(o)}`,children:[i.jsxs("div",{className:"flex items-center justify-between",children:[i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx(Gn,{className:"w-5 h-5"}),i.jsx("span",{className:"font-semibold",children:"Similaridade Detectada:"})]}),i.jsxs("div",{className:"text-2xl font-bold",children:[o,"%"]})]}),o>=60&&i.jsx("p",{className:"text-sm mt-2",children:"Alta similaridade detectada entre as submissÃµes. Recomenda-se revisÃ£o manual detalhada."})]}),i.jsx("div",{className:"grid grid-cols-2 gap-4 flex-1 overflow-hidden",children:n.map((p,g)=>i.jsxs(ke,{className:"p-4 flex flex-col",children:[i.jsxs("div",{className:"mb-4",children:[i.jsx("h3",{className:"font-semibold text-lg",children:p.student?.full_name}),i.jsx("p",{className:"text-sm text-gray-600",children:p.activity?.title}),i.jsxs("div",{className:"flex gap-2 mt-2",children:[p.grade!==null&&i.jsxs(Be,{children:["Nota: ",p.grade]}),i.jsx(Be,{variant:"outline",children:p.status==="graded"?"Corrigida":"Pendente"})]})]}),i.jsx(Br,{className:"flex-1",children:i.jsxs("div",{className:"pr-4",children:[i.jsx("h4",{className:"font-semibold mb-2",children:"SubmissÃ£o:"}),i.jsx("div",{className:"bg-gray-50 p-3 rounded whitespace-pre-wrap text-sm",children:d(p)||"Sem conteÃºdo"}),p.feedback&&i.jsxs(i.Fragment,{children:[i.jsx("h4",{className:"font-semibold mt-4 mb-2",children:"Feedback:"}),i.jsx("div",{className:"bg-blue-50 p-3 rounded text-sm",children:p.feedback})]})]})})]},p.id))}),i.jsxs("div",{className:"flex justify-between items-center pt-4 border-t",children:[i.jsxs("div",{className:"text-sm text-gray-600",children:["Comparando ",n.length," submissÃµes"]}),i.jsxs("div",{className:"flex gap-2",children:[i.jsx(X,{variant:"outline",onClick:t,children:"Fechar"}),i.jsx(X,{variant:"destructive",disabled:o<60,onClick:()=>{r({title:"ðŸš§ Em desenvolvimento",description:"Funcionalidade de marcar plÃ¡gio serÃ¡ implementada em breve."})},children:"Marcar como Suspeita"})]})]})]})})},il=()=>{const{user:e}=Yt(),{toast:t}=Ct(),r=rn();nn();const[n,s]=u.useState(!1),[a,l]=u.useState(!0),[o,c]=u.useState([]),[d,f]=u.useState([]),[m,h]=u.useState(null),[p,g]=u.useState(0),[N,v]=u.useState(!1),[y,D]=u.useState([]),[b,j]=u.useState(!1),[x,C]=u.useState(!1),[w,O]=u.useState("all"),[M,T]=u.useState(""),[A,H]=u.useState("oldest"),[ne,z]=u.useState(!1),[V,je]=u.useState([]),[Z,U]=u.useState(""),[K,J]=u.useState([]),[me,he]=u.useState("all"),[Me,we]=u.useState(!0),[Ae,We]=u.useState(!1),[Se,Re]=u.useState({totalPending:0,correctedToday:0,avgGrade:0,avgTime:0}),Ce=u.useCallback(async()=>{if(e?.id)try{we(!0);const _=await hn.getTeacherClasses(e.id);je(_),(_.length===1||_.length>1)&&U(_[0].id)}catch(_){F.error("Erro ao carregar turmas:",_),t({title:"Erro",description:"NÃ£o foi possÃ­vel carregar as turmas.",variant:"destructive"})}finally{we(!1)}},[e]),ze=u.useCallback(async _=>{if(!_){J([]),he("all");return}try{We(!0);const W=await Ds.getActivitiesByClass(_),L=Array.isArray(W)?W.map(G=>({id:G.id,title:G.title,description:G.description,due_date:G.due_date,created_at:G.created_at,status:G.status,max_score:G.max_score})):[];J(L),L.length===1?he(L[0].id):he("all")}catch(W){F.error("Erro ao carregar atividades:",W),t({title:"Erro",description:"NÃ£o foi possÃ­vel carregar as atividades desta turma.",variant:"destructive"})}finally{We(!1)}},[]);u.useEffect(()=>{(async()=>{await Ce(),await Ve(),l(!1)})()},[Ce]),u.useEffect(()=>{Z?ze(Z):(J([]),he(""))},[Z,ze]),u.useEffect(()=>{Z&&Ue()},[Z]);const qe=u.useMemo(()=>{if(!o||o.length===0)return[];let _=[...o];if(me&&me!=="all"&&(_=_.filter(W=>W.activity_id===me)),w==="pending"?_=_.filter(W=>W.status==="submitted"):w==="graded"?_=_.filter(W=>W.status==="graded"):w==="flagged"&&(_=_.filter(W=>W.status==="needs_review")),M){const W=M.toLowerCase();_=_.filter(L=>L.student?.full_name?.toLowerCase().includes(W)||L.activity?.title?.toLowerCase().includes(W))}return A==="newest"?_.sort((W,L)=>new Date(L.submitted_at)-new Date(W.submitted_at)):A==="oldest"?_.sort((W,L)=>new Date(W.submitted_at)-new Date(L.submitted_at)):A==="grade_asc"?_.sort((W,L)=>(W.grade||0)-(L.grade||0)):A==="grade_desc"&&_.sort((W,L)=>(L.grade||0)-(W.grade||0)),_},[o,me,w,M,A]);u.useEffect(()=>{f(qe)},[qe]);const Ue=async()=>{if(!(!e||!Z))try{s(!0);const _={classId:Z,activityId:null,status:null,sortBy:A},{data:W,error:L}=await Ss(_);if(L)throw L;c(W||[]);const G=W?.filter(ye=>ye.status==="submitted").length||0;Re(ye=>({...ye,totalPending:G}))}catch(_){F.error("Erro ao carregar submissÃµes:",_),t({title:"Erro",description:"NÃ£o foi possÃ­vel carregar as submissÃµes.",variant:"destructive"})}finally{s(!1)}},Ve=async()=>{if(e)try{const{data:_}=await ks(e.id,"day");_&&Re(W=>({...W,correctedToday:_.corrections_count||0,avgGrade:_.avg_grade?.toFixed(1)||0,avgTime:Math.round(_.avg_time_per_correction/60)||0}))}catch(_){F.error("Erro ao carregar mÃ©tricas:",_)}},Ze=(_,W=0)=>{r(`/dashboard/grading/${_.id}`)},at=()=>{if(y.length===0){t({title:"Erro",description:"Selecione pelo menos uma submissÃ£o",variant:"destructive"});return}j(!0)},it=()=>{if(y.length!==2){t({title:"Erro",description:"Selecione exatamente 2 submissÃµes para comparar",variant:"destructive"});return}C(!0)},lt=()=>{t({title:"Em breve",description:"FunÃ§Ã£o de exportaÃ§Ã£o serÃ¡ implementada em breve."})};return a?i.jsx("div",{className:"flex items-center justify-center min-h-screen",children:i.jsx(sn,{size:"lg",text:"Carregando correÃ§Ãµes..."})}):i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[i.jsx(ln,{title:"CorreÃ§Ãµes Pendentes",subtitle:`${Se.totalPending} submissÃµes aguardando correÃ§Ã£o`,role:"teacher"}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-6 mb-8",children:[i.jsx(Qe,{title:"Pendentes",value:Se.totalPending,icon:Xn,gradient:mt.warning,bgColor:"bg-yellow-50 dark:bg-yellow-950/30"}),i.jsx(Qe,{title:"Corrigidas Hoje",value:Se.correctedToday,icon:Kn,gradient:mt.success,bgColor:"bg-green-50 dark:bg-green-950/30"}),i.jsx(Qe,{title:"MÃ©dia de Notas",value:Se.avgGrade,icon:Jn,gradient:mt.info,bgColor:"bg-blue-50 dark:bg-blue-950/30"}),i.jsx(Qe,{title:"Tempo MÃ©dio",value:`${Se.avgTime}min`,icon:Qn,gradient:"from-purple-500 to-pink-500",bgColor:"bg-purple-50 dark:bg-purple-950/30"})]}),i.jsx(ke,{className:"p-6 mb-6",children:i.jsxs("div",{className:"space-y-6",children:[i.jsxs("div",{className:"space-y-4",children:[i.jsx("div",{className:"flex flex-col md:flex-row md:items-center md:justify-between gap-4",children:i.jsxs("div",{children:[i.jsx("h1",{className:"text-2xl font-bold tracking-tight",children:"CorreÃ§Ãµes"}),i.jsx("p",{className:"text-muted-foreground",children:w==="all"?"Todas as submissÃµes":w==="pending"?"SubmissÃµes aguardando correÃ§Ã£o":w==="graded"?"SubmissÃµes jÃ¡ corrigidas":"SubmissÃµes sinalizadas"})]})}),i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-medium leading-none",children:"Turma"}),i.jsxs(Ge,{value:Z,onValueChange:U,disabled:Me,children:[i.jsx(Xe,{children:i.jsx(Ke,{placeholder:Me?"Carregando turmas...":"Selecione uma turma"})}),i.jsx(Je,{children:V.map(_=>i.jsx(ie,{value:_.id,children:_.name},_.id))})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-medium leading-none",children:"Atividade"}),i.jsxs(Ge,{value:me,onValueChange:he,disabled:!Z||Ae,children:[i.jsx(Xe,{children:i.jsx(Ke,{placeholder:Z?Ae?"Carregando atividades...":"Todas as atividades":"Selecione uma turma primeiro"})}),i.jsxs(Je,{children:[i.jsx(ie,{value:"all",children:"Todas as atividades"}),K.map(_=>i.jsx(ie,{value:_.id,children:_.title},_.id))]})]})]}),i.jsxs("div",{className:"space-y-2",children:[i.jsx("label",{className:"text-sm font-medium leading-none",children:"Status"}),i.jsxs(Ge,{value:w,onValueChange:O,children:[i.jsx(Xe,{children:i.jsx(Ke,{placeholder:"Todas"})}),i.jsxs(Je,{children:[i.jsx(ie,{value:"all",children:"Todas"}),i.jsx(ie,{value:"pending",children:"Pendentes"}),i.jsx(ie,{value:"graded",children:"Corrigidas"}),i.jsx(ie,{value:"flagged",children:"Sinalizadas"})]})]})]})]}),i.jsxs("div",{className:"flex flex-col sm:flex-row gap-2 w-full",children:[i.jsxs("div",{className:"relative flex-1",children:[i.jsx(es,{className:"absolute left-3 top-1/2 h-4 w-4 -translate-y-1/2 text-muted-foreground"}),i.jsx(Lt,{placeholder:"Buscar por aluno ou atividade...",className:"pl-9 w-full",value:M,onChange:_=>T(_.target.value)})]}),i.jsxs(Ge,{value:A,onValueChange:H,children:[i.jsx(Xe,{className:"w-full sm:w-[180px]",children:i.jsx(Ke,{placeholder:"Ordenar por"})}),i.jsxs(Je,{children:[i.jsx(ie,{value:"oldest",children:"Mais antigas primeiro"}),i.jsx(ie,{value:"newest",children:"Mais recentes primeiro"}),i.jsx(ie,{value:"grade_asc",children:"Nota: menor para maior"}),i.jsx(ie,{value:"grade_desc",children:"Nota: maior para menor"})]})]}),i.jsxs(X,{variant:"outline",onClick:()=>z(!ne),className:"w-full sm:w-auto",children:[i.jsx(ts,{className:"mr-2 h-4 w-4"}),"Mais filtros"]})]})]}),i.jsxs("div",{className:"flex flex-wrap gap-3",children:[i.jsxs(X,{variant:"outline",onClick:lt,children:[i.jsx(rs,{className:"w-4 h-4 mr-2"}),"Exportar"]}),y.length>0&&i.jsxs(i.Fragment,{children:[i.jsxs(X,{variant:"outline",onClick:at,children:["CorreÃ§Ã£o em Lote (",y.length,")"]}),y.length===2&&i.jsx(X,{variant:"outline",onClick:it,children:"Comparar SubmissÃµes"})]})]})]})}),ne&&i.jsx("div",{className:"mb-6",children:i.jsx(Wa,{onApply:_=>{F.debug("Aplicar filtros avanÃ§ados:",_),t({title:"Filtros aplicados"})},onClear:()=>{z(!1)}})}),d.length>0?i.jsx("div",{className:"space-y-3",children:d.map((_,W)=>i.jsx(ns.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:W*.05},children:i.jsx(Gs,{submission:_,onCorrect:()=>Ze(_,W),isSelected:y.includes(_.id),onSelect:L=>{D(G=>L?[...G,_.id]:G.filter(ye=>ye!==_.id))}})},_.id))}):i.jsx(cn,{icon:Zt,title:"Nenhuma submissÃ£o encontrada",description:"NÃ£o hÃ¡ submissÃµes pendentes de correÃ§Ã£o no momento."}),b&&i.jsx(Xs,{submissions:o.filter(_=>y.includes(_.id)),onClose:()=>j(!1),onCompleted:()=>{j(!1),D([]),Ue(),Ve()}}),x&&i.jsx(Ga,{submissionIds:y,onClose:()=>C(!1)})]})};export{il as default};
