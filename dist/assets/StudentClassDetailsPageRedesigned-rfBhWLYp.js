import{j as e,a as je,r as n,s as u,l as h,v as ke,u as Ce,q as Se}from"./main-BSMlxxlZ.js";import{C as z}from"./card-DMraIbJz.js";import{A as Ee}from"./ActivityCard-C7t1TV7f.js";import{h as Y,k as De}from"./SidebarPremium-Bf98hnme.js";import{E as M}from"./EmptyState-BSYIwJt2.js";import{m as _,B as w}from"./button-CKV5JkoH.js";import"./dialog-DORbdWMS.js";import{D as Ae}from"./download-BxwFDvRG.js";import{F as xe}from"./file-BkDWQ1fJ.js";import{F as Q}from"./file-text-BP6UKDNn.js";import{I as Fe,A as V,a as $,b as U,M as pe}from"./avatar-7Qtl3MN2.js";import{V as Me}from"./video-CPtVorUA.js";import{f as Pe}from"./format-BcFT9btV.js";import{p as Z}from"./pt-BR-CuGSKEGQ.js";import{T as qe,a as ze,b as P,c as q}from"./tabs-COryJLg7.js";import{T as Ie}from"./textarea-DUFKXAdq.js";import{u as Le}from"./use-toast-DU85wOBR.js";import{H as Be}from"./heart-BRsvLotr.js";import{T as Te}from"./trash-2-DyY8LVvA.js";import{S as Ve}from"./send-CrV6JN56.js";import{f as re}from"./formatDistanceToNow-CMbiJYtj.js";import{A as $e}from"./arrow-left-J1T7R3Sc.js";import{B as fe}from"./chevron-right-D_FKfY1S.js";import{S as ge}from"./star-DKU9KxO3.js";import{U as ve}from"./users-BNOTPuIE.js";import{F as Ue}from"./funnel-x-XGGCQHlB.js";import"./differenceInHours-DzWJNcba.js";import"./getRoundingMethod-D0I6Z7xl.js";import"./en-US-B6HbAA6N.js";import"./circle-alert-EA2lUZox.js";import"./clock-2llRiqNt.js";import"./circle-check-CNIrcWjw.js";import"./index-CpTBUXYw.js";import"./target-BWVM_5Ui.js";import"./bell-C38I9ebQ.js";import"./trending-up-6aD5U3kC.js";import"./user-C2we2FXy.js";import"./settings-Ce4vc5Vl.js";import"./house-BiazGQzC.js";import"./graduation-cap-CzbYlLlS.js";import"./chart-column-CNsjJ5jU.js";import"./x-rSiybgWV.js";import"./index-DrqYlGSU.js";import"./index-D6vFAzWj.js";import"./index-Cwkg_cGm.js";import"./index-BwDK55Mp.js";import"./index-CB9Ufca0.js";import"./constructNow-re94FRT2.js";import"./differenceInCalendarMonths-FFYroMBa.js";import"./endOfDay-mJ-5sjFp.js";import"./endOfMonth-BD-g1yyK.js";const Ge=s=>s?s.includes("pdf")?Q:s.includes("image")?Fe:s.includes("video")?Me:xe:xe,Oe=s=>s?s.includes("pdf")?"from-red-500 to-red-600":s.includes("image")?"from-purple-500 to-pink-500":s.includes("video")?"from-blue-500 to-cyan-500":s.includes("document")||s.includes("word")?"from-blue-600 to-indigo-600":s.includes("sheet")||s.includes("excel")?"from-green-500 to-green-600":"from-slate-500 to-slate-600":"from-slate-500 to-slate-600",Re=s=>s?s<1024?s+" B":s<1024*1024?(s/1024).toFixed(1)+" KB":(s/(1024*1024)).toFixed(1)+" MB":"",He=({material:s,index:E=0})=>{const c=o=>o?.includes("image"),p=o=>o?.includes("video"),g=()=>c(s.file_type)||p(s.file_type),v=Ge(s.file_type),D=Oe(s.file_type);return e.jsx(e.Fragment,{children:e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:E*.05},children:e.jsxs(z,{className:"p-6 hover:shadow-xl transition-all group",children:[e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:`w-16 h-16 rounded-xl bg-gradient-to-br ${D} flex items-center justify-center flex-shrink-0 shadow-md group-hover:scale-110 transition-transform`,children:e.jsx(v,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white mb-1 truncate",children:s.title}),s.description&&e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-2 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center gap-3 text-xs text-slate-500 dark:text-slate-400 mb-3",children:[s.created_at&&e.jsx("span",{children:Pe(new Date(s.created_at),"dd/MM/yyyy",{locale:Z})}),s.file_size&&e.jsxs("span",{children:["‚Ä¢ ",Re(s.file_size)]})]}),g()&&s.file_url&&e.jsxs("div",{className:"mt-3",children:[c(s.file_type)&&e.jsx(_.div,{initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},className:"relative rounded-lg overflow-hidden bg-slate-100 dark:bg-slate-800",children:e.jsx("img",{src:s.file_url,alt:s.title,className:"w-full h-auto max-h-[360px] object-contain",loading:"lazy"})}),p(s.file_type)&&e.jsx(_.div,{initial:{opacity:0,scale:.98},animate:{opacity:1,scale:1},className:"relative rounded-lg overflow-hidden bg-black",children:e.jsxs("video",{controls:!0,className:"w-full h-auto max-h-[360px]",controlsList:"nodownload",children:[e.jsx("source",{src:s.file_url,type:s.file_type}),"Seu navegador n√£o suporta o elemento de v√≠deo."]})})]}),s.file_url?e.jsx("div",{className:"mt-3",children:e.jsx("a",{href:s.file_url,target:"_blank",rel:"noopener noreferrer",download:!0,children:e.jsxs(w,{size:"sm",className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700 text-white",children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Baixar"]})})}):e.jsx(w,{size:"sm",variant:"outline",className:"mt-3",disabled:!0,children:"Indispon√≠vel"})]})]}),s.tags&&s.tags.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mt-4 pt-4 border-t border-slate-200 dark:border-slate-700",children:s.tags.map((o,y)=>e.jsx(Y,{variant:"outline",className:"text-xs",children:o},y))})]})})})},We=({post:s,onUpdate:E})=>{const{user:c}=je(),{toast:p}=Le(),[g,v]=n.useState(!1),[D,o]=n.useState(0),[y,j]=n.useState(0),[I,L]=n.useState([]),[k,B]=n.useState(""),[C,G]=n.useState(!1),[O,T]=n.useState(!1),[R,b]=n.useState(!1);n.useEffect(()=>{ee()},[s.id]),n.useEffect(()=>{C&&A()},[C]);const ee=async()=>{try{const{data:r}=await u.from("post_likes").select("user_id").eq("post_id",s.id);o(r?.length||0),v(r?.some(t=>t.user_id===c.id)||!1);const{count:d}=await u.from("post_comments").select("id",{count:"exact",head:!0}).eq("post_id",s.id);j(d||0)}catch(r){h.error("Erro ao carregar contagens:",r)}},A=async()=>{try{b(!0);const{data:r}=await u.from("post_likes").select("user_id").eq("post_id",s.id);o(r?.length||0),v(r?.some(t=>t.user_id===c.id)||!1);const{data:d}=await u.from("post_comments").select("id, content, created_at, author_id").eq("post_id",s.id).order("created_at",{ascending:!0});if(d){const t=[...new Set(d.map(l=>l.author_id))],{data:i}=await u.from("profiles").select("id, full_name, avatar_url").in("id",t),x={};i?.forEach(l=>{x[l.id]=l});const N=d.map(l=>({...l,author:x[l.author_id]}));L(N)}}catch(r){h.error("Erro ao carregar intera√ß√µes:",r)}finally{b(!1)}},H=async()=>{try{if(g){const{error:r}=await u.from("post_likes").delete().eq("post_id",s.id).eq("user_id",c.id);if(r)throw r;v(!1),o(d=>Math.max(0,d-1))}else{const{error:r}=await u.from("post_likes").upsert({post_id:s.id,user_id:c.id},{onConflict:"post_id,user_id",ignoreDuplicates:!1});if(r&&r.code!=="23505")throw r;v(!0),o(d=>d+1)}}catch(r){if(r.code==="23505"||r.message?.includes("duplicate")){h.debug("Like j√° existe (esperado)");return}h.error("Erro ao curtir:",r),p({title:"‚ùå Erro",description:"N√£o foi poss√≠vel curtir o post",variant:"destructive"})}},se=async()=>{if(k.trim())try{T(!0);const{data:r,error:d}=await u.from("post_comments").insert({post_id:s.id,author_id:c.id,content:k.trim()}).select().single();if(d)throw d;const{data:t}=await u.from("profiles").select("id, full_name, avatar_url").eq("id",c.id).single();L(i=>[...i,{...r,author:t}]),j(i=>i+1),B(""),p({title:"‚úÖ Coment√°rio enviado!",description:"Seu coment√°rio foi publicado"})}catch(r){h.error("Erro ao comentar:",r),p({title:"‚ùå Erro",description:"N√£o foi poss√≠vel enviar o coment√°rio",variant:"destructive"})}finally{T(!1)}},W=async r=>{try{await u.from("post_comments").delete().eq("id",r).eq("author_id",c.id),L(d=>d.filter(t=>t.id!==r)),j(d=>Math.max(0,d-1)),p({title:"‚úÖ Coment√°rio removido",description:"Seu coment√°rio foi deletado"})}catch(d){h.error("Erro ao deletar coment√°rio:",d),p({title:"‚ùå Erro",description:"N√£o foi poss√≠vel deletar o coment√°rio",variant:"destructive"})}};return e.jsxs(z,{className:"p-6",children:[e.jsxs("div",{className:"flex items-start gap-4 mb-4",children:[e.jsxs(V,{className:"w-12 h-12",children:[e.jsx($,{src:s.creator?.avatar_url||s.author?.avatar_url}),e.jsx(U,{children:(s.creator?.full_name||s.author?.full_name||"P")[0]})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:s.creator?.full_name||s.author?.full_name||"Professor"}),e.jsx(Y,{variant:"secondary",children:"Professor"}),e.jsx("span",{className:"text-sm text-slate-500",children:re(new Date(s.created_at),{locale:Z,addSuffix:!0})})]}),s.title&&e.jsx("h4",{className:"font-semibold text-slate-800 dark:text-slate-200 mb-2",children:s.title}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300 whitespace-pre-wrap",children:s.content||s.description})]})]}),e.jsxs("div",{className:"flex items-center gap-4 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsxs(w,{variant:"ghost",size:"sm",onClick:H,className:g?"text-red-600":"",children:[e.jsx(Be,{className:`w-5 h-5 mr-2 ${g?"fill-current":""}`}),D>0&&e.jsx("span",{className:"ml-1",children:D})]}),e.jsxs(w,{variant:"ghost",size:"sm",onClick:()=>G(!C),children:[e.jsx(De,{className:"w-5 h-5 mr-2"}),y>0&&e.jsx("span",{className:"ml-1",children:y})]})]}),C&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-slate-200 dark:border-slate-700 space-y-4",children:[R?e.jsx("p",{className:"text-sm text-slate-500 text-center",children:"Carregando..."}):I.length>0?e.jsx("div",{className:"space-y-3",children:I.map(r=>e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsxs(V,{className:"w-8 h-8",children:[e.jsx($,{src:r.author?.avatar_url}),e.jsx(U,{children:r.author?.full_name?.[0]||"U"})]}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"bg-slate-100 dark:bg-slate-800 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-center justify-between mb-1",children:[e.jsx("span",{className:"font-semibold text-sm",children:r.author?.full_name||"Usu√°rio"}),r.author_id===c.id&&e.jsx(w,{variant:"ghost",size:"sm",onClick:()=>W(r.id),className:"h-6 w-6 p-0",children:e.jsx(Te,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-sm text-slate-700 dark:text-slate-300",children:r.content})]}),e.jsx("span",{className:"text-xs text-slate-500 mt-1 block",children:re(new Date(r.created_at),{locale:Z,addSuffix:!0})})]})]},r.id))}):e.jsx("p",{className:"text-sm text-slate-500 text-center",children:"Nenhum coment√°rio ainda"}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs(V,{className:"w-8 h-8",children:[e.jsx($,{src:c.user_metadata?.avatar_url}),e.jsx(U,{children:c.user_metadata?.full_name?.[0]||"V"})]}),e.jsxs("div",{className:"flex-1 flex gap-2",children:[e.jsx(Ie,{value:k,onChange:r=>B(r.target.value),placeholder:"Escreva um coment√°rio...",className:"min-h-[60px]"}),e.jsx(w,{onClick:se,disabled:O||!k.trim(),size:"sm",children:e.jsx(Ve,{className:"w-4 h-4"})})]})]})]})]})},Ws=()=>{const{classId:s}=ke(),{user:E}=je(),c=Ce(),[p,g]=n.useState(!0),[v,D]=n.useState("feed"),[o,y]=n.useState(null),[j,I]=n.useState([]),[L,k]=n.useState([]),[B,C]=n.useState([]),[G,O]=n.useState([]),[T,R]=n.useState([]),[b,ee]=n.useState(!1),[A,H]=n.useState({pendingActivities:0,avgGrade:0,studentsCount:0}),se=async()=>{try{const{data:t}=await u.auth.getSession(),i=t?.session?.access_token,x=await fetch("https://wapbwaimkurbuihatmix.supabase.co/functions/v1/get-class-data-optimized",{method:"POST",headers:{"Content-Type":"application/json",Authorization:`Bearer ${i}`},body:JSON.stringify({classId:s})});if(!x.ok)throw new Error("Edge Function falhou");const l=(await x.json()).data,J=[...l.posts||[],...(l.discussions||[]).map(m=>({...m,title:m.title,description:m.description,content:m.description,creator:m.author,created_at:m.created_at}))],F=(l.activities||[]).filter(m=>m.status==="published");y({...l.classInfo,teacher_name:l.classInfo?.teacher?.full_name||"Professor",teacher_avatar:l.classInfo?.teacher?.avatar_url,teacher_email:l.classInfo?.teacher?.email}),I(J),C(l.library||[]),k(F),R((l.members||[]).filter(m=>m.role==="student")),O([]),H(m=>({...m,studentsCount:(l.members||[]).filter(K=>K.role==="student").length,pendingActivities:F.length})),h.debug("[ClassDetails][Fallback EF] Dados aplicados",{posts:J.length,materials:(l.library||[]).length,activities:F.length,students:(l.members||[]).filter(m=>m.role==="student").length})}catch(t){h.error("[ClassDetails][Fallback EF] Erro ao buscar:",t)}};n.useEffect(()=>{E?.id&&s&&W()},[E,s]);const W=async()=>{try{g(!0);const{data:t,error:i}=await u.from("classes").select(`
          *,
          teacher:profiles!created_by(id, full_name, avatar_url, email)
        `).eq("id",s).single();if(i)throw h.error("[ClassDetails] Erro classes:",i),i;const{data:x,error:N}=await u.from("class_members").select(`
          id,
          user_id,
          is_archived,
          user:profiles!user_id(id, full_name, email, avatar_url, role)
        `).eq("class_id",s),l=x?.filter(a=>!a.is_archived)||[];if(N)throw h.error("[ClassDetails] Erro members:",N),N;const J=t?.teacher?.id,F=l.filter(a=>a.user?.role?a.user.role==="student":a.user_id!==J).map(a=>({id:a.user?.id||a.user_id,full_name:a.user?.full_name||null,email:a.user?.email||null,avatar_url:a.user?.avatar_url||null})).filter(a=>!!a.id),{data:m,error:K}=await u.from("class_posts").select(`
          *,
          creator:profiles!created_by(id, full_name, avatar_url)
        `).eq("class_id",s).order("created_at",{ascending:!1});K&&h.error("[ClassDetails] Erro posts:",K);const{data:ie,error:le}=await u.from("class_materials").select("*").eq("class_id",s).order("created_at",{ascending:!1});le&&h.error("[ClassDetails] Erro materials:",le);const{data:ne,error:oe}=await u.from("activity_class_assignments").select(`
          activity_id,
          assigned_at,
          activity:activities(*)
        `).eq("class_id",s);oe&&h.error("[ClassDetails] Erro assignments:",oe);const be=new Map(ne?.map(a=>[a.activity_id,a.assigned_at])||[]),X=(ne?.map(a=>a.activity).filter(Boolean)||[]).filter(a=>a.status==="published"),Ne=X.map(a=>a.id),{data:de,error:ce}=await u.from("submissions").select("activity_id, status, grade, submitted_at").eq("student_id",E.id).in("activity_id",Ne);ce&&h.error("[ClassDetails] Erro submissions:",ce);const _e=new Map((de||[]).map(a=>[a.activity_id,a])),me=(de||[]).filter(a=>a.grade!==null&&a.grade!==void 0).map(a=>{const f=X.find(S=>S.id===a.activity_id)||{};return{id:`${a.activity_id}`,activity_title:f.title||"Atividade",grade:Number(a.grade),max_score:Number(f.max_score)||100,feedback:f.feedback||null}}),te=me,ue=te.length>0?te.reduce((a,f)=>a+Number(f.grade),0)/te.length:null,he=X.map(a=>{const f=_e.get(a.id),S=!!f,ae=!S&&a.due_date&&new Date(a.due_date)<new Date,ye=be.get(a.id);return{...a,assigned_at:ye,submission:f,hasSubmission:S,isCompleted:S&&f.status==="graded",isPending:!S&&!ae,isLate:ae,status:S?f.status==="graded"?"completed":"submitted":ae?"late":"pending"}}),we=he.filter(a=>a.isPending).length;if(l.length===0&&(m?.length||0)===0&&(ie?.length||0)===0&&X.length===0){h.warn("[ClassDetails] Dados vazios possivelmente por RLS, usando fallback Edge Function"),await se();return}y({...t,teacher_name:t.teacher?.full_name||"Professor",teacher_avatar:t.teacher?.avatar_url,teacher_email:t.teacher?.email}),I(m||[]),k(he),C(ie||[]),R(F),O(me),H({pendingActivities:we,avgGrade:ue!==null?ue:0,studentsCount:F.length})}catch(t){h.error("Erro ao carregar dados da turma:",t)}finally{g(!1)}};if(p&&!o)return e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(Se,{size:"lg"})});const r={blue:"from-blue-600 to-cyan-500",green:"from-green-600 to-emerald-500",purple:"from-purple-600 to-pink-500",orange:"from-orange-600 to-amber-500",red:"from-red-600 to-rose-500"},d=r[o?.color]||r.blue;return e.jsxs("div",{className:"min-h-screen bg-slate-50 dark:bg-slate-950 p-6",children:[e.jsxs(w,{variant:"ghost",onClick:()=>c("/students/classes"),className:"mb-4",children:[e.jsx($e,{className:"w-4 h-4 mr-2"}),"Voltar para Turmas"]}),e.jsxs(_.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:`bg-gradient-to-r ${d} rounded-2xl p-8 mb-8 text-white shadow-xl relative overflow-hidden`,children:[e.jsx("div",{className:"absolute -right-16 -bottom-16 opacity-10",children:e.jsx(fe,{className:"w-64 h-64"})}),e.jsxs("div",{className:"relative z-10",children:[e.jsxs("div",{className:"flex items-start justify-between flex-wrap gap-4 mb-6",children:[e.jsxs("div",{children:[e.jsx(Y,{className:"mb-3 bg-white/20 text-white border-white/30",children:o?.subject||"Mat√©ria"}),e.jsx("h1",{className:"text-4xl font-bold mb-2",children:o?.name}),o?.description&&e.jsx("p",{className:"text-white/90 text-lg max-w-2xl",children:o.description})]}),e.jsx(z,{className:"p-4 bg-white/10 backdrop-blur border-white/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(V,{className:"w-12 h-12 border-2 border-white",children:[e.jsx($,{src:o?.teacher_avatar}),e.jsx(U,{className:"bg-white/20 text-white",children:o?.teacher_name?.[0]||"P"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-white/70",children:"Professor(a)"}),e.jsx("p",{className:"font-bold text-white",children:o?.teacher_name})]})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsx("div",{className:"bg-white/10 backdrop-blur rounded-lg p-4 border border-white/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(Q,{className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:A.pendingActivities}),e.jsx("p",{className:"text-sm text-white/80",children:"Atividades Pendentes"})]})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur rounded-lg p-4 border border-white/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ge,{className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:A.avgGrade>0?A.avgGrade.toFixed(1):"--"}),e.jsx("p",{className:"text-sm text-white/80",children:"M√©dia de Notas"})]})]})}),e.jsx("div",{className:"bg-white/10 backdrop-blur rounded-lg p-4 border border-white/20",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(ve,{className:"w-8 h-8"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-2xl font-bold",children:A.studentsCount}),e.jsx("p",{className:"text-sm text-white/80",children:"Alunos na Turma"})]})]})})]})]})]}),e.jsxs(qe,{value:v,onValueChange:D,children:[e.jsxs(ze,{className:"mb-6",children:[e.jsx(P,{value:"feed",children:"üì¢ Feed"}),e.jsx(P,{value:"announcements",children:"üì£ Comunicados"}),e.jsx(P,{value:"activities",children:"üìù Atividades"}),e.jsx(P,{value:"materials",children:"üìö Materiais"}),e.jsx(P,{value:"grades",children:"‚≠ê Notas"}),e.jsx(P,{value:"students",children:"üë• Alunos"})]}),e.jsx(q,{value:"feed",children:j.length>0?e.jsx("div",{className:"space-y-4",children:j.map((t,i)=>e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.05},children:e.jsx(We,{post:t,onUpdate:W})},t.id))}):e.jsx(M,{icon:Q,title:"Nenhum post ainda",description:"N√£o h√° posts publicados nesta turma ainda."})}),e.jsx(q,{value:"announcements",children:j.filter(t=>t.category==="announcement"||t.type==="announcement").length>0?e.jsx("div",{className:"space-y-4",children:j.filter(t=>t.category==="announcement"||t.type==="announcement").map((t,i)=>e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.05},children:e.jsx(z,{className:"p-6 border-l-4 border-l-orange-500",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-orange-100 dark:bg-orange-900/20 rounded-lg",children:e.jsx(pe,{className:"w-6 h-6 text-orange-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white",children:t.title||"Comunicado Importante"}),e.jsx(Y,{className:"bg-orange-100 text-orange-700",children:"Comunicado"}),e.jsx("span",{className:"text-sm text-slate-500",children:re(new Date(t.created_at),{locale:Z,addSuffix:!0})})]}),e.jsx("p",{className:"text-slate-700 dark:text-slate-300 whitespace-pre-wrap",children:t.content||t.description})]})]})})},t.id))}):e.jsx(M,{icon:pe,title:"Nenhum comunicado",description:"N√£o h√° comunicados importantes nesta turma ainda."})}),e.jsxs(q,{value:"activities",children:[e.jsx("div",{className:"mb-4",children:e.jsxs(w,{variant:b?"default":"outline",onClick:()=>ee(!b),size:"sm",children:[e.jsx(Ue,{className:"w-4 h-4 mr-2"}),"N√£o Respondidas"]})}),(()=>{let t=[...L];return b&&(t=t.filter(i=>i.status==="pending")),t.sort((i,x)=>{const N=i.assigned_at?new Date(i.assigned_at):new Date(0);return(x.assigned_at?new Date(x.assigned_at):new Date(0))-N}),t.length>0?e.jsx("div",{className:"space-y-4",children:t.map((i,x)=>e.jsx(Ee,{activity:i,onStart:()=>c(`/students/activities/${i.id}`),onView:()=>c(`/students/activities/${i.id}`),index:x},i.id))}):e.jsx(M,{icon:Q,title:b?"Nenhuma atividade n√£o respondida":"Nenhuma atividade",description:b?"Voc√™ j√° respondeu todas as atividades dispon√≠veis!":"N√£o h√° atividades dispon√≠veis nesta turma ainda."})})()]}),e.jsx(q,{value:"materials",children:B.length>0?e.jsx("div",{className:"space-y-4",children:B.map((t,i)=>e.jsx(He,{material:t,index:i},t.id))}):e.jsx(M,{icon:fe,title:"Nenhum material",description:"N√£o h√° materiais dispon√≠veis nesta turma ainda."})}),e.jsx(q,{value:"grades",children:G.length>0?e.jsx("div",{className:"space-y-4",children:G.map((t,i)=>e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.05},children:e.jsx(z,{className:"p-6",children:e.jsx("div",{className:"flex items-start justify-between gap-4",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-bold text-slate-900 dark:text-white mb-2",children:t.activity_title}),e.jsxs("div",{className:"flex items-center gap-4 mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-3xl font-bold text-blue-600",children:parseFloat(t.grade).toFixed(1)}),e.jsxs("span",{className:"text-slate-500",children:["/",t.max_score]})]}),e.jsx("div",{className:"flex-1 bg-slate-200 dark:bg-slate-700 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all",style:{width:`${parseFloat(t.grade)/t.max_score*100}%`}})})]}),t.feedback&&e.jsxs("div",{className:"p-3 bg-slate-100 dark:bg-slate-800 rounded-lg",children:[e.jsx("p",{className:"text-sm font-semibold text-slate-700 dark:text-slate-300 mb-1",children:"Feedback do Professor:"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:t.feedback})]})]})})})},t.id))}):e.jsx(M,{icon:ge,title:"Nenhuma nota ainda",description:"Voc√™ ainda n√£o possui notas nesta turma."})}),e.jsx(q,{value:"students",children:T.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:T.map((t,i)=>e.jsx(_.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:i*.05},children:e.jsx(z,{className:"p-4 hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs(V,{className:"w-12 h-12",children:[e.jsx($,{src:t.avatar_url}),e.jsx(U,{className:"bg-blue-100 text-blue-600",children:(t.full_name||t.name)?.[0]||"A"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-slate-900 dark:text-white",children:t.full_name||t.name||"Aluno"}),e.jsx("p",{className:"text-sm text-slate-500",children:t.email||"Sem email"})]})]})})},t.id))}):e.jsx(M,{icon:ve,title:"Nenhum aluno",description:"N√£o h√° alunos nesta turma ainda."})})]})]})};export{Ws as default};
