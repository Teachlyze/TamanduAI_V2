import{k as D,u as C,r as a,s as i,j as e,i as B}from"./main-vCmkj0Ph.js";import{B as x,C as l}from"./card-QZFCDucj.js";import{B as u}from"./badge-DYNIDruK.js";import{T,a as L,b as r,c}from"./tabs-DESQXg6q.js";import{D as A}from"./dropdown-menu-CRv4RkRy.js";import"./label-DA0WPkHe.js";import{C as E}from"./classService-MrelqPQP.js";import{A as M}from"./arrow-left-DABf050f.js";import{M as q}from"./message-square-B_K00Q7Z.js";import{F as R}from"./file-text-BrP95lln.js";import"./index-DF9gUw3L.js";import"./chevron-right-DOiZ8o1C.js";const U=()=>{const{classId:t}=D(),n=C(),[h,d]=a.useState(!0),[o,p]=a.useState(null),[f,j]=a.useState([]),[m,b]=a.useState([]),[g,N]=a.useState([]);a.useEffect(()=>{v()},[t]);const v=async()=>{try{d(!0);const s=await E.getClassById(t);p(s);const{data:w}=await i.from("activity_class_assignments").select(`
          activity_id,
          activity:activities (
            id,
            title,
            description,
            due_date,
            max_score,
            type,
            status
          )
        `).eq("class_id",t),_=w?.map(y=>y.activity).filter(Boolean)||[];j(_);const{data:S}=await i.from("discussions").select(`
          id,
          title,
          content,
          type,
          created_at,
          created_by,
          author:profiles!discussions_created_by_fkey (
            id,
            name,
            avatar_url
          )
        `).eq("class_id",t).order("created_at",{ascending:!1}).limit(10);b(S||[]);const{data:k}=await i.from("materials").select("*").eq("class_id",t).order("created_at",{ascending:!1});N(k||[])}catch(s){console.error("Erro:",s)}finally{d(!1)}};return h?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(B,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsxs(x,{variant:"ghost",onClick:()=>n("/student/classes"),className:"mb-4",children:[e.jsx(M,{className:"w-4 h-4 mr-2"}),"Voltar"]}),e.jsx(A,{title:o?.name||"Turma",subtitle:o?.subject||"Sem matÃ©ria",role:"student"}),e.jsxs(T,{defaultValue:"feed",className:"w-full",children:[e.jsxs(L,{className:"mb-6",children:[e.jsx(r,{value:"feed",children:"Mural"}),e.jsx(r,{value:"activities",children:"Atividades"}),e.jsx(r,{value:"materials",children:"Materiais"})]}),e.jsx(c,{value:"feed",children:e.jsx("div",{className:"space-y-4",children:m.length>0?m.map(s=>e.jsx(l,{className:"p-6 bg-white dark:bg-slate-900",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-purple-500 flex items-center justify-center text-white font-bold",children:s.author?.name?.[0]||"A"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("span",{className:"font-semibold",children:s.author?.name}),e.jsx(u,{children:s.type}),e.jsx("span",{className:"text-xs text-slate-600",children:new Date(s.created_at).toLocaleDateString("pt-BR")})]}),e.jsx("h3",{className:"font-bold mb-2",children:s.title}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400",children:s.content})]})]})},s.id)):e.jsxs(l,{className:"p-8 text-center",children:[e.jsx(q,{className:"w-12 h-12 mx-auto mb-4 text-slate-400"}),e.jsx("p",{className:"text-slate-600",children:"Nenhuma publicaÃ§Ã£o no mural ainda"})]})})}),e.jsx(c,{value:"activities",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:f.map(s=>e.jsxs(l,{onClick:()=>n(`/student/activities/${s.id}`),className:"p-6 cursor-pointer hover:shadow-lg transition-all bg-white dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx(R,{className:"w-8 h-8 text-blue-600"}),e.jsx(u,{className:s.status==="active"?"bg-green-100 text-green-700":s.status==="closed"?"bg-red-100 text-red-700":"bg-slate-100 text-slate-700",children:s.status==="active"?"Ativa":s.status==="closed"?"Encerrada":"Rascunho"})]}),e.jsx("h3",{className:"font-bold mb-2",children:s.title}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4 line-clamp-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("span",{className:"text-slate-600",children:["ðŸ“… ",s.due_date?new Date(s.due_date).toLocaleDateString("pt-BR"):"Sem prazo"]}),e.jsxs("span",{className:"font-semibold text-blue-600",children:[s.max_score," pts"]})]})]},s.id))})}),e.jsx(c,{value:"materials",children:e.jsx("div",{className:"space-y-4",children:g.map(s=>e.jsx(l,{className:"p-6 bg-white dark:bg-slate-900",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg bg-purple-100 dark:bg-purple-900/30 flex items-center justify-center",children:"ðŸ“Ž"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:s.title}),e.jsx("p",{className:"text-sm text-slate-600",children:s.description})]})]}),e.jsx(x,{variant:"outline",size:"sm",children:"Download"})]})},s.id))})})]})]})};export{U as default};
