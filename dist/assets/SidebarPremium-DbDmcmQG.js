import{c as w,j as e,d as V,a as R,r as n,s as k,L as p,i as X,u as J,e as f}from"./main-PnoWv5mu.js";import{C as K}from"./card-DNyDBtwZ.js";import{m as P}from"./button-B1az96ai.js";import{B as Q}from"./bell-jlu-i0nu.js";import{B as _}from"./book-open-BN8GTFXN.js";import{T as Y}from"./trending-up-BnoBnv7_.js";import{U as Z}from"./user-IPdw0V9z.js";import{F as z}from"./file-text-WNEYLkuB.js";import{S as C,H as U}from"./settings-BAc4VZJo.js";import{U as N}from"./users-CZvcSbj_.js";import{G as ee}from"./graduation-cap-BTPeK0uK.js";import{C as B,A as te}from"./index-DvZMkTcl.js";import{C as A}from"./chart-column-Ba9dXnEb.js";import{X as ae}from"./x-7WqOwCJm.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=[["path",{d:"m15.477 12.89 1.515 8.526a.5.5 0 0 1-.81.47l-3.58-2.687a1 1 0 0 0-1.197 0l-3.586 2.686a.5.5 0 0 1-.81-.469l1.514-8.526",key:"1yiouv"}],["circle",{cx:"12",cy:"8",r:"6",key:"1vp47v"}]],se=w("award",re);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ie=[["path",{d:"m16 17 5-5-5-5",key:"1bji2h"}],["path",{d:"M21 12H9",key:"dn1m92"}],["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}]],G=w("log-out",ie);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oe=[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]],Me=w("menu",oe);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ne=[["path",{d:"M2.992 16.342a2 2 0 0 1 .094 1.167l-1.065 3.29a1 1 0 0 0 1.236 1.168l3.413-.998a2 2 0 0 1 1.099.092 10 10 0 1 0-4.777-4.719",key:"1sd12s"}]],q=w("message-circle",ne);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const de=[["path",{d:"M20.985 12.486a9 9 0 1 1-9.473-9.472c.405-.022.617.46.402.803a6 6 0 0 0 8.268 8.268c.344-.215.825-.004.803.401",key:"kfwtm"}]],ce=w("moon",de);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const le=[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]],he=w("sun",le),L={default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"};function ue({className:x,variant:a="default",...s}){return e.jsx("div",{className:V("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",L[a]||L.default,x),...s})}const me=({className:x=""})=>{const{user:a}=R(),[s,M]=n.useState(null),[r,v]=n.useState({completedActivities:0,pendingActivities:0,avgGrade:0}),[i,u]=n.useState(new Date),[g,m]=n.useState(()=>{if(typeof window<"u"){const t=localStorage.getItem("theme");return t?t==="dark":window.matchMedia("(prefers-color-scheme: dark)").matches}return!1});n.useEffect(()=>{a?.id&&(y(),setTimeout(()=>{S()},100))},[a]),n.useEffect(()=>{g?(document.documentElement.classList.add("dark"),localStorage.setItem("theme","dark")):(document.documentElement.classList.remove("dark"),localStorage.setItem("theme","light"))},[g]),n.useEffect(()=>{const t=setInterval(()=>{u(new Date)},1e3);return()=>clearInterval(t)},[]);const y=async()=>{if(a?.id)try{const{data:t}=await k.from("profiles").select("*").eq("id",a.id).single();M(t)}catch(t){console.error("Error loading profile:",t)}},S=async()=>{if(a?.id)try{const{data:t}=await k.from("submissions").select("status, grade").eq("student_id",a.id),b=t?.filter(l=>l.status==="submitted"||l.status==="graded").length||0,E=t?.filter(l=>l.grade!==null)||[],$=E.length>0?E.reduce((l,I)=>l+parseFloat(I.grade),0)/E.length:0,{data:H}=await k.from("class_members").select("class_id").eq("user_id",a.id).eq("role","student"),D=H?.map(l=>l.class_id)||[];if(D.length>0){const{data:l}=await k.from("activity_class_assignments").select("activity_id, activity:activities(id, is_published, status)").in("class_id",D),I=l?.map(h=>h.activity).filter(h=>h?.is_published&&h?.status==="active")||[],W=new Map(t?.map(h=>[h.activity_id,h])||[]),O=I.filter(h=>!W.has(h.id)).length;v({completedActivities:b,pendingActivities:O,avgGrade:parseFloat($.toFixed(1))})}else v({completedActivities:b,pendingActivities:0,avgGrade:parseFloat($.toFixed(1))})}catch(t){console.error("Error loading stats:",t)}},o=()=>{m(!g)},d=()=>i.toLocaleString("pt-BR",{day:"2-digit",month:"2-digit",year:"numeric",hour:"2-digit",minute:"2-digit"}),c=t=>{if(!t)return"ES";const b=t.split(" ");return b.length>=2?`${b[0][0]}${b[1][0]}`.toUpperCase():t.substring(0,2).toUpperCase()};return e.jsx("div",{className:x,children:e.jsxs(K,{className:"relative overflow-hidden border-0 shadow-md",children:[e.jsx("div",{className:"absolute inset-0 bg-gradient-to-br from-cyan-400 via-sky-400 to-blue-500 dark:from-cyan-600 dark:via-sky-600 dark:to-blue-700"}),e.jsx("div",{className:"absolute inset-0 opacity-10 dark:opacity-5",children:e.jsx("div",{className:"absolute inset-0",style:{backgroundImage:"radial-gradient(circle, white 1px, transparent 1px)",backgroundSize:"16px 16px"}})}),e.jsxs("div",{className:"relative z-10 p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx(ue,{variant:"secondary",className:"bg-white/90 dark:bg-white/95 text-sky-700 dark:text-sky-800 px-2 py-0.5 text-[10px] font-semibold border border-white/50 shadow-sm","aria-label":"Tipo de usuário: Estudante",children:"Aluno"}),e.jsx("time",{className:"text-white/90 dark:text-white/80 text-[10px] font-medium",children:d()}),e.jsxs("div",{className:"flex items-center gap-1.5",children:[e.jsx("button",{onClick:o,className:"p-1 rounded-md bg-white/20 hover:bg-white/30 dark:bg-white/10 dark:hover:bg-white/20 transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-white/50","aria-label":"Alternar tema claro/escuro",title:"Alternar tema",children:g?e.jsx(ce,{className:"w-3.5 h-3.5 text-white","aria-hidden":"true"}):e.jsx(he,{className:"w-3.5 h-3.5 text-white","aria-hidden":"true"})}),e.jsxs("button",{className:"p-1 rounded-md bg-white/20 hover:bg-white/30 dark:bg-white/10 dark:hover:bg-white/20 transition-all duration-200 relative focus:outline-none focus:ring-2 focus:ring-white/50","aria-label":"3 notificações não lidas",title:"Notificações",children:[e.jsx(Q,{className:"w-3.5 h-3.5 text-white","aria-hidden":"true"}),e.jsx("span",{className:"absolute -top-0.5 -right-0.5 w-3 h-3 bg-orange-500 dark:bg-orange-600 rounded-full text-[8px] text-white flex items-center justify-center font-bold","aria-hidden":"true",children:"3"})]})]})]}),e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-14 h-14 rounded-full bg-white/20 dark:bg-white/10 backdrop-blur-sm border-2 border-white/30 dark:border-white/20 flex items-center justify-center shadow-md flex-shrink-0",children:s?.avatar_url?e.jsx("img",{src:s.avatar_url,alt:`Foto de perfil de ${s.full_name||"estudante"}`,className:"w-full h-full rounded-full object-cover"}):e.jsx("span",{className:"text-xl font-bold text-white","aria-label":"Iniciais do nome",children:c(s?.full_name||a?.email)})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h2",{className:"text-base font-bold text-white dark:text-white truncate",children:s?.full_name||"Estudante"}),e.jsx("p",{className:"text-white/80 dark:text-white/70 text-xs truncate",children:a?.email||"email@example.com"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mb-3",children:[e.jsxs("div",{className:"bg-white/20 dark:bg-white/10 backdrop-blur-sm rounded-lg p-2 border border-white/30 dark:border-white/20 text-center hover:bg-white/25 dark:hover:bg-white/15 transition-colors",children:[e.jsx(_,{className:"w-4 h-4 text-yellow-300 dark:text-yellow-400 mx-auto mb-1","aria-hidden":"true"}),e.jsx("p",{className:"text-base font-bold text-white dark:text-white","aria-label":`${r.completedActivities} atividades concluídas`,children:r.completedActivities}),e.jsx("p",{className:"text-[10px] text-white/80 dark:text-white/70 font-medium leading-tight",children:"Concluídas"})]}),e.jsxs("div",{className:"bg-white/20 dark:bg-white/10 backdrop-blur-sm rounded-lg p-2 border border-white/30 dark:border-white/20 text-center hover:bg-white/25 dark:hover:bg-white/15 transition-colors",children:[e.jsx(Y,{className:"w-4 h-4 text-orange-300 dark:text-orange-400 mx-auto mb-1","aria-hidden":"true"}),e.jsx("p",{className:"text-base font-bold text-white dark:text-white","aria-label":`${r.pendingActivities} atividades pendentes`,children:r.pendingActivities}),e.jsx("p",{className:"text-[10px] text-white/80 dark:text-white/70 font-medium leading-tight",children:"Pendentes"})]}),e.jsxs("div",{className:"bg-white/20 dark:bg-white/10 backdrop-blur-sm rounded-lg p-2 border border-white/30 dark:border-white/20 text-center hover:bg-white/25 dark:hover:bg-white/15 transition-colors",children:[e.jsx(se,{className:"w-4 h-4 text-cyan-300 dark:text-cyan-400 mx-auto mb-1","aria-hidden":"true"}),e.jsx("p",{className:"text-base font-bold text-white dark:text-white","aria-label":`Nota média ${r.avgGrade.toFixed(1)}`,children:r.avgGrade.toFixed(1)}),e.jsx("p",{className:"text-[10px] text-white/80 dark:text-white/70 font-medium leading-tight",children:"Média"})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(p,{to:"/students/profile",className:"block",children:e.jsxs("button",{className:"w-full bg-white/20 dark:bg-white/10 hover:bg-white/30 dark:hover:bg-white/20 text-white border border-white/30 dark:border-white/20 text-xs h-9 font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-white/50 rounded-md flex items-center justify-center gap-1 px-2","aria-label":"Acessar meu perfil",children:[e.jsx(Z,{className:"w-3.5 h-3.5 flex-shrink-0","aria-hidden":"true"}),e.jsx("span",{className:"truncate",children:"Perfil"})]})}),e.jsx(p,{to:"/students/history",className:"block",children:e.jsxs("button",{className:"w-full bg-white/20 dark:bg-white/10 hover:bg-white/30 dark:hover:bg-white/20 text-white border border-white/30 dark:border-white/20 text-xs h-9 font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-white/50 rounded-md flex items-center justify-center gap-1 px-2","aria-label":"Ver histórico de atividades",children:[e.jsx(z,{className:"w-3.5 h-3.5 flex-shrink-0","aria-hidden":"true"}),e.jsx("span",{className:"truncate",children:"Histórico"})]})}),e.jsx(p,{to:"/students/settings",className:"block",children:e.jsxs("button",{className:"w-full bg-white/20 dark:bg-white/10 hover:bg-white/30 dark:hover:bg-white/20 text-white border border-white/30 dark:border-white/20 text-xs h-9 font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-white/50 rounded-md flex items-center justify-center gap-1 px-2","aria-label":"Acessar configurações",children:[e.jsx(C,{className:"w-3.5 h-3.5 flex-shrink-0","aria-hidden":"true"}),e.jsx("span",{className:"truncate",children:"Config"})]})})]})]})]})})},j=[{name:"Dashboard",href:"/dashboard",icon:U},{name:"Turmas",href:"/dashboard/classes",icon:N},{name:"Atividades",href:"/dashboard/activities",icon:_},{name:"Alunos",href:"/dashboard/students",icon:ee},{name:"Agenda",href:"/dashboard/calendar",icon:B},{name:"Relatórios",href:"/dashboard/reports",icon:A},{name:"Analytics",href:"/dashboard/analytics",icon:A},{name:"Chatbot",href:"/dashboard/chatbot",icon:q},{name:"Perfil",href:"/dashboard/profile",icon:C}],T=[{name:"Dashboard",href:"/students",icon:U},{name:"Turmas",href:"/students/classes",icon:N},{name:"Atividades",href:"/students/activities",icon:_},{name:"Meu Desempenho",href:"/students/performance",icon:A},{name:"Agenda",href:"/students/calendar",icon:B},{name:"Histórico",href:"/students/history",icon:z}],F=[{name:"Dashboard",href:"/school",icon:U},{name:"Professores",href:"/school/teachers",icon:N},{name:"Turmas",href:"/school/classes",icon:N},{name:"Relatórios",href:"/school/reports",icon:A},{name:"Comunicações",href:"/school/comms",icon:q},{name:"Configurações",href:"/school/settings",icon:C}],Se=({isOpen:x,onClose:a})=>{const s=X(),M=J(),{user:r,signOut:v}=R(),[i,u]=n.useState("teacher"),[g,m]=n.useState(j),y=async()=>{await v(),M("/login")};n.useEffect(()=>{(async()=>{if(r?.id)try{if(r.user_metadata?.role){const c=r.user_metadata.role;u(c),m(c==="student"?T:c==="school"?F:j);return}const{data:d}=await k.from("profiles").select("role").eq("id",r.id).maybeSingle();d?.role&&(u(d.role),m(d.role==="student"?T:d.role==="school"?F:j))}catch(d){console.error("Error fetching user role:",d)}})()},[r]),n.useEffect(()=>{if(s.pathname.startsWith("/school")){u("school"),m(F);return}if(s.pathname.startsWith("/students")){u("student"),m(T);return}s.pathname.startsWith("/dashboard")&&(u("teacher"),m(j))},[s.pathname]);const S=o=>o==="/dashboard"||o==="/students"||o==="/school"?s.pathname===o:s.pathname.startsWith(o);return e.jsxs(e.Fragment,{children:[e.jsx(te,{children:x&&e.jsx(P.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"fixed inset-0 z-40 bg-black/50 lg:hidden",onClick:a})}),e.jsxs(P.aside,{initial:!1,animate:{x:x?0:-280},className:f("fixed top-0 left-0 z-50 h-screen w-[280px] flex flex-col","bg-card border-r border-border shadow-lg overflow-hidden","lg:!translate-x-0 lg:z-30"),style:{transition:"transform 0.3s ease-in-out"},role:"navigation","aria-label":"Menu principal",children:[e.jsxs("div",{className:f("flex items-center justify-between h-14 px-4 border-b",i==="student"?"bg-gradient-to-r from-cyan-500/10 to-sky-500/10 dark:from-cyan-600/20 dark:to-sky-600/20 border-cyan-200/20 dark:border-cyan-700/30":"bg-gradient-to-r from-blue-500/10 to-cyan-500/10 dark:from-blue-600/20 dark:to-cyan-600/20 border-blue-200/20 dark:border-blue-700/30"),children:[e.jsxs(p,{to:i==="student"?"/students":i==="school"?"/school":"/dashboard",className:"flex items-center gap-2",onClick:a,"aria-label":"Ir para página inicial",children:[e.jsx("div",{className:f("w-7 h-7 rounded-lg flex items-center justify-center shadow-sm",i==="student"?"bg-gradient-to-br from-cyan-500 to-sky-600 dark:from-cyan-600 dark:to-sky-700":"bg-gradient-to-br from-blue-600 to-cyan-500 dark:from-blue-700 dark:to-cyan-600"),children:e.jsx(_,{className:"w-4 h-4 text-white","aria-hidden":"true"})}),e.jsx("span",{className:f("text-base font-bold bg-clip-text text-transparent hover:opacity-80 transition-opacity",i==="student"?"bg-gradient-to-r from-cyan-600 to-sky-600 dark:from-cyan-400 dark:to-sky-400":"bg-gradient-to-r from-blue-600 to-cyan-600 dark:from-blue-400 dark:to-cyan-400"),children:"TamanduAI"})]}),e.jsx("button",{onClick:a,className:"lg:hidden p-1.5 rounded-lg hover:bg-muted dark:hover:bg-slate-800 transition-colors focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-cyan-500","aria-label":"Fechar menu",title:"Fechar menu",children:e.jsx(ae,{className:"w-4 h-4","aria-hidden":"true"})})]}),i==="student"&&e.jsx("div",{className:"px-2 pt-2",children:e.jsx(me,{})}),e.jsx("nav",{className:f("flex-1 overflow-y-auto px-3",i==="student"?"py-2":"py-4"),role:"navigation","aria-label":"Menu principal",children:e.jsx("div",{className:"space-y-1",children:g.map(o=>{const d=o.icon,c=S(o.href);return e.jsxs(p,{to:o.href,onClick:a,className:f("group flex items-center gap-2.5 px-3 py-2 rounded-lg text-sm font-medium transition-all duration-200 focus:outline-none focus:ring-2 focus:ring-offset-1",c&&i==="student"?"bg-gradient-to-r from-cyan-500 to-sky-600 dark:from-cyan-600 dark:to-sky-700 text-white shadow-md focus:ring-cyan-400":c?"bg-gradient-to-r from-blue-600 to-cyan-500 dark:from-blue-700 dark:to-cyan-600 text-white shadow-md focus:ring-blue-400":i==="student"?"text-slate-700 dark:text-slate-300 hover:bg-cyan-50 hover:text-cyan-700 dark:hover:bg-cyan-950/30 dark:hover:text-cyan-400 focus:ring-cyan-400":"text-muted-foreground hover:bg-blue-50 hover:text-blue-700 dark:hover:bg-blue-950/30 dark:hover:text-blue-400 focus:ring-blue-400"),"aria-current":c?"page":void 0,children:[e.jsx(d,{className:f("w-4 h-4 flex-shrink-0",c?"text-white":i==="student"?"text-slate-500 dark:text-slate-400 group-hover:text-cyan-600 dark:group-hover:text-cyan-400":"text-muted-foreground group-hover:text-blue-600 dark:group-hover:text-blue-400"),"aria-hidden":"true"}),o.name]},o.name)})})}),i==="student"?e.jsx("div",{className:"border-t border-cyan-200/20 dark:border-cyan-700/30 p-3",children:e.jsxs("button",{onClick:y,className:"w-full flex items-center justify-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-red-600 dark:text-red-400 hover:bg-red-50 dark:hover:bg-red-950/50 transition-all duration-200 border border-red-200 dark:border-red-800 focus:outline-none focus:ring-2 focus:ring-red-400 focus:ring-offset-2","aria-label":"Sair da conta",children:[e.jsx(G,{className:"w-4 h-4","aria-hidden":"true"}),"Sair"]})}):e.jsxs("div",{className:"border-t border-border p-4 bg-gradient-to-r from-blue-500/5 to-cyan-500/5 dark:from-blue-600/10 dark:to-cyan-600/10",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-600 to-cyan-500 flex items-center justify-center flex-shrink-0 shadow-md",children:e.jsx("span",{className:"text-white font-semibold text-sm",children:r?.email?.charAt(0).toUpperCase()||"U"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-sm font-medium truncate",children:r?.email?.split("@")[0]||"Usuário"}),e.jsx("p",{className:"text-xs text-muted-foreground truncate",children:r?.email||"user@email.com"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(p,{to:i==="school"?"/school/settings":"/dashboard/settings",onClick:a,className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-muted-foreground hover:bg-muted hover:text-foreground transition-colors",children:[e.jsx(C,{className:"w-4 h-4"}),"Configurações"]}),e.jsxs("button",{onClick:y,className:"w-full flex items-center gap-2 px-3 py-2 rounded-lg text-sm font-medium text-destructive hover:bg-destructive/10 transition-colors",children:[e.jsx(G,{className:"w-4 h-4"}),"Sair"]})]})]})]})]})};export{se as A,ue as B,Me as M,Se as S,ce as a,he as b,q as c};
