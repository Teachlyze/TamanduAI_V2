import{c as ye,j as e,l as r,r as o,s as _,u as Ve,b as Be,a as ds,m as cs}from"./main-BXI8jImK.js";import{B as p,m as ae}from"./button-DhJSXayK.js";import{C as Ce}from"./card-Dts-jKab.js";import{I as Z}from"./input-YtE9-IyT.js";import{L as C}from"./label-DZTyMoK9.js";import{S as he,a as xe,b as pe,c as ue,d as P}from"./select-BYpegp6M.js";import{c as H,D as Ae,a as ke,b as Se,d as Te,e as Pe,f as _e}from"./utils-CwPH5tNa.js";import{T as ms,a as hs,b as G}from"./tabs-Cc_Y9tQd.js";import{D as xs,g as re}from"./DashboardHeader-BC80IxDW.js";import{S as ie}from"./StatsCard-BvzfNeJ2.js";import{E as ps}from"./EmptyState-BgA-VgrI.js";import{D as Xe,a as Ge,b as He,c as y,d as ge}from"./dropdown-menu-7nHS86TP.js";import{u as Y}from"./use-toast-B4cJHS9G.js";import{B as K}from"./SidebarPremium-CqhK_O_u.js";import{C as We}from"./checkbox-BTFRdSl9.js";import{S as De}from"./star-qgVESZf4.js";import{F as Qe}from"./file-text-B1_cTV9D.js";import{U as Ee}from"./users-1MVt23UL.js";import{C as be}from"./circle-check-big-BGyFuaS8.js";import{S as oe}from"./square-pen-Cm7iaTGa.js";import{E as Je}from"./ellipsis-vertical-DoZ4nRxQ.js";import{C as Ze}from"./copy-DrYuqgQt.js";import{E as le}from"./eye-CtZjPFNS.js";import{S as Fe}from"./share-2-Cuo1eKc9.js";import{D as Ke}from"./download-COsSi_Yf.js";import{A as W}from"./archive-B_LTTO2m.js";import{T as us}from"./trash-2-CYDlaDtE.js";import{f as gs}from"./format-D0LVKLFA.js";import{p as vs}from"./pt-BR-zMqltMoH.js";import{T as Ye}from"./trending-up-C_AGH9Be.js";import{T as fe}from"./textarea-C2TbCwiG.js";import{S as ve,G as js,A as bs}from"./ActivityPreview-DkrKJHDi.js";import{C as es}from"./circle-alert-D0X6fNnu.js";import{C as ss}from"./index-Cyt6Mlq7.js";import{U as Ne}from"./upload-l2_FgUlV.js";import{X as we}from"./x-DhRNfShw.js";import{P as je}from"./plus-CjBUib9U.js";import{C as Re}from"./clipboard-list-DArUsZqA.js";import{S as fs}from"./search-BE_TttKm.js";import{C as Ns}from"./chevron-up-3f7I9tWa.js";import{C as ws}from"./chevron-down-vfmnlur0.js";import"./index-laUz9pSU.js";import"./index-D63a-v4Z.js";import"./Combination-7NRWB7dp.js";import"./index-PCXR_M5s.js";import"./index-DWCzEl6o.js";import"./check-P2w7Pyl_.js";import"./chevron-right-DFiBXpQq.js";import"./bell-De3gaLfU.js";import"./book-open-BMCImb8A.js";import"./user-XMBxPeUS.js";import"./settings-Dn83Owos.js";import"./graduation-cap-BVXXkz0b.js";import"./chart-column-D6pi1FRc.js";import"./en-US-Bd7_-tVp.js";import"./clock-Ic71-9yN.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ys=[["rect",{width:"7",height:"7",x:"3",y:"3",rx:"1",key:"1g98yp"}],["rect",{width:"7",height:"7",x:"14",y:"3",rx:"1",key:"6d4xhi"}],["rect",{width:"7",height:"7",x:"14",y:"14",rx:"1",key:"nxv5o0"}],["rect",{width:"7",height:"7",x:"3",y:"14",rx:"1",key:"1bb6yr"}]],Cs=ye("layout-grid",ys);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const As=[["path",{d:"M3 5h.01",key:"18ugdj"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M3 19h.01",key:"noohij"}],["path",{d:"M8 5h13",key:"1pao27"}],["path",{d:"M8 12h13",key:"1za7za"}],["path",{d:"M8 19h13",key:"m83p4d"}]],ks=ye("list",As);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Ss=[["path",{d:"M10 5H3",key:"1qgfaw"}],["path",{d:"M12 19H3",key:"yhmn1j"}],["path",{d:"M14 3v4",key:"1sua03"}],["path",{d:"M16 17v4",key:"1q0r14"}],["path",{d:"M21 12h-9",key:"1o4lsq"}],["path",{d:"M21 19h-5",key:"1rlt1p"}],["path",{d:"M21 5h-7",key:"1oszz2"}],["path",{d:"M8 10v4",key:"tgpxqk"}],["path",{d:"M8 12H3",key:"a7s4jb"}]],Ts=ye("sliders-horizontal",Ss),Ps=({activity:t,selected:b,onSelect:c,onEdit:D,onDuplicate:f,onToggleFavorite:m,onArchive:E,onUnarchive:j,onDelete:F,onPreview:x,getTypeBadge:n})=>{const{toast:l}=Y(),U=u=>{const d={open:"bg-green-500 text-white",assignment:"bg-green-500 text-white",closed:"bg-blue-500 text-white",quiz:"bg-blue-500 text-white",mixed:"bg-purple-500 text-white",project:"bg-purple-500 text-white"};return d[t.type]||d.open},A=u=>{const d={published:{label:"Publicada",color:"bg-emerald-500 text-white"},draft:{label:"Rascunho",color:"bg-gray-400 text-white"},archived:{label:"Arquivada",color:"bg-slate-400 text-white"}},q=d[u]||d.draft;return e.jsx(K,{className:H("text-xs font-medium",q.color),children:q.label})};return e.jsx(Ce,{className:H("p-5 hover:shadow-lg transition-all duration-200 bg-white dark:bg-slate-800 border-l-4",b?"ring-2 ring-blue-500 bg-blue-50 dark:bg-blue-950/30 border-l-blue-500":"border-l-transparent hover:border-l-blue-400"),children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(We,{checked:b,onCheckedChange:()=>c(t.id),className:"flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0 space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 dark:text-gray-100 line-clamp-1 flex-1",children:t.title}),e.jsx("button",{onClick:()=>{r.debug("[ActivityListItem] â­ BotÃ£o Favorito clicado"),r.debug("[ActivityListItem] Activity ID:",t.id),m(t.id)},className:"flex-shrink-0 text-gray-400 hover:text-yellow-500 transition-colors",children:e.jsx(De,{className:H("w-4 h-4",t.is_favorite&&"fill-yellow-500 text-yellow-500")})})]}),t.description&&e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-2",children:t.description}),e.jsxs("div",{className:"flex items-center gap-5 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx("div",{className:"p-1.5 rounded-md bg-blue-100 dark:bg-blue-900/30",children:e.jsx(Qe,{className:"w-4 h-4 text-blue-600 dark:text-blue-400"})}),e.jsxs("span",{className:"font-medium",children:[t.content?.questions?.length||0," questÃµes"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx("div",{className:"p-1.5 rounded-md bg-purple-100 dark:bg-purple-900/30",children:e.jsx(Ee,{className:"w-4 h-4 text-purple-600 dark:text-purple-400"})}),e.jsxs("span",{className:"font-medium",children:[t.timesUsed||0," turma(s)"]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-gray-700 dark:text-gray-300",children:[e.jsx("div",{className:"p-1.5 rounded-md bg-green-100 dark:bg-green-900/30",children:e.jsx(be,{className:"w-4 h-4 text-green-600 dark:text-green-400"})}),e.jsxs("span",{className:"font-medium",children:[t.submittedCount||0," envios"]})]}),t.created_at&&e.jsx("div",{className:"text-xs text-gray-500 dark:text-gray-400 ml-auto",children:gs(new Date(t.created_at),"dd/MM/yyyy",{locale:vs})})]})]}),e.jsxs("div",{className:"flex flex-col items-center justify-center gap-2 px-4 border-l border-r border-gray-200 dark:border-gray-700",children:[e.jsx(K,{className:H("text-xs font-bold px-4 py-1.5 shadow-sm",U(t.type)),children:n(t.type)}),A(t.status)]}),e.jsxs("div",{className:"flex flex-col items-center justify-center px-6",children:[e.jsx("div",{className:"p-3 rounded-xl bg-gradient-to-br from-amber-50 to-amber-100 dark:from-amber-900/20 dark:to-amber-800/20 border border-amber-200 dark:border-amber-700",children:e.jsx("span",{className:"text-3xl font-black text-amber-600 dark:text-amber-400",children:t.max_score||100})}),e.jsx("span",{className:"text-xs font-semibold text-gray-500 dark:text-gray-400 mt-1",children:"pontos"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs(p,{size:"sm",onClick:()=>{r.debug("[ActivityListItem] âœï¸ BotÃ£o Editar Principal clicado"),r.debug("[ActivityListItem] Activity:",t),D(t)},className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 text-white px-6 shadow-md hover:shadow-lg",children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Editar"]}),e.jsxs(Xe,{children:[e.jsx(Ge,{asChild:!0,children:e.jsx(p,{variant:"ghost",size:"icon",className:"flex-shrink-0",children:e.jsx(Je,{className:"w-5 h-5"})})}),e.jsxs(He,{align:"end",className:"w-48",children:[e.jsxs(y,{onClick:()=>{r.debug('[ActivityListItem] âœï¸ Dropdown "Editar" clicado'),r.debug("[ActivityListItem] Activity:",t),D(t)},children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Editar"]}),e.jsxs(y,{onClick:()=>{r.debug('[ActivityListItem] ðŸ“‹ Dropdown "Duplicar" clicado'),r.debug("[ActivityListItem] Activity:",t),f(t)},children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Duplicar"]}),e.jsxs(y,{onClick:u=>{u.stopPropagation(),l({title:"Em breve",description:"FunÃ§Ã£o de prÃ©via serÃ¡ implementada em breve."})},children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Ver PrÃ©via"]}),e.jsx(ge,{}),e.jsxs(y,{onClick:async u=>{u.stopPropagation();try{const d=`${window.location.origin}/dashboard/activities/${t.id}`;await navigator.clipboard.writeText(d),l({title:" Link copiado!",description:"O link da atividade foi copiado para a Ã¡rea de transferÃªncia."})}catch(d){r.error("Erro ao copiar:",d),l({title:" Erro",description:"NÃ£o foi possÃ­vel copiar o link.",variant:"destructive"})}},children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Compartilhar"]}),x&&e.jsxs(y,{onClick:()=>x(t),children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"Ver PrÃ©via"]}),e.jsx(ge,{}),e.jsxs(y,{onClick:async u=>{u.stopPropagation();try{const d=JSON.stringify(t,null,2),q=new Blob([d],{type:"application/json"}),w=URL.createObjectURL(q),M=document.createElement("a");M.href=w,M.download=`atividade_${t.title?.replace(/\s+/g,"_")}_${new Date().toISOString().split("T")[0]}.json`,document.body.appendChild(M),M.click(),document.body.removeChild(M),URL.revokeObjectURL(w),l({title:"âœ… Atividade exportada!",description:"Download iniciado."})}catch(d){r.error("Erro ao exportar:",d),l({title:"âŒ Erro",description:"NÃ£o foi possÃ­vel exportar a atividade.",variant:"destructive"})}},children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),"Exportar"]}),e.jsx(ge,{}),t.status==="archived"?e.jsxs(y,{onClick:u=>{u.stopPropagation(),j(t.id)},children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Desarquivar"]}):e.jsxs(y,{onClick:u=>{u.stopPropagation(),E(t.id)},children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Arquivar"]}),e.jsxs(y,{onClick:u=>{u.stopPropagation(),F(t)},className:"text-red-600 focus:text-red-600 dark:text-red-400",children:[e.jsx(us,{className:"w-4 h-4 mr-2"}),"Excluir"]})]})]})]})]})})},_s=({activity:t,onEdit:b,onToggleFavorite:c,onDuplicate:D,onArchive:f,onUnarchive:m,getTypeBadge:E,navigate:j})=>{const{toast:F}=Y(),x=n=>{const l={open:"bg-green-100 text-green-700",assignment:"bg-green-100 text-green-700",closed:"bg-blue-100 text-blue-700",quiz:"bg-blue-100 text-blue-700",mixed:"bg-purple-100 text-purple-700",project:"bg-purple-100 text-purple-700"};return l[t.type]||l.open};return e.jsxs(Ce,{className:"group h-full hover:shadow-xl transition-all duration-300 overflow-hidden border-t-4 border-t-blue-500",children:[e.jsx("div",{className:"relative p-5 bg-gradient-to-br from-blue-50 to-indigo-50 dark:from-blue-950/30 dark:to-indigo-950/30",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsx(K,{className:x(t.type),children:E(t.type)}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:n=>{n.stopPropagation(),c(t.id)},className:"text-gray-400 hover:text-yellow-500 transition-colors",children:e.jsx(De,{className:H("w-5 h-5",t.is_favorite&&"fill-yellow-500 text-yellow-500")})}),e.jsxs(Xe,{children:[e.jsx(Ge,{asChild:!0,onClick:n=>n.stopPropagation(),children:e.jsx(p,{variant:"ghost",size:"icon",className:"h-8 w-8",children:e.jsx(Je,{className:"w-4 h-4"})})}),e.jsxs(He,{align:"end",children:[e.jsxs(y,{onClick:n=>{n.stopPropagation(),b(t)},children:[e.jsx(oe,{className:"w-4 h-4 mr-2"}),"Editar"]}),e.jsxs(y,{onClick:n=>{n.stopPropagation(),D&&D(t)},children:[e.jsx(Ze,{className:"w-4 h-4 mr-2"}),"Duplicar"]}),e.jsxs(y,{onClick:n=>{n.stopPropagation(),F({title:"Em breve",description:"PrÃ©via em desenvolvimento."})},children:[e.jsx(le,{className:"w-4 h-4 mr-2"}),"PrÃ©via"]}),e.jsxs(y,{onClick:n=>{n.stopPropagation();const l=`${window.location.origin}/dashboard/activities/${t.id}`;navigator.clipboard.writeText(l),F({title:"Link copiado!",description:"O link da atividade foi copiado para a Ã¡rea de transferÃªncia."})},children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Compartilhar"]}),t.status==="archived"?e.jsxs(y,{onClick:n=>{n.stopPropagation(),m&&m(t.id)},children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Desarquivar"]}):e.jsxs(y,{onClick:n=>{n.stopPropagation(),f&&f(t.id)},children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Arquivar"]})]})]})]})]})}),e.jsxs("div",{className:"p-5",children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900 dark:text-gray-100 line-clamp-2 mb-3 min-h-[56px]",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600 dark:text-gray-400 line-clamp-3 mb-4 min-h-[60px]",children:t.description||"Sem descriÃ§Ã£o"}),e.jsxs("div",{className:"flex flex-wrap gap-2 mb-4",children:[t.content?.tags?.slice(0,2).map((n,l)=>e.jsxs(K,{variant:"secondary",className:"text-xs",children:["#",n]},l)),t.content?.tags?.length>2&&e.jsxs(K,{variant:"secondary",className:"text-xs",children:["+",t.content.tags.length-2]})]}),e.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200 dark:border-gray-700",children:[e.jsxs("div",{className:"flex items-center gap-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-1",title:"QuestÃµes",children:[e.jsx(le,{className:"w-4 h-4"}),e.jsx("span",{children:t.content?.questions?.length||0})]}),e.jsxs("div",{className:"flex items-center gap-1",title:"Pontos",children:[e.jsx(Ye,{className:"w-4 h-4"}),e.jsx("span",{children:t.max_score})]}),e.jsxs("div",{className:"flex items-center gap-1",title:"Usos",children:[e.jsx(Ee,{className:"w-4 h-4"}),e.jsxs("span",{children:[t.timesUsed,"x"]})]})]}),e.jsxs(p,{size:"sm",className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 shadow-md hover:shadow-lg transition-all",onClick:()=>j(`/dashboard/activities/${t.id}/edit`),children:[e.jsx(oe,{className:"w-4 h-4 mr-1"}),"Editar"]})]})]})]})},Ds=({activities:t,classes:b,onClose:c,onSuccess:D})=>{const{toast:f}=Y(),[m,E]=o.useState([]),[j,F]=o.useState(""),[x,n]=o.useState(t[0]?.max_score||10),[l,U]=o.useState(1),[A,u]=o.useState(""),[d,q]=o.useState(!1),[w,M]=o.useState(!1),[I,h]=o.useState(!0),[v,S]=o.useState(!1),O=i=>{E(T=>T.includes(i)?T.filter(V=>V!==i):[...T,i])},$=async()=>{if(m.length===0){f({title:"Erro",description:"Selecione pelo menos uma turma.",variant:"destructive"});return}if(!j){f({title:"Erro",description:"Defina uma data de entrega.",variant:"destructive"});return}try{S(!0);for(const i of t)for(const T of m){const{data:V}=await _.from("activity_class_assignments").select("id").eq("activity_id",i.id);let B=i.id;if(V&&V.length>0){const{data:L,error:X}=await _.from("activities").insert({title:i.title,description:i.description,content:i.content,type:i.type,max_score:x,due_date:j,weight:l,instructions:A||i.instructions,plagiarism_enabled:w,status:"published",created_by:i.created_by,teacher_id:i.teacher_id}).select().single();if(X)throw X;B=L.id}else{const{error:L}=await _.from("activities").update({due_date:j,max_score:x,weight:l,instructions:A||i.instructions,plagiarism_enabled:w,status:"published"}).eq("id",i.id);if(L)throw L}const{error:ee}=await _.from("activity_class_assignments").insert({activity_id:B,class_id:T});if(ee)throw ee;if(I){const{data:L}=await _.from("class_members").select("user_id").eq("class_id",T).eq("role","student");if(L){const X=L.map(se=>({user_id:se.user_id,title:"Nova Atividade Postada",message:`A atividade "${i.title}" foi postada e estÃ¡ disponÃ­vel.`,type:"activity_posted",data:{activity_id:i.id,class_id:T,due_date:j}}));await _.from("notifications").insert(X)}}}f({title:"Sucesso!",description:`Atividade${t.length>1?"s":""} postada${t.length>1?"s":""} em ${m.length} turma${m.length>1?"s":""}.`}),D()}catch(i){r.error("Erro ao postar atividade:",i),f({title:"Erro",description:"NÃ£o foi possÃ­vel postar a atividade.",variant:"destructive"})}finally{S(!1)}};return e.jsx(Ae,{open:!0,onOpenChange:c,children:e.jsxs(ke,{className:"max-w-2xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Se,{children:[e.jsxs(Te,{children:["Postar Atividade",t.length>1?"s":"",": ",t[0]?.title,t.length>1&&` (+${t.length-1})`]}),e.jsx(Pe,{children:"Configure as opÃ§Ãµes de postagem e selecione as turmas"})]}),e.jsxs("div",{className:"space-y-6 py-4",children:[e.jsxs("div",{children:[e.jsxs(C,{className:"text-base font-semibold mb-3 flex items-center gap-2",children:[e.jsx(Ee,{className:"w-5 h-5"}),"Selecionar Turmas"]}),e.jsx("div",{className:"space-y-2 max-h-48 overflow-y-auto border rounded-lg p-3",children:b.length===0?e.jsxs("div",{className:"text-center py-4 text-gray-500",children:[e.jsx(es,{className:"w-8 h-8 mx-auto mb-2 text-gray-400"}),e.jsx("p",{children:"VocÃª nÃ£o tem turmas ativas."}),e.jsx("p",{className:"text-sm",children:"Crie uma turma primeiro."})]}):b.map(i=>e.jsxs("div",{className:"flex items-center space-x-2 p-2 hover:bg-gray-50 dark:hover:bg-gray-800 rounded",children:[e.jsx(We,{id:i.id,checked:m.includes(i.id),onCheckedChange:()=>O(i.id)}),e.jsx(C,{htmlFor:i.id,className:"flex-1 cursor-pointer",children:i.name})]},i.id))})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs(C,{htmlFor:"dueDate",className:"flex items-center gap-2",children:[e.jsx(ss,{className:"w-4 h-4"}),"Prazo de Entrega *"]}),e.jsx(Z,{id:"dueDate",type:"datetime-local",value:j,onChange:i=>F(i.target.value),className:"mt-1",required:!0})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"maxScore",children:"PontuaÃ§Ã£o Total *"}),e.jsx(Z,{id:"maxScore",type:"number",min:"0",step:"0.1",value:x,onChange:i=>n(parseFloat(i.target.value)),className:"mt-1"})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"weight",children:"Peso na MÃ©dia"}),e.jsx(Z,{id:"weight",type:"number",min:"0",step:"0.1",value:l,onChange:i=>U(parseFloat(i.target.value)),className:"mt-1"})]})]}),e.jsxs("div",{children:[e.jsx(C,{htmlFor:"instructions",children:"InstruÃ§Ãµes Adicionais (Opcional)"}),e.jsx(fe,{id:"instructions",placeholder:"Adicione instruÃ§Ãµes especÃ­ficas para esta postagem...",value:A,onChange:i=>u(i.target.value),className:"mt-1 min-h-[100px]"})]}),e.jsxs("div",{className:"space-y-3 p-4 bg-gray-50 dark:bg-gray-900 rounded-lg",children:[e.jsx("h4",{className:"font-semibold text-sm",children:"ConfiguraÃ§Ãµes AvanÃ§adas"}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(C,{htmlFor:"allowLate",className:"cursor-pointer",children:"Permitir Envio Atrasado"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Alunos poderÃ£o submeter apÃ³s o prazo"})]}),e.jsx(ve,{id:"allowLate",checked:d,onCheckedChange:q})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(C,{htmlFor:"plagiarism",className:"cursor-pointer",children:"Ativar AntiplÃ¡gio"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Verificar originalidade das respostas"})]}),e.jsx(ve,{id:"plagiarism",checked:w,onCheckedChange:M})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx(C,{htmlFor:"notify",className:"cursor-pointer",children:"Notificar Alunos"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Enviar notificaÃ§Ã£o sobre nova atividade"})]}),e.jsx(ve,{id:"notify",checked:I,onCheckedChange:h})]})]})]}),e.jsxs(_e,{children:[e.jsx(p,{variant:"outline",onClick:c,disabled:v,children:"Cancelar"}),e.jsx(p,{onClick:$,disabled:v||m.length===0,children:v?"Postando...":"Postar Agora"})]})]})})},Es=({open:t,onClose:b})=>{const{toast:c}=Y(),D=Ve(),f=o.useRef(null),[m,E]=o.useState(null),[j,F]=o.useState(!1),[x,n]=o.useState(""),[l,U]=o.useState(""),[A,u]=o.useState(""),d=[{ext:".txt",label:"Texto (TXT)",mime:"text/plain"},{ext:".pdf",label:"PDF",mime:"application/pdf"},{ext:".docx",label:"Word (DOCX)",mime:"application/vnd.openxmlformats-officedocument.wordprocessingml.document"},{ext:".odt",label:"OpenDocument (ODT)",mime:"application/vnd.oasis.opendocument.text"}],q=async h=>{const v=h.target.files?.[0];if(!v)return;const S="."+v.name.split(".").pop().toLowerCase();if(!d.some($=>$.ext===S)){c({title:"Formato nÃ£o suportado",description:`Por favor, selecione um arquivo ${d.map($=>$.ext.toUpperCase()).join(", ")}`,variant:"destructive"});return}E(v),await w(v)},w=async h=>{try{F(!0);const v="."+h.name.split(".").pop().toLowerCase();let S="";v===".txt"?S=await h.text():v===".pdf"?S=`[ConteÃºdo extraÃ­do do PDF: ${h.name}]

NOTA: Para extraÃ§Ã£o completa de PDF, instale a biblioteca 'pdf-parse'.

Por enquanto, cole o conteÃºdo manualmente abaixo.`:v===".docx"?S=`[ConteÃºdo extraÃ­do do DOCX: ${h.name}]

NOTA: Para extraÃ§Ã£o completa de DOCX, instale a biblioteca 'mammoth'.

Por enquanto, cole o conteÃºdo manualmente abaixo.`:v===".odt"&&(S=`[ConteÃºdo extraÃ­do do ODT: ${h.name}]

NOTA: Para extraÃ§Ã£o completa de ODT, instale biblioteca apropriada.

Por enquanto, cole o conteÃºdo manualmente abaixo.`),n(S);const O=h.name.replace(/\.[^/.]+$/,"");U(O),c({title:"Arquivo carregado",description:v===".txt"?"Texto extraÃ­do com sucesso!":"Revise e edite o conteÃºdo abaixo."})}catch(v){r.error("Erro ao processar arquivo:",v),c({title:"Erro ao processar arquivo",description:v.message,variant:"destructive"})}finally{F(!1)}},M=()=>{if(!l.trim()){c({title:"TÃ­tulo obrigatÃ³rio",description:"Insira um tÃ­tulo para a atividade",variant:"destructive"});return}if(!x.trim()){c({title:"ConteÃºdo vazio",description:"O arquivo nÃ£o possui conteÃºdo ou nÃ£o foi processado",variant:"destructive"});return}const h={title:l.trim(),description:A.trim()||x.substring(0,200)+"...",content:x,imported:!0,importedFrom:m?.name};sessionStorage.setItem("importedActivity",JSON.stringify(h)),c({title:"ImportaÃ§Ã£o concluÃ­da",description:"Redirecionando para editor de atividades..."}),b(),D("/dashboard/activities/create")},I=()=>{E(null),n(""),U(""),u(""),f.current&&(f.current.value="")};return e.jsx(Ae,{open:t,onOpenChange:b,children:e.jsxs(ke,{className:"max-w-3xl max-h-[90vh] overflow-y-auto",children:[e.jsxs(Se,{children:[e.jsxs(Te,{className:"flex items-center gap-2",children:[e.jsx(Ne,{className:"w-5 h-5"}),"Importar Atividade de Arquivo"]}),e.jsx(Pe,{children:"FaÃ§a upload de um arquivo (TXT, PDF, DOCX, ODT) e extraia o conteÃºdo para criar uma atividade"})]}),e.jsx("div",{className:"space-y-6 py-4",children:m?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 dark:bg-blue-950/30 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[j?e.jsx(Be,{className:"w-5 h-5 text-blue-600 animate-spin"}):e.jsx(be,{className:"w-5 h-5 text-green-600"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:m.name}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:[(m.size/1024).toFixed(2)," KB"]})]})]}),e.jsx(p,{variant:"ghost",size:"sm",onClick:I,disabled:j,children:e.jsx(we,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"title",children:"TÃ­tulo da Atividade *"}),e.jsx(Z,{id:"title",value:l,onChange:h=>U(h.target.value),placeholder:"Digite o tÃ­tulo...",disabled:j})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"description",children:"DescriÃ§Ã£o (Opcional)"}),e.jsx(fe,{id:"description",value:A,onChange:h=>u(h.target.value),placeholder:"Breve descriÃ§Ã£o da atividade...",rows:2,disabled:j})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(C,{htmlFor:"content",children:"ConteÃºdo ExtraÃ­do"}),e.jsx(fe,{id:"content",value:x,onChange:h=>n(h.target.value),placeholder:"O conteÃºdo extraÃ­do aparecerÃ¡ aqui...",rows:12,disabled:j,className:"font-mono text-sm"}),e.jsx("p",{className:"text-xs text-slate-500",children:"VocÃª pode editar o conteÃºdo extraÃ­do antes de importar"})]}),m&&(m.name.endsWith(".pdf")||m.name.endsWith(".docx")||m.name.endsWith(".odt"))&&e.jsxs("div",{className:"flex items-start gap-2 p-4 bg-amber-50 dark:bg-amber-950/30 border border-amber-200 dark:border-amber-800 rounded-lg",children:[e.jsx(es,{className:"w-5 h-5 text-amber-600 flex-shrink-0 mt-0.5"}),e.jsxs("div",{className:"text-sm",children:[e.jsx("p",{className:"font-medium text-amber-900 dark:text-amber-100 mb-1",children:"ExtraÃ§Ã£o Manual NecessÃ¡ria"}),e.jsxs("p",{className:"text-amber-700 dark:text-amber-300",children:["Para arquivos ",m.name.split(".").pop().toUpperCase(),", copie e cole o conteÃºdo manualmente no campo acima. Para extraÃ§Ã£o automÃ¡tica, as bibliotecas 'pdf-parse' (PDF) ou 'mammoth' (DOCX) precisam ser instaladas."]})]})]})]}):e.jsx("div",{className:"border-2 border-dashed border-slate-300 dark:border-slate-700 rounded-lg p-8",children:e.jsxs("div",{className:"text-center",children:[e.jsx(Ne,{className:"w-16 h-16 mx-auto mb-4 text-slate-400"}),e.jsx("p",{className:"text-lg font-medium mb-2",children:"Selecione um arquivo"}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:["Formatos suportados: ",d.map(h=>h.ext.toUpperCase()).join(", ")]}),e.jsx("input",{ref:f,type:"file",accept:d.map(h=>h.ext).join(","),onChange:q,className:"hidden",id:"file-upload"}),e.jsx("label",{htmlFor:"file-upload",children:e.jsx(p,{asChild:!0,variant:"outline",size:"lg",children:e.jsxs("span",{className:"cursor-pointer",children:[e.jsx(Qe,{className:"w-4 h-4 mr-2"}),"Escolher Arquivo"]})})})]})})}),e.jsxs(_e,{children:[e.jsx(p,{variant:"outline",onClick:b,disabled:j,children:"Cancelar"}),e.jsx(p,{onClick:M,disabled:!m||!l.trim()||!x.trim()||j,children:j?e.jsxs(e.Fragment,{children:[e.jsx(Be,{className:"w-4 h-4 mr-2 animate-spin"}),"Processando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(be,{className:"w-4 h-4 mr-2"}),"Importar e Criar Atividade"]})})]})]})})},zt=()=>{const t=Ve(),{user:b}=ds(),{toast:c}=Y();r.debug("[TeacherActivitiesPage] Componente montado"),r.debug("[TeacherActivitiesPage] User:",b),r.debug("[TeacherActivitiesPage] Current URL:",window.location.pathname);const[D,f]=o.useState(!0),[m,E]=o.useState([]),[j,F]=o.useState([]),[x,n]=o.useState({total:0,byType:{open:0,closed:0,mixed:0},mostUsed:null,recentCount:0}),[l,U]=o.useState("all"),[A,u]=o.useState("list"),[d,q]=o.useState(""),[w,M]=o.useState({type:[],status:[]}),[I,h]=o.useState(!1),[v,S]=o.useState(!1),[O,$]=o.useState("created_desc"),[i,T]=o.useState([]),[V,B]=o.useState(!1),[ee,L]=o.useState(!1),[X,se]=o.useState(!1),[ne,qe]=o.useState(null),[de,ts]=o.useState(null),[Fs,qs]=o.useState(null),[as,Me]=o.useState(!1);o.useEffect(()=>{r.debug("[TeacherActivitiesPage] useEffect triggered, user:",b),b?(r.debug("[TeacherActivitiesPage] Loading activities and classes..."),Q(),rs()):r.warn("[TeacherActivitiesPage] âš ï¸ User not found!")},[b,v]);const Q=async()=>{try{f(!0);let s=_.from("activities").select(`
          *,
          assignments:activity_class_assignments(
            id, class_id, assigned_at,
            class:classes(id, name)
          ),
          submissions:submissions(id, status, grade)
        `).eq("created_by",b.id).is("deleted_at",null);v||(s=s.neq("status","archived"));const{data:a,error:g}=await s.order("created_at",{ascending:!1});if(g)throw g;const R=(a||[]).map(z=>{const J=z.submissions?.filter(k=>k.status==="submitted"||k.status==="graded").length||0,N=z.submissions?.filter(k=>k.grade!==null).reduce((k,te)=>k+parseFloat(te.grade),0)/J||0;return{...z,timesUsed:z.assignments?.length||0,submittedCount:J,avgGrade:N.toFixed(2),classNames:z.assignments?.map(k=>k.class?.name).filter(Boolean)||[]}});E(R),is(R)}catch(s){r.error("Erro ao carregar atividades:",s),c({title:"Erro",description:"NÃ£o foi possÃ­vel carregar as atividades.",variant:"destructive"})}finally{f(!1)}},rs=async()=>{try{const{data:s,error:a}=await _.from("classes").select("id, name").eq("created_by",b.id).eq("is_active",!0);if(a)throw a;F(s||[])}catch(s){r.error("Erro ao carregar turmas:",s)}},is=s=>{const a=s.length,g={open:s.filter(N=>N.type==="open"||N.type==="assignment").length,closed:s.filter(N=>N.type==="closed"||N.type==="quiz").length,mixed:s.filter(N=>N.type==="mixed"||N.type==="project").length},R=s.reduce((N,k)=>k.timesUsed>(N?.timesUsed||0)?k:N,null),z=new Date;z.setMonth(z.getMonth()-1);const J=s.filter(N=>new Date(N.created_at)>z).length;n({total:a,byType:g,mostUsed:R,recentCount:J})},ce=o.useMemo(()=>{let s=[...m];if(l==="open"?s=s.filter(a=>a.type==="open"||a.type==="assignment"):l==="closed"?s=s.filter(a=>a.type==="closed"||a.type==="quiz"):l==="mixed"?s=s.filter(a=>a.type==="mixed"||a.type==="project"):l==="drafts"?s=s.filter(a=>a.status==="draft"):l==="favorites"&&(s=s.filter(a=>a.is_favorite)),d){const a=d.toLowerCase();s=s.filter(g=>g.title?.toLowerCase().includes(a)||g.description?.toLowerCase().includes(a)||g.instructions?.toLowerCase().includes(a))}return w.type.length>0&&(s=s.filter(a=>w.type.includes(a.type))),w.status.length>0&&(s=s.filter(a=>w.status.includes(a.status))),s.sort((a,g)=>{switch(O){case"created_desc":return new Date(g.created_at)-new Date(a.created_at);case"created_asc":return new Date(a.created_at)-new Date(g.created_at);case"name_asc":return a.title.localeCompare(g.title);case"name_desc":return g.title.localeCompare(a.title);case"most_used":return g.timesUsed-a.timesUsed;case"highest_score":return g.max_score-a.max_score;default:return 0}}),s},[m,l,d,w,O]),os=s=>{T(a=>a.includes(s)?a.filter(g=>g!==s):[...a,s])},Le=s=>{r.debug("[TeacherActivitiesPage] ðŸŽ¯ handleEdit chamado"),r.debug("[TeacherActivitiesPage] Activity:",s),r.debug("[TeacherActivitiesPage] Navegando para:",`/dashboard/activities/${s.id}/edit`),t(`/dashboard/activities/${s.id}/edit`)},ze=async s=>{r.debug("[TeacherActivitiesPage] ðŸ“‹ handleDuplicate chamado"),r.debug("[TeacherActivitiesPage] Activity:",s);try{const{assignments:a,submissions:g,submittedCount:R,avgGrade:z,timesUsed:J,classNames:N,...k}=s,{data:te,error:$e}=await _.from("activities").insert({...k,id:void 0,title:`${s.title} - CÃ³pia`,status:"draft",is_published:!1,created_at:void 0,updated_at:void 0,deleted_at:null}).select().single();if($e)throw $e;c({title:"Sucesso",description:"Atividade duplicada com sucesso!"}),Q(),r.debug("[TeacherActivitiesPage] Navegando apÃ³s duplicar para:",`/dashboard/activities/${te.id}/edit`),t(`/dashboard/activities/${te.id}/edit`)}catch(a){r.error("Erro ao duplicar:",a),c({title:"Erro",description:"NÃ£o foi possÃ­vel duplicar a atividade.",variant:"destructive"})}},Ue=async s=>{r.debug("[TeacherActivitiesPage] â­ handleToggleFavorite chamado"),r.debug("[TeacherActivitiesPage] Activity ID:",s),c({title:"Funcionalidade em desenvolvimento",description:"Sistema de favoritos serÃ¡ implementado em breve."})},me=async s=>{r.debug("[TeacherActivitiesPage] ðŸ“¦ handleArchive chamado"),r.debug("[TeacherActivitiesPage] Activity ID:",s);try{const{error:a}=await _.from("activities").update({status:"archived",updated_at:new Date().toISOString()}).eq("id",s);if(a)throw a;c({title:"Atividade arquivada"}),E(g=>g.filter(R=>R.id!==s))}catch(a){r.error("Erro ao arquivar:",a),c({title:"Erro ao arquivar",variant:"destructive"})}},Ie=async s=>{try{const{error:a}=await _.from("activities").update({status:"draft",updated_at:new Date().toISOString()}).eq("id",s);if(a)throw a;c({title:"Atividade desarquivada"}),Q()}catch(a){r.error("Erro ao desarquivar:",a),c({title:"Erro ao desarquivar",variant:"destructive"})}},ls=async s=>{r.debug("[TeacherActivitiesPage] ðŸ—‘ï¸ handleDelete chamado"),r.debug("[TeacherActivitiesPage] Activity ID:",s);try{const{error:a}=await _.from("activities").update({deleted_at:new Date().toISOString()}).eq("id",s);if(a)throw a;c({title:"Atividade excluÃ­da"}),B(!1),Q()}catch(a){r.error("Erro ao excluir:",a)}},ns=()=>{M({type:[],status:[]}),q("")},Oe=s=>({open:"Aberta",assignment:"Aberta",closed:"Fechada",quiz:"Fechada",mixed:"Mista",project:"Mista"})[s]||"Aberta";return D?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(cs,{size:"lg",text:"Carregando banco de atividades..."})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx(xs,{title:"Banco de Atividades",subtitle:"Crie, organize e reutilize suas atividades",role:"teacher"}),e.jsxs("div",{className:"flex flex-wrap gap-3 mt-4",children:[e.jsxs(p,{size:"lg",onClick:()=>{r.debug('[TeacherActivitiesPage] âž• BotÃ£o "Nova Atividade" clicado'),r.debug("[TeacherActivitiesPage] Navegando para: /dashboard/activities/create"),r.debug("[TeacherActivitiesPage] URL atual:",window.location.pathname),t("/dashboard/activities/create")},className:"bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800",children:[e.jsx(je,{className:"w-5 h-5 mr-2"}),"Nova Atividade"]}),e.jsxs(p,{variant:"outline",size:"lg",onClick:()=>Me(!0),children:[e.jsx(Ne,{className:"w-5 h-5 mr-2"}),"Importar"]}),e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-white dark:bg-slate-900 border-2 border-slate-300 dark:border-slate-700 px-4 py-2 rounded-lg hover:bg-slate-50 dark:hover:bg-slate-800 transition-colors",children:[e.jsx("input",{type:"checkbox",checked:v,onChange:s=>S(s.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-blue-500"}),e.jsx(W,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Mostrar Arquivadas"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:[e.jsx(ie,{title:"Total",value:x.total,icon:Re,gradient:re.primary,bgColor:"bg-blue-50"}),e.jsx(ie,{title:"Por Tipo",value:`${x.byType.open}/${x.byType.closed}/${x.byType.mixed}`,icon:js,gradient:re.success,bgColor:"bg-emerald-50",subtitle:"Abertas/Fechadas/Mistas"}),e.jsx(ie,{title:"Mais Usada",value:x.mostUsed?.timesUsed||0,icon:Ye,gradient:re.warning,bgColor:"bg-amber-50",subtitle:x.mostUsed?x.mostUsed.title.substring(0,20)+"...":"Nenhuma"}),e.jsx(ie,{title:"Recentes",value:x.recentCount,icon:ss,gradient:re.info,bgColor:"bg-cyan-50",subtitle:"Ãšltimo mÃªs"})]}),e.jsx(ms,{value:l,onValueChange:U,className:"mb-6",children:e.jsxs(hs,{className:"grid w-full grid-cols-6",children:[e.jsx(G,{value:"all",children:"Todas"}),e.jsx(G,{value:"open",children:"Abertas"}),e.jsx(G,{value:"closed",children:"Fechadas"}),e.jsx(G,{value:"mixed",children:"Mistas"}),e.jsx(G,{value:"drafts",children:"Rascunhos"}),e.jsxs(G,{value:"favorites",children:[e.jsx(De,{className:"w-4 h-4 mr-1"}),"Favoritas"]})]})}),e.jsx(Ce,{className:"p-6 mb-6",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(fs,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx(Z,{placeholder:"Buscar atividade...",value:d,onChange:s=>q(s.target.value),className:"pl-10"})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(he,{value:O,onValueChange:$,children:[e.jsx(xe,{className:"w-[200px]",children:e.jsx(pe,{})}),e.jsxs(ue,{children:[e.jsx(P,{value:"created_desc",children:"Mais Recentes"}),e.jsx(P,{value:"created_asc",children:"Mais Antigas"}),e.jsx(P,{value:"name_asc",children:"Nome (A-Z)"}),e.jsx(P,{value:"name_desc",children:"Nome (Z-A)"}),e.jsx(P,{value:"most_used",children:"Mais Usadas"}),e.jsx(P,{value:"highest_score",children:"Maior PontuaÃ§Ã£o"})]})]}),e.jsx(p,{variant:A==="list"?"default":"outline",size:"icon",onClick:()=>u("list"),children:e.jsx(ks,{className:"w-5 h-5"})}),e.jsx(p,{variant:A==="grid"?"default":"outline",size:"icon",onClick:()=>u("grid"),children:e.jsx(Cs,{className:"w-5 h-5"})})]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs(p,{variant:"ghost",size:"sm",onClick:()=>h(!I),children:[e.jsx(Ts,{className:"w-4 h-4 mr-2"}),"Filtros AvanÃ§ados",I?e.jsx(Ns,{className:"w-4 h-4 ml-2"}):e.jsx(ws,{className:"w-4 h-4 ml-2"})]}),(d||w.type.length>0)&&e.jsxs(p,{variant:"ghost",size:"sm",onClick:ns,children:[e.jsx(we,{className:"w-4 h-4 mr-2"}),"Limpar"]})]}),I&&e.jsxs(ae.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},className:"grid grid-cols-1 md:grid-cols-2 gap-4 pt-4 border-t",children:[e.jsxs("div",{children:[e.jsx(C,{children:"Tipo"}),e.jsxs(he,{children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Todos"})}),e.jsxs(ue,{children:[e.jsx(P,{value:"open",children:"Abertas"}),e.jsx(P,{value:"closed",children:"Fechadas"}),e.jsx(P,{value:"mixed",children:"Mistas"})]})]})]}),e.jsxs("div",{children:[e.jsx(C,{children:"Status"}),e.jsxs(he,{children:[e.jsx(xe,{children:e.jsx(pe,{placeholder:"Todos"})}),e.jsxs(ue,{children:[e.jsx(P,{value:"published",children:"Publicadas"}),e.jsx(P,{value:"draft",children:"Rascunhos"}),e.jsx(P,{value:"archived",children:"Arquivadas"})]})]})]})]})]})}),i.length>0&&e.jsxs(ae.div,{initial:{opacity:0,y:-20},animate:{opacity:1,y:0},className:"fixed top-20 left-1/2 transform -translate-x-1/2 z-50 bg-blue-600 text-white px-6 py-4 rounded-lg shadow-2xl flex items-center gap-4",children:[e.jsxs("span",{className:"font-semibold",children:[i.length," selecionada(s)"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(p,{size:"sm",variant:"secondary",onClick:()=>L(!0),children:[e.jsx(Fe,{className:"w-4 h-4 mr-2"}),"Postar"]}),e.jsxs(p,{size:"sm",variant:"secondary",onClick:()=>{c({title:"Em breve",description:"FunÃ§Ã£o de exportaÃ§Ã£o em massa serÃ¡ implementada em breve."})},children:[e.jsx(Ke,{className:"w-4 h-4 mr-2"}),"Exportar"]}),e.jsxs(p,{size:"sm",variant:"secondary",onClick:async()=>{try{for(const s of i)await me(s);T([]),c({title:"Sucesso",description:`${i.length} atividade(s) arquivada(s).`})}catch(s){r.error("Erro ao arquivar:",s),c({title:"Erro",description:"NÃ£o foi possÃ­vel arquivar as atividades.",variant:"destructive"})}},children:[e.jsx(W,{className:"w-4 h-4 mr-2"}),"Arquivar"]}),e.jsx(p,{size:"sm",variant:"destructive",onClick:()=>T([]),children:e.jsx(we,{className:"w-4 h-4"})})]})]}),ce.length>0?e.jsx("div",{className:H(A==="grid"?"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6":"space-y-4"),children:ce.map((s,a)=>e.jsx(ae.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:a*.05},children:A==="list"?e.jsx(Ps,{activity:s,selected:i.includes(s.id),onSelect:os,onEdit:Le,onDuplicate:ze,onToggleFavorite:Ue,onArchive:me,onUnarchive:Ie,onDelete:()=>{ts(s),B(!0)},onPreview:g=>{qe(g),se(!0)},getTypeBadge:Oe}):e.jsx(_s,{activity:s,onEdit:Le,onToggleFavorite:Ue,onDuplicate:ze,onArchive:me,onUnarchive:Ie,getTypeBadge:Oe,navigate:t})},s.id))}):e.jsx(ps,{icon:Re,title:d?"Nenhuma atividade encontrada":"VocÃª ainda nÃ£o criou nenhuma atividade",description:d?"Tente ajustar os filtros.":"Comece criando sua primeira atividade.",actionLabel:"Criar Primeira Atividade",actionIcon:je,action:()=>{r.debug('[TeacherActivitiesPage] âž• EmptyState "Criar Primeira Atividade" clicado'),r.debug("[TeacherActivitiesPage] Navegando para: /dashboard/activities/create"),t("/dashboard/activities/create")}}),ce.length>0&&e.jsx(ae.div,{initial:{scale:0},animate:{scale:1},transition:{delay:.5},className:"fixed bottom-8 right-8 z-40",children:e.jsx(p,{size:"lg",onClick:()=>{r.debug("[TeacherActivitiesPage] ðŸŽ¯ FAB (Floating Action Button) clicado"),r.debug("[TeacherActivitiesPage] Navegando para: /dashboard/activities/create"),t("/dashboard/activities/create")},className:"w-16 h-16 rounded-full shadow-2xl bg-gradient-to-r from-blue-600 to-blue-700",children:e.jsx(je,{className:"w-8 h-8"})})}),e.jsx(Ae,{open:V,onOpenChange:B,children:e.jsxs(ke,{children:[e.jsxs(Se,{children:[e.jsx(Te,{children:"Excluir Atividade"}),e.jsx(Pe,{asChild:!0,children:de?.timesUsed>0?e.jsxs("div",{className:"space-y-2",children:[e.jsx("div",{className:"text-yellow-600 font-semibold",children:"âš ï¸ AtenÃ§Ã£o!"}),e.jsxs("div",{children:["Esta atividade foi usada ",de.timesUsed," vez(es)."]}),e.jsx("div",{children:"As submissÃµes existentes nÃ£o serÃ£o afetadas."})]}):e.jsx("div",{children:"Tem certeza? Esta aÃ§Ã£o nÃ£o pode ser desfeita."})})]}),e.jsxs(_e,{children:[e.jsx(p,{variant:"outline",onClick:()=>B(!1),children:"Cancelar"}),e.jsx(p,{variant:"destructive",onClick:()=>ls(de?.id),children:"Excluir"})]})]})}),ee&&e.jsx(Ds,{activities:i.map(s=>m.find(a=>a.id===s)),classes:j,onClose:()=>L(!1),onSuccess:()=>{L(!1),Q(),T([])}}),X&&ne&&e.jsx(bs,{activity:{...ne,...ne.content},onClose:()=>{se(!1),qe(null)}}),e.jsx(Es,{open:as,onClose:()=>Me(!1)})]})};export{zt as default};
