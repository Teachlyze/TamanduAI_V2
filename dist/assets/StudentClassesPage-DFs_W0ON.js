import{u as w,a as S,r as a,s as k,j as e,k as E}from"./main-Cr4CeQqJ.js";import{B as o,m as h}from"./button-VDnOzUX8.js";import{C as p}from"./card-CvoT5xff.js";import{I as B}from"./input-DJYxsXYr.js";import{B as L}from"./badge-BpFoLbJI.js";import{D as T}from"./dropdown-menu-W1Sf6eM2.js";import{E as _}from"./EmptyState-B0IxJOql.js";import{S as D}from"./SearchInput-DsjTKZsh.js";import"./label-Cj0ah_CE.js";import{C as I}from"./classService-Dl5Pj-lT.js";import{P as f}from"./plus-Ay-wLg4a.js";import{B as J}from"./book-open-Bm_7-XsZ.js";import"./index-Zvo5G3yJ.js";import"./chevron-right-D9YOEkTh.js";import"./check-BNbB6Qjw.js";import"./search-BPLrgJyl.js";import"./x-B5z18hzp.js";const Y=()=>{const x=w(),{user:t}=S(),[g,c]=a.useState(!0),[j,b]=a.useState([]),[i,C]=a.useState(""),[y,r]=a.useState(!1),[n,m]=a.useState("");a.useEffect(()=>{d()},[t]);const d=async()=>{if(t)try{c(!0);const{data:s}=await k.from("class_members").select(`
          class_id,
          classes:class_id (
            id,
            name,
            subject,
            color,
            created_by,
            teacher:created_by (
              id,
              name
            )
          )
        `).eq("user_id",t.id).eq("role","student"),l=(s||[]).map(N=>N.classes).filter(Boolean);b(l)}catch(s){console.error("Erro:",s)}finally{c(!1)}},v=async()=>{if(!n.trim()){alert("Digite o cÃ³digo da turma");return}try{await I.joinClassByCode(n.trim().toUpperCase(),t.id),alert("VocÃª entrou na turma com sucesso!"),r(!1),m(""),d()}catch(s){console.error("Erro:",s),alert(s.message||"Erro ao entrar na turma")}},u=j.filter(s=>s.name?.toLowerCase().includes(i.toLowerCase())||s.subject?.toLowerCase().includes(i.toLowerCase()));return g?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(E,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsx(T,{title:"Minhas Turmas",subtitle:"Acompanhe suas turmas e atividades",role:"student"}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsx(D,{value:i,onChange:s=>C(s.target.value),placeholder:"Buscar turmas..."}),e.jsxs(o,{onClick:()=>r(!0),className:"bg-gradient-to-r from-blue-600 to-purple-600",children:[e.jsx(f,{className:"w-4 h-4 mr-2"}),"Entrar em Turma"]})]}),u.length>0?e.jsx(h.div,{initial:{opacity:0},animate:{opacity:1},className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:u.map((s,l)=>e.jsx(h.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:l*.05},children:e.jsxs(p,{onClick:()=>x(`/student/classes/${s.id}`),className:"p-6 cursor-pointer hover:shadow-lg transition-all bg-white dark:bg-slate-900",children:[e.jsxs("div",{className:"flex items-start justify-between mb-4",children:[e.jsx("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center text-2xl",style:{backgroundColor:s.color||"#3B82F6"},children:"ðŸ“š"}),e.jsx(L,{children:s.subject||"Sem matÃ©ria"})]}),e.jsx("h3",{className:"font-bold text-lg mb-2",children:s.name}),e.jsxs("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-4",children:["Prof. ",s.teacher?.name||"Desconhecido"]}),e.jsx(o,{variant:"ghost",className:"w-full",children:"Ver Turma"})]})},s.id))}):e.jsx(_,{icon:J,title:"Nenhuma turma encontrada",description:"Entre em uma turma usando o cÃ³digo de convite",actionLabel:"Entrar em Turma",actionIcon:f,action:()=>r(!0)}),y&&e.jsx("div",{className:"fixed inset-0 bg-black/50 flex items-center justify-center z-50",children:e.jsxs(p,{className:"p-6 max-w-md w-full bg-white dark:bg-slate-900",children:[e.jsx("h3",{className:"text-xl font-bold mb-4",children:"Entrar em Turma"}),e.jsx(B,{value:n,onChange:s=>m(s.target.value),placeholder:"Digite o cÃ³digo da turma",className:"mb-4"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{onClick:v,className:"flex-1",children:"Entrar"}),e.jsx(o,{variant:"outline",onClick:()=>r(!1),children:"Cancelar"})]})]})})]})};export{Y as default};
