import{c as ft,r as T,j as e,k as Z,s as P,R as mt,l as At,u as ht,a as Mt}from"./main-PnoWv5mu.js";import{C as U}from"./card-DNyDBtwZ.js";import{B as R,m as gt}from"./button-B1az96ai.js";import{t as I}from"./use-toast-VMwxor12.js";import{r as Bt}from"./redisCache-Vh2O3gTE.js";import{B as xt,c as Tt}from"./SidebarPremium-DbDmcmQG.js";import{X as ee}from"./x-7WqOwCJm.js";import{S as Ae}from"./save-C6-ScC0D.js";import{C as Rt}from"./clock-Dkzb1QSl.js";import{T as bt}from"./trash-2-DfKFoENa.js";import{P as pt}from"./plus-DIEHEl2o.js";import{L as It}from"./link-C6n_5Pxs.js";import{M as Pt}from"./map-pin-pat613P4.js";import{C as Pe}from"./copy-B3LPT1my.js";import{D as Lt}from"./download-Dw41jWXn.js";import{B as Se}from"./book-open-BN8GTFXN.js";import{U as vt}from"./users-CZvcSbj_.js";import{F as qt}from"./file-text-WNEYLkuB.js";import{T as yt}from"./trending-up-BnoBnv7_.js";import{c as Dt}from"./constructNow-PU7y2RSz.js";import{t as K,n as Me,g as Le,a as Ft,e as zt,m as qe,b as Q,p as Ut}from"./pt-BR-CcyWMXEv.js";import{e as Ot}from"./endOfMonth-C-GYSVTr.js";import{E as Vt}from"./eye-DRJaLhZW.js";import{S as Ht}from"./square-pen-CGfQTttM.js";import{S as Gt}from"./settings-BAc4VZJo.js";import{A as wt}from"./archive-CRl2E2Px.js";import{S as Kt}from"./search-CcwmVUyB.js";import"./bell-jlu-i0nu.js";import"./user-IPdw0V9z.js";import"./graduation-cap-BTPeK0uK.js";import"./index-DvZMkTcl.js";import"./chart-column-Ba9dXnEb.js";/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Yt=[["path",{d:"m15.5 7.5 2.3 2.3a1 1 0 0 0 1.4 0l2.1-2.1a1 1 0 0 0 0-1.4L19 4",key:"g0fldk"}],["path",{d:"m21 2-9.6 9.6",key:"1j0ho8"}],["circle",{cx:"7.5",cy:"15.5",r:"5.5",key:"yqb3hr"}]],$t=ft("key",Yt);/**
 * @license lucide-react v0.544.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Jt=[["circle",{cx:"18",cy:"5",r:"3",key:"gq8acd"}],["circle",{cx:"6",cy:"12",r:"3",key:"w7nqdw"}],["circle",{cx:"18",cy:"19",r:"3",key:"1xt0gg"}],["line",{x1:"8.59",x2:"15.42",y1:"13.51",y2:"17.49",key:"47mynk"}],["line",{x1:"15.41",x2:"8.59",y1:"6.51",y2:"10.49",key:"1n3mei"}]],Qt=ft("share-2",Jt);function W(s,n){const o=+K(s)-+K(n);return o<0?-1:o>0?1:o}function Xt(s,n,o){const[r,t]=Me(o?.in,s,n),a=r.getFullYear()-t.getFullYear(),l=r.getMonth()-t.getMonth();return a*12+l}function Wt(s){return n=>{const r=(s?Math[s]:Math.trunc)(n);return r===0?0:r}}function Zt(s,n){return+K(s)-+K(n)}function er(s,n){const o=K(s,n?.in);return o.setHours(23,59,59,999),o}function tr(s,n){const o=K(s,n?.in);return+er(o,n)==+Ot(o,n)}function rr(s,n,o){const[r,t,a]=Me(o?.in,s,s,n),l=W(t,a),i=Math.abs(Xt(t,a));if(i<1)return 0;t.getMonth()===1&&t.getDate()>27&&t.setDate(30),t.setMonth(t.getMonth()-l*i);let c=W(t,a)===-l;tr(r)&&i===1&&W(r,a)===1&&(c=!1);const g=l*(i-+c);return g===0?0:g}function sr(s,n,o){const r=Zt(s,n)/1e3;return Wt(o?.roundingMethod)(r)}function ar(s,n,o){const r=Ft(),t=o?.locale??r.locale??zt,a=2520,l=W(s,n);if(isNaN(l))throw new RangeError("Invalid time value");const i=Object.assign({},o,{addSuffix:o?.addSuffix,comparison:l}),[c,g]=Me(o?.in,...l>0?[n,s]:[s,n]),u=sr(g,c),x=(Le(g)-Le(c))/1e3,f=Math.round((u-x)/60);let m;if(f<2)return o?.includeSeconds?u<5?t.formatDistance("lessThanXSeconds",5,i):u<10?t.formatDistance("lessThanXSeconds",10,i):u<20?t.formatDistance("lessThanXSeconds",20,i):u<40?t.formatDistance("halfAMinute",0,i):u<60?t.formatDistance("lessThanXMinutes",1,i):t.formatDistance("xMinutes",1,i):f===0?t.formatDistance("lessThanXMinutes",1,i):t.formatDistance("xMinutes",f,i);if(f<45)return t.formatDistance("xMinutes",f,i);if(f<90)return t.formatDistance("aboutXHours",1,i);if(f<qe){const v=Math.round(f/60);return t.formatDistance("aboutXHours",v,i)}else{if(f<a)return t.formatDistance("xDays",1,i);if(f<Q){const v=Math.round(f/qe);return t.formatDistance("xDays",v,i)}else if(f<Q*2)return m=Math.round(f/Q),t.formatDistance("aboutXMonths",m,i)}if(m=rr(g,c),m<12){const v=Math.round(f/Q);return t.formatDistance("xMonths",v,i)}else{const v=m%12,C=Math.trunc(m/12);return v<3?t.formatDistance("aboutXYears",C,i):v<9?t.formatDistance("overXYears",C,i):t.formatDistance("almostXYears",C+1,i)}}function nr(s,n){return ar(s,Dt(s),n)}const ir=({isOpen:s,onClose:n,onSuccess:o,classData:r})=>{const[t,a]=T.useState(!1),[l,i]=T.useState({name:"",subject:"",description:"",color:"",student_capacity:30});T.useEffect(()=>{r&&i({name:r.name||"",subject:r.subject||"",description:r.description||"",color:r.color||"from-blue-600 to-cyan-500",student_capacity:r.student_capacity||30})},[r]);const c=async u=>{if(u.preventDefault(),!l.name.trim()||!l.subject.trim()){I({title:"Campos obrigatórios",description:"Preencha o nome e a disciplina da turma.",variant:"destructive"});return}try{a(!0);const{error:x}=await P.from("classes").update({name:l.name,subject:l.subject,description:l.description,color:l.color,student_capacity:l.student_capacity,updated_at:new Date().toISOString()}).eq("id",r.id);if(x)throw x;I({title:"Turma atualizada!",description:"As alterações foram salvas com sucesso."}),o(),n()}catch(x){console.error("Erro ao atualizar turma:",x),I({title:"Erro ao atualizar",description:"Não foi possível atualizar a turma.",variant:"destructive"})}finally{a(!1)}},g=[{value:"from-blue-600 to-cyan-500",label:"Azul-Ciano"},{value:"from-green-600 to-emerald-500",label:"Verde"},{value:"from-purple-600 to-pink-500",label:"Roxo-Rosa"},{value:"from-orange-600 to-red-500",label:"Laranja-Vermelho"},{value:"from-indigo-600 to-blue-500",label:"Índigo"},{value:"from-teal-600 to-cyan-500",label:"Teal"}];return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 to-cyan-500 p-6 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Editar Turma"}),e.jsx("button",{onClick:n,className:"text-white hover:bg-white/20 p-2 rounded-lg",children:e.jsx(ee,{className:"w-5 h-5"})})]})}),e.jsxs("form",{onSubmit:c,className:"p-6 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Nome da Turma *"}),e.jsx("input",{type:"text",value:l.name,onChange:u=>i({...l,name:u.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Disciplina *"}),e.jsx("input",{type:"text",value:l.subject,onChange:u=>i({...l,subject:u.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Descrição"}),e.jsx("textarea",{value:l.description,onChange:u=>i({...l,description:u.target.value}),rows:3,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Capacidade de Alunos"}),e.jsx("input",{type:"number",value:l.student_capacity,onChange:u=>i({...l,student_capacity:parseInt(u.target.value)||0}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Cor do Banner"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:g.map(u=>e.jsxs("button",{type:"button",onClick:()=>i({...l,color:u.value}),className:`p-3 rounded-lg border-2 transition-all ${l.color===u.value?"border-blue-600 scale-105":"border-slate-200 dark:border-slate-700"}`,children:[e.jsx("div",{className:`h-8 rounded bg-gradient-to-r ${u.value} mb-2`}),e.jsx("span",{className:"text-xs",children:u.label})]},u.value))})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-slate-200 dark:border-slate-800",children:[e.jsx(R,{type:"button",variant:"outline",onClick:n,disabled:t,className:"flex-1",children:"Cancelar"}),e.jsx(R,{type:"submit",disabled:t,className:"flex-1 bg-gradient-to-r from-blue-600 to-cyan-600",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Z,{size:"sm",className:"mr-2"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Salvar"]})})]})]})]})}):null},or=({isOpen:s,onClose:n,onSuccess:o,classData:r})=>{const[t,a]=T.useState(!1),[l,i]=T.useState("invite"),[c,g]=T.useState([]),[u,x]=T.useState({invite_code:"",code_max_uses:null,code_expiration:null,code_uses_count:0,is_code_active:!0,schedule:[],modality:"online",meeting_link:"",location:"",chatbot_enabled:!1}),[f,m]=T.useState({day:"monday",start_time:"08:00",end_time:"09:00"});T.useEffect(()=>{r&&s&&(v(),C())},[r,s]);const v=async()=>{try{const{data:d}=await P.from("class_settings").select("*").eq("class_id",r.id).single();d&&x({invite_code:d.join_code||r.invite_code,code_max_uses:d.join_code_max_uses,code_expiration:d.join_code_expiration,code_uses_count:d.join_code_uses_count||0,is_code_active:d.is_join_code_active!==!1,schedule:d.schedule||[],modality:d.modality||"online",meeting_link:d.meeting_link||"",location:d.address||"",chatbot_enabled:d.chatbot_enabled||!1})}catch(d){console.error("Erro ao carregar configurações:",d)}},C=async()=>{try{const{data:d}=await P.from("invite_code_history").select("*").eq("class_id",r.id).order("created_at",{ascending:!1});g(d||[])}catch(d){console.error("Erro ao carregar histórico:",d)}},M=()=>{const d="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let b="";for(let j=0;j<8;j++)b+=d.charAt(Math.floor(Math.random()*d.length));return b},_=async()=>{const d=M();if(u.invite_code)try{await P.from("invite_code_history").insert([{class_id:r.id,code:u.invite_code,uses_count:u.code_uses_count,deactivated_at:new Date().toISOString()}])}catch(b){console.error("Erro ao salvar histórico:",b)}x({...u,invite_code:d,code_uses_count:0}),I({title:"Novo código gerado!",description:"O código anterior foi desativado."})},B=()=>{if(f.start_time>=f.end_time){I({title:"Horário inválido",description:"O horário de término deve ser após o horário de início.",variant:"destructive"});return}x({...u,schedule:[...u.schedule,{...f}]}),m({day:"monday",start_time:"08:00",end_time:"09:00"})},S=d=>{x({...u,schedule:u.schedule.filter((b,j)=>j!==d)})},h=async()=>{try{a(!0);const{error:d}=await P.from("classes").update({invite_code:u.invite_code,updated_at:new Date().toISOString()}).eq("id",r.id);if(d)throw d;const{error:b}=await P.from("class_settings").upsert({class_id:r.id,join_code:u.invite_code,join_code_max_uses:u.code_max_uses,join_code_expiration:u.code_expiration,join_code_uses_count:u.code_uses_count,is_join_code_active:u.is_code_active,schedule:u.schedule,modality:u.modality,meeting_link:u.meeting_link,address:u.location,chatbot_enabled:u.chatbot_enabled},{onConflict:"class_id"});if(b)throw b;I({title:"Configurações salvas!",description:"As configurações foram atualizadas com sucesso."}),o(),n()}catch(d){console.error("Erro ao salvar:",d),I({title:"Erro ao salvar",description:"Não foi possível salvar as configurações.",variant:"destructive"})}finally{a(!1)}},E={monday:"Segunda",tuesday:"Terça",wednesday:"Quarta",thursday:"Quinta",friday:"Sexta",saturday:"Sábado",sunday:"Domingo"};return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 to-cyan-500 p-6 rounded-t-2xl z-10",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Configurações Avançadas"}),e.jsx("p",{className:"text-cyan-100 text-sm",children:r.name})]}),e.jsx("button",{onClick:n,className:"text-white hover:bg-white/20 p-2 rounded-lg",children:e.jsx(ee,{className:"w-5 h-5"})})]})}),e.jsx("div",{className:"border-b border-slate-200 dark:border-slate-800 px-6",children:e.jsx("div",{className:"flex gap-4",children:[{id:"invite",label:"Código de Convite"},{id:"schedule",label:"Horários"},{id:"location",label:"Local/Link"},{id:"chatbot",label:"Chatbot"}].map(d=>e.jsx("button",{onClick:()=>i(d.id),className:`px-4 py-3 border-b-2 transition-colors ${l===d.id?"border-blue-600 text-blue-600 font-medium":"border-transparent text-slate-600 hover:text-slate-900"}`,children:d.label},d.id))})}),e.jsxs("div",{className:"p-6",children:[l==="invite"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Código Atual"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:u.invite_code,readOnly:!0,className:"flex-1 px-3 py-2 border rounded-lg bg-slate-50 dark:bg-slate-800 font-mono text-lg"}),e.jsxs(R,{onClick:_,variant:"outline",children:[e.jsx(mt,{className:"w-4 h-4 mr-2"}),"Gerar Novo"]})]}),e.jsxs("p",{className:"text-xs text-slate-500 mt-1",children:["Usado ",u.code_uses_count," ",u.code_uses_count===1?"vez":"vezes"]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Máximo de Usos"}),e.jsx("input",{type:"number",value:u.code_max_uses||"",onChange:d=>x({...u,code_max_uses:d.target.value?parseInt(d.target.value):null}),className:"w-full px-3 py-2 border rounded-lg dark:bg-slate-800",placeholder:"Ilimitado",min:"1"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Data de Expiração"}),e.jsx("input",{type:"date",value:u.code_expiration?u.code_expiration.split("T")[0]:"",onChange:d=>x({...u,code_expiration:d.target.value?new Date(d.target.value).toISOString():null}),className:"w-full px-3 py-2 border rounded-lg dark:bg-slate-800"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"checkbox",checked:u.is_code_active,onChange:d=>x({...u,is_code_active:d.target.checked}),className:"w-4 h-4"}),e.jsx("label",{className:"text-sm text-slate-700 dark:text-slate-300",children:"Código ativo (desmarque para desabilitar temporariamente)"})]}),c.length>0&&e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Histórico de Códigos"}),e.jsx("div",{className:"space-y-2",children:c.slice(0,5).map(d=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[e.jsx("span",{className:"font-mono",children:d.code}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("span",{className:"text-sm text-slate-600",children:[d.uses_count," ",d.uses_count===1?"uso":"usos"]}),e.jsx(xt,{variant:"outline",children:"Desativado"})]})]},d.id))})]})]}),l==="schedule"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold mb-3",children:"Horários de Aula"}),e.jsx("div",{className:"space-y-2",children:u.schedule.map((d,b)=>e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-slate-50 dark:bg-slate-800 rounded-lg",children:[e.jsx(Rt,{className:"w-5 h-5 text-slate-400"}),e.jsxs("span",{className:"flex-1",children:[E[d.day],": ",d.start_time," - ",d.end_time]}),e.jsx("button",{onClick:()=>S(b),className:"text-red-600 hover:text-red-700",children:e.jsx(bt,{className:"w-4 h-4"})})]},b))})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsx("h4",{className:"font-medium mb-3",children:"Adicionar Horário"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-3",children:[e.jsx("select",{value:f.day,onChange:d=>m({...f,day:d.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-slate-800",children:Object.entries(E).map(([d,b])=>e.jsx("option",{value:d,children:b},d))}),e.jsx("input",{type:"time",value:f.start_time,onChange:d=>m({...f,start_time:d.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-slate-800"}),e.jsx("input",{type:"time",value:f.end_time,onChange:d=>m({...f,end_time:d.target.value}),className:"px-3 py-2 border rounded-lg dark:bg-slate-800"})]}),e.jsxs(R,{onClick:B,size:"sm",children:[e.jsx(pt,{className:"w-4 h-4 mr-2"}),"Adicionar"]})]})]}),l==="location"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Modalidade"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",checked:u.modality==="online",onChange:()=>x({...u,modality:"online"}),className:"w-4 h-4"}),e.jsx("span",{children:"Online"})]}),e.jsxs("label",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"radio",checked:u.modality==="presential",onChange:()=>x({...u,modality:"presential"}),className:"w-4 h-4"}),e.jsx("span",{children:"Presencial"})]})]})]}),u.modality==="online"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Link da Reunião"}),e.jsxs("div",{className:"relative",children:[e.jsx(It,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"url",value:u.meeting_link,onChange:d=>x({...u,meeting_link:d.target.value}),className:"w-full pl-10 pr-3 py-2 border rounded-lg dark:bg-slate-800",placeholder:"https://meet.google.com/..."})]})]}),u.modality==="presential"&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Local/Endereço"}),e.jsxs("div",{className:"relative",children:[e.jsx(Pt,{className:"absolute left-3 top-3 w-5 h-5 text-slate-400"}),e.jsx("textarea",{value:u.location,onChange:d=>x({...u,location:d.target.value}),rows:3,className:"w-full pl-10 pr-3 py-2 border rounded-lg dark:bg-slate-800",placeholder:"Ex: Sala 203, Bloco B, Campus Centro"})]})]})]}),l==="chatbot"&&e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-3 p-4 bg-blue-50 dark:bg-blue-950/20 rounded-lg",children:[e.jsx(Tt,{className:"w-8 h-8 text-blue-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-slate-900 dark:text-white",children:"Assistente Virtual (Chatbot)"}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Ative um chatbot para responder dúvidas dos alunos automaticamente"})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:u.chatbot_enabled,onChange:d=>x({...u,chatbot_enabled:d.target.checked}),className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 dark:peer-focus:ring-blue-800 rounded-full peer dark:bg-gray-700 peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all dark:border-gray-600 peer-checked:bg-blue-600"})]})]}),u.chatbot_enabled&&e.jsx("div",{className:"p-4 bg-yellow-50 dark:bg-yellow-950/20 border border-yellow-200 dark:border-yellow-800 rounded-lg",children:e.jsx("p",{className:"text-sm text-yellow-800 dark:text-yellow-200",children:"ℹ️ Você poderá treinar e configurar o chatbot posteriormente na página específica de Chatbot."})})]})]}),e.jsx("div",{className:"border-t border-slate-200 dark:border-slate-800 p-6",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx(R,{variant:"outline",onClick:n,disabled:t,className:"flex-1",children:"Cancelar"}),e.jsx(R,{onClick:h,disabled:t,className:"flex-1 bg-gradient-to-r from-blue-600 to-cyan-600",children:t?e.jsxs(e.Fragment,{children:[e.jsx(Z,{size:"sm",className:"mr-2"}),"Salvando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Salvar Configurações"]})})]})})]})}):null};var G={},ne,De;function lr(){return De||(De=1,ne=function(){return typeof Promise=="function"&&Promise.prototype&&Promise.prototype.then}),ne}var ie={},z={},Fe;function O(){if(Fe)return z;Fe=1;let s;const n=[0,26,44,70,100,134,172,196,242,292,346,404,466,532,581,655,733,815,901,991,1085,1156,1258,1364,1474,1588,1706,1828,1921,2051,2185,2323,2465,2611,2761,2876,3034,3196,3362,3532,3706];return z.getSymbolSize=function(r){if(!r)throw new Error('"version" cannot be null or undefined');if(r<1||r>40)throw new Error('"version" should be in range from 1 to 40');return r*4+17},z.getSymbolTotalCodewords=function(r){return n[r]},z.getBCHDigit=function(o){let r=0;for(;o!==0;)r++,o>>>=1;return r},z.setToSJISFunction=function(r){if(typeof r!="function")throw new Error('"toSJISFunc" is not a valid function.');s=r},z.isKanjiModeEnabled=function(){return typeof s<"u"},z.toSJIS=function(r){return s(r)},z}var oe={},ze;function Be(){return ze||(ze=1,(function(s){s.L={bit:1},s.M={bit:0},s.Q={bit:3},s.H={bit:2};function n(o){if(typeof o!="string")throw new Error("Param is not a string");switch(o.toLowerCase()){case"l":case"low":return s.L;case"m":case"medium":return s.M;case"q":case"quartile":return s.Q;case"h":case"high":return s.H;default:throw new Error("Unknown EC Level: "+o)}}s.isValid=function(r){return r&&typeof r.bit<"u"&&r.bit>=0&&r.bit<4},s.from=function(r,t){if(s.isValid(r))return r;try{return n(r)}catch{return t}}})(oe)),oe}var le,Ue;function cr(){if(Ue)return le;Ue=1;function s(){this.buffer=[],this.length=0}return s.prototype={get:function(n){const o=Math.floor(n/8);return(this.buffer[o]>>>7-n%8&1)===1},put:function(n,o){for(let r=0;r<o;r++)this.putBit((n>>>o-r-1&1)===1)},getLengthInBits:function(){return this.length},putBit:function(n){const o=Math.floor(this.length/8);this.buffer.length<=o&&this.buffer.push(0),n&&(this.buffer[o]|=128>>>this.length%8),this.length++}},le=s,le}var ce,Oe;function dr(){if(Oe)return ce;Oe=1;function s(n){if(!n||n<1)throw new Error("BitMatrix size must be defined and greater than 0");this.size=n,this.data=new Uint8Array(n*n),this.reservedBit=new Uint8Array(n*n)}return s.prototype.set=function(n,o,r,t){const a=n*this.size+o;this.data[a]=r,t&&(this.reservedBit[a]=!0)},s.prototype.get=function(n,o){return this.data[n*this.size+o]},s.prototype.xor=function(n,o,r){this.data[n*this.size+o]^=r},s.prototype.isReserved=function(n,o){return this.reservedBit[n*this.size+o]},ce=s,ce}var de={},Ve;function ur(){return Ve||(Ve=1,(function(s){const n=O().getSymbolSize;s.getRowColCoords=function(r){if(r===1)return[];const t=Math.floor(r/7)+2,a=n(r),l=a===145?26:Math.ceil((a-13)/(2*t-2))*2,i=[a-7];for(let c=1;c<t-1;c++)i[c]=i[c-1]-l;return i.push(6),i.reverse()},s.getPositions=function(r){const t=[],a=s.getRowColCoords(r),l=a.length;for(let i=0;i<l;i++)for(let c=0;c<l;c++)i===0&&c===0||i===0&&c===l-1||i===l-1&&c===0||t.push([a[i],a[c]]);return t}})(de)),de}var ue={},He;function fr(){if(He)return ue;He=1;const s=O().getSymbolSize,n=7;return ue.getPositions=function(r){const t=s(r);return[[0,0],[t-n,0],[0,t-n]]},ue}var fe={},Ge;function mr(){return Ge||(Ge=1,(function(s){s.Patterns={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7};const n={N1:3,N2:3,N3:40,N4:10};s.isValid=function(t){return t!=null&&t!==""&&!isNaN(t)&&t>=0&&t<=7},s.from=function(t){return s.isValid(t)?parseInt(t,10):void 0},s.getPenaltyN1=function(t){const a=t.size;let l=0,i=0,c=0,g=null,u=null;for(let x=0;x<a;x++){i=c=0,g=u=null;for(let f=0;f<a;f++){let m=t.get(x,f);m===g?i++:(i>=5&&(l+=n.N1+(i-5)),g=m,i=1),m=t.get(f,x),m===u?c++:(c>=5&&(l+=n.N1+(c-5)),u=m,c=1)}i>=5&&(l+=n.N1+(i-5)),c>=5&&(l+=n.N1+(c-5))}return l},s.getPenaltyN2=function(t){const a=t.size;let l=0;for(let i=0;i<a-1;i++)for(let c=0;c<a-1;c++){const g=t.get(i,c)+t.get(i,c+1)+t.get(i+1,c)+t.get(i+1,c+1);(g===4||g===0)&&l++}return l*n.N2},s.getPenaltyN3=function(t){const a=t.size;let l=0,i=0,c=0;for(let g=0;g<a;g++){i=c=0;for(let u=0;u<a;u++)i=i<<1&2047|t.get(g,u),u>=10&&(i===1488||i===93)&&l++,c=c<<1&2047|t.get(u,g),u>=10&&(c===1488||c===93)&&l++}return l*n.N3},s.getPenaltyN4=function(t){let a=0;const l=t.data.length;for(let c=0;c<l;c++)a+=t.data[c];return Math.abs(Math.ceil(a*100/l/5)-10)*n.N4};function o(r,t,a){switch(r){case s.Patterns.PATTERN000:return(t+a)%2===0;case s.Patterns.PATTERN001:return t%2===0;case s.Patterns.PATTERN010:return a%3===0;case s.Patterns.PATTERN011:return(t+a)%3===0;case s.Patterns.PATTERN100:return(Math.floor(t/2)+Math.floor(a/3))%2===0;case s.Patterns.PATTERN101:return t*a%2+t*a%3===0;case s.Patterns.PATTERN110:return(t*a%2+t*a%3)%2===0;case s.Patterns.PATTERN111:return(t*a%3+(t+a)%2)%2===0;default:throw new Error("bad maskPattern:"+r)}}s.applyMask=function(t,a){const l=a.size;for(let i=0;i<l;i++)for(let c=0;c<l;c++)a.isReserved(c,i)||a.xor(c,i,o(t,c,i))},s.getBestMask=function(t,a){const l=Object.keys(s.Patterns).length;let i=0,c=1/0;for(let g=0;g<l;g++){a(g),s.applyMask(g,t);const u=s.getPenaltyN1(t)+s.getPenaltyN2(t)+s.getPenaltyN3(t)+s.getPenaltyN4(t);s.applyMask(g,t),u<c&&(c=u,i=g)}return i}})(fe)),fe}var X={},Ke;function jt(){if(Ke)return X;Ke=1;const s=Be(),n=[1,1,1,1,1,1,1,1,1,1,2,2,1,2,2,4,1,2,4,4,2,4,4,4,2,4,6,5,2,4,6,6,2,5,8,8,4,5,8,8,4,5,8,11,4,8,10,11,4,9,12,16,4,9,16,16,6,10,12,18,6,10,17,16,6,11,16,19,6,13,18,21,7,14,21,25,8,16,20,25,8,17,23,25,9,17,23,34,9,18,25,30,10,20,27,32,12,21,29,35,12,23,34,37,12,25,34,40,13,26,35,42,14,28,38,45,15,29,40,48,16,31,43,51,17,33,45,54,18,35,48,57,19,37,51,60,19,38,53,63,20,40,56,66,21,43,59,70,22,45,62,74,24,47,65,77,25,49,68,81],o=[7,10,13,17,10,16,22,28,15,26,36,44,20,36,52,64,26,48,72,88,36,64,96,112,40,72,108,130,48,88,132,156,60,110,160,192,72,130,192,224,80,150,224,264,96,176,260,308,104,198,288,352,120,216,320,384,132,240,360,432,144,280,408,480,168,308,448,532,180,338,504,588,196,364,546,650,224,416,600,700,224,442,644,750,252,476,690,816,270,504,750,900,300,560,810,960,312,588,870,1050,336,644,952,1110,360,700,1020,1200,390,728,1050,1260,420,784,1140,1350,450,812,1200,1440,480,868,1290,1530,510,924,1350,1620,540,980,1440,1710,570,1036,1530,1800,570,1064,1590,1890,600,1120,1680,1980,630,1204,1770,2100,660,1260,1860,2220,720,1316,1950,2310,750,1372,2040,2430];return X.getBlocksCount=function(t,a){switch(a){case s.L:return n[(t-1)*4+0];case s.M:return n[(t-1)*4+1];case s.Q:return n[(t-1)*4+2];case s.H:return n[(t-1)*4+3];default:return}},X.getTotalCodewordsCount=function(t,a){switch(a){case s.L:return o[(t-1)*4+0];case s.M:return o[(t-1)*4+1];case s.Q:return o[(t-1)*4+2];case s.H:return o[(t-1)*4+3];default:return}},X}var me={},$={},Ye;function hr(){if(Ye)return $;Ye=1;const s=new Uint8Array(512),n=new Uint8Array(256);return(function(){let r=1;for(let t=0;t<255;t++)s[t]=r,n[r]=t,r<<=1,r&256&&(r^=285);for(let t=255;t<512;t++)s[t]=s[t-255]})(),$.log=function(r){if(r<1)throw new Error("log("+r+")");return n[r]},$.exp=function(r){return s[r]},$.mul=function(r,t){return r===0||t===0?0:s[n[r]+n[t]]},$}var $e;function gr(){return $e||($e=1,(function(s){const n=hr();s.mul=function(r,t){const a=new Uint8Array(r.length+t.length-1);for(let l=0;l<r.length;l++)for(let i=0;i<t.length;i++)a[l+i]^=n.mul(r[l],t[i]);return a},s.mod=function(r,t){let a=new Uint8Array(r);for(;a.length-t.length>=0;){const l=a[0];for(let c=0;c<t.length;c++)a[c]^=n.mul(t[c],l);let i=0;for(;i<a.length&&a[i]===0;)i++;a=a.slice(i)}return a},s.generateECPolynomial=function(r){let t=new Uint8Array([1]);for(let a=0;a<r;a++)t=s.mul(t,new Uint8Array([1,n.exp(a)]));return t}})(me)),me}var he,Je;function xr(){if(Je)return he;Je=1;const s=gr();function n(o){this.genPoly=void 0,this.degree=o,this.degree&&this.initialize(this.degree)}return n.prototype.initialize=function(r){this.degree=r,this.genPoly=s.generateECPolynomial(this.degree)},n.prototype.encode=function(r){if(!this.genPoly)throw new Error("Encoder not initialized");const t=new Uint8Array(r.length+this.degree);t.set(r);const a=s.mod(t,this.genPoly),l=this.degree-a.length;if(l>0){const i=new Uint8Array(this.degree);return i.set(a,l),i}return a},he=n,he}var ge={},xe={},be={},Qe;function Nt(){return Qe||(Qe=1,be.isValid=function(n){return!isNaN(n)&&n>=1&&n<=40}),be}var q={},Xe;function Ct(){if(Xe)return q;Xe=1;const s="[0-9]+",n="[A-Z $%*+\\-./:]+";let o="(?:[u3000-u303F]|[u3040-u309F]|[u30A0-u30FF]|[uFF00-uFFEF]|[u4E00-u9FAF]|[u2605-u2606]|[u2190-u2195]|u203B|[u2010u2015u2018u2019u2025u2026u201Cu201Du2225u2260]|[u0391-u0451]|[u00A7u00A8u00B1u00B4u00D7u00F7])+";o=o.replace(/u/g,"\\u");const r="(?:(?![A-Z0-9 $%*+\\-./:]|"+o+`)(?:.|[\r
]))+`;q.KANJI=new RegExp(o,"g"),q.BYTE_KANJI=new RegExp("[^A-Z0-9 $%*+\\-./:]+","g"),q.BYTE=new RegExp(r,"g"),q.NUMERIC=new RegExp(s,"g"),q.ALPHANUMERIC=new RegExp(n,"g");const t=new RegExp("^"+o+"$"),a=new RegExp("^"+s+"$"),l=new RegExp("^[A-Z0-9 $%*+\\-./:]+$");return q.testKanji=function(c){return t.test(c)},q.testNumeric=function(c){return a.test(c)},q.testAlphanumeric=function(c){return l.test(c)},q}var We;function V(){return We||(We=1,(function(s){const n=Nt(),o=Ct();s.NUMERIC={id:"Numeric",bit:1,ccBits:[10,12,14]},s.ALPHANUMERIC={id:"Alphanumeric",bit:2,ccBits:[9,11,13]},s.BYTE={id:"Byte",bit:4,ccBits:[8,16,16]},s.KANJI={id:"Kanji",bit:8,ccBits:[8,10,12]},s.MIXED={bit:-1},s.getCharCountIndicator=function(a,l){if(!a.ccBits)throw new Error("Invalid mode: "+a);if(!n.isValid(l))throw new Error("Invalid version: "+l);return l>=1&&l<10?a.ccBits[0]:l<27?a.ccBits[1]:a.ccBits[2]},s.getBestModeForData=function(a){return o.testNumeric(a)?s.NUMERIC:o.testAlphanumeric(a)?s.ALPHANUMERIC:o.testKanji(a)?s.KANJI:s.BYTE},s.toString=function(a){if(a&&a.id)return a.id;throw new Error("Invalid mode")},s.isValid=function(a){return a&&a.bit&&a.ccBits};function r(t){if(typeof t!="string")throw new Error("Param is not a string");switch(t.toLowerCase()){case"numeric":return s.NUMERIC;case"alphanumeric":return s.ALPHANUMERIC;case"kanji":return s.KANJI;case"byte":return s.BYTE;default:throw new Error("Unknown mode: "+t)}}s.from=function(a,l){if(s.isValid(a))return a;try{return r(a)}catch{return l}}})(xe)),xe}var Ze;function br(){return Ze||(Ze=1,(function(s){const n=O(),o=jt(),r=Be(),t=V(),a=Nt(),l=7973,i=n.getBCHDigit(l);function c(f,m,v){for(let C=1;C<=40;C++)if(m<=s.getCapacity(C,v,f))return C}function g(f,m){return t.getCharCountIndicator(f,m)+4}function u(f,m){let v=0;return f.forEach(function(C){const M=g(C.mode,m);v+=M+C.getBitsLength()}),v}function x(f,m){for(let v=1;v<=40;v++)if(u(f,v)<=s.getCapacity(v,m,t.MIXED))return v}s.from=function(m,v){return a.isValid(m)?parseInt(m,10):v},s.getCapacity=function(m,v,C){if(!a.isValid(m))throw new Error("Invalid QR Code version");typeof C>"u"&&(C=t.BYTE);const M=n.getSymbolTotalCodewords(m),_=o.getTotalCodewordsCount(m,v),B=(M-_)*8;if(C===t.MIXED)return B;const S=B-g(C,m);switch(C){case t.NUMERIC:return Math.floor(S/10*3);case t.ALPHANUMERIC:return Math.floor(S/11*2);case t.KANJI:return Math.floor(S/13);case t.BYTE:default:return Math.floor(S/8)}},s.getBestVersionForData=function(m,v){let C;const M=r.from(v,r.M);if(Array.isArray(m)){if(m.length>1)return x(m,M);if(m.length===0)return 1;C=m[0]}else C=m;return c(C.mode,C.getLength(),M)},s.getEncodedBits=function(m){if(!a.isValid(m)||m<7)throw new Error("Invalid QR Code version");let v=m<<12;for(;n.getBCHDigit(v)-i>=0;)v^=l<<n.getBCHDigit(v)-i;return m<<12|v}})(ge)),ge}var pe={},et;function pr(){if(et)return pe;et=1;const s=O(),n=1335,o=21522,r=s.getBCHDigit(n);return pe.getEncodedBits=function(a,l){const i=a.bit<<3|l;let c=i<<10;for(;s.getBCHDigit(c)-r>=0;)c^=n<<s.getBCHDigit(c)-r;return(i<<10|c)^o},pe}var ve={},ye,tt;function vr(){if(tt)return ye;tt=1;const s=V();function n(o){this.mode=s.NUMERIC,this.data=o.toString()}return n.getBitsLength=function(r){return 10*Math.floor(r/3)+(r%3?r%3*3+1:0)},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(r){let t,a,l;for(t=0;t+3<=this.data.length;t+=3)a=this.data.substr(t,3),l=parseInt(a,10),r.put(l,10);const i=this.data.length-t;i>0&&(a=this.data.substr(t),l=parseInt(a,10),r.put(l,i*3+1))},ye=n,ye}var we,rt;function yr(){if(rt)return we;rt=1;const s=V(),n=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"," ","$","%","*","+","-",".","/",":"];function o(r){this.mode=s.ALPHANUMERIC,this.data=r}return o.getBitsLength=function(t){return 11*Math.floor(t/2)+6*(t%2)},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(t){let a;for(a=0;a+2<=this.data.length;a+=2){let l=n.indexOf(this.data[a])*45;l+=n.indexOf(this.data[a+1]),t.put(l,11)}this.data.length%2&&t.put(n.indexOf(this.data[a]),6)},we=o,we}var je,st;function wr(){if(st)return je;st=1;const s=V();function n(o){this.mode=s.BYTE,typeof o=="string"?this.data=new TextEncoder().encode(o):this.data=new Uint8Array(o)}return n.getBitsLength=function(r){return r*8},n.prototype.getLength=function(){return this.data.length},n.prototype.getBitsLength=function(){return n.getBitsLength(this.data.length)},n.prototype.write=function(o){for(let r=0,t=this.data.length;r<t;r++)o.put(this.data[r],8)},je=n,je}var Ne,at;function jr(){if(at)return Ne;at=1;const s=V(),n=O();function o(r){this.mode=s.KANJI,this.data=r}return o.getBitsLength=function(t){return t*13},o.prototype.getLength=function(){return this.data.length},o.prototype.getBitsLength=function(){return o.getBitsLength(this.data.length)},o.prototype.write=function(r){let t;for(t=0;t<this.data.length;t++){let a=n.toSJIS(this.data[t]);if(a>=33088&&a<=40956)a-=33088;else if(a>=57408&&a<=60351)a-=49472;else throw new Error("Invalid SJIS character: "+this.data[t]+`
Make sure your charset is UTF-8`);a=(a>>>8&255)*192+(a&255),r.put(a,13)}},Ne=o,Ne}var Ce={exports:{}},nt;function Nr(){return nt||(nt=1,(function(s){var n={single_source_shortest_paths:function(o,r,t){var a={},l={};l[r]=0;var i=n.PriorityQueue.make();i.push(r,0);for(var c,g,u,x,f,m,v,C,M;!i.empty();){c=i.pop(),g=c.value,x=c.cost,f=o[g]||{};for(u in f)f.hasOwnProperty(u)&&(m=f[u],v=x+m,C=l[u],M=typeof l[u]>"u",(M||C>v)&&(l[u]=v,i.push(u,v),a[u]=g))}if(typeof t<"u"&&typeof l[t]>"u"){var _=["Could not find a path from ",r," to ",t,"."].join("");throw new Error(_)}return a},extract_shortest_path_from_predecessor_list:function(o,r){for(var t=[],a=r;a;)t.push(a),o[a],a=o[a];return t.reverse(),t},find_path:function(o,r,t){var a=n.single_source_shortest_paths(o,r,t);return n.extract_shortest_path_from_predecessor_list(a,t)},PriorityQueue:{make:function(o){var r=n.PriorityQueue,t={},a;o=o||{};for(a in r)r.hasOwnProperty(a)&&(t[a]=r[a]);return t.queue=[],t.sorter=o.sorter||r.default_sorter,t},default_sorter:function(o,r){return o.cost-r.cost},push:function(o,r){var t={value:o,cost:r};this.queue.push(t),this.queue.sort(this.sorter)},pop:function(){return this.queue.shift()},empty:function(){return this.queue.length===0}}};s.exports=n})(Ce)),Ce.exports}var it;function Cr(){return it||(it=1,(function(s){const n=V(),o=vr(),r=yr(),t=wr(),a=jr(),l=Ct(),i=O(),c=Nr();function g(_){return unescape(encodeURIComponent(_)).length}function u(_,B,S){const h=[];let E;for(;(E=_.exec(S))!==null;)h.push({data:E[0],index:E.index,mode:B,length:E[0].length});return h}function x(_){const B=u(l.NUMERIC,n.NUMERIC,_),S=u(l.ALPHANUMERIC,n.ALPHANUMERIC,_);let h,E;return i.isKanjiModeEnabled()?(h=u(l.BYTE,n.BYTE,_),E=u(l.KANJI,n.KANJI,_)):(h=u(l.BYTE_KANJI,n.BYTE,_),E=[]),B.concat(S,h,E).sort(function(b,j){return b.index-j.index}).map(function(b){return{data:b.data,mode:b.mode,length:b.length}})}function f(_,B){switch(B){case n.NUMERIC:return o.getBitsLength(_);case n.ALPHANUMERIC:return r.getBitsLength(_);case n.KANJI:return a.getBitsLength(_);case n.BYTE:return t.getBitsLength(_)}}function m(_){return _.reduce(function(B,S){const h=B.length-1>=0?B[B.length-1]:null;return h&&h.mode===S.mode?(B[B.length-1].data+=S.data,B):(B.push(S),B)},[])}function v(_){const B=[];for(let S=0;S<_.length;S++){const h=_[S];switch(h.mode){case n.NUMERIC:B.push([h,{data:h.data,mode:n.ALPHANUMERIC,length:h.length},{data:h.data,mode:n.BYTE,length:h.length}]);break;case n.ALPHANUMERIC:B.push([h,{data:h.data,mode:n.BYTE,length:h.length}]);break;case n.KANJI:B.push([h,{data:h.data,mode:n.BYTE,length:g(h.data)}]);break;case n.BYTE:B.push([{data:h.data,mode:n.BYTE,length:g(h.data)}])}}return B}function C(_,B){const S={},h={start:{}};let E=["start"];for(let d=0;d<_.length;d++){const b=_[d],j=[];for(let w=0;w<b.length;w++){const k=b[w],N=""+d+w;j.push(N),S[N]={node:k,lastCount:0},h[N]={};for(let p=0;p<E.length;p++){const y=E[p];S[y]&&S[y].node.mode===k.mode?(h[y][N]=f(S[y].lastCount+k.length,k.mode)-f(S[y].lastCount,k.mode),S[y].lastCount+=k.length):(S[y]&&(S[y].lastCount=k.length),h[y][N]=f(k.length,k.mode)+4+n.getCharCountIndicator(k.mode,B))}}E=j}for(let d=0;d<E.length;d++)h[E[d]].end=0;return{map:h,table:S}}function M(_,B){let S;const h=n.getBestModeForData(_);if(S=n.from(B,h),S!==n.BYTE&&S.bit<h.bit)throw new Error('"'+_+'" cannot be encoded with mode '+n.toString(S)+`.
 Suggested mode is: `+n.toString(h));switch(S===n.KANJI&&!i.isKanjiModeEnabled()&&(S=n.BYTE),S){case n.NUMERIC:return new o(_);case n.ALPHANUMERIC:return new r(_);case n.KANJI:return new a(_);case n.BYTE:return new t(_)}}s.fromArray=function(B){return B.reduce(function(S,h){return typeof h=="string"?S.push(M(h,null)):h.data&&S.push(M(h.data,h.mode)),S},[])},s.fromString=function(B,S){const h=x(B,i.isKanjiModeEnabled()),E=v(h),d=C(E,S),b=c.find_path(d.map,"start","end"),j=[];for(let w=1;w<b.length-1;w++)j.push(d.table[b[w]].node);return s.fromArray(m(j))},s.rawSplit=function(B){return s.fromArray(x(B,i.isKanjiModeEnabled()))}})(ve)),ve}var ot;function kr(){if(ot)return ie;ot=1;const s=O(),n=Be(),o=cr(),r=dr(),t=ur(),a=fr(),l=mr(),i=jt(),c=xr(),g=br(),u=pr(),x=V(),f=Cr();function m(d,b){const j=d.size,w=a.getPositions(b);for(let k=0;k<w.length;k++){const N=w[k][0],p=w[k][1];for(let y=-1;y<=7;y++)if(!(N+y<=-1||j<=N+y))for(let A=-1;A<=7;A++)p+A<=-1||j<=p+A||(y>=0&&y<=6&&(A===0||A===6)||A>=0&&A<=6&&(y===0||y===6)||y>=2&&y<=4&&A>=2&&A<=4?d.set(N+y,p+A,!0,!0):d.set(N+y,p+A,!1,!0))}}function v(d){const b=d.size;for(let j=8;j<b-8;j++){const w=j%2===0;d.set(j,6,w,!0),d.set(6,j,w,!0)}}function C(d,b){const j=t.getPositions(b);for(let w=0;w<j.length;w++){const k=j[w][0],N=j[w][1];for(let p=-2;p<=2;p++)for(let y=-2;y<=2;y++)p===-2||p===2||y===-2||y===2||p===0&&y===0?d.set(k+p,N+y,!0,!0):d.set(k+p,N+y,!1,!0)}}function M(d,b){const j=d.size,w=g.getEncodedBits(b);let k,N,p;for(let y=0;y<18;y++)k=Math.floor(y/3),N=y%3+j-8-3,p=(w>>y&1)===1,d.set(k,N,p,!0),d.set(N,k,p,!0)}function _(d,b,j){const w=d.size,k=u.getEncodedBits(b,j);let N,p;for(N=0;N<15;N++)p=(k>>N&1)===1,N<6?d.set(N,8,p,!0):N<8?d.set(N+1,8,p,!0):d.set(w-15+N,8,p,!0),N<8?d.set(8,w-N-1,p,!0):N<9?d.set(8,15-N-1+1,p,!0):d.set(8,15-N-1,p,!0);d.set(w-8,8,1,!0)}function B(d,b){const j=d.size;let w=-1,k=j-1,N=7,p=0;for(let y=j-1;y>0;y-=2)for(y===6&&y--;;){for(let A=0;A<2;A++)if(!d.isReserved(k,y-A)){let L=!1;p<b.length&&(L=(b[p]>>>N&1)===1),d.set(k,y-A,L),N--,N===-1&&(p++,N=7)}if(k+=w,k<0||j<=k){k-=w,w=-w;break}}}function S(d,b,j){const w=new o;j.forEach(function(A){w.put(A.mode.bit,4),w.put(A.getLength(),x.getCharCountIndicator(A.mode,d)),A.write(w)});const k=s.getSymbolTotalCodewords(d),N=i.getTotalCodewordsCount(d,b),p=(k-N)*8;for(w.getLengthInBits()+4<=p&&w.put(0,4);w.getLengthInBits()%8!==0;)w.putBit(0);const y=(p-w.getLengthInBits())/8;for(let A=0;A<y;A++)w.put(A%2?17:236,8);return h(w,d,b)}function h(d,b,j){const w=s.getSymbolTotalCodewords(b),k=i.getTotalCodewordsCount(b,j),N=w-k,p=i.getBlocksCount(b,j),y=w%p,A=p-y,L=Math.floor(w/p),Y=Math.floor(N/p),_t=Y+1,Te=L-Y,Et=new c(Te);let te=0;const J=new Array(p),Re=new Array(p);let re=0;const St=new Uint8Array(d.buffer);for(let H=0;H<p;H++){const ae=H<A?Y:_t;J[H]=St.slice(te,te+ae),Re[H]=Et.encode(J[H]),te+=ae,re=Math.max(re,ae)}const se=new Uint8Array(w);let Ie=0,D,F;for(D=0;D<re;D++)for(F=0;F<p;F++)D<J[F].length&&(se[Ie++]=J[F][D]);for(D=0;D<Te;D++)for(F=0;F<p;F++)se[Ie++]=Re[F][D];return se}function E(d,b,j,w){let k;if(Array.isArray(d))k=f.fromArray(d);else if(typeof d=="string"){let L=b;if(!L){const Y=f.rawSplit(d);L=g.getBestVersionForData(Y,j)}k=f.fromString(d,L||40)}else throw new Error("Invalid data");const N=g.getBestVersionForData(k,j);if(!N)throw new Error("The amount of data is too big to be stored in a QR Code");if(!b)b=N;else if(b<N)throw new Error(`
The chosen QR Code version cannot contain this amount of data.
Minimum version required to store current data is: `+N+`.
`);const p=S(b,j,k),y=s.getSymbolSize(b),A=new r(y);return m(A,b),v(A),C(A,b),_(A,j,0),b>=7&&M(A,b),B(A,p),isNaN(w)&&(w=l.getBestMask(A,_.bind(null,A,j))),l.applyMask(w,A),_(A,j,w),{modules:A,version:b,errorCorrectionLevel:j,maskPattern:w,segments:k}}return ie.create=function(b,j){if(typeof b>"u"||b==="")throw new Error("No input text");let w=n.M,k,N;return typeof j<"u"&&(w=n.from(j.errorCorrectionLevel,n.M),k=g.from(j.version),N=l.from(j.maskPattern),j.toSJISFunc&&s.setToSJISFunction(j.toSJISFunc)),E(b,k,w,N)},ie}var ke={},_e={},lt;function kt(){return lt||(lt=1,(function(s){function n(o){if(typeof o=="number"&&(o=o.toString()),typeof o!="string")throw new Error("Color should be defined as hex string");let r=o.slice().replace("#","").split("");if(r.length<3||r.length===5||r.length>8)throw new Error("Invalid hex color: "+o);(r.length===3||r.length===4)&&(r=Array.prototype.concat.apply([],r.map(function(a){return[a,a]}))),r.length===6&&r.push("F","F");const t=parseInt(r.join(""),16);return{r:t>>24&255,g:t>>16&255,b:t>>8&255,a:t&255,hex:"#"+r.slice(0,6).join("")}}s.getOptions=function(r){r||(r={}),r.color||(r.color={});const t=typeof r.margin>"u"||r.margin===null||r.margin<0?4:r.margin,a=r.width&&r.width>=21?r.width:void 0,l=r.scale||4;return{width:a,scale:a?4:l,margin:t,color:{dark:n(r.color.dark||"#000000ff"),light:n(r.color.light||"#ffffffff")},type:r.type,rendererOpts:r.rendererOpts||{}}},s.getScale=function(r,t){return t.width&&t.width>=r+t.margin*2?t.width/(r+t.margin*2):t.scale},s.getImageWidth=function(r,t){const a=s.getScale(r,t);return Math.floor((r+t.margin*2)*a)},s.qrToImageData=function(r,t,a){const l=t.modules.size,i=t.modules.data,c=s.getScale(l,a),g=Math.floor((l+a.margin*2)*c),u=a.margin*c,x=[a.color.light,a.color.dark];for(let f=0;f<g;f++)for(let m=0;m<g;m++){let v=(f*g+m)*4,C=a.color.light;if(f>=u&&m>=u&&f<g-u&&m<g-u){const M=Math.floor((f-u)/c),_=Math.floor((m-u)/c);C=x[i[M*l+_]?1:0]}r[v++]=C.r,r[v++]=C.g,r[v++]=C.b,r[v]=C.a}}})(_e)),_e}var ct;function _r(){return ct||(ct=1,(function(s){const n=kt();function o(t,a,l){t.clearRect(0,0,a.width,a.height),a.style||(a.style={}),a.height=l,a.width=l,a.style.height=l+"px",a.style.width=l+"px"}function r(){try{return document.createElement("canvas")}catch{throw new Error("You need to specify a canvas element")}}s.render=function(a,l,i){let c=i,g=l;typeof c>"u"&&(!l||!l.getContext)&&(c=l,l=void 0),l||(g=r()),c=n.getOptions(c);const u=n.getImageWidth(a.modules.size,c),x=g.getContext("2d"),f=x.createImageData(u,u);return n.qrToImageData(f.data,a,c),o(x,g,u),x.putImageData(f,0,0),g},s.renderToDataURL=function(a,l,i){let c=i;typeof c>"u"&&(!l||!l.getContext)&&(c=l,l=void 0),c||(c={});const g=s.render(a,l,c),u=c.type||"image/png",x=c.rendererOpts||{};return g.toDataURL(u,x.quality)}})(ke)),ke}var Ee={},dt;function Er(){if(dt)return Ee;dt=1;const s=kt();function n(t,a){const l=t.a/255,i=a+'="'+t.hex+'"';return l<1?i+" "+a+'-opacity="'+l.toFixed(2).slice(1)+'"':i}function o(t,a,l){let i=t+a;return typeof l<"u"&&(i+=" "+l),i}function r(t,a,l){let i="",c=0,g=!1,u=0;for(let x=0;x<t.length;x++){const f=Math.floor(x%a),m=Math.floor(x/a);!f&&!g&&(g=!0),t[x]?(u++,x>0&&f>0&&t[x-1]||(i+=g?o("M",f+l,.5+m+l):o("m",c,0),c=0,g=!1),f+1<a&&t[x+1]||(i+=o("h",u),u=0)):c++}return i}return Ee.render=function(a,l,i){const c=s.getOptions(l),g=a.modules.size,u=a.modules.data,x=g+c.margin*2,f=c.color.light.a?"<path "+n(c.color.light,"fill")+' d="M0 0h'+x+"v"+x+'H0z"/>':"",m="<path "+n(c.color.dark,"stroke")+' d="'+r(u,g,c.margin)+'"/>',v='viewBox="0 0 '+x+" "+x+'"',M='<svg xmlns="http://www.w3.org/2000/svg" '+(c.width?'width="'+c.width+'" height="'+c.width+'" ':"")+v+' shape-rendering="crispEdges">'+f+m+`</svg>
`;return typeof i=="function"&&i(null,M),M},Ee}var ut;function Sr(){if(ut)return G;ut=1;const s=lr(),n=kr(),o=_r(),r=Er();function t(a,l,i,c,g){const u=[].slice.call(arguments,1),x=u.length,f=typeof u[x-1]=="function";if(!f&&!s())throw new Error("Callback required as last argument");if(f){if(x<2)throw new Error("Too few arguments provided");x===2?(g=i,i=l,l=c=void 0):x===3&&(l.getContext&&typeof g>"u"?(g=c,c=void 0):(g=c,c=i,i=l,l=void 0))}else{if(x<1)throw new Error("Too few arguments provided");return x===1?(i=l,l=c=void 0):x===2&&!l.getContext&&(c=i,i=l,l=void 0),new Promise(function(m,v){try{const C=n.create(i,c);m(a(C,l,c))}catch(C){v(C)}})}try{const m=n.create(i,c);g(null,a(m,l,c))}catch(m){g(m)}}return G.create=n.create,G.toCanvas=t.bind(null,o.render),G.toDataURL=t.bind(null,o.renderToDataURL),G.toString=t.bind(null,function(a,l,i){return r.render(a,i)}),G}var Ar=Sr();const Mr=At(Ar),Br=({isOpen:s,onClose:n,classData:o})=>{const r=T.useRef(null),t=o?.invite_code,a=`${window.location.origin}/join/${t}`;T.useEffect(()=>{s&&r.current&&t&&Mr.toCanvas(r.current,a,{width:256,margin:2,color:{dark:"#1e40af",light:"#ffffff"}})},[s,a,t]);const l=()=>{navigator.clipboard.writeText(t),I({title:"Código copiado!",description:"O código foi copiado para a área de transferência."})},i=()=>{navigator.clipboard.writeText(a),I({title:"Link copiado!",description:"O link foi copiado para a área de transferência."})},c=()=>{if(r.current){const u=r.current.toDataURL("image/png"),x=document.createElement("a");x.download=`qr-code-${o.name}.png`,x.href=u,x.click(),I({title:"QR Code baixado!",description:"O QR Code foi salvo em seu dispositivo."})}},g=async()=>{if(navigator.share)try{await navigator.share({title:`Convite para ${o.name}`,text:`Use o código ${t} para entrar na turma ${o.name}`,url:a})}catch(u){u.name!=="AbortError"&&console.error("Erro ao compartilhar:",u)}else i()};return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-xl max-w-md w-full",children:[e.jsxs("div",{className:"bg-gradient-to-r from-blue-600 to-cyan-500 p-6 rounded-t-2xl",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Código de Convite"}),e.jsx("button",{onClick:n,className:"text-white hover:bg-white/20 p-2 rounded-lg",children:e.jsx(ee,{className:"w-5 h-5"})})]}),e.jsx("p",{className:"text-cyan-100 text-sm mt-1",children:o.name})]}),e.jsxs("div",{className:"p-6 space-y-6",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"Código da Turma"}),e.jsx("div",{className:"bg-slate-100 dark:bg-slate-800 rounded-xl p-6",children:e.jsx("div",{className:"text-4xl font-bold text-blue-600 dark:text-blue-400 font-mono tracking-wider",children:t})}),e.jsxs(R,{onClick:l,variant:"outline",className:"mt-3",size:"sm",children:[e.jsx(Pe,{className:"w-4 h-4 mr-2"}),"Copiar Código"]})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-3",children:"QR Code"}),e.jsx("div",{className:"flex justify-center",children:e.jsx("div",{className:"bg-white p-4 rounded-xl",children:e.jsx("canvas",{ref:r})})}),e.jsx("p",{className:"text-xs text-slate-500 mt-2",children:"Escaneie para acessar o link de convite"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Link de Convite"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:a,readOnly:!0,className:"flex-1 px-3 py-2 text-sm border border-slate-300 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-800"}),e.jsx(R,{onClick:i,variant:"outline",size:"sm",children:e.jsx(Pe,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-slate-200 dark:border-slate-800",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-slate-900 dark:text-white",children:o.studentCount||0}),e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:o.studentCount===1?"Aluno":"Alunos"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:o.student_capacity||"∞"}),e.jsx("div",{className:"text-xs text-slate-600 dark:text-slate-400",children:"Capacidade"})]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(R,{onClick:c,variant:"outline",className:"flex-1",children:[e.jsx(Lt,{className:"w-4 h-4 mr-2"}),"Baixar QR Code"]}),e.jsxs(R,{onClick:g,className:"flex-1 bg-gradient-to-r from-blue-600 to-cyan-600",children:[e.jsx(Qt,{className:"w-4 h-4 mr-2"}),"Compartilhar"]})]})]})]})}):null},Tr=({classData:s,index:n,onUpdate:o})=>{const r=ht(),[t,a]=T.useState(!1),[l,i]=T.useState(!1),[c,g]=T.useState(!1),[u,x]=T.useState(!1),f=async()=>{try{const{error:M}=await P.from("classes").update({is_active:!s.is_active}).eq("id",s.id);if(M)throw M;I({title:s.is_active?"Turma arquivada!":"Turma restaurada!",description:s.is_active?"A turma foi arquivada com sucesso.":"A turma foi restaurada com sucesso."}),o()}catch(M){console.error("Erro ao arquivar turma:",M),I({title:"Erro",description:"Não foi possível arquivar a turma.",variant:"destructive"})}},m=async()=>{if(s.studentCount>0||s.activityCount>0){I({title:"Não é possível excluir",description:"A turma possui alunos ou atividades. Arquive a turma ao invés de excluí-la.",variant:"destructive"});return}try{const{error:M}=await P.from("classes").delete().eq("id",s.id);if(M)throw M;I({title:"Turma excluída!",description:"A turma foi excluída permanentemente."}),o()}catch(M){console.error("Erro ao excluir turma:",M),I({title:"Erro ao excluir",description:"Não foi possível excluir a turma.",variant:"destructive"})}finally{a(!1)}},v=M=>M>=7?"text-green-600":M>=5?"text-yellow-600":"text-red-600",C=s.color||"from-blue-600 to-cyan-500";return e.jsx(gt.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},transition:{delay:n*.05},children:e.jsxs(U,{className:`overflow-hidden hover:shadow-xl transition-all ${s.is_active===!1?"opacity-60":""}`,children:[e.jsxs("div",{className:`h-32 bg-gradient-to-r ${C} flex items-center justify-center relative`,children:[e.jsx("div",{className:"absolute inset-0 bg-grid-white/[0.05] bg-[size:20px_20px]"}),e.jsx(Se,{className:"w-12 h-12 text-white relative z-10"}),e.jsx("div",{className:"absolute top-3 right-3 flex flex-col gap-2",children:s.is_active===!1&&e.jsx(xt,{className:"bg-gray-600 text-white",children:"Arquivada"})})]}),e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-xl font-bold text-slate-900 dark:text-white mb-1 line-clamp-2",children:s.name}),e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400 mb-2",children:s.subject}),s.description&&e.jsx("p",{className:"text-sm text-slate-500 dark:text-slate-500 line-clamp-2 mb-4",children:s.description}),e.jsxs("div",{className:"grid grid-cols-2 gap-4 mb-4 pt-4 border-t border-slate-200 dark:border-slate-700",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(vt,{className:"w-4 h-4 text-slate-400"}),e.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:[s.studentCount," ",s.studentCount===1?"aluno":"alunos"]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(qt,{className:"w-4 h-4 text-slate-400"}),e.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:[s.activityCount," ",s.activityCount===1?"atividade":"atividades"]})]}),s.avgGrade>0&&e.jsxs("div",{className:"flex items-center gap-2 col-span-2",children:[e.jsx(yt,{className:"w-4 h-4 text-slate-400"}),e.jsxs("span",{className:"text-sm text-slate-600 dark:text-slate-400",children:["Média: ",e.jsx("span",{className:`font-semibold ${v(s.avgGrade)}`,children:s.avgGrade.toFixed(1)})]})]})]}),e.jsxs("p",{className:"text-xs text-slate-500 mb-4",children:["Atualizada ",nr(new Date(s.updated_at),{locale:Ut,addSuffix:!0})]}),t&&e.jsxs("div",{className:"mb-4 p-3 bg-red-50 dark:bg-red-950/20 border border-red-200 dark:border-red-800 rounded-lg",children:[e.jsx("p",{className:"text-sm text-red-800 dark:text-red-200 mb-2",children:"Confirmar exclusão permanente?"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(R,{size:"sm",variant:"outline",onClick:()=>a(!1),children:"Cancelar"}),e.jsx(R,{size:"sm",onClick:m,className:"bg-red-600 hover:bg-red-700",children:"Excluir"})]})]}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs(R,{onClick:()=>r(`/dashboard/classes/${s.id}`),className:"w-full bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:[e.jsx(Vt,{className:"w-4 h-4 mr-2"}),"Abrir Turma"]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2",children:[e.jsx(R,{variant:"outline",size:"sm",onClick:()=>i(!0),title:"Editar",children:e.jsx(Ht,{className:"w-4 h-4"})}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>x(!0),title:"Ver Código",children:e.jsx($t,{className:"w-4 h-4"})}),e.jsx(R,{variant:"outline",size:"sm",onClick:()=>g(!0),title:"Configurações",children:e.jsx(Gt,{className:"w-4 h-4"})})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs(R,{variant:"outline",size:"sm",onClick:f,className:"flex-1",title:s.is_active?"Arquivar":"Restaurar",children:[e.jsx(wt,{className:"w-4 h-4 mr-1"}),s.is_active?"Arquivar":"Restaurar"]}),s.studentCount===0&&s.activityCount===0&&e.jsxs(R,{variant:"outline",size:"sm",onClick:()=>a(!0),className:"flex-1 text-red-600 hover:text-red-700 hover:bg-red-50",title:"Excluir",children:[e.jsx(bt,{className:"w-4 h-4 mr-1"}),"Excluir"]})]})]}),l&&e.jsx(ir,{isOpen:l,onClose:()=>i(!1),onSuccess:o,classData:s}),c&&e.jsx(or,{isOpen:c,onClose:()=>g(!1),onSuccess:o,classData:s}),u&&e.jsx(Br,{isOpen:u,onClose:()=>x(!1),classData:s})]})]})})},Rr=({isOpen:s,onClose:n,onSuccess:o,teacherId:r})=>{const t=ht(),[a,l]=T.useState(!1),[i,c]=T.useState({name:"",subject:"",description:"",color:"from-blue-600 to-cyan-500",student_capacity:30,invite_code:g()});function g(){const f="ABCDEFGHJKLMNPQRSTUVWXYZ23456789";let m="";for(let v=0;v<8;v++)m+=f.charAt(Math.floor(Math.random()*f.length));return m}const u=async f=>{if(f.preventDefault(),!i.name.trim()||!i.subject.trim()){I({title:"Campos obrigatórios",description:"Preencha o nome e a disciplina da turma.",variant:"destructive"});return}try{l(!0);const{data:m}=await P.from("classes").select("id").eq("invite_code",i.invite_code).single();if(m){const _=g();c({...i,invite_code:_}),I({title:"Código duplicado",description:"Gerando novo código automaticamente..."});return}const{data:v,error:C}=await P.from("classes").insert([{name:i.name,subject:i.subject,description:i.description,color:i.color,invite_code:i.invite_code,student_capacity:i.student_capacity,created_by:r,professor_id:r,is_active:!0}]).select().single();if(C)throw C;const{error:M}=await P.from("class_members").insert([{class_id:v.id,user_id:r,role:"teacher"}]);if(M)throw M;I({title:"Turma criada!",description:"Sua turma foi criada com sucesso."}),o(),t(`/dashboard/classes/${v.id}`)}catch(m){console.error("Erro ao criar turma:",m),I({title:"Erro ao criar turma",description:"Não foi possível criar a turma.",variant:"destructive"})}finally{l(!1)}},x=[{value:"from-blue-600 to-cyan-500",label:"Azul-Ciano"},{value:"from-green-600 to-emerald-500",label:"Verde"},{value:"from-purple-600 to-pink-500",label:"Roxo-Rosa"},{value:"from-orange-600 to-red-500",label:"Laranja-Vermelho"},{value:"from-indigo-600 to-blue-500",label:"Índigo"},{value:"from-teal-600 to-cyan-500",label:"Teal"}];return s?e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black/50 p-4",children:e.jsxs("div",{className:"bg-white dark:bg-slate-900 rounded-2xl shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsx("div",{className:"sticky top-0 bg-gradient-to-r from-blue-600 to-cyan-500 p-6 rounded-t-2xl",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-white",children:"Nova Turma"}),e.jsx("p",{className:"text-cyan-100 text-sm mt-1",children:"Configure as informações básicas da turma"})]}),e.jsx("button",{onClick:n,className:"text-white hover:bg-white/20 p-2 rounded-lg transition-colors",children:e.jsx(ee,{className:"w-5 h-5"})})]})}),e.jsxs("form",{onSubmit:u,className:"p-6 space-y-6",children:[e.jsxs("div",{className:"space-y-4",children:[e.jsx("h3",{className:"font-semibold text-lg text-slate-900 dark:text-white",children:"Informações Básicas"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Nome da Turma *"}),e.jsx("input",{type:"text",value:i.name,onChange:f=>c({...i,name:f.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",placeholder:"Ex: Matemática Avançada 2025.1",maxLength:100,required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Disciplina *"}),e.jsx("input",{type:"text",value:i.subject,onChange:f=>c({...i,subject:f.target.value}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",placeholder:"Ex: Matemática, Física, Programação",maxLength:50,required:!0})]}),e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300",children:"Descrição"}),e.jsxs("span",{className:"text-xs text-slate-500",children:[i.description.length,"/500"]})]}),e.jsx("textarea",{value:i.description,onChange:f=>{f.target.value.length<=500&&c({...i,description:f.target.value})},rows:3,className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",placeholder:"Descreva o conteúdo, objetivos e características da turma..."})]})]}),e.jsxs("div",{className:"space-y-4 pt-4 border-t border-slate-200 dark:border-slate-800",children:[e.jsx("h3",{className:"font-semibold text-lg text-slate-900 dark:text-white",children:"Configurações"}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Número Máximo de Alunos"}),e.jsx("input",{type:"number",value:i.student_capacity,onChange:f=>c({...i,student_capacity:parseInt(f.target.value)||0}),className:"w-full px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",min:"1",max:"1000"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Cor do Banner"}),e.jsx("div",{className:"grid grid-cols-3 gap-3",children:x.map(f=>e.jsxs("button",{type:"button",onClick:()=>c({...i,color:f.value}),className:`p-3 rounded-lg border-2 transition-all ${i.color===f.value?"border-blue-600 scale-105":"border-slate-200 dark:border-slate-700 hover:border-blue-300"}`,children:[e.jsx("div",{className:`h-8 rounded bg-gradient-to-r ${f.value} mb-2`}),e.jsx("span",{className:"text-xs text-slate-600 dark:text-slate-400",children:f.label})]},f.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-slate-700 dark:text-slate-300 mb-2",children:"Código de Convite"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:i.invite_code,readOnly:!0,className:"flex-1 px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg bg-slate-50 dark:bg-slate-800 font-mono"}),e.jsx(R,{type:"button",variant:"outline",onClick:()=>c({...i,invite_code:g()}),children:e.jsx(mt,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-slate-500 mt-1",children:"Alunos usarão este código para entrar na turma"})]})]}),e.jsxs("div",{className:"flex items-center gap-3 pt-4 border-t border-slate-200 dark:border-slate-800",children:[e.jsx(R,{type:"button",variant:"outline",onClick:n,disabled:a,className:"flex-1",children:"Cancelar"}),e.jsx(R,{type:"submit",disabled:a,className:"flex-1 bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:a?e.jsxs(e.Fragment,{children:[e.jsx(Z,{size:"sm",className:"mr-2"}),"Criando..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ae,{className:"w-4 h-4 mr-2"}),"Criar Turma"]})})]})]})]})}):null},fs=()=>{const{user:s}=Mt(),[n,o]=T.useState(!0),[r,t]=T.useState([]),[a,l]=T.useState([]),[i,c]=T.useState({totalActive:0,totalStudents:0,avgGrade:0,totalArchived:0}),[g,u]=T.useState(!1),[x,f]=T.useState(!1),[m,v]=T.useState({searchTerm:"",subject:"all",status:"active",sortBy:"recent"});T.useEffect(()=>{s?.id&&(C(),M())},[s,g]),T.useEffect(()=>{_()},[r,m]);const C=T.useCallback(async()=>{try{o(!0);const h=await Bt.cacheQuery(`teacher:${s.id}:classes`,async()=>{const{data:E,error:d}=await P.from("classes").select("*").eq("created_by",s.id).order("updated_at",{ascending:!1});if(d)throw d;const b=E.map(y=>y.id),[j,w]=await Promise.all([P.from("class_members").select("class_id").in("class_id",b).eq("role","student"),P.from("activity_class_assignments").select("class_id, activity_id").in("class_id",b)]),k={},N={};return j.data?.forEach(y=>{k[y.class_id]=(k[y.class_id]||0)+1}),w.data?.forEach(y=>{N[y.class_id]=(N[y.class_id]||0)+1}),E.map(y=>({...y,studentCount:k[y.id]||0,activityCount:N[y.id]||0,avgGrade:0}))},300);t(h)}catch(h){console.error("Erro ao carregar turmas:",h),I({title:"Erro ao carregar turmas",description:"Não foi possível carregar suas turmas.",variant:"destructive"})}finally{o(!1)}},[s?.id]),M=async()=>{try{const{data:h}=await P.from("classes").select("id, is_active").eq("created_by",s.id),E=h?.filter(p=>p.is_active)||[],d=h?.filter(p=>!p.is_active)||[],{data:b}=await P.from("class_members").select("user_id").in("class_id",h?.map(p=>p.id)||[]).eq("role","student"),j=new Set(b?.map(p=>p.user_id)||[]),{data:w}=await P.from("activity_class_assignments").select("activity_id").in("class_id",E.map(p=>p.id)),k=w?.map(p=>p.activity_id)||[];let N=0;if(k.length>0){const{data:p}=await P.from("submissions").select("grade").in("activity_id",k).not("grade","is",null);p&&p.length>0&&(N=p.reduce((A,L)=>A+L.grade,0)/p.length)}c({totalActive:E.length,totalStudents:j.size,avgGrade:Number(N.toFixed(1)),totalArchived:d.length})}catch(h){console.error("Erro ao carregar estatísticas:",h)}},_=()=>{let h=[...r];if(m.searchTerm){const E=m.searchTerm.toLowerCase();h=h.filter(d=>d.name.toLowerCase().includes(E)||d.subject?.toLowerCase().includes(E))}switch(m.subject!=="all"&&(h=h.filter(E=>E.subject===m.subject)),m.status==="active"?h=h.filter(E=>E.is_active!==!1):m.status==="archived"&&(h=h.filter(E=>E.is_active===!1)),m.sortBy){case"recent":h.sort((E,d)=>new Date(d.updated_at)-new Date(E.updated_at));break;case"alphabetical":h.sort((E,d)=>E.name.localeCompare(d.name));break;case"alphabetical-desc":h.sort((E,d)=>d.name.localeCompare(E.name));break;case"most-students":h.sort((E,d)=>d.studentCount-E.studentCount);break;case"least-students":h.sort((E,d)=>E.studentCount-d.studentCount);break}l(h)},B=[...new Set(r.map(h=>h.subject).filter(Boolean))],S=h=>h>=7?"text-green-600":h>=5?"text-yellow-600":"text-red-600";return n?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsx(Z,{size:"lg"})}):e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 to-slate-100 dark:from-slate-950 dark:to-slate-900 p-6",children:[e.jsxs("div",{className:"relative mb-6 overflow-hidden rounded-2xl bg-gradient-to-r from-blue-600 to-cyan-500 p-8 text-white shadow-lg",children:[e.jsx("div",{className:"absolute inset-0 bg-grid-white/[0.05] bg-[size:20px_20px]"}),e.jsxs(gt.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},className:"relative z-10 flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold mb-2",children:"Minhas Turmas"}),e.jsx("p",{className:"text-cyan-100",children:"Gerencie suas turmas, alunos e atividades"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer bg-white/10 hover:bg-white/20 px-4 py-2 rounded-lg transition-colors",children:[e.jsx("input",{type:"checkbox",checked:g,onChange:h=>u(h.target.checked),className:"w-4 h-4"}),e.jsx("span",{className:"text-sm",children:"Mostrar Arquivadas"})]}),e.jsxs(R,{onClick:()=>f(!0),className:"bg-white text-blue-600 hover:bg-white/90",children:[e.jsx(pt,{className:"w-4 h-4 mr-2"}),"Nova Turma"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsx(U,{className:"p-6 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Turmas Ativas"}),e.jsx("p",{className:"text-3xl font-bold text-slate-900 dark:text-white mt-1",children:i.totalActive})]}),e.jsx("div",{className:"p-3 bg-blue-100 dark:bg-blue-900/30 rounded-lg",children:e.jsx(Se,{className:"w-6 h-6 text-blue-600 dark:text-blue-400"})})]})}),e.jsx(U,{className:"p-6 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Total de Alunos"}),e.jsx("p",{className:"text-3xl font-bold text-slate-900 dark:text-white mt-1",children:i.totalStudents})]}),e.jsx("div",{className:"p-3 bg-cyan-100 dark:bg-cyan-900/30 rounded-lg",children:e.jsx(vt,{className:"w-6 h-6 text-cyan-600 dark:text-cyan-400"})})]})}),e.jsx(U,{className:"p-6 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Média Geral"}),e.jsx("p",{className:`text-3xl font-bold mt-1 ${S(i.avgGrade)}`,children:i.avgGrade.toFixed(1)})]}),e.jsx("div",{className:"p-3 bg-green-100 dark:bg-green-900/30 rounded-lg",children:e.jsx(yt,{className:"w-6 h-6 text-green-600 dark:text-green-400"})})]})}),e.jsx(U,{className:"p-6 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 cursor-pointer hover:shadow-lg transition-shadow",onClick:()=>u(!g),children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-slate-600 dark:text-slate-400",children:"Arquivadas"}),e.jsx("p",{className:"text-3xl font-bold text-slate-900 dark:text-white mt-1",children:i.totalArchived})]}),e.jsx("div",{className:"p-3 bg-gray-100 dark:bg-gray-800 rounded-lg",children:e.jsx(wt,{className:"w-6 h-6 text-gray-600 dark:text-gray-400"})})]})})]}),e.jsx(U,{className:"p-4 mb-6 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(Kt,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-slate-400"}),e.jsx("input",{type:"text",value:m.searchTerm,onChange:h=>v({...m,searchTerm:h.target.value}),placeholder:"Buscar turma por nome ou disciplina...",className:"w-full pl-10 pr-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800"})]}),e.jsxs("select",{value:m.subject,onChange:h=>v({...m,subject:h.target.value}),className:"px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",children:[e.jsx("option",{value:"all",children:"Todas as Disciplinas"}),B.map(h=>e.jsx("option",{value:h,children:h},h))]}),e.jsxs("select",{value:m.sortBy,onChange:h=>v({...m,sortBy:h.target.value}),className:"px-3 py-2 border border-slate-300 dark:border-slate-700 rounded-lg focus:ring-2 focus:ring-blue-500 dark:bg-slate-800",children:[e.jsx("option",{value:"recent",children:"Atualizadas Recentemente"}),e.jsx("option",{value:"alphabetical",children:"Alfabética (A-Z)"}),e.jsx("option",{value:"alphabetical-desc",children:"Alfabética (Z-A)"}),e.jsx("option",{value:"most-students",children:"Mais Alunos"}),e.jsx("option",{value:"least-students",children:"Menos Alunos"})]})]})}),a.length===0?e.jsxs(U,{className:"p-12 bg-white dark:bg-slate-900 border border-slate-200 dark:border-slate-800 text-center",children:[e.jsx(Se,{className:"w-16 h-16 mx-auto mb-4 text-slate-300"}),e.jsx("h3",{className:"text-xl font-semibold text-slate-900 dark:text-white mb-2",children:r.length===0?"Nenhuma turma criada ainda":"Nenhuma turma encontrada"}),e.jsx("p",{className:"text-slate-600 dark:text-slate-400 mb-4",children:r.length===0?"Comece criando sua primeira turma":"Tente ajustar os filtros"}),e.jsx(R,{onClick:()=>{r.length===0?f(!0):v({searchTerm:"",subject:"all",status:"active",sortBy:"recent"})},className:"bg-gradient-to-r from-blue-600 to-cyan-600 hover:from-blue-700 hover:to-cyan-700",children:r.length===0?"Criar Primeira Turma":"Limpar Filtros"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map((h,E)=>e.jsx(Tr,{classData:h,index:E,onUpdate:C},h.id))}),x&&e.jsx(Rr,{isOpen:x,onClose:()=>f(!1),onSuccess:()=>{C(),M()},teacherId:s?.id})]})};export{fs as default};
